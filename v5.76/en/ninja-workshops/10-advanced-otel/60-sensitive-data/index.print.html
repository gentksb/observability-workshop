<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=print><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=generator content="Relearn 7.2.1"><meta name=description content="In this section, you’ll learn how to configure the OpenTelemetry Collector to remove specific tags and redact sensitive data from your telemetry (traces). This is essential when dealing with sensitive information such as credit card numbers, personal data, or other security-related information that needs to be protected or anonymized.
We’ll walk through how to configure several processors in the OpenTelemetry Collector, including:
Removing Tags. Redacting Sensitive Data (such as credit card numbers and account credentials). Using regular expressions to block sensitive data. By the end of this workshop, you’ll have a working OpenTelemetry Collector configuration that securely handles sensitive telemetry data."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Removing Tags and Redacting Sensitive Data in OpenTelemetry Collector :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="In this section, you’ll learn how to configure the OpenTelemetry Collector to remove specific tags and redact sensitive data from your telemetry (traces). This is essential when dealing with sensitive information such as credit card numbers, personal data, or other security-related information that needs to be protected or anonymized.
We’ll walk through how to configure several processors in the OpenTelemetry Collector, including:
Removing Tags. Redacting Sensitive Data (such as credit card numbers and account credentials). Using regular expressions to block sensitive data. By the end of this workshop, you’ll have a working OpenTelemetry Collector configuration that securely handles sensitive telemetry data."><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.76/en/ninja-workshops/10-advanced-otel/60-sensitive-data/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Removing Tags and Redacting Sensitive Data in OpenTelemetry Collector :: Splunk Observability Cloud Workshops"><meta property="og:description" content="In this section, you’ll learn how to configure the OpenTelemetry Collector to remove specific tags and redact sensitive data from your telemetry (traces). This is essential when dealing with sensitive information such as credit card numbers, personal data, or other security-related information that needs to be protected or anonymized.
We’ll walk through how to configure several processors in the OpenTelemetry Collector, including:
Removing Tags. Redacting Sensitive Data (such as credit card numbers and account credentials). Using regular expressions to block sensitive data. By the end of this workshop, you’ll have a working OpenTelemetry Collector configuration that securely handles sensitive telemetry data."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Removing Tags and Redacting Sensitive Data in OpenTelemetry Collector :: Splunk Observability Cloud Workshops"><meta itemprop=description content="In this section, you’ll learn how to configure the OpenTelemetry Collector to remove specific tags and redact sensitive data from your telemetry (traces). This is essential when dealing with sensitive information such as credit card numbers, personal data, or other security-related information that needs to be protected or anonymized.
We’ll walk through how to configure several processors in the OpenTelemetry Collector, including:
Removing Tags. Redacting Sensitive Data (such as credit card numbers and account credentials). Using regular expressions to block sensitive data. By the end of this workshop, you’ll have a working OpenTelemetry Collector configuration that securely handles sensitive telemetry data."><meta itemprop=dateModified content="2025-01-20T16:39:01+00:00"><meta itemprop=wordCount content="953"><title>Removing Tags and Redacting Sensitive Data in OpenTelemetry Collector :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.76/en/ninja-workshops/10-advanced-otel/60-sensitive-data/index.html rel=canonical type=text/html title="Removing Tags and Redacting Sensitive Data in OpenTelemetry Collector :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.76/images/favicon.ico?1737480558 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.76/css/fontawesome-all.min.css?1737480558 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.76/css/fontawesome-all.min.css?1737480558 rel=stylesheet></noscript><link href=/observability-workshop/v5.76/css/auto-complete.css?1737480558 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.76/css/auto-complete.css?1737480558 rel=stylesheet></noscript><link href=/observability-workshop/v5.76/css/perfect-scrollbar.min.css?1737480558 rel=stylesheet><link href=/observability-workshop/v5.76/css/theme.min.css?1737480558 rel=stylesheet><link href=/observability-workshop/v5.76/css/format-print.min.css?1737480558 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../..",window.relearn.relBaseUri="../../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.76",window.relearn.min=`.min`,window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.themevariants=["auto","splunk-light","splunk-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}}))},window.relearn.markVariant=function(){var t=window.localStorage.getItem(window.relearn.absBaseUri+"/variant"),e=document.querySelector("#R-select-variant");e&&(e.value=t)},window.relearn.initVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA"})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.76/en/ninja-workshops/10-advanced-otel/60-sensitive-data/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><ul><li><a href=#step-1-review-the-yaml-configuration>Step 1: Review the YAML Configuration</a></li><li><a href=#breakdown-of-key-configurations>Breakdown of Key Configurations</a></li><li><a href=#step-2-apply-and-test-the-configuration>Step 2: Apply and Test the Configuration</a></li><li><a href=#23-generate-some-sample-data>2.3 Generate Some Sample Data</a></li><li><a href=#24-verify-the-redaction>2.4 Verify the Redaction</a></li><li><a href=#step-3-debugging-and-monitoring>Step 3: Debugging and Monitoring</a></li><li><a href=#step-4-advanced-configuration-optional>Step 4: Advanced Configuration (Optional)</a></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.76/en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.76/en/ninja-workshops/index.html><span itemprop=name>Ninja Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.76/en/ninja-workshops/10-advanced-otel/index.html><span itemprop=name>Advanced OpenTelemetry</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>6. Sensitive Data</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-print" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.76/en/ninja-workshops/10-advanced-otel/60-sensitive-data/index.print.html title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></div><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.76/en/ninja-workshops/10-advanced-otel/50-dropping-spans/index.html title="Using a Filter to Drop Spans in OpenTelemetry Collector (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.76/en/ninja-workshops/10-advanced-otel/70-transform-data/index.html title="Using the OpenTelemetry Transform Processor (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable ninja-workshops" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=removing-tags-and-redacting-sensitive-data-in-opentelemetry-collector>Removing Tags and Redacting Sensitive Data in OpenTelemetry Collector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>In this section, you&rsquo;ll learn how to configure the OpenTelemetry Collector to remove specific tags and redact sensitive data from your telemetry (traces). This is essential when dealing with sensitive information such as credit card numbers, personal data, or other security-related information that needs to be protected or anonymized.</p><p>We&rsquo;ll walk through how to configure several processors in the OpenTelemetry Collector, including:</p><ul><li><strong>Removing Tags</strong>.</li><li><strong>Redacting Sensitive Data</strong> (such as credit card numbers and account credentials).</li><li><strong>Using regular expressions to block sensitive data</strong>.</li></ul><p>By the end of this workshop, you&rsquo;ll have a working OpenTelemetry Collector configuration that securely handles sensitive telemetry data.</p><p>Here’s a breakdown of the main components:</p><p>Processors: These will handle the data removal and redaction.
Batch Processor: We&rsquo;ll use it to control how traces are batched and exported.
Memory Limiter: Ensures that the collector does not consume too much memory.
Redaction Processor: A dedicated processor for redacting sensitive data, including credit card numbers and account details.</p><h3 id=step-1-review-the-yaml-configuration>Step 1: Review the YAML Configuration</h3><p>Let&rsquo;s look at the YAML configuration for this workshop. This file contains various processors and how they are configured to remove and redact sensitive data.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Batch processor to control batch size and metadata keys</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata_keys</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>X-SF-Token</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Memory Limiter processor to prevent excessive memory usage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>memory_limiter</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>check_interval</span><span class=p>:</span><span class=w> </span><span class=l>2s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>limit_mib</span><span class=p>:</span><span class=w> </span><span class=m>512</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Resource detection processor to detect system resource attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>override</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Resource processor to add a new mode attribute</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resource/add_mode</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;agent&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>otelcol.service.mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Attributes processor to remove specific tags (attributes) from traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/removetags</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>SPAN_TAG_KEY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>delete</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Attributes processor to update or redact sensitive data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/update</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>cc_number</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>redacted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>update </span><span class=w> </span><span class=c># Redacts credit card numbers with the word &#39;redacted&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>account_password</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>delete </span><span class=w> </span><span class=c># Deletes account password attribute</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>account_email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>hash </span><span class=w> </span><span class=c># Hashes the account email for privacy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Redaction processor to apply custom redaction rules</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>redaction/update</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>allow_all_keys</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>  </span><span class=c># Block non-allowed keys</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>allowed_keys</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>description</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>group</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ignored_keys</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>safe_attribute </span><span class=w> </span><span class=c># Safe attributes that won’t be redacted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>blocked_values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;4[0-9]{12}(?:[0-9]{3})?&#34;</span><span class=w>  </span><span class=c># Regular expression for Visa credit card numbers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;(5[1-5][0-9]{14})&#34;</span><span class=w>        </span><span class=c># Regular expression for MasterCard numbers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=l>debug </span><span class=w> </span><span class=c># Diagnostic summary of redacted attributes</span></span></span></code></pre></div><h3 id=breakdown-of-key-configurations>Breakdown of Key Configurations</h3><h4 id=1-remove-tags-attributes>1. Remove Tags (Attributes)</h4><p>The attributes/removetags processor allows you to delete specific attributes (tags) from spans. In this case, we&rsquo;re removing the tag SPAN_TAG_KEY:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>attributes/removetags</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>SPAN_TAG_KEY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>delete</span></span></span></code></pre></div><h4 id=2-update-sensitive-data>2. Update Sensitive Data</h4><p>The attributes/update processor is used to update or redact sensitive data. We perform the following actions:</p><p>Redacting credit card numbers: Replace the cc_number with the word &ldquo;redacted&rdquo;.
Deleting the account_password field to remove passwords from traces.
Hashing the account_email to anonymize email addresses.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>attributes/update</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>cc_number</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>redacted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>account_password</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>delete</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>account_email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>hash</span></span></span></code></pre></div><h4 id=3-redaction-processor>3. Redaction Processor</h4><p>The redaction/update processor provides fine-grained control over which attributes are allowed or blocked from traces. We configure this processor to:</p><p>Allow specific keys: description, group, id, and name are the only allowed attributes.
Block sensitive data: Credit card numbers matching the provided regex patterns (Visa and MasterCard) will be blocked and redacted.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>redaction/update</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>allow_all_keys</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>allowed_keys</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>description</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>group</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ignored_keys</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>safe_attribute </span><span class=w> </span><span class=c># Attributes that will not be redacted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>blocked_values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=s2>&#34;4[0-9]{12}(?:[0-9]{3})?&#34;</span><span class=w>  </span><span class=c># Visa card regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=s2>&#34;(5[1-5][0-9]{14})&#34;</span><span class=w>         </span><span class=c># MasterCard card regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=l>debug </span><span class=w> </span><span class=c># Show detailed debug information about redactions</span></span></span></code></pre></div><h3 id=step-2-apply-and-test-the-configuration>Step 2: Apply and Test the Configuration</h3><h4 id=21-save-the-configuration>2.1 Save the Configuration</h4><p>Save the YAML configuration above into a file called otel-collector-config.yaml.</p><h4 id=22-run-the-opentelemetry-collector>2.2 Run the OpenTelemetry Collector</h4><p>To run the OpenTelemetry Collector with your configuration file, use the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol --config<span class=o>=</span>otel-collector-config.yaml</span></span></code></pre></div><h3 id=23-generate-some-sample-data>2.3 Generate Some Sample Data</h3><p>To test the configuration, generate some sample telemetry data (traces) that includes sensitive attributes such as:</p><ul><li>cc_number (credit card number),</li><li>account_password (password),</li><li>account_email (email address).</li></ul><p>You can use a test application or OpenTelemetry instrumentation to simulate these traces.</p><h3 id=24-verify-the-redaction>2.4 Verify the Redaction</h3><p>After the collector processes the data, verify that:</p><ul><li>The cc_number field is redacted with the word redacted.</li><li>The account_password field is deleted.</li><li>The account_email field is hashed.</li><li>Sensitive credit card numbers (Visa, MasterCard) are properly masked using regex.</li><li>Check the exported trace data in the file or backend you&rsquo;re using.</li></ul><h3 id=step-3-debugging-and-monitoring>Step 3: Debugging and Monitoring</h3><p>If you&rsquo;re unsure whether the redaction is working correctly, the summary field in the redaction/update processor will provide helpful debug information.</p><ul><li>Set summary: debug in the configuration.</li><li>This will show detailed diagnostic information about which attributes are redacted, deleted, or updated.</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=l>debug </span><span class=w> </span><span class=c># Provides debug-level details on redactions</span></span></span></code></pre></div><p>This will log information about each redacted or deleted attribute, helping you troubleshoot if something is missing.</p><h3 id=step-4-advanced-configuration-optional>Step 4: Advanced Configuration (Optional)</h3><h4 id=41-redacting-more-data>4.1 Redacting More Data</h4><p>You can easily extend the configuration to redact additional sensitive information. For example, if you need to redact phone numbers, social security numbers, or other personally identifiable information (PII), you can add more blocked_values in the redaction processor.</p><p>Example:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>blocked_values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=s2>&#34;(\\+\\d{1,2}\\s?)?\\(?\\d{3}\\)?\\s?-?\\d{3}-?\\d{4}&#34;</span><span class=w>  </span><span class=c># Phone number regex</span></span></span></code></pre></div><h4 id=42-using-multiple-redaction-strategies>4.2 Using Multiple Redaction Strategies</h4><p>You can combine different strategies for redaction, such as:</p><p>-Replacing values with a fixed string (&ldquo;REDACTED&rdquo;).
-Hashing values for anonymity.
-Deleting values to remove them completely from telemetry data.</p><h3 id=conclusion>Conclusion</h3><p>Congratulations! You&rsquo;ve successfully configured the OpenTelemetry Collector to remove tags and redact sensitive data. By following the steps in this workshop, you&rsquo;ve ensured that any sensitive information in your telemetry data is properly handled and protected. This configuration is critical for adhering to privacy standards and ensuring secure handling of data in your observability pipelines.</p><p>Feel free to extend this configuration to suit your own use cases, and explore more advanced redaction patterns based on your requirements.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 20, 2025</span></span></footer></article></div></main></div><script src=/observability-workshop/v5.76/js/clipboard.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/perfect-scrollbar.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/theme.js?1737480558 defer></script></body></html>