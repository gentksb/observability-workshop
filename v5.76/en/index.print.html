<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=print><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=generator content="Relearn 7.2.1"><meta name=description content="Learn how to build observability solutions with Splunk"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Learn how to build observability solutions with Splunk"><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.76/en/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Learn how to build observability solutions with Splunk"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><meta itemprop=description content="Learn how to build observability solutions with Splunk"><meta itemprop=dateModified content="2024-09-18T18:53:13+01:00"><meta itemprop=wordCount content="719"><title>Splunk Observability Workshops :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.76/en/index.html rel=alternate hreflang=x-default><link href=https://splunk.github.io/observability-workshop/v5.76/en/index.html rel=alternate hreflang=en><link href=https://splunk.github.io/observability-workshop/v5.76/ja/index.html rel=alternate hreflang=ja><link href=https://splunk.github.io/observability-workshop/v5.76/en/index.html rel=canonical type=text/html title="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.76/images/favicon.ico?1737480558 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.76/css/fontawesome-all.min.css?1737480558 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.76/css/fontawesome-all.min.css?1737480558 rel=stylesheet></noscript><link href=/observability-workshop/v5.76/css/auto-complete.css?1737480558 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.76/css/auto-complete.css?1737480558 rel=stylesheet></noscript><link href=/observability-workshop/v5.76/css/perfect-scrollbar.min.css?1737480558 rel=stylesheet><link href=/observability-workshop/v5.76/css/theme.min.css?1737480558 rel=stylesheet><link href=/observability-workshop/v5.76/css/format-print.min.css?1737480558 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.relBasePath="..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.76",window.relearn.min=`.min`,window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.themevariants=["auto","splunk-light","splunk-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}}))},window.relearn.markVariant=function(){var t=window.localStorage.getItem(window.relearn.absBaseUri+"/variant"),e=document.querySelector("#R-select-variant");e&&(e.value=t)},window.relearn.initVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA"})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.76/en/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Splunk Observability Workshops</span><meta itemprop=position content="1"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-print" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.76/en/index.print.html title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></div><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class=topbar-control><i class="fa-fw fas fa-chevron-left"></i></span></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.76/en/s4r/index.html title="Splunk4Rookies - Observability Cloud (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable page" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=splunk-observability-workshops>Splunk Observability Workshops</h1><details open class="box cstyle notices splunk"><summary class=box-label><i class="fa-fw fas fa-circle-info"></i>
Welcome</summary><div class=box-content><p>Get insights into your applications and infrastructure in real-time with the help of the monitoring, analytics and response tools of the Splunk Observability Cloud</p><p>These workshops are going to take you through the best-in-class observability platform for ingesting, monitoring, visualizing and analyzing metrics, traces and logs.</p></div></details><p><a href=#R-image-e8effe0fa458dd08c7df513ad846162e class=lightbox-link><img alt=gif class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/images/observability-hero-dashboard.gif style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e8effe0fa458dd08c7df513ad846162e><img alt=gif class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/images/observability-hero-dashboard.gif></a></p><ul class="children children-li children-sort-"><li><a href=/observability-workshop/v5.76/en/s4r/index.html>Splunk4Rookies - Observability Cloud</a><p>In this workshop, we will be showing how Splunk Observability Cloud provides instant visibility of the user experience – from the perspective of the front-end application to its back-end services – Letting you experience some of the most compelling product features and differentiators of Splunk Observability Cloud.</p><ul><li><a href=/observability-workshop/v5.76/en/s4r/1-workshop-goals/index.html>1. Workshop Overview</a><p>Workshop Overview</p></li><li><a href=/observability-workshop/v5.76/en/s4r/2-opentelemetry/index.html>2. OpenTelemetry</a><p>Learn about OpenTelemetry and why you should care about it.</p></li><li><a href=/observability-workshop/v5.76/en/s4r/3-quick-tour/index.html>3. UI - Quick Tour</a><p>A quick tour of the Splunk Observability Cloud UI.</p></li><li><a href=/observability-workshop/v5.76/en/s4r/4-online-boutique/index.html>4. Shopping at the Online Boutique</a><p>Interact with the Online Boutique web application to generate data for Splunk Observability Cloud.</p></li><li><a href=/observability-workshop/v5.76/en/s4r/5-rum/index.html>5. Splunk RUM</a><p>This section helps you understand how to use Splunk RUM to monitor the performance of your applications from the end user's perspective.</p></li><li><a href=/observability-workshop/v5.76/en/s4r/6-apm/index.html>6. Splunk APM</a><p>In this section, we will use APM to drill down and identify where the problem is.</p></li><li><a href=/observability-workshop/v5.76/en/s4r/7-log-observer/index.html>7. Splunk Log Observer</a><p>In this section, we will use Log Observer to drill down and identify what the problem is.</p></li><li><a href=/observability-workshop/v5.76/en/s4r/8-synthetics/index.html>8. Splunk Synthetics</a><p>In this section, you will learn how to use Splunk Synthetics to monitor the performance and availability of your applications.</p></li><li><a href=/observability-workshop/v5.76/en/s4r/9-custom-dashboard/index.html>9. Service Health Dashboard</a><p>In this section, you will learn how to build a custom Service Health Dashboard to monitor the health of your services.</p></li><li><a href=/observability-workshop/v5.76/en/s4r/10-wrap-up/index.html>10. Workshop Wrap-up</a><p>Congratulations, you have completed the Splunk4Rookies - Observability Cloud Workshop. Today, you have become familiar with how to use Splunk Observability Cloud to monitor your applications and infrastructure.</p></li></ul></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/index.html>Ninja Workshops</a><p>The following workshops require Ninja skills, wax on, wax off.</p><ul><li><a href=/observability-workshop/v5.76/en/ninja-workshops/1-automatic-discovery/index.html>Automatic Discovery Workshops</a><p>Automatic Discovery Workshops</p></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/2-hpa/index.html>Horizontal Pod Autoscaling</a><p>This workshop will equip you with the basic understanding of monitoring Kubernetes using the Splunk OpenTelemetry Collector</p></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/index.html>OpenTelemetry Collector</a><p>Learn the concepts of the OpenTelemetry Collector and how to use it to send data to Splunk Observability Cloud.</p></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/4-synthetics-scripting/index.html>Splunk Synthetic Scripting</a><p>Proactively find and fix performance issues across user flows, business transactions and APIs to deliver better digital experiences.</p></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/6-lambda-kinesis/index.html>Lambda Tracing</a><p>This workshop will enable you to build a distributed trace for a small serverless application that runs on AWS Lambda, producing and consuming a message via AWS Kinesis</p></li></ul></li><li><a href=/observability-workshop/v5.76/en/scenarios/index.html>Scenarios</a><p>Learn how to build observability solutions with Splunk</p><ul><li><a href=/observability-workshop/v5.76/en/scenarios/optimize_monitoring/index.html>Optimize Cloud Monitoring</a><p>This scenario is for ITOps teams managing a hybrid infrastructure that need to troubleshoot cloud-native performance issues, by correlating real-time metrics with logs to troubleshoot faster, improve MTTD/MTTR, and optimize costs.</p></li><li><a href=/observability-workshop/v5.76/en/scenarios/debug_problems/index.html>Debug Problems in Microservices</a><p>This scenario helps engineering teams identify and fix issues caused by planned and unplanned changes to their microservices-based applications.</p></li><li><a href=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/index.html>Optimize End User Experiences</a><p>Use Splunk Real User Monitoring (RUM) and Synthetics to get insight into end user experience, and proactively test scenarios to improve that experience.</p></li><li><a href=/observability-workshop/v5.76/en/scenarios/self_service_observability/index.html>Self-Service Observability</a><p>This scenario helps platform engineering (or central tools) teams enable engineers with self-service observability tooling at scale, so developers and SREs can spend less time managing their toolchain and more time building and delivering cool software.</p></li></ul></li><li><a href=/observability-workshop/v5.76/en/resources/index.html>Resources</a><p>Resources for learning about Splunk Observability Cloud</p><ul><li><a href=/observability-workshop/v5.76/en/resources/dimensions_properties_tags/index.html>Dimension, Properties and Tags</a><p>One conversation that frequently comes up is Dimensions vs Properties and when you should use one verus the other.</p></li><li><a href=/observability-workshop/v5.76/en/resources/otel_tagging/index.html>OpenTelemetry Tagging</a><p>When deploying OpenTelemetry in a large organization, it’s critical to define a standardized naming convention for tagging, and a governance process to ensure the convention is adhered to.</p></li><li><a href=/observability-workshop/v5.76/en/resources/local-hosting/index.html>Local Hosting</a><p>Resources for setting up a locally hosted workshop environment.</p></li></ul></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/index.html>Unsupported Field Workshops</a><p><ul class="children children-li children-sort-"><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/1-imt/index.html>Splunk IM</a><p>Splunk delivers real-time monitoring and troubleshooting to help you maximize infrastructure performance with complete visibility.</p></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/3-nodejs-kubernetes/index.html>NodeJS Zero-Config Workshop</a><p>A workshop using Zero Configuration Auto-Instrumentation for NodeJS.</p></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/8-gdi/index.html>GDI (OTel & UF)</a><p>Learn how to get data into Splunk Observability Cloud with OpenTelemetry and the Splunk Universal Forwarder.</p></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/index.html>Splunk OnCall</a><p>Make expensive service outages a thing of the past. Remediate issues faster, reduce on-call burnout and keep your services up and running.</p></p><ul><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/1-imt/index.html>Splunk IM</a><p>Splunk delivers real-time monitoring and troubleshooting to help you maximize infrastructure performance with complete visibility.</p></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/3-nodejs-kubernetes/index.html>NodeJS Zero-Config Workshop</a><p>A workshop using Zero Configuration Auto-Instrumentation for NodeJS.</p></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/8-gdi/index.html>GDI (OTel & UF)</a><p>Learn how to get data into Splunk Observability Cloud with OpenTelemetry and the Splunk Universal Forwarder.</p></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/index.html>Splunk OnCall</a><p>Make expensive service outages a thing of the past. Remediate issues faster, reduce on-call burnout and keep your services up and running.</p></li></ul></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 18, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Splunk Observability Workshops</h1><article class=default><header class=headline></header><h1 id=splunk4rookies---observability-cloud>Splunk4Rookies - Observability Cloud</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Authors
</span><span class=badge-content>Robert Castley
Pieter Hagen</span></span><p>In this workshop, we will be showing how <strong>Splunk Observability Cloud</strong> provides instant visibility of the user experience – from the perspective of the front-end application to its back-end services – Letting you experience some of the most compelling product features and differentiators of <strong>Splunk Observability Cloud</strong>:</p><ul><li>Infrastructure Monitoring</li><li><strong>Full-fidelity</strong> Real User Monitoring (RUM)</li><li>Complete <strong>end-to-end NoSample Full-fidelity</strong> trace visibility with Application Performance Monitoring (APM)</li><li><strong>No code</strong> log querying</li><li>Synthetic Monitoring</li><li>Finding root causes with tag analytics and error stacks</li><li>Related content</li></ul><p>A key factor in building the Splunk Observability Cloud is to unify telemetry data to create a complete picture of an end-user experience and your application stack.</p><p>The workshop uses a microservices-based application that is deployed on AWS EC2 instances. The application is a simple e-commerce application that allows users to browse products, add them to a cart, and checkout. The application is instrumented with OpenTelemetry.</p><hr><p><strong><a href=https://opentelemetry.io rel=external target=_blank>OpenTelemetry</a></strong> is a collection of tools, APIs, and software development kits (SDKs), used to instrument, generate, collect, and export telemetry data (metrics, traces, and logs) to help you analyze your software’s performance and behavior.</p><p>The OpenTelemetry community is growing. As a joint project between Splunk, Google, Microsoft, Amazon, and many other organizations, it currently has the second-largest number of contributors in the Cloud Native Computing Foundation after Kubernetes.</p><p><a href=#R-image-157fed21b7d5abd76b4106f108e8ee81 class=lightbox-link><img alt="Full Stack" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/images/splunk-full-stack.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-157fed21b7d5abd76b4106f108e8ee81><img alt="Full Stack" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/images/splunk-full-stack.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 20, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Splunk4Rookies - Observability Cloud</h1><article class=default><header class=headline></header><h1 id=workshop-overview>Workshop Overview</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h4 id=introduction>Introduction</h4><p>The goal of this workshop is to experience an issue and use Splunk Observability Cloud to troubleshoot and identify the root cause. For this, we have provided a complete microservices-based application running in Kubernetes that has been instrumented to send <strong>metrics, traces, and logs</strong> to Splunk Observability Cloud.</p><h4 id=who-should-attend>Who should attend?</h4><p>Those wanting to gain an understanding of Splunk Observability in a hands-on environment. This workshop is designed for people with little or no experience with Splunk Observability.</p><h4 id=what-youll-need>What you’ll need</h4><p>Just you, your laptop, and a browser that can access external websites. We run these workshops in person or on Zoom, if you don’t have the Zoom client on your device you will be able to access them via a web browser.</p><h4 id=whats-covered-in-this-workshop>What&rsquo;s covered in this workshop?</h4><p>This 3-hour session will take you through the basics of Splunk Observability, the only observability platform with <strong>streaming analytics</strong>, <strong>NoSample Full Fidelity</strong> distributed tracing in a hands-on environment.</p><h5 id=opentelemetry>OpenTelemetry</h5><p>A Quick introduction to <strong>why OpenTelemetry</strong> and why is it important for Observability.</p><h5 id=tour-of-the-splunk-observability-user-interface>Tour of the Splunk Observability User Interface</h5><p>A walkthrough of the various components of Splunk Observability Cloud showing you how to easily navigate the 5 main components:- <strong>APM, RUM, Log Observer, Synthetics and Infrastructure</strong>.</p><h5 id=generate-real-user-data>Generate Real User Data</h5><p>Enjoy some retail therapy using the Online Boutique Website. Use your browser, mobile or tablet to spend some hard-earned virtual money to send <strong>metrics <em>(do we have a problem?)</em>, traces <em>(where is the problem?)</em> and logs <em>(what is the problem?)</em></strong>.</p><h5 id=splunk-real-user-monitoring-rum>Splunk Real User Monitoring (RUM)</h5><p>Examine the real user data that has been provided by the telemetry received from all participants&rsquo; browser sessions. The goal is to find a browser, mobile or tablet session that performed poorly and begin the troubleshooting process.</p><h5 id=splunk-application-performance-monitoring-apm>Splunk Application Performance Monitoring (APM)</h5><p>Discover the power of <strong>full end-to-end visibility</strong> by jumping from a RUM trace (front-end) to an APM trace (back-end). All the services are sending telemetry (traces and spans) that Splunk Observability Cloud can visualize, analyze and use to detect anomalies and errors.</p><h5 id=splunk-log-observer-lo>Splunk Log Observer (LO)</h5><p>Related Content is a powerful feature that allows you to jump from one component to another. In this case, we will jump from the APM trace to the logs to the related logs.</p><h5 id=splunk-synthetics>Splunk Synthetics</h5><p>Wouldn’t it be great if we could have <strong>24/7</strong> monitoring of our application, and be <strong>alerted</strong> when there is a problem? This is where Synthetics comes in. We will show you a simple test that runs every 1 minute and checks the performance and availability of a typical user journey through the Online Boutique.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 20, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=what-is-opentelemetry--why-should-you-care>What is OpenTelemetry & why should you care?</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=opentelemetry>OpenTelemetry</h2><p>With the rise of cloud computing, microservices architectures, and ever-more complex business requirements, the need for Observability has never been greater. Observability is the ability to understand the internal state of a system by examining its outputs. In the context of software, this means being able to understand the internal state of a system by examining its telemetry data, which includes <strong>metrics</strong>, <strong>traces</strong>, and <strong>logs</strong>.</p><p>To make a system observable, it must be instrumented. That is, the code must emit traces, metrics, and logs. The instrumented data must then be sent to an Observability back-end such as <strong>Splunk Observability Cloud</strong>.</p><table><thead><tr><th style=text-align:center>Metrics</th><th style=text-align:center>Traces</th><th style=text-align:center>Logs</th></tr></thead><tbody><tr><td style=text-align:center><em><strong>Do I have a problem?</strong></em></td><td style=text-align:center><em><strong>Where is the problem?</strong></em></td><td style=text-align:center><em><strong>What is the problem?</strong></em></td></tr></tbody></table><p>OpenTelemetry does two important things:</p><ul><li>Allows you to <strong>own</strong> the data that you generate rather than be stuck with a proprietary data format or tool.</li><li>Allows you to learn <strong>a single set</strong> of APIs and conventions</li></ul><p>These two things combined enable teams and organizations the flexibility they need in today’s modern computing world.</p><p>There are a lot of variables to consider when getting started with Observability, including the all-important question: <em>&ldquo;How do I get my data into an Observability tool?&rdquo;</em>. The industry-wide adoption of OpenTelemetry makes this question easier to answer than ever.</p><h2 id=why-should-you-care>Why Should You Care?</h2><p>OpenTelemetry is completely open-source and free to use. In the past, monitoring and Observability tools relied heavily on proprietary agents meaning that the effort required to change or set up additional tooling required a large amount of changes across systems, from the infrastructure level to the application level.</p><p>Since OpenTelemetry is vendor-neutral and supported by many industry leaders in the Observability space, adopters can switch between supported Observability tools at any time with minor changes to their instrumentation. This is true regardless of which distribution of OpenTelemetry is used – like with Linux, the various distributions bundle settings and add-ons but are all fundamentally based on the community-driven OpenTelemetry project.</p><p>Splunk has fully committed to OpenTelemetry so that our customers can collect and use <strong>ALL</strong> their data, in any type, any structure, from any source, on any scale, and all in real-time. OpenTelemetry is fundamentally changing the monitoring landscape, enabling IT and DevOps teams to bring data to every question and every action. You will experience this during these workshops.</p><p><a href=#R-image-e7fee0bf0a9d15d1cc2cc58ee675e631 class=lightbox-link><img alt="OpenTelemetry Logo" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/2-opentelemetry/images/otel.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e7fee0bf0a9d15d1cc2cc58ee675e631><img alt="OpenTelemetry Logo" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/2-opentelemetry/images/otel.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=ui---quick-tour->UI - Quick Tour 🚌</h1><p>We are going to start with a short walkthrough of the various components of Splunk Observability Cloud. The aim of this is to get you familiar with the UI.</p><ol><li><strong>Signing in to Splunk Observability Cloud</strong></li><li><strong>Real User Monitoring (RUM)</strong></li><li><strong>Application Performance Monitoring (APM)</strong></li><li><strong>Log Observer</strong></li><li><strong>Synthetics</strong></li><li><strong>Infrastructure Monitoring</strong></li></ol><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (◀️) and right (▶️) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. UI - Quick Tour</h1><article class=default><header class=headline></header><h1 id=getting-started>Getting Started</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h3 id=1-sign-in-to-splunk-observability-cloud>1. Sign in to Splunk Observability Cloud</h3><p>You should have received an e-mail from Splunk inviting you to the Workshop Org. This e-mail will look like the screenshot below, if you cannot find it, please check your Spam/Junk folders or inform your Instructor. You can also check for other solutions in our <a href=/observability-workshop/v5.76/en/s4r/3-quick-tour/1-homepage/99-login-faq/index.html><strong>login F.A.Q.</strong></a>.</p><p>To proceed click the <strong>Join Now</strong> button or click on the link provided in the e-mail.</p><p>If you have already completed the registration process you can skip the rest and proceed directly to Splunk Observability Cloud and log in:</p><ul><li><a href=https://app.eu0.signalfx.com rel=external target=_blank><strong>https://app.eu0.signalfx.com (EMEA)</strong></a></li><li><a href=https://app.us1.signalfx.com rel=external target=_blank><strong>https://app.us1.signalfx.com (APAC/AMER)</strong></a></li></ul><p><a href=#R-image-834253bd2bd69269913d6fcd092b11f9 class=lightbox-link><img alt=email class="noborder lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.76/en/s4r/3-quick-tour/1-homepage/images/invite-email.png?width=25vw" style=height:auto;width:25vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-834253bd2bd69269913d6fcd092b11f9><img alt=email class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.76/en/s4r/3-quick-tour/1-homepage/images/invite-email.png?width=25vw"></a></p><p>If this is your first time using Splunk Observability Cloud, you will be presented with the registration form. Enter your full name, and desired password. Please note that the password requirements are:</p><ul><li><strong>Must</strong> be between 8 and 32 characters</li><li><strong>Must</strong> contain at least one capital letter</li><li><strong>Must</strong> have at least one number</li><li><strong>Must</strong> have at least one symbol (e.g. !@#$%^&*()_+)</li></ul><p>Click the checkbox to agree to the terms and conditions and click the <strong>SIGN IN NOW</strong> button.</p><p><a href=#R-image-41a7889dfad4ba66a9533ed4f4cd4f96 class=lightbox-link><img alt=User-Setup class="noborder lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.76/en/s4r/3-quick-tour/1-homepage/images/enter-password.png?width=25vw" style=height:auto;width:25vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-41a7889dfad4ba66a9533ed4f4cd4f96><img alt=User-Setup class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.76/en/s4r/3-quick-tour/1-homepage/images/enter-password.png?width=25vw"></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Getting Started</h1><article class=default><header class=headline></header><h1 id=home-page>Home Page</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>After you have registered and logged into Splunk Observability Cloud you will be taken to the home or landing page. Here, you will find several useful features to help you get started.</p><p><a href=#R-image-07eb78f5df871bc41877b13b6ee2756a class=lightbox-link><img alt="home page" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/home-screen.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-07eb78f5df871bc41877b13b6ee2756a><img alt="home page" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/home-screen.png></a></p><ol><li><strong>Explore your data pane:</strong> Displays which integrations are enabled and allows you to add additional integrations if you are an Administrator.</li><li><strong>Documentation pane:</strong> Training videos and links to documentation to get you started with Splunk Observability Cloud.</li><li><strong>Recents pane:</strong> Recently created/visited dashboards and/or detectors for quick access.</li><li><strong>Main Menu pane:</strong> Navigate the components of Splunk Observability Cloud.</li><li><strong>Org Switcher:</strong> Easily switch between Organizations (if you are a member of more than one Organization).</li><li><strong>Expand/Contract Main Menu:</strong> Expand <strong>&#187;</strong> / Collapse <strong>&#171;</strong> the main menu if space is at a premium.</li></ol><p>Let&rsquo;s start with our first exercise:</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Expand the Main Menu and click on <strong>Settings</strong>.</li><li>Check in the <strong>Org Switcher</strong> if you have access to more than one Organization.</li></ul></div></details><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>If you have used Splunk Observability before, you may be placed in an Organization you have used previously. Make sure you are in the correct workshop organization. Verify this with your instructor if you have access to multiple Organizations.</p></div></details><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Click <strong>Onboarding Guidance</strong> (Here you can toggle the visibility of the onboarding panes. This is useful if you know the product well enough, and can use the space to show more information).</li><li>Hide the Onboarding Content for the <strong>Home Page</strong>.</li><li>At the bottom of the menu, select your preferred appearance: <strong>Light</strong>, <strong>Dark</strong> or <strong>Auto</strong> mode.</li><li>Did you also notice this is where the <strong>Sign Out</strong> option is? Please don&rsquo;t 😊 !</li><li>Click <strong>&lt;</strong> to get back to the main menu.</li></ul></div></details><p>Next, let&rsquo;s check out <strong>Splunk Real User Monitoring (RUM)</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 22, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=real-user-monitoring-overview>Real User Monitoring Overview</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>Splunk RUM is the industry’s only end-to-end, <strong>NoSample</strong> RUM solution - providing visibility into the full user experience of every web and mobile session to uniquely combine all front-end traces with back-end metrics, traces, and logs as they happen. IT Operations and Engineering teams can quickly scope, prioritize and isolate errors, measure how performance impacts real users and optimize end-user experiences by correlating performance metrics alongside video reconstructions of all user interactions.</p><p><strong>Full user session analysis:</strong> Streaming analytics capture full user sessions from single and multi-page apps, measuring the customer impact of every resource, image, route change and API call.<br><strong>Correlate issues faster:</strong> Infinite cardinality and full transaction analysis help you pinpoint and correlate issues faster across complex distributed systems.<br><strong>Isolate latency and errors:</strong> Easily identify latency, errors and poor performance for each code change and deployment. Measure how content, images and third-party dependencies impact your customers.<br><strong>Benchmark and improve page performance:</strong> Leverage core web vitals to measure and improve your page load experience, interactivity and visual stability. Find and fix impactful JavaScript errors, and easily understand which pages to improve first.<br><strong>Explore meaningful metrics:</strong> Instantly visualize the customer impact with metrics on specific workflows, custom tags and auto-suggest un-indexed tags to quickly find the root cause of issues.<br><strong>Optimize end-user experience:</strong> Correlate performance metrics alongside video reconstructions of all user interactions to optimize end-user experiences.</p><p><a href=#R-image-532be0884599eec64422a3133a6974f7 class=lightbox-link><img alt="Architecture Overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/2-rum-home/images/rum-architecture.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-532be0884599eec64422a3133a6974f7><img alt="Architecture Overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/2-rum-home/images/rum-architecture.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 20, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. RUM Overview</h1><article class=default><header class=headline></header><h1 id=real-user-monitoring-home-page>Real User Monitoring Home Page</h1><p>Click <strong>RUM</strong> in the main menu, this will bring you to the main RUM Home or Landing page. The main concept of this page is to provide you at a glance, the overall status of all selected RUM applications, either in a full dashboard or the compact view.</p><p>Independent of the type of Status Dashboard used, the RUM Home Page is made up of 3 distinct sections:</p><p><a href=#R-image-32ad63e4dc2c33f254cf2decc27d9ddc class=lightbox-link><img alt="RUM Page" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-main.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-32ad63e4dc2c33f254cf2decc27d9ddc><img alt="RUM Page" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-main.png></a></p><ol><li><strong>Onboarding Pane:</strong> Training videos and links to documentation to get you started with Splunk RUM. (You can hide this pane in case you need the screen real estate).</li><li><strong>Filter Pane:</strong> Filter on the time frame, environment, application and source type.</li><li><strong>Application Summary Pane:</strong> Summary of all your applications that send RUM data.</li></ol><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
RUM Environments & Application and Source Type</summary><div class=box-content><ul><li>Splunk Observability uses the <strong>environments</strong> Tag that is sent as part of the RUM trace, (created with every interaction with your website or Mobile App), to separate data coming from different environments like &ldquo;Production&rdquo; or &ldquo;Development&rdquo;.</li><li>A further separation can be made by the <strong>Applications</strong> Tag. This allows you to distinguish between separate browser/mobile applications running in the same environment.</li><li>Splunk RUM is available for both browser and mobile applications, you could use <strong>Source Type</strong> to distinguish between them, however for this workshop, we will only use browser-based RUM.</li></ul></div></details><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Ensure the time window is set to <strong>-15m</strong></li><li>Select the environment for your workshop from the drop-down box. The naming convention is <strong>[NAME OF WORKSHOP]-workshop</strong> (Selecting this will make sure the workshop RUM application is visible)</li><li>Select the <strong>App</strong> name. There the naming convention is <strong>[NAME OF WORKSHOP]-store</strong> and leave <strong>Source</strong> set to <strong>All</strong></li><li>In the <strong>JavaScript Errors</strong> tile click on the <strong>TypeError</strong> entry that says: <em>Cannot read properties of undefined (reading &lsquo;Prcie&rsquo;)</em> to see more details. Note that you are given a quick indication of what part of the website the error occurred, allowing you to fix this quickly.</li><li>Close the pane.</li><li>The 3rd tile reports <strong>Web Vitals</strong>, a metric that focuses on three important aspects of the user experience: <em>loading</em>, <em>interactivity</em>, and <em>visual stability</em>.</li></ul><div class=tab-panel data-tab-group=311313e8f552413c802acea40fd2d80c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("311313e8f552413c802acea40fd2d80c","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("311313e8f552413c802acea40fd2d80c","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Based on the <strong>Web Vitals</strong> metrics, how do you rate the current web performance of the site?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>According to the <em>Web Vitals</em> Metrics, the initial load of the site is OK and is rated <em>Good</em></strong></p></div></div></div></div><ul><li>The last tile, <strong>Most recent detectors</strong> tile, will show if any alerts have been triggered for the application.</li><li>Click on the down <strong>⌵</strong> arrow in front of the Application name to toggle the view to the compact style. Note that you have all the main information available in this view as well. Click anywhere in the compact view to go back to the full view.</li></ul></div></details><p>Next, let&rsquo;s check out <strong>Splunk Application Performance Monitoring (APM)</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Feb 16, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=application-performance-monitoring-overview>Application Performance Monitoring Overview</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>Splunk APM provides a <strong>NoSample</strong> end-to-end visibility of every service and its dependency to solve problems quicker across monoliths and microservices. Teams can immediately detect problems from new deployments, confidently troubleshoot by scoping and isolating the source of an issue, and optimize service performance by understanding how back-end services impact end users and business workflows.</p><p><strong>Real-time monitoring and alerting:</strong> Splunk provides out-of-the-box service dashboards and automatically detects and alerts on RED metrics (rate, error and duration) when there is a sudden change.
<strong>Dynamic telemetry maps:</strong> Easily visualize service performance in modern production environments in real-time. End-to-end visibility of service performance from infrastructure, applications, end users, and all dependencies helps quickly scope new issues and troubleshoot more effectively.<br><strong>Intelligent tagging and analysis:</strong> View all tags from your business, infrastructure and applications in one place to easily compare new trends in latency or errors to their specific tag values.<br><strong>AI-directed troubleshooting identifies the most impactful issues:</strong> Instead of manually digging through individual dashboards, isolate problems more efficiently. Automatically identify anomalies and the sources of errors that impact services and customers the most.<br><strong>Complete distributed tracing analyses every transaction:</strong> Identify problems in your cloud-native environment more effectively. Splunk distributed tracing visualizes and correlates every transaction from the back-end and front-end in context with your infrastructure, business workflows and applications.<br><strong>Full stack correlation:</strong> Within Splunk Observability, APM links traces, metrics, logs and profiling together to easily understand the performance of every component and its dependency across your stack.<br><strong>Monitor database query performance:</strong> Easily identify how slow and high execution queries from SQL and NoSQL databases impact your services, endpoints and business workflows — no instrumentation required.</p><p><a href=#R-image-96ad9a40c57c9fa110e332e105f7159c class=lightbox-link><img alt="Architecture Overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/3-apm-home/images/arch-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-96ad9a40c57c9fa110e332e105f7159c><img alt="Architecture Overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/3-apm-home/images/arch-overview.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 20, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. APM Overview</h1><article class=default><header class=headline></header><h1 id=application-performance-monitoring-home-page>Application Performance Monitoring Home page</h1><p>Click <strong>APM</strong> in the main menu, the APM Home Page is made up of 3 distinct sections:</p><p><a href=#R-image-c385479175295566812c3b25a4d20930 class=lightbox-link><img alt="APM page" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-main.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c385479175295566812c3b25a4d20930><img alt="APM page" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-main.png></a></p><ol><li><strong>Onboarding Pane Pane:</strong> Training videos and links to documentation to get you started with Splunk APM.</li><li><strong>APM Overview Pane:</strong> Real-time metrics for the Top Services and Top Business Workflows.</li><li><strong>Functions Pane:</strong> Links for deeper analysis of your services, tags, traces, database query performance and code profiling.</li></ol><p>The <strong>APM Overview</strong> pan provides a high-level view of the health of your application. It includes a summary of the services, latency and errors in your application. It also includes a list of the top services by error rate and the top business workflows by error rate (a business workflow is the start-to-finish journey of the collection of traces associated with a given activity or transaction and enables monitoring of end-to-end KPIs and identifying root causes and bottlenecks).</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
About Environments</summary><div class=box-content><p>To easily differentiate between multiple applications, Splunk uses <strong>environments</strong>. The naming convention for workshop environments is <strong>[NAME OF WORKSHOP]-workshop</strong>. Your instructor will provide you with the correct one to select.</p></div></details><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Verify that the time window we are working with is set to the last 15 minutes (<strong>-15m</strong>).</li><li>Change the environment to the workshop one by selecting its name from the drop-down box and make sure that is the only one selected.</li></ul><div class=tab-panel data-tab-group=8797e1db9c4a36182504ed57108a174d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8797e1db9c4a36182504ed57108a174d","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("8797e1db9c4a36182504ed57108a174d","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>What can you conclude from the <em>Top Services by Error Rate</em> chart?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The <em>paymentservice</em> has a high error rate</strong></p></div></div></div></div></div></details><p>If you scroll down the Overview Page you will notice some services listed have <strong>Inferred Service</strong> next to them.</p><p>Splunk APM can infer the presence of the remote service, or inferred service if the span calling the remote service has the necessary information. Examples of possible inferred services include databases, HTTP endpoints, and message queues. Inferred services are not instrumented, but they are displayed on the service map and the service list.</p><p>Next, let&rsquo;s check out <strong>Splunk Log Observer (LO)</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 1, 2023</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=log-observer-overview>Log Observer Overview</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>Log Observer Connect allows you to seamlessly bring in the same log data from your Splunk Platform into an intuitive and <strong>no-code</strong> interface designed to help you find and fix problems quickly. You can easily perform log-based analysis and seamlessly correlate your logs with Splunk Infrastructure Monitoring’s real-time metrics and Splunk APM traces in one place.</p><p><strong>End-to-end visibility:</strong> By combining the powerful logging capabilities of Splunk Platform with Splunk Observability Cloud’s traces and real-time metrics for deeper insights and more context of your hybrid environment.<br><strong>Perform quick and easy log-based investigations:</strong> By reusing logs that are already ingested in Splunk Cloud Platform or Enterprise in a simplified and intuitive interface (no need to know SPL!) with customizable and out-of-the-box dashboards<br><strong>Achieve higher economies of scale and operational efficiency:</strong> By centralizing log management across teams, breaking down data and team silos, and getting better overall support</p><p><a href=#R-image-6f44c75e39b0bce2d6cf499a95e70be7 class=lightbox-link><img alt="Logo graph" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/4-log-observer-home/images/logo-image-loop.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6f44c75e39b0bce2d6cf499a95e70be7><img alt="Logo graph" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/4-log-observer-home/images/logo-image-loop.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 22, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 4. Log Observer Overview</h1><article class=default><header class=headline></header><h1 id=log-observer-home-page>Log Observer Home Page</h1><p>Click <strong>Log Observer</strong> in the main menu, the Log Observer Home Page is made up of 4 distinct sections:</p><p><a href=#R-image-d32f5d1ddaeea82f13ea424ca5ca4adb class=lightbox-link><img alt="Lo Page" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log-observer-main.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d32f5d1ddaeea82f13ea424ca5ca4adb><img alt="Lo Page" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log-observer-main.png></a></p><ol><li><strong>Onboarding Pane:</strong> Training videos and links to documentation to get you started with Splunk Log Observer.</li><li><strong>Filter Bar:</strong> Filter on time, indexes, and fields and also Save Queries.</li><li><strong>Logs Table Pane:</strong> List of log entries that match the current filter criteria.</li><li><strong>Fields Pane:</strong> List of fields available in the currently selected index.</li></ol><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Splunk indexes</summary><div class=box-content><p>Generally, in Splunk, an &ldquo;index&rdquo; refers to a designated place where your data is stored. It&rsquo;s like a folder or container for your data. Data within a Splunk index is organized and structured in a way that makes it easy to search and analyze. Different indexes can be created to store specific types of data. For example, you might have one index for web server logs, another for application logs, and so on.</p></div></details><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>If you have used Splunk Enterprise or Splunk Cloud before, you are probably used to starting investigations with logs. As you will see in the following exercise, you can do that with Splunk Observability Cloud as well. This workshop, however, will use all the <strong>OpenTelemetry</strong> signals for investigations.</p></div></details><p>Let&rsquo;s run a little search exercise:</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li><p>Set the time frame to <strong>-15m</strong>.</p></li><li><p>Click on <span class="btn cstyle gray"><span><span class=title>Add Filter</span></span></span> in the filter bar then click on <strong>Fields</strong> in the dialog.</p></li><li><p>Type in <strong>cardType</strong> and select it.</p></li><li><p>Under <strong>Top values</strong> click on <strong>visa</strong>, then click on <strong>=</strong> to add it to the filter.</p><p><a href=#R-image-77e9fa58a6de859009cc8ae778ab7aad class=lightbox-link><img alt="logo search" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../images/log-filter-bar.png?width=920px" style=height:auto;width:920px></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-77e9fa58a6de859009cc8ae778ab7aad><img alt="logo search" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../images/log-filter-bar.png?width=920px"></a></p></li><li><p>Click on one of the log entries in the Logs table to validate that the entry contains <code>cardType: "visa"</code>.</p></li><li><p>Let&rsquo;s find all the orders that have been shipped. Click on <strong>Clear All</strong> in the filter bar to remove the previous filter.</p></li><li><p>Click again on <span class="btn cstyle gray"><span><span class=title>Add Filter</span></span></span> in the filter bar, then select <strong>Keyword</strong>. Next just type <code>order:</code> in the <strong>Enter Keyword&mldr;</strong> box and press enter.</p></li><li><p>You should now only have log lines that contain the word &ldquo;order:&rdquo;. There are still a lot of log lines, so let&rsquo;s filter some more.</p></li><li><p>Add another filter, this time select the <strong>Fields</strong> box, then type <code>severity</code> in the <strong>Find a field&mldr;</strong> search box and select it.
<a href=#R-image-169bb6e22a5641170d2fc64f7a94672b class=lightbox-link><img alt=severity class="noborder lazy left lightbox noshadow figure-image" loading=lazy src="../images/find-severity.png?width=15vw&classes=left" style=height:auto;width:15vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-169bb6e22a5641170d2fc64f7a94672b><img alt=severity class="noborder lazy left lightbox noshadow lightbox-image" loading=lazy src="../images/find-severity.png?width=15vw&classes=left"></a></p></li><li><p>Make sure you click the <span class="btn cstyle gray"><span><span class=title><strong>Exclude all logs with this fields</strong></span></span></span> at the bottom of the dialog box, as the order log line does not have a severity assigned. This will remove the others.</p></li><li><p>You may need to scroll down the page if you still have the onboarding content displayed at the top to see the <strong>Exclude all logs with this fields</strong> button.</p></li><li><p>You should now have a list of orders sold for the last 15 minutes.</p></li></ul></div></details><p>Next, let&rsquo;s check out <strong>Splunk Synthetics</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 4, 2023</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=synthetics-overview>Synthetics Overview</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>Splunk Synthetic Monitoring provides visibility across URLs, APIs and critical web services to solve problems faster. IT Operations and engineering teams can easily detect, alert and prioritize issues, simulate multi-step user journeys, measure business impact from new code deployments and optimize web performance with guided step-by-step recommendations to ensure better digital experiences.</p><p><strong>Ensure Availability:</strong> Proactively monitor and alert on the health and availability of critical services, URLs and APIs with customizable browser tests to simulate multi-step workflows that make up the user experience.<br><strong>Improve Metrics:</strong> Core Web Vitals and modern performance metrics allow users to view all their performance defects in one place, measure and improve page load, interactivity and visual stability, and find and fix JavaScript errors to improve page performance.<br><strong>front-end to back-end:</strong> Integrations with Splunk APM, Infrastructure Monitoring, On-Call and ITSI help teams view endpoint uptime against back-end services, the underlying infrastructure and within their incident response coordination so they can troubleshoot across their entire environment, in a single UI.<br><strong>Detect and Alert:</strong> Monitor and simulate end-user experiences to detect, communicate and resolve issues for APIs, service endpoints and critical business transactions before they impact customers.<br><strong>Business Performance:</strong> Easily define multi-step user flows for key business transactions and start recording and testing your critical user journeys in minutes. Track and report SLAs and SLOs for uptime and performance.<br><strong>Filmstrips and Video Playback:</strong> View screen recordings, film strips, and screenshots alongside modern performance scores, competitive benchmarking, and metrics to visualize artificial end-user experiences. Optimize how fast you deliver visual content, and improve page stability and interactivity to deploy better digital experiences.</p><p><a href=#R-image-6325ba7cecfcaa6039488fdaeb751596 class=lightbox-link><img alt="Synthetics overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/5-synthetics-home/images/synthetic-tests.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6325ba7cecfcaa6039488fdaeb751596><img alt="Synthetics overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/5-synthetics-home/images/synthetic-tests.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 22, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 5. Synthetics Overview</h1><article class=default><header class=headline></header><h1 id=synthetics-home-page>Synthetics Home Page</h1><p>Click on <strong>Synthetics</strong> in the main menu. This will bring us to the Synthetics Home Page. It has 3 distinct sections that provide either useful information or allow you to pick or create a Synthetic Test.</p><p><a href=#R-image-c8ee5146083786a8103be6fad7237769 class=lightbox-link><img alt="Synthetic main" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/synthetics-main.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c8ee5146083786a8103be6fad7237769><img alt="Synthetic main" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/synthetics-main.png></a></p><ol><li><strong>Onboarding Pane:</strong> Training videos and links to documentation to get you started with Splunk Synthetics.</li><li><strong>Test Pane:</strong> List of all the tests that are configured (<strong>Browser</strong>, <strong>API</strong> and <strong>Uptime</strong>)</li><li><strong>Create Test Pane:</strong> Drop-down for creating new Synthetic tests.</li></ol><p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>As part of the workshop we have created a default browser test against the application we are running. You find it in the Test Pane (<strong>2</strong>). It will have the following name <strong>Workshop Browser Test for</strong>, followed by the name of your Workshop (your instructor should have provided that to you).</p></div></details>To continue our tour, let&rsquo;s look at the result of our workshop&rsquo;s automatic browser test.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>In the Test Pane, click on the line that contains the name of your workshop. The result should look like this:</li></ul><p><a href=#R-image-29be6f794291f7caccb30233d23feba5 class=lightbox-link><img alt=Synthetics-overview class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/synthetics-test-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-29be6f794291f7caccb30233d23feba5><img alt=Synthetics-overview class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/synthetics-test-overview.png></a></p><ul><li>Note, On the Synthetic Tests Page, the first pane will show the performance of your site for the last day, 8 days and 30 days. As shown in the screenshot above, only if a test started far enough in the past, the corresponding chart will contain valid data. For the workshop, this depends on when it was created.</li><li>In the Performance KPI drop-down, change the time from the default 4 hours to the 1 last hour.</li></ul><div class=tab-panel data-tab-group=907c3ca21e8ed68c158e3c56ceefcce1><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("907c3ca21e8ed68c158e3c56ceefcce1","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("907c3ca21e8ed68c158e3c56ceefcce1","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>How often is the test run, and from where?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The test runs at <strong>a 1-minute <strong>round-robin</strong> interval from</strong> Frankfurt, London and Paris</strong></p></div></div></div></div></div></details><p>Next, let’s examine the infrastructure our application is running on using <strong>Splunk Infrastructure Monitoring (IM)</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 1, 2023</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=infrastructure-overview>Infrastructure Overview</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>Splunk Infrastructure Monitoring (IM) is a market-leading monitoring and observability service for hybrid cloud environments. Built on a patented streaming architecture, it provides a <strong>real-time</strong> solution for engineering teams to visualize and analyze performance across infrastructure, services, and applications in a fraction of the time and with greater accuracy than traditional solutions.</p><p><strong>OpenTelemetry standardization:</strong> Gives you full control over your data — freeing you from vendor lock-in and implementing proprietary agents.<br><strong>Splunk’s OTel Collector:</strong> Seamless installation and dynamic configuration, auto-discovers your entire stack in seconds for visibility across clouds, services, and systems.<br><strong>300+ Easy-to-use OOTB content:</strong> Pre-built navigators and dashboards, deliver immediate visualizations of your entire environment so that you can interact with all your data in real time.<br><strong>Kubernetes navigator:</strong> Provides an instant, comprehensive out-of-the-box hierarchical view of nodes, pods, and containers. Ramp up even the most novice Kubernetes user with easy-to-understand interactive cluster maps.<br><strong>AutoDetect alerts and detectors:</strong> Automatically identify the most important metrics, out-of-the-box, to create alert conditions for detectors that accurately alert from the moment telemetry data is ingested and use real-time alerting capabilities for important notifications in seconds.<br><strong>Log views in dashboards:</strong> Combine log messages and real-time metrics on one page with common filters and time controls for faster in-context troubleshooting.<br><strong>Metrics pipeline management:</strong> Control metrics volume at the point of ingest without re-instrumentation with a set of aggregation and data-dropping rules to store and analyze only the needed data. Reduce metrics volume and optimize observability spend.</p><p><a href=#R-image-3e192930eefbe770084ae1591fb54178 class=lightbox-link><img alt="Infrastructure Overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/6-infrastructure-home/images/infrastructure-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3e192930eefbe770084ae1591fb54178><img alt="Infrastructure Overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/3-quick-tour/6-infrastructure-home/images/infrastructure-overview.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 22, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=lets-go-shopping->Let's go shopping 💶</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<details open class="box cstyle notices orange"><summary class=box-label><i class="fa-fw fas fa-user"></i>
Persona</summary><div class=box-content><p>You are a <strong>hip urban professional</strong>, longing to buy your next novelty items in the famous Online Boutique shop. You have heard that the Online Boutique is the place to go for all your hipster needs.</p></div></details><p>The purpose of this exercise is for you to interact with the Online Boutique web application. This is a sample application that is used to demonstrate the capabilities of Splunk Observability Cloud. The application is a simple e-commerce site that allows you to browse items, add them to your cart, and then checkout.</p><p>The application will already be deployed for you and your instructor will provide you with a link to the Online Boutique website e.g:</p><ul><li><strong>http://&lt;s4r-workshop-i-xxx.splunk>.show:81/</strong>. The application is also running on ports <strong>80</strong> & <strong>443</strong> if you prefer to use those or port <strong>81</strong> is unreachable.</li></ul><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise - Let&rsquo;s go shopping</summary><div class=box-content><ul><li>Once you have the link to the Online Boutique, have a browse through a few items, add them to your cart and then, finally, do a checkout.</li><li>Repeat this exercise a few times and if possible use different browsers, mobile devices or tablets as this will generate more data for you to explore.</li></ul></div></details><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>While you are waiting for pages to load, please move your mouse cursor around the page. This will generate more data for us to explore at a later date in this workshop.</p></div></details><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise (cont.)</summary><div class=box-content><ul><li>Did you notice anything about the checkout process? Did it seem to take a while to complete, but it did ultimately complete? When this happens please copy the <strong>Order Confirmation ID</strong> and save it locally somewhere as we will need it later.</li><li>Close the browser sessions you used to shop.</li></ul></div></details><p>This is what a poor user experience can feel like and since this is a potential customer satisfaction issue we had better jump on this and troubleshoot.</p><p><a href=#R-image-905908e358b0c88fecbcca72ced3151e class=lightbox-link><img alt="Online Boutique" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/4-online-boutique/images/shop.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-905908e358b0c88fecbcca72ced3151e><img alt="Online Boutique" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/s4r/4-online-boutique/images/shop.png></a></p><p>Let’s go take a look at what the data looks like in <strong>Splunk RUM</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 11, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=splunk-rum>Splunk RUM</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<details open class="box cstyle notices orange"><summary class=box-label><i class="fa-fw fas fa-user"></i>
Persona</summary><div class=box-content><p>You are a <strong>frontend engineer</strong>, or an <strong>SRE</strong> tasked to do the first triage of a performance issue. You have been asked to investigate a potential customer satisfaction issue with the Online Boutique application.</p></div></details><p>We are going to examine the real user data that has been provided by the telemetry received from all participants&rsquo; browser sessions. The goal is to find a browser, mobile or tablet session that performed poorly and begin the troubleshooting process.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 5. Splunk RUM</h1><article class=default><header class=headline></header><h1 id=1-rum-dashboard>1. RUM Dashboard</h1><p>In Splunk Observability Cloud from the main menu, click on <strong>RUM</strong>. you arrive at the RUM Home page, this view has already been covered in the short introduction earlier.</p><p><a href=#R-image-0e24a3b0ec988915a60f0ff7ed9517ff class=lightbox-link><img alt="multiple apps" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0e24a3b0ec988915a60f0ff7ed9517ff><img alt="multiple apps" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-dashboard.png></a></p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Make sure you select your workshop by ensuring the drop-downs are set/selected as follows:<ul><li>The <strong>Time frame</strong> is set to <strong>-15m</strong>.</li><li>The <strong>Environment</strong> selected is <strong>[NAME OF WORKSHOP]-workshop</strong>.</li><li>The <strong>App</strong> selected is <strong>[NAME OF WORKSHOP]-store</strong>.</li><li>The <strong>Source</strong> is set to <strong>All</strong>.</li></ul></li><li>Next, click on the <strong>[NAME OF WORKSHOP]-store</strong> above the <strong>Page Views / JavaScript Errors</strong> chart.</li><li>This will bring up a new dashboard view breaking down the metrics by <strong>UX Metrics</strong>, <strong>Front-end Health</strong>, <strong>Back-end Health</strong> and <strong>Custom Events</strong> and comparing them to historic metrics (1 hour by default).</li></ul></div></details><p><a href=#R-image-f55a5aba8402c7432563de7c10290d52 class=lightbox-link><img alt="RUM Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-metrics-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f55a5aba8402c7432563de7c10290d52><img alt="RUM Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-metrics-dashboard.png></a></p><ul><li><strong>UX Metrics:</strong> Page Views, Page Load and Web Vitals metrics.</li><li><strong>Front-end Health:</strong> Breakdown of Javascript Errors and Long Task duration and count.</li><li><strong>Back-end Health:</strong> Network Errors and Requests and Time to First Byte.</li><li><strong>Custom Events:</strong> RED metrics (Rate, Error & Duration) for custom events.</li></ul><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Click through each of the tabs (<strong>UX Metrics</strong>, <strong>Front-end Health</strong>, <strong>Back-end Health</strong> and <strong>Custom Events</strong>) and examine the data.</li></ul><div class=tab-panel data-tab-group=ceb1ca020d07d7a5458d21a14fd72db4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ceb1ca020d07d7a5458d21a14fd72db4","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("ceb1ca020d07d7a5458d21a14fd72db4","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>If you examine the charts in the <em>Custom Events</em> Tab, <strong>what chart <strong>shows</strong> clearly the</strong> latency Spikes?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>It is the <em>Custom Event Latency</em> chart</strong></p></div></div></div></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=2-tag-spotlight>2. Tag Spotlight</h1><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li><p>Make sure you are on the <strong>Custom Events</strong> tab by selecting it.</p></li><li><p>Have a look at the <strong>Custom Event Latency</strong> chart. The metrics shown here show the application latency. The comparison metrics to the side show the latency compared to 1 hour ago (which is selected in the top filter bar).</p></li><li><p>Click on the <strong>see all</strong> link under the chart title.</p></li></ul></div></details><p><a href=#R-image-be792046e9f0e9b91e07a26743c5b0ad class=lightbox-link><img alt="RUM Tag Spotlight" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-tag-spotlight.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-be792046e9f0e9b91e07a26743c5b0ad><img alt="RUM Tag Spotlight" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-tag-spotlight.png></a></p><p>In this dashboard view, you are presented with all the tags associated with the RUM data. Tags are key-value pairs that are used to identify the data. In this case, the tags are automatically generated by the OpenTelemetry instrumentation. The tags are used to filter the data and to create the charts and tables. The Tag Spotlight view allows you to drill down into a user session.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Change the timeframe to <strong>Last 1 hour</strong>.</li><li>Click <strong>Add Filters</strong>, select <strong>OS Version</strong>, click <strong>!=</strong> and select <strong>Synthetics</strong> and <strong>RUMLoadGen</strong> then click the <span class="btn cstyle blue"><span><span class=title>Apply Filter</span></span></span> button.</li><li>Find the <strong>Custom Event Name</strong> chart, locate <strong>PlaceOrder</strong> in the list, click on it and select <strong>Add to filter</strong>.</li><li>Notice the large spikes in the graph across the top.</li><li>Click on the <strong>User Sessions</strong> tab.</li><li>Click on the <strong>Duration</strong> heading twice to sort the sessions by duration (longest at the top).</li><li>Click on the <i class="fa-fw fas fa-cog"></i> above the table and select <strong>Sf Geo City</strong> from the list of additional columns and click <span class="btn cstyle blue"><span><span class=title>Save</span></span></span></li></ul></div></details><p>We now have a User Session table that is sorted by longest duration descending and includes the cities of all the users that have been shopping on the site. We could apply more filters to further narrow down the data e.g. OS version, browser version, etc.</p><p><a href=#R-image-2824dd86436f672851a1fbc1a2f46ce6 class=lightbox-link><img alt="RUM Tag Spotlight" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-user-sessions.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2824dd86436f672851a1fbc1a2f46ce6><img alt="RUM Tag Spotlight" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-user-sessions.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 4, 2023</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-session-replay>3. Session Replay</h1><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Sessions</summary><div class=box-content><p>A session is a collection of traces that correspond to the actions a single user takes when interacting with an application. By default, a session lasts until 15 minutes have passed from the last event captured in the session. The maximum session duration is 4 hours.</p></div></details><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>In the <strong>User Sessions</strong> table, click on the top <strong>Session ID</strong> with the longest <strong>Duration</strong> (over 20 seconds or longer), this will take you to the RUM Session view.</li></ul></div></details><p><a href=#R-image-531a4d545c378eea42300fea13aab0b6 class=lightbox-link><img alt="RUM Session" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-session.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-531a4d545c378eea42300fea13aab0b6><img alt="RUM Session" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-session.png></a></p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Click the RUM Session Replay <span class="btn cstyle transparent"><span><i class="fa-fw fas fa-play"></i> <span class=title>Replay</span></span></span> button. RUM Session Replay allows you to replay and see the user session. This is a great way to see exactly what the user experienced.</li><li>Click the button to start the replay.</li></ul></div></details><p>RUM Session Replay can redact information, by default text is redacted. You can also redact images (which has been done for this workshop example). This is useful if you are replaying a session that contains sensitive information. You can also change the playback speed and pause the replay.</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>When playing back the session, notice how the mouse movements are captured. This is useful to see where the user is focusing their attention.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-user-sessions>4. User Sessions</h1><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Close the RUM Session Replay by clicking on the <strong>X</strong> in the top right corner.</li><li>Note the length of the span, this is the time it took to complete the order, not good!</li><li>Scroll down the page and you will see the <strong>Tags</strong> metadata (which is used in Tag Spotlight). After the tags, we come to the waterfall which shows the page objects that have been loaded (HTML, CSS, images, JavaScript etc.)</li><li>Keep scrolling down the page until you come to a blue <strong>APM</strong> link (the one with <code>/cart/checkout</code> at the end of the URL) and hover over it.</li></ul></div></details><p><a href=#R-image-0b7f8e86ca5e929caa728f736779aa87 class=lightbox-link><img alt="RUM Session" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0b7f8e86ca5e929caa728f736779aa87><img alt="RUM Session" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-waterfall.png></a></p><p>This brings up the APM Performance Summary. Having this end-to-end (RUM to APM) view is very useful when troubleshooting issues.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>You will see <strong>paymentservice</strong> and <strong>checkoutservice</strong> are in an error state as per the screenshot above.</li><li>Under <strong>Workflow Name</strong> click on <code>front-end:/cart/checkout</code>, this will bring up the <strong>APM Service Map</strong>.</li></ul></div></details><p><a href=#R-image-855fe7f67ba086247d8e4bfeed5d9b19 class=lightbox-link><img alt="RUM to APM" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-to-apm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-855fe7f67ba086247d8e4bfeed5d9b19><img alt="RUM to APM" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-to-apm.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=splunk-apm>Splunk APM</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<details open class="box cstyle notices orange"><summary class=box-label><i class="fa-fw fas fa-user"></i>
Persona</summary><div class=box-content><p>You are a <strong>back-end developer</strong> and you have been called in to help investigate an issue found by the SRE. The SRE has identified a poor user experience and has asked you to investigate the issue.</p></div></details><p>Discover the power of full end-to-end visibility by jumping from a RUM trace (front-end) to an APM trace (back-end). All the services are sending telemetry (traces and spans) that Splunk Observability Cloud can visualize, analyze and use to detect anomalies and errors.</p><p>RUM and APM are two sides of the same coin. RUM is the client-side view of the application and APM is the server-side view. In this section, we will use APM to drill down and identify where the problem is.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 6. Splunk APM</h1><article class=default><header class=headline></header><h1 id=1-apm-explore>1. APM Explore</h1><p>The APM Service Map displays the dependencies and connections among your instrumented and inferred services in APM. The map is dynamically generated based on your selections in the time range, environment, workflow, service, and tag filters.</p><p>When we clicked on the APM link in the RUM waterfall, filters were automatically added to the service map view to show the services that were involved in that <strong>WorkFlow Name</strong> (<code>frontend:/cart/checkout</code>).</p><p>You can see the services involved in the workflow in the <strong>Service Map</strong>. In the side pane, under <strong>Business Workflow</strong>, charts for the selected workflow are displayed. The <strong>Service Map</strong> and <strong>Business Workflow</strong> charts are synchronized. When you select a service in the <strong>Service Map</strong>, the charts in the <strong>Business Workflow</strong> pane are updated to show metrics for the selected service.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Click on the <strong>paymentservice</strong> in the Service Map.</li></ul></div></details><p><a href=#R-image-502f8c655e030996f9b1e3d92bbd856f class=lightbox-link><img alt="APM Explore" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-business-workflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-502f8c655e030996f9b1e3d92bbd856f><img alt="APM Explore" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-business-workflow.png></a></p><p>Splunk APM also provides built-in <strong>Service Centric Views</strong> to help you see problems occurring in real time and quickly determine whether the problem is associated with a service, a specific endpoint, or the underlying infrastructure. Let&rsquo;s have a closer look.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>In the right hand pane, click on <strong>View Service</strong>.</li></ul></div></details><p><a href=#R-image-e682f832221b4b7453847da1442844a8 class=lightbox-link><img alt="APM Service" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-service.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e682f832221b4b7453847da1442844a8><img alt="APM Service" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-service.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=2-apm-service-view>2. APM Service View</h1><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Service View</summary><div class=box-content><p>As a service owners you can use the service view in Splunk APM to get a complete view of your service health in a single pane of glass. The service view includes a service-level indicator (SLI) for availability, dependencies, request, error, and duration (RED) metrics, runtime metrics, infrastructure metrics, Tag Spotlight, endpoints, and logs for a selected service. You can also quickly navigate to code profiling and memory profiling for your service from the service view.</p></div></details><p><a href=#R-image-b781aca5cad51073daf191842f1493d2 class=lightbox-link><img alt="Service Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-service-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b781aca5cad51073daf191842f1493d2><img alt="Service Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-service-dashboard.png></a></p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Check the <strong>Time</strong> box, you can see that the dashboards only show data relevant to the time it took for the APM trace we previosuly selected to complete (note that the charts are static).</li><li>In the <strong>Time</strong> box change the timeframe to <strong>-1h</strong>.</li><li>These charts are very useful to quickly identify performance issues. You can use this dashboard to keep an eye on the health of your service.</li><li>Scroll down the page and expand <strong>Infrastructure Metrics</strong>. Here you will see the metrics for the Host and Pod.</li><li><strong>Runtime Metrics</strong> are not available as profiling data is not available for services written in Node.js.</li><li>Now let&rsquo;s go back to the explore view, you can hit the back button in your Browser</li></ul></div></details><p><a href=#R-image-30b1ce0beb122371df262cf30bd49748 class=lightbox-link><img alt="APM Explore" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-business-workflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-30b1ce0beb122371df262cf30bd49748><img alt="APM Explore" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-business-workflow.png></a></p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><div class=tab-panel data-tab-group=a36834f9b72cba9e8543972105ea23f6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("a36834f9b72cba9e8543972105ea23f6","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a36834f9b72cba9e8543972105ea23f6","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>In the Service Map hover over the <strong>paymentservice</strong>. What can you conclude from the popup service chart?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The error percentage is very high.</strong></p></div></div></div></div></div></details><p><a href=#R-image-fa9d52304cb28f672b8e2adf33a84a5c class=lightbox-link><img alt="APM Service Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-service-popup-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fa9d52304cb28f672b8e2adf33a84a5c><img alt="APM Service Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-service-popup-chart.png></a></p><p>We need to understand if there is a pattern to this error rate. We have a handy tool for that, <strong>Tag Spotlight</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-apm-tag-spotlight>3. APM Tag Spotlight</h1><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>To view the tags for the <strong>paymentservice</strong> click on the <strong>paymentservice</strong> and then click on <strong>Tag Spotlight</strong> in the right-hand side functions pane (you may need to scroll down depending upon your screen resolution).* Once in <strong>Tag Spotlight</strong> ensure the toggle <strong>Show tags with no values</strong> is off.</li></ul></div></details><p><a href=#R-image-bd23947bd3216a53621fb108e9adb6f4 class=lightbox-link><img alt="APM Tag Spotlight" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-tag-spotlight.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bd23947bd3216a53621fb108e9adb6f4><img alt="APM Tag Spotlight" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-tag-spotlight.png></a></p><p>The views in <strong>Tag Spotlight</strong> are configurable for both the chart and cards. The view defaults to <strong>Requests & Errors</strong>.</p><p>It is also possible to configure which tag metrics are displayed in the cards. It is possible to select any combinations of:</p><ul><li>Requests</li><li>Errors</li><li>Root cause errors</li><li>P50 Latency</li><li>P90 Latency</li><li>P99 Latency</li></ul><p>Also ensure that the <strong>Show tags with no values</strong> toggle is unchecked.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><div class=tab-panel data-tab-group=521c5c0e6a6a7f1c426068d21adfa08b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("521c5c0e6a6a7f1c426068d21adfa08b","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("521c5c0e6a6a7f1c426068d21adfa08b","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Which card exposes the tag that identifies what the problem is?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The <em>version</em> card. The number of requests against <code>v350.10</code> matches the number of errors i.e. 100%</strong></p></div></div></div></div></div></details><p>Now that we have identified the version of the <strong>paymentservice</strong> that is causing the issue, let&rsquo;s see if we can find out more information about the error. Click on <strong>← Tag Spotlight</strong> at the top of the page to get back to the Service Map.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-apm-service-breakdown>4. APM Service Breakdown</h1><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Select the <strong>paymentservice</strong> in the Service Map.</li><li>In the right-hand pane click on the <span class="btn cstyle grey"><span><span class=title>Breakdown</span></span></span>.</li><li>Select <code>tenant.level</code> in the list.</li><li>Back in the Service Map click on <strong>gold</strong>.</li><li>Click on <span class="btn cstyle grey"><span><span class=title>Breakdown</span></span></span> and select <code>version</code>, this is the tag that exposes the service version.</li><li>Repeat this for <strong>silver</strong> and <strong>bronze</strong>.</li></ul><div class=tab-panel data-tab-group=ae187a7fc58afe98f0ab6f076e92b102><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ae187a7fc58afe98f0ab6f076e92b102","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("ae187a7fc58afe98f0ab6f076e92b102","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>What can you conclude from what you are seeing?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>Every <code>tenant.level</code> is being impacted by <code>v350.10</code></strong></p></div></div></div></div></div></details><p>You will now see the <strong>paymentservice</strong> broken down into three services, <strong>gold</strong>, <strong>silver</strong> and <strong>bronze</strong>. Each tenant is broken down into two services, one for each version (<code>v350.10</code> and <code>v350.9</code>).</p><p><a href=#R-image-0a77407c1205443a2e78bbf8f46223a1 class=lightbox-link><img alt="APM Service Breakdown" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-service-breakdown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a77407c1205443a2e78bbf8f46223a1><img alt="APM Service Breakdown" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-service-breakdown.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Span Tags</summary><div class=box-content><p>Using span tags to break down services is a very powerful feature. It allows you to see how your services are performing for different customers, different versions, different regions, etc. In this exercise, we have determined that <code>v350.10</code> of the <strong>paymentservice</strong> is causing problems for all our customers.</p></div></details><p>Next, we need to drill down into a trace to see what is going on.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=5-apm-trace-analyzer>5. APM Trace Analyzer</h1><p>As Splunk APM provides a <strong>NoSample</strong> end-to-end visibility of every service Splunk APM captures every trace. For this workshop, the <strong>Order Confirmation ID</strong> is available as a tag. This means that we can use this to search for the exact trace of the poor user experience you encountered earlier in the workshop.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Trace Analyzer</summary><div class=box-content><p>Splunk Observability Cloud provides several tools for exploring application monitoring data. <strong>Trace Analyzer</strong> is suited to scenarios where you have high-cardinality, high-granularity searches and explorations to research unknown or new issues.</p></div></details><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>With the outer box of the <strong>paymentservice</strong> selected, in the right-hand pane, click on <strong>Traces</strong>.</li><li>To ensure we are using <strong>Trace Analyzer</strong> make sure the button <span class="btn cstyle transparent"><span><span class=title>Switch to Classic View</span></span></span> is showing. If it is not, click on <span class="btn cstyle blue"><span><span class=title>Switch to Trace Analyzer</span></span></span>.</li><li>Set <strong>Time Range</strong> to <strong>Last 15 minutes</strong>.</li><li>Ensure the <strong>Sample Ratio</strong> is set to <code>1:1</code> and <strong>not</strong> <code>1:10</code>.</li></ul></div></details><p><a href=#R-image-8b9931bc2177d49f8c1c505e6703210f class=lightbox-link><img alt="APM Trace Analyzer" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-trace-analyzer.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8b9931bc2177d49f8c1c505e6703210f><img alt="APM Trace Analyzer" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-trace-analyzer.png></a></p><p>The <strong>Trace & error count</strong> view shows the total traces and traces with errors in a stacked bar chart. You can use your mouse to select a specific period within the available time frame.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Click on the dropdown menu that says <strong>Trace & error count</strong>, and change it to <strong>Trace duration</strong></li></ul></div></details><p><a href=#R-image-b947c5dbc671248e9f26a007305907ed class=lightbox-link><img alt="APM Trace Analyzer Heat Map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-trace-analyzer-heat-map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b947c5dbc671248e9f26a007305907ed><img alt="APM Trace Analyzer Heat Map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-trace-analyzer-heat-map.png></a></p><p>The <strong>Trace Duration</strong> view shows a heatmap of traces by duration. The heatmap represents 3 dimensions of data:</p><ul><li>Time on the x-axis</li><li>Trace duration on the y-axis</li><li>The traces (or requests) per second are represented by the heatmap shades</li></ul><p>You can use your mouse to select an area on the heatmap, to focus on a specific time period and trace duration range.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Switch from <strong>Trace duration</strong> back to <strong>Trace & Error count</strong>.</li><li>In the time picker select <strong>Last 1 hour</strong>.</li><li>Note, that most of our traces have errors (red) and there are only a limited amount of traces that are error-free (blue).</li><li>Make sure the <strong>Sample Ratio</strong> is set to <code>1:1</code> and <strong>not</strong> <code>1:10</code>.</li><li>Click on <strong>Add filters</strong>, type in <code>orderId</code> and select <strong>orderId</strong> from the list.</li><li>Paste in your <strong>Order Confirmation ID</strong> from when you went shopping earlier in the workshop and hit enter. If you didn&rsquo;t capture one, please ask your instructor for one.
<a href=#R-image-a18549aabd5b37c4a20e5f23974b362d class=lightbox-link><img alt="Traces by Duration" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-trace-by-duration.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a18549aabd5b37c4a20e5f23974b362d><img alt="Traces by Duration" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-trace-by-duration.png></a></li></ul></div></details><p>We have now filtered down to the exact trace where you encountered a poor user experience with a very long checkout wait.</p><p>A secondary benefit to viewing this trace is that the trace will be accessible for up to 13 months. This will allow developers to come back to this issue at a later stage and still view this trace for example.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Click on the trace in the list.</li></ul></div></details><p>Next, we will walk through the trace waterfall.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 20, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=6-apm-waterfall>6. APM Waterfall</h1><p>We have arrived at the <strong>Trace Waterfall</strong> from the <strong>Trace Analyzer</strong>. A trace is a collection of spans that share the same trace ID, representing a unique transaction handled by your application and its constituent services.</p><p>Each span in Splunk APM captures a single operation. Splunk APM considers a span to be an error span if the operation that the span captures results in an error.</p><p><a href=#R-image-763f541632d34d33d0bf6a785399013c class=lightbox-link><img alt="Trace Waterfall" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-trace-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-763f541632d34d33d0bf6a785399013c><img alt="Trace Waterfall" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-trace-waterfall.png></a></p><p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Click on the <span class="btn cstyle red"><span><span class=title>!</span></span></span> next to any of the <code>paymentservice:grpc.hipstershop.PaymentService/Charge</code> spans in the waterfall.</li></ul><div class=tab-panel data-tab-group=af87e31ec7c41744b28aaf674e3d164a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("af87e31ec7c41744b28aaf674e3d164a","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("af87e31ec7c41744b28aaf674e3d164a","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>What is the error message and version being reported in the Span Details?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong><code>Invalid request</code> and <code>v350.10</code></strong>.</p></div></div></div></div></div></details>Now that we have identified the version of the <strong>paymentservice</strong> that is causing the issue, let&rsquo;s see if we can find out more information about the error. This is where <strong>Related Logs</strong> come in.</p><p>Related Content relies on specific metadata that allow APM, Infrastructure Monitoring, and Log Observer to pass filters around Observability Cloud. For related logs to work, you need to have the following metadata in your logs:</p><ul><li><code>service.name</code></li><li><code>deployment.environment</code></li><li><code>host.name</code></li><li><code>trace_id</code></li><li><code>span_id</code></li></ul><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>At the very bottom of the <strong>Trace Waterfall</strong> click on <strong>Logs (1)</strong>. This highlights that there are <strong>Related Logs</strong> for this trace.</li><li>Click on the <strong>Logs for trace xxx</strong> entry in the pop-up, this will open the logs for the complete trace in <strong>Log Observer</strong>.</li></ul></div></details><p><a href=#R-image-5aa00b84213501965346438ed9c75db0 class=lightbox-link><img alt="Related Logs" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-related-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5aa00b84213501965346438ed9c75db0><img alt="Related Logs" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-related-logs.png></a></p><p>Next, let&rsquo;s find out more about the error in the logs.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=splunk-log-observer>Splunk Log Observer</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<details open class="box cstyle notices orange"><summary class=box-label><i class="fa-fw fas fa-user"></i>
Persona</summary><div class=box-content><p>Remaining in your <strong>back-end developer</strong> role, you need to inspect the logs from your application to determine the root cause of the issue.</p></div></details><p>Using the content related to the APM trace (logs) we will now use Splunk Log Observer to drill down further to understand exactly what the problem is.</p><p>Related Content is a powerful feature that allows you to jump from one component to another and is available for <strong>metrics</strong>, <strong>traces</strong> and <strong>logs</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 7. Splunk Log Observer</h1><article class=default><header class=headline></header><h1 id=1-log-filtering>1. Log Filtering</h1><p><strong>Log Observer (LO)</strong>, can be used in multiple ways. In the quick tour, you used the LO <strong>no-code interface</strong> to search for specific entries in the logs. This section, however, assumes you have arrived in LO from a trace in APM using the <strong>Related Content</strong> link.</p><p>The advantage of this is, as it was with the link between RUM & APM, that you are looking at your logs within the context of your previous actions. In this case, the context is the time frame (<strong>1</strong>), which matches that of the trace and the filter (<strong>2</strong>) which is set to the <strong>trace_id</strong>.</p><p><a href=#R-image-75e98d99bc5875811df590c72531b021 class=lightbox-link><img alt="Trace Logs" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log-observer-trace-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-75e98d99bc5875811df590c72531b021><img alt="Trace Logs" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log-observer-trace-logs.png></a></p><p>This view will include <strong>all</strong> the log lines from <strong>all</strong> applications or services that participated in the back-end transaction started by the end-user interaction with the Online Boutique.</p><p>Even in a small application such as our Online Boutique, the sheer amount of logs found can make it hard to see the specific log lines that matter to the actual incident we are investigating.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>We need to focus on just the Error messages in the logs:</p><ul><li>Click on the <strong>Group By</strong> drop-down box and use the filter to find <strong>Severity</strong>.</li><li>Once selected click the <span class="btn cstyle blue"><span><span class=title>Apply</span></span></span> button (notice that the chart legend changes to show debug, error and info).
<a href=#R-image-359696e0885731ae217e4c8ccd0153ac class=lightbox-link><img alt=legend class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/severity-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-359696e0885731ae217e4c8ccd0153ac><img alt=legend class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/severity-logs.png></a></li><li>Selecting just the error logs can be done by either clicking on the word error (<strong>1</strong>) in the legend, followed by selecting <strong>Add to filter</strong>. Then click <span class="btn cstyle blue"><span><span class=title>Run Search</span></span></span></li><li>You could also add the service name, <code>sf_service=paymentservice</code>, to the filter if there are error lines for multiple services, but in our case, this is not necessary.
<a href=#R-image-f60cb9ff9b272f1d4a827fef50029e1f class=lightbox-link><img alt="Error Logs" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log-observer-errors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f60cb9ff9b272f1d4a827fef50029e1f><img alt="Error Logs" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log-observer-errors.png></a></li></ul></div></details><p>Next, we will look at log entries in detail.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=2-viewing-log-entries>2. Viewing Log Entries</h1><p>Before we look at a specific log line, let&rsquo;s quickly recap what we have done so far and why we are here based on the 3 pillars of Observability:</p><table><thead><tr><th style=text-align:center>Metrics</th><th style=text-align:center>Traces</th><th style=text-align:center>Logs</th></tr></thead><tbody><tr><td style=text-align:center><em><strong>Do I have a problem?</strong></em></td><td style=text-align:center><em><strong>Where is the problem?</strong></em></td><td style=text-align:center><em><strong>What is the problem?</strong></em></td></tr></tbody></table><ul><li>Using metrics we identified <strong>we have a problem</strong> with our application. This was obvious from the error rate in the Service Dashboards as it was higher than it should be.</li><li>Using traces and span tags we found <strong>where the problem is</strong>. The <strong>paymentservice</strong> comprises of two versions, <code>v350.9</code> and <code>v350.10</code>, and the error rate was <strong>100%</strong> for <code>v350.10</code>.</li><li>We did see that this error from the <strong>paymentservice</strong> <code>v350.10</code> caused multiple retries and a long delay in the response back from the Online Boutique checkout.</li><li>From the trace, using the power of <strong>Related Content</strong>, we arrived at the log entries for the failing <strong>paymentservice</strong> version. Now, we can determine <strong>what the problem is</strong>.</li></ul><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Click on an error entry in the log table (make sure it says <code>hostname: "paymentservice-xxxx"</code> in case there is a rare error from a different service in the list too.</li></ul><div class=tab-panel data-tab-group=b0dd525770b2c57b4181cbc9a0dd45ec><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b0dd525770b2c57b4181cbc9a0dd45ec","question")'>
<span class=tab-nav-text>Question</span>
</button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("b0dd525770b2c57b4181cbc9a0dd45ec","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Based on the message, what would you tell the development team to do to resolve the issue?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The development team needs to rebuild and deploy the container with a valid API Token or rollback to <code>v350.9</code></strong>.</p></div></div></div></div><p><a href=#R-image-3d852b016ec69e03e24b431721a7de9d class=lightbox-link><img alt="Log Message" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log-observer-log-message.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3d852b016ec69e03e24b431721a7de9d><img alt="Log Message" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log-observer-log-message.png></a></p><ul><li>Click on the <strong>X</strong> in the log message pane to close it.</li></ul></div></details><details open class="box cstyle notices blue"><summary class=box-label><i class="fa-fw fas fa-wine-bottle"></i>
Congratulations</summary><div class=box-content><p>You have <strong>successfully</strong> used Splunk Observability Cloud to understand why you experienced a poor user experience whilst shopping at the Online Boutique. You used RUM, APM and logs to understand what happened in your service landscape and subsequently, found the underlying cause, all based on the 3 pillars of Observability, <strong>metrics</strong>, <strong>traces</strong> and <strong>logs</strong></p><p>You also learned how to use Splunk&rsquo;s <strong>intelligent tagging and analysis</strong> with <strong>Tag Spotlight</strong> to detect patterns in your applications&rsquo; behavior and to use the <strong>full stack correlation</strong> power of <strong>Related Content</strong> to quickly move between the different components whilst keeping in context of the issue.</p></div></details><p>In the next part of the workshop, we will move from <strong>problem-finding mode</strong> into <strong>mitigation</strong>, <strong>prevention</strong> and <strong>process improvement mode</strong>.</p><p>Next up, creating log charts in a custom dashboard.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 4, 2023</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-log-timeline-chart>3. Log Timeline Chart</h1><p>Once you have a specific view in Log Observer, it is very useful to be able to use that view in a dashboard, to help in the future with reducing the time to detect or resolve issues. As part of the workshop, we will create an example custom dashboard that will use these charts.</p><p>Let&rsquo;s look at creating a <strong>Log Timeline</strong> chart. The Log Timeline chart is used for visualizing log messages over time. It is a great way to see the frequency of log messages and to identify patterns. It is also a great way to see the distribution of log messages across your environment. These charts can be saved to a custom dashboard.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>First, we will reduce the amount of information to only the columns we are interested in:</p><ul><li>Click on the Configure Table <i class="fa-fw fas fa-cog"></i> icon above the <strong>Logs table</strong> to open the <strong>Table Settings</strong>, untick <code>_raw</code> and ensure the following fields are selected <code>k8s.pod.name</code>, <code>message</code> and <code>version</code>.
<a href=#R-image-0b2a3364a1f23bc12e23a8b14cb3fb8b class=lightbox-link><img alt="Log Table Settings" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log-observer-table.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0b2a3364a1f23bc12e23a8b14cb3fb8b><img alt="Log Table Settings" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log-observer-table.png></a></li><li>Remove the fixed time from the time picker, and set it to the <strong>Last 15 minutes</strong>.</li><li>To make this work for all traces, remove the <code>trace_id</code> from the filter and add the fields <code>sf_service=paymentservice</code> and <code>sf_environment=[WORKSHOPNAME]</code>.</li><li>Click <strong>Save</strong> and select <strong>Save to Dashboard</strong>.
<a href=#R-image-c6bdb7bd548c9d1feed59cfc182ece46 class=lightbox-link><img alt="save it" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/save-query.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c6bdb7bd548c9d1feed59cfc182ece46><img alt="save it" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/save-query.png></a></li><li>In the chart creation dialog box that appears, for the <strong>Chart name</strong> use <code>Log Timeline</code>.</li><li>Click <span class="btn cstyle blue"><span><span class=title>Select Dashboard</span></span></span> and then click <span class="btn cstyle blue"><span><span class=title>New dashboard</span></span></span> in the Dashboard Selection dialog box.</li><li>In the <strong>New dashboard</strong> dialog box, enter a name for the new dashboard (no need to enter a description). Use the following format: <code>Initials - Service Health Dashboard</code> and click <span class="btn cstyle blue"><span><span class=title>Save</span></span></span></li><li>Ensure the new dashboard is highlighted in the list (<strong>1</strong>) and click <span class="btn cstyle blue"><span><span class=title>OK</span></span></span> (<strong>2</strong>).
<a href=#R-image-44290668880f47ea1d70dcfac1899e01 class=lightbox-link><img alt="Save dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/dashboard-save.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-44290668880f47ea1d70dcfac1899e01><img alt="Save dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/dashboard-save.png></a></li><li>Ensure that <strong>Log Timeline</strong> is selected as the <strong>Chart Type</strong>.
<a href=#R-image-8b38ed02e1d19dd14a0110048c2871db class=lightbox-link><img alt="log timeline" class="noborder lazy left lightbox noshadow figure-image" loading=lazy src="../images/log-timeline.png?classes=left&width=25vw" style=height:auto;width:25vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8b38ed02e1d19dd14a0110048c2871db><img alt="log timeline" class="noborder lazy left lightbox noshadow lightbox-image" loading=lazy src="../images/log-timeline.png?classes=left&width=25vw"></a></li><li>Click the <span class="btn cstyle transparent"><span><span class=title>Save</span></span></span> button (<strong>do not</strong> click <strong>Save and goto dashboard</strong> at this time).</li></ul></div></details><p>Next, we will create a <strong>Log View</strong> chart.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 18, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-log-view-chart>4. Log View Chart</h1><p>The next chart type that can be used with logs is the <strong>Log View</strong> chart type. This chart will allow us to see log messages based on predefined filters.</p><p>As with the previous Log Timeline chart, we will add a version of this chart to our Customer Health Service Dashboard:</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>After the previous exercise make sure you are still in <strong>Log Observer</strong>.</li><li>The filters should be the same as the previous exercise, with the time picker set to the <strong>Last 15 minutes</strong> and filtering on severity=error, <code>sf_service=paymentservice</code> and <code>sf_environment=[WORKSHOPNAME]</code>.</li><li>Make sure we have the header with just the fields we wanted.</li><li>Click again on <strong>Save</strong> and then <strong>Save to Dashboard</strong>.</li><li>This will again provide you with the Chart creation dialog.</li><li>For the <strong>Chart name</strong> use <strong>Log View</strong>.</li><li>This time Click <span class="btn cstyle blue"><span><span class=title>Select Dashboard</span></span></span> and search for the Dashboard you created in the previous exercise. You can start by typing your initials in the search box (<strong>1</strong>).
<a href=#R-image-e4dcc8645ea4372db994611786b70ba9 class=lightbox-link><img alt="search dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/search-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e4dcc8645ea4372db994611786b70ba9><img alt="search dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/search-dashboard.png></a></li><li>Click on your dashboard name to highlight it (<strong>2</strong>) and click <span class="btn cstyle blue"><span><span class=title>OK</span></span></span> (<strong>3</strong>).</li><li>This will return you to the create chart dialog.</li><li>Ensure <strong>Log View</strong> is selected as the <strong>Chart Type</strong>.
<a href=#R-image-b8de3f627caf5f7eafd554e6e54fe2a7 class=lightbox-link><img alt="log view" class="noborder lazy left lightbox noshadow figure-image" loading=lazy src="../images/log-view.png?classes=left&width=30vw" style=height:auto;width:30vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b8de3f627caf5f7eafd554e6e54fe2a7><img alt="log view" class="noborder lazy left lightbox noshadow lightbox-image" loading=lazy src="../images/log-view.png?classes=left&width=30vw"></a></li><li>To see your dashboard click <span class="btn cstyle blue"><span><span class=title>Save and go to dashboard</span></span></span>.</li><li>The result should be similar to the dashboard below:
<a href=#R-image-4f14e4e3b5e0a05a00a0214e1e42702a class=lightbox-link><img alt="Custom Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log-observer-custom-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4f14e4e3b5e0a05a00a0214e1e42702a><img alt="Custom Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log-observer-custom-dashboard.png></a></li><li>As the last step in this exercise, let us add your dashboard to your workshop team page, this will make it easy to find later in the workshop.</li><li>At the top of the page, click on the <em><strong>&mldr;</strong></em> to the left of your dashboard name.
<a href=#R-image-fc5c147cf080a539c100c9ace2a78a84 class=lightbox-link><img alt=linking class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/linking.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fc5c147cf080a539c100c9ace2a78a84><img alt=linking class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/linking.png></a></li><li>Select <strong>Link to teams</strong> from the drop-down.</li><li>In the following <strong>Link to teams</strong> dialog box, find the Workshop team that your instructor will have provided for you and click <span class="btn cstyle blue"><span><span class=title>Done</span></span></span>.</li></ul></div></details><p>In the next session, we will look at Splunk Synthetics and see how we can automate the testing of web-based applications.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=splunk-synthetics>Splunk Synthetics</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<details open class="box cstyle notices orange"><summary class=box-label><i class="fa-fw fas fa-user"></i>
Persona</summary><div class=box-content><p>Putting your <strong>SRE</strong> hat back on, you have been asked to set up monitoring for the Online Boutique. You need to ensure that the application is available and performing well 24 hours a day, 7 days a week.</p></div></details><p>Wouldn’t it be great if we could have 24/7 monitoring of our application, and be alerted when there is a problem? This is where Synthetics comes in. We will show you a simple test that runs every 1 minute and checks the performance and availability of a typical user journey through the Online Boutique.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 8. Splunk Synthetics</h1><article class=default><header class=headline></header><h1 id=1-synthetics-dashboard>1. Synthetics Dashboard</h1><p>In Splunk Observability Cloud from the main menu, click on <strong>Synthetics</strong>. Click on <strong>All</strong> or <strong>Browser tests</strong> to see the list of active tests.</p><p>During our investigation in the RUM section, we found there was an issue with the <strong>Place Order</strong> Transaction. Let&rsquo;s see if we can confirm this from the Synthetics test as well. We will be using the metric <strong>First byte time</strong> for the 4th page of the test, which is the <strong>Place Order</strong> step.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>In the <strong>Search</strong> box enter <strong>[WORKSHOP NAME]</strong> and select the test for your workshop (your instructor will advise as to which one to select).</li><li>Under <strong>Performance KPIs</strong> set the Time Picker to <strong>Last 1 hour</strong> and hit enter.</li><li>Click on <strong>Location</strong> and from the drop-down select <strong>Page</strong>. The next filter will be populated with the pages that are part of the test.</li><li>Click on <strong>Duration</strong>, deselect <strong>Duration</strong> and select <strong>First byte time</strong>.
<a href=#R-image-2090b013f2d17c3232cc3079d7c31212 class=lightbox-link><img alt="Transaction Filter" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/synthetics-transaction-filter.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2090b013f2d17c3232cc3079d7c31212><img alt="Transaction Filter" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/synthetics-transaction-filter.png></a></li><li>Look at the legend and note the color of <strong>First byte time - Page 4</strong>.</li><li>Select the highest data point for <strong>First byte time - Page 4</strong>. You will now be taken to the <strong>Run results</strong> for this particular test run.</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=2-synthetics-test-detail>2. Synthetics Test Detail</h1><p>Right now we are looking at the result of a single Synthetic Browser Test. This test is split up into <strong>Business Transactions</strong>, think of this as a group of one or more logically related interactions that represent a business-critical user flow.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>The screenshot below doesn&rsquo;t contain a red banner with an error in it however you might be seeing one in your run results. This is expected as in some cases the test run fails and does not impact the workshop.</p></div></details><p><a href=#R-image-2a7eee4113e1acd232461567c7664742 class=lightbox-link><img alt=waterfall class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/synth-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2a7eee4113e1acd232461567c7664742><img alt=waterfall class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/synth-waterfall.png></a></p><ol><li><strong>Filmstrip:</strong> Offers a set of screenshots of site performance so that you can see how the page responds in real-time.</li><li><strong>Video:</strong> This lets you see exactly what a user trying to load your site from the location and device of a particular test run would experience.</li><li><strong>Browser test metrics:</strong> A View that offers you a picture of website performance.</li><li><strong>Synthetic transactions:</strong> List of the Synthetic transactions that made up the interaction with the site</li><li><strong>Waterfall chart</strong> The waterfall chart is a visual representation of the interaction between the test runner and the site being tested.</li></ol><p>By default, Splunk Synthetics provides screenshots and video capture of the test. This is useful for debugging issues. You can see, for example, the slow loading of large images, the slow rendering of a page etc.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Use your mouse to scroll left and right through the filmstrip to see how the site was being rendered during the test run.</li><li>In the Video pane, press on the play button <strong>▶</strong> to see the test playback. If you click the ellipses <strong>⋮</strong> you can change the <em>playback speed</em>, view it <em>Picture in Picture</em> and even <em>Download</em> the video.</li><li>In the Synthetic Transaction pane, under the header <em>Business Transactions</em>, click on the first button <span class="btn cstyle blue"><span><span class=title><strong>Home</strong></span></span></span></li><li>The waterfall below will show all the objects that make up the page. The first line is the HTML page itself. The next lines are the objects that make up the page (HTML, CSS, JavaScript, Images, Fonts, etc.).</li><li>In the waterfall find the line <strong>GET</strong> <em>splunk-otel-web.js</em>.</li><li>Click on the <strong>></strong> button to open the metadata section to see the Request/Response Header information.</li><li>In the Synthetic Transaction pane, click on the second Business Transaction <span class="btn cstyle blue"><span><span class=title><strong>Shop</strong></span></span></span>. Note that the filmstrip adjusts and moves to the beginning of the new transaction.</li><li>Repeat this for all the other Transactions, then finally select the<span class="btn cstyle blue"><span><span class=title><strong>PlaceOrder</strong></span></span></span> transaction.</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 4, 2023</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-synthetics-to-apm>3. Synthetics to APM</h1><p>We now should have a view similar to the one below.</p><p><a href=#R-image-4fbf929a53ab5ca106b608906a3e5056 class=lightbox-link><img alt="Place Order" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/run-results-place-order.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4fbf929a53ab5ca106b608906a3e5056><img alt="Place Order" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/run-results-place-order.png></a></p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>In the waterfall find an entry that starts with <strong>POST checkout</strong>.</li><li>Click on the <strong>></strong> button in front of it to drop open the metadata section. Observe the metadata that is collected, and note the <strong>Server-Timing</strong> header. This header is what allows us to correlate the test run to a back-end trace.</li><li>Click on the blue <i class="fa-fw fas fa-link"></i> <strong>APM</strong> link on the <strong>POST checkout</strong> line in the waterfall.</li></ul></div></details><p><a href=#R-image-af67ed2b24a23afa4a97832ee267e847 class=lightbox-link><img alt="APM trace" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af67ed2b24a23afa4a97832ee267e847><img alt="APM trace" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-trace.png></a></p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>Validate you see one or more errors for the <strong>paymentservice</strong> (<strong>1</strong>).</li><li>To validate that it&rsquo;s the same error, click on the related content for <strong>Logs</strong> (<strong>2</strong>).</li><li>Repeat the earlier exercise to filter down to the errors only.</li><li>View the error log to validate the failed payment due to an invalid token.</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 4, 2023</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-synthetics-detector>4. Synthetics Detector</h1><p>Given you can run these tests 24/7, it is an ideal tool to get warned early if your tests are failing or starting to run longer than your agreed SLA instead of getting informed by social media, or Uptime websites.</p><p><a href=#R-image-8fd2685fcc7f16e68b529c25486e05f3 class=lightbox-link><img alt="Social media" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/social-media-post.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8fd2685fcc7f16e68b529c25486e05f3><img alt="Social media" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/social-media-post.png></a></p><p>To stop that from happening let&rsquo;s detect if our test is taking more than 1.1 minutes.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li><p>Go back to the Synthetics home page via the menu on the left</p></li><li><p>Select the workshop test again and click the <span class="btn cstyle white"><span><span class=title>Create Detector</span></span></span> button at the top of the page.<br><a href=#R-image-84dfa104e57755d896a7f1ac98f7d5de class=lightbox-link><img alt="synth detector" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/synth-detector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-84dfa104e57755d896a7f1ac98f7d5de><img alt="synth detector" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/synth-detector.png></a></p></li><li><p>Edit the text <strong>New Synthetics Detector</strong> (<strong>1</strong>) and replace it with <code>INITIALS -</code> [WORKSHOPNAME]`.</p></li><li><p>Ensure that <span class="btn cstyle transparent"><span><span class=title>Run duration</span></span></span> and <span class="btn cstyle transparent"><span><span class=title>Static threshold</span></span></span> are selected.</p></li><li><p>Set the <strong>Trigger threshold</strong> (<strong>2</strong>) to be around <code>65,000</code> to <code>68,000</code> and hit enter to update the chart. Make sure you have more than one spike cutting through the threshold line as shown above (you may have to adjust the threshold value a bit to match your actual latency).</p></li><li><p>Leave the rest as default.</p></li><li><p>Note that there is now a row of red and white triangles appearing below the spikes (<strong>3</strong>). The red triangles let you know that your detector found that your test was above the given threshold & the white triangle indicates that the result returned below the threshold. Each red triangle will trigger an alert.</p></li><li><p>You can change the Alerts criticality (<strong>4</strong>) by changing the drop-down to a different level, as well as the method of alerting. Make sure you do <strong>NOT</strong> add a Recipient as this could lead to you being subjected to an alert storm!</p></li><li><p>Click <span class="btn cstyle blue"><span><span class=title>Activate</span></span></span> to deploy your detector.</p></li><li><p>To see your new created detector click <span class="btn cstyle white"><span><span class=title>Edit Test</span></span></span> button</p></li><li><p>At the bottom of the page is a list of active detectors.</p><p><a href=#R-image-61e36471ad31ce986ec3f0157c103bd3 class=lightbox-link><img alt="list of detectors" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/detector-list.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-61e36471ad31ce986ec3f0157c103bd3><img alt="list of detectors" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/detector-list.png></a></p></li><li><p>If you can&rsquo;t find yours, but see one called <em>New Synthetic Detector</em>, you may not have saved it correctly with your name. Click on the <em>New Synthetic Detector</em> link, and redo the rename.</p></li><li><p>Click on the <span class="btn cstyle transparent"><span><span class=title>Close</span></span></span> button to exit the edit mode.</p></li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 4, 2023</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=custom-service-health-dashboard->Custom Service Health Dashboard 🏥</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<details open class="box cstyle notices orange"><summary class=box-label><i class="fa-fw fas fa-user"></i>
Persona</summary><div class=box-content><p>As the <strong>SRE</strong> hat suits you let&rsquo;s keep it on as you have been asked to build a custom Service Health Dashboard for the <strong>paymentservice</strong>. The requirement is to display RED metrics, logs and Synthetic test duration results.</p></div></details><p>It is common for development and SRE teams to require a summary of the health of their applications and/or services. More often or not these are displayed on wall-mounted TVs. Splunk Observability Cloud has the perfect solution for this by creating custom dashboards.</p><p>In this section we are going to build a <strong>Service Health Dashboard</strong> we can use to display on teams&rsquo; monitors or TVs.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 9. Service Health Dashboard</h1><article class=default><header class=headline></header><h1 id=enhancing-the-dashboard>Enhancing the Dashboard</h1><p>As we already saved some useful log charts in a dashboard in the Log Observer exercise, we are going to extend that dashboard.</p><p><a href=#R-image-d74db9a5d254d7ee0c14e80a725cd2d1 class=lightbox-link><img alt="Wall mounted" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/wall-mount.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d74db9a5d254d7ee0c14e80a725cd2d1><img alt="Wall mounted" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/wall-mount.png></a></p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>To get back to your dashboard with the two log charts, click on <strong>Dashboards</strong> from the main menu and you will be taken to your Team Dashboard view. Under <strong>Dashboards</strong> click in <strong>Search dashboards</strong> to search for your Service Health Dashboard group.</li><li>Click on the name and this will bring up your previously saved dashboard.
<a href=#R-image-5303d7a7302fcccd6aacf3a5a89bb689 class=lightbox-link><img alt="log list" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../7-log-observer/images/log-observer-custom-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5303d7a7302fcccd6aacf3a5a89bb689><img alt="log list" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../7-log-observer/images/log-observer-custom-dashboard.png></a></li><li>Even if the log information is useful, it will need more information to have it make sense for our team so let&rsquo;s add a bit more information</li><li>The first step is adding a description chart to the dashboard. Click on the <span class="btn cstyle grey"><span><span class=title>New text note</span></span></span> and replace the text in the note with the following text and then click the <span class="btn cstyle blue"><span><span class=title>Save and close</span></span></span> button and name the chart <strong>Instructions</strong></li></ul><details open class="box cstyle notices grey"><summary class=box-label>Information to use with text note</summary><div class=box-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>This is a Custom Health Dashboard for the **Payment service**,  
</span></span><span class=line><span class=cl>Please pay attention to any errors in the logs.
</span></span><span class=line><span class=cl>For more detail visit [link](https://https://www.splunk.com/en_us/products/observability.html)</span></span></code></pre></div></div></details><ul><li>The charts are not in a nice order, let&rsquo;s correct that and rearrange the charts so that they are useful.</li><li>Move your mouse over the top edge of the <strong>Instructions</strong> chart, your mouse pointer will change to a <strong>☩</strong>. This will allow you to drag the chart in the dashboard. Drag the <strong>Instructions</strong> chart to the top left location and resize it to a 1/3rd of the page by dragging the right-hand edge.</li><li>Drag and add the <strong>Log Timeline view</strong> chart next to the <strong>Instruction</strong> chart, resize it so it fills the other 2/3rd of the page to be the error rate chart next to the two the chart and resize it so it fills the page</li><li>Next, resize the <strong>Log lines</strong> chart to be the width of the page and resize it the make it at least twice as long.</li><li>You should have something similar to the dashboard below:
<a href=#R-image-3d2aa8f8c0674030b3e2718cbb3fcb70 class=lightbox-link><img alt="Initial Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/initial-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3d2aa8f8c0674030b3e2718cbb3fcb70><img alt="Initial Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/initial-dashboard.png></a></li></ul></div></details><p>This looks great, let&rsquo;s continue and add more meaningful charts.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=adding-a-custom-chart>Adding a Custom Chart</h1><p>In this part of the workshop we are going to create a chart that we will add to our dashboard, we will also link it to the detector we previously built. This will allow us to see the behavior of our test and get alerted if one or more of our test runs breach its SLA.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li>At the top of the dashboard click on the <strong>+</strong> and select <strong>Chart</strong>.
<a href=#R-image-497926ebbdef78c8b4aaf326f3c49819 class=lightbox-link><img alt="new chart screen" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/new-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-497926ebbdef78c8b4aaf326f3c49819><img alt="new chart screen" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/new-chart.png></a></li><li>First, use the <span class="btn cstyle grey"><span><span class=title>Untitled chart</span></span></span> input field and name the chart <strong>Overall Test Duration</strong>.</li><li>For this exercise we want a bar or column chart, so click on the 3rd icon <i class="fa-fw fas fa-chart-bar"></i> in the chart option box.</li><li>In the <strong>Plot editor</strong> enter <code>synthetics.run.duration.time.ms</code> (this is runtime in duration for our test) in the <strong>Signal</strong> box and hit enter.</li><li>Right now we see different colored bars, a different color for each region the test runs from. As this is not needed we can change that behavior by adding some analytics.</li><li>Click the <span class="btn cstyle blue"><span><span class=title>Add analytics</span></span></span> button.</li><li>From the drop-down choose the <strong>Mean</strong> option, then pick <code>mean:aggregation</code> and click outside the dialog box. Notice how the chart changes to a single color as the metrics are now aggregated.</li><li>The x-axis does not currently represent time to change this click on the settings <i class="fa-fw fas fa-cog"></i> icon at the end of the plot line. The following following dialog will open:
<a href=#R-image-fab7cd8297dee03dae2335c8476cddeb class=lightbox-link><img alt="signal setup" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/signal-setup.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fab7cd8297dee03dae2335c8476cddeb><img alt="signal setup" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/signal-setup.png></a></li><li>Change the <strong>Display units</strong> (<strong>2</strong>) in the drop-down box from <strong>None</strong> to <strong>Time (autoscaling)/Milliseconds(ms)</strong>. The drop-down changes to <strong>Millisecond</strong> and the x-axis of the chart now represents the test duration time.</li><li>Close the dialog, either by clicking on the settings <i class="fa-fw fas fa-cog"></i> icon or the <span class="btn cstyle gray"><span><span class=title>close</span></span></span> button.</li><li>Add our detector by clicking the <span class="btn cstyle blue"><span><span class=title>Link Detector</span></span></span> button and start typing the name of the detector you created earlier.</li><li>Click on the detector name to select it.</li><li>Notice that a colored border appears around the chart, indicating the status of the alert, along with a bell icon at the top of the dashboard as shown below:
<a href=#R-image-4c550237d49edaa91d88b4914f6fd9a2 class=lightbox-link><img alt="detector added" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/detector-added.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4c550237d49edaa91d88b4914f6fd9a2><img alt="detector added" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/detector-added.png></a></li><li>Click the <span class="btn cstyle blue"><span><span class=title>Save and close</span></span></span> button.</li><li>In the dashboard, move the charts so they look like the screenshot below:
<a href=#R-image-5e715ac9cd2e60c04b4a6942c4de4d8e class=lightbox-link><img alt="Service Health Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/service-health-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5e715ac9cd2e60c04b4a6942c4de4d8e><img alt="Service Health Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/service-health-dashboard.png></a></li><li>For the final task, click three dots <strong>&mldr;</strong> at the top of the page (next to <strong>Event Overlay</strong>) and click on <strong>View fullscreen</strong>. This will be the view you would use on the TV monitor on the wall (press Esc to go back).</li></ul></div></details><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>In your spare time have a try at adding another custom chart to the dashboard using RUM metrics. You could copy a chart from the out-of-the-box <strong>RUM applications</strong> dashboard group. Or you could use the RUM metric <code>rum.client_error.count</code> to create a chart that shows the number of client errors in the application.</p></div></details><p>Finally, we will run through a workshop wrap-up.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 11, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=workshop-wrap-up->Workshop Wrap-up 🎁</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Congratulations, you have completed the <strong>Splunk4Rookies - Observability Cloud Workshop</strong>. Today, you have become familiar with how to use Splunk Observability Cloud to monitor your applications and infrastructure.</p><p>Celebrate your achievement by adding this certificate to your <span class="badge cstyle blue badge-with-title"><span class=badge-title><i class="fab fa-fw fa-linkedin-in"></i></span><span class=badge-content><a href='https://www.linkedin.com/profile/add?startTask=CERTIFICATION_NAME&name=Splunk4Rookies%20-%20Observability%20Cloud&organizationId=20226&issueYear
=2025&issueMonth=1&certUrl=https%3A%2F%2Fsplunk.github.io%2Fobservability-workshop%2Flatest%2Fen%2Fs4r%2Fimages%2Fcertificate.png' style=color:#fff target=_blank>LinkedIn</a>
</span></span>profile.</p><p>Let&rsquo;s recap what we have learned and what you can do next.</p><p><a href=#R-image-709365fcf2cd2377b0f10883ddfeb63a class=lightbox-link><img alt=Champagne class="noborder lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.76/en/s4r/10-wrap-up/images/champagne.png?width=45vw" style=height:auto;width:45vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-709365fcf2cd2377b0f10883ddfeb63a><img alt=Champagne class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.76/en/s4r/10-wrap-up/images/champagne.png?width=45vw"></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 27, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 10. Workshop Wrap-up</h1><article class=default><header class=headline></header><h1 id=key-takeaways>Key Takeaways</h1><p>During the workshop, we have seen how the Splunk Observability Cloud in combination with the OpenTelemetry signals (<strong>metrics</strong>, <strong>traces</strong> and <strong>logs</strong>) can help you to reduce mean time to detect (<strong>MTTD</strong>) and also reduce mean time to resolution (<strong>MTTR</strong>).</p><ul><li>We have a better understanding of the Main User interface and its components, the <em>Landing, Infrastructure, APM, RUM, Synthetics, Dashboard</em> pages, and a quick peek at the <em>Settings</em> page.</li><li>Depending on time, we did an <em>Infrastructure</em> exercise and looked at <em>Metrics</em> used in the Kubernetes Navigators and saw related services found on our Kubernetes cluster:</li></ul><p><a href=#R-image-7cc42f80051dcfa650906523c5c54832 class=lightbox-link><img alt=Kubernetes class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/infra.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7cc42f80051dcfa650906523c5c54832><img alt=Kubernetes class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/infra.png></a></p><ul><li>Understood what users were experiencing and used RUM & APM to Troubleshoot a particularly long page load, by following its trace across the front and back end and right to the log entries.
We used tools like RUM <em>Session replay</em> and the APM <em>Dependency map</em> with Breakdown to discover what is causing our issue:</li></ul><p><a href=#R-image-0732258ebf232c9b371191e763450b0e class=lightbox-link><img alt="rum and apm" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-apm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0732258ebf232c9b371191e763450b0e><img alt="rum and apm" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-apm.png></a></p><ul><li>Used <em>Tag Spotlight</em>, in both RUM and APM, to understand blast radius, detect trends and context for our performance issues and errors. We drilled down in <em>Span&rsquo;s</em> in the APM <em>Trace waterfall</em> to see how services interacted and find errors:</li></ul><p><a href=#R-image-72d8f336b69a622593349b32896c184e class=lightbox-link><img alt="tag and waterfall" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/tag-spotlight-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-72d8f336b69a622593349b32896c184e><img alt="tag and waterfall" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/tag-spotlight-waterfall.png></a></p><ul><li>We used the <em>Related content</em> feature to follow the link between our <em>Trace</em> directly to the <em>Logs</em> related to our <em>Trace</em> and used filters to drill down to the exact cause of our issue.</li></ul><p><a href=#R-image-f7a832ca8a84e65214b0f5c5b3f266e3 class=lightbox-link><img alt=logs class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f7a832ca8a84e65214b0f5c5b3f266e3><img alt=logs class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log.png></a></p><ul><li><p>We then looked at Synthetics, which can simulate web and mobile traffic and we used the available Synthetic Test, first to confirm our finding from RUM/AMP and Log observer, then we created a <em>Detector</em> so we would be alerted if when the run time of a test exceeded our SLA.</p></li><li><p>In the final exercise, we created a health dashboard to keep that running for our Developers and SREs on a TV screen:</p></li></ul><p><a href=#R-image-20e4175a992ff256bf8e64394efdef73 class=lightbox-link><img alt="synth and TV" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/synth-tv.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-20e4175a992ff256bf8e64394efdef73><img alt="synth and TV" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/synth-tv.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 29, 2023</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=ninja-workshops>Ninja Workshops</h1><ul class="children children-li children-sort-"><li><a href=/observability-workshop/v5.76/en/ninja-workshops/1-automatic-discovery/index.html>Automatic Discovery Workshops</a><p>Automatic Discovery Workshops</p></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/2-hpa/index.html>Horizontal Pod Autoscaling</a><p>This workshop will equip you with the basic understanding of monitoring Kubernetes using the Splunk OpenTelemetry Collector</p></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/index.html>OpenTelemetry Collector</a><p>Learn the concepts of the OpenTelemetry Collector and how to use it to send data to Splunk Observability Cloud.</p></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/4-synthetics-scripting/index.html>Splunk Synthetic Scripting</a><p>Proactively find and fix performance issues across user flows, business transactions and APIs to deliver better digital experiences.</p></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/6-lambda-kinesis/index.html>Lambda Tracing</a><p>This workshop will enable you to build a distributed trace for a small serverless application that runs on AWS Lambda, producing and consuming a message via AWS Kinesis</p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Ninja Workshops</h1><article class=default><header class=headline></header><h1 id=automatic-discovery-workshops>Automatic Discovery Workshops</h1><ul class="children children-li children-sort-"><li><a href=/observability-workshop/v5.76/en/ninja-workshops/1-automatic-discovery/1-petclinic-monolith/index.html>PetClinic Monolith Workshop</a><p>A workshop using automatic discovery and configuration for Java.</p></li><li><a href=/observability-workshop/v5.76/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/index.html>PetClinic Kubernetes Workshop</a><p>Learn how to enable automatic discovery and configuration for your Java-based application running in Kubernetes. Experience real-time monitoring to help you maximize application behavior with end-to-end visibility.</p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Automatic Discovery Workshops</h1><article class=default><header class=headline></header><h1 id=petclinic-monolith-workshop>PetClinic Monolith Workshop</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>30 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Robert Castley</span></span><p>The goal is to walk through the basic steps to configure the following components of the <strong>Splunk Observability Cloud</strong> platform:</p><ul><li>Splunk Infrastructure Monitoring (IM)</li><li>Splunk Automatic Discovery for Java (APM)<ul><li>Database Query Performance</li><li>AlwaysOn Profiling</li></ul></li><li>Splunk Real User Monitoring (RUM)</li><li>RUM to APM Correlation</li><li>Splunk Log Observer (LO)</li></ul><p>We will also show the steps about how to clone (download) a sample Java application (Spring PetClinic), as well as how to compile, package and run the application.</p><p>Once the application is up and running, we will instantly start seeing metrics, traces and logs via the <strong>automatic discovery and configuration</strong> for Java 2.x that will be used by the <strong>Splunk APM</strong> product.</p><p>After that, we will instrument PetClinic&rsquo;s end user interface (HTML pages rendered by the application) with the <strong>Splunk OpenTelemetry Javascript Libraries (RUM)</strong> that will generate RUM traces around all the individual clicks and page loads executed by an end user.</p><p>Lastly, we will view the logs generated by the automatic injection of trace metadata into the PetClinic application logs.</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-info"></i>
Prerequisites</summary><div class=box-content><ul><li>Outbound SSH access to port <code>2222</code>.</li><li>Outbound HTTP access to port <code>8083</code>.</li><li>Familiarity with the <code>bash</code> shell and <code>vi/vim</code> editor.</li></ul></div></details><p><a href=#R-image-1d8035baae233ebf36df57687ef3d695 class=lightbox-link><img alt="PetClinic Exercise" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/ninja-workshops/1-automatic-discovery/1-petclinic-monolith/images/petclinic-exercise.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1d8035baae233ebf36df57687ef3d695><img alt="PetClinic Exercise" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/ninja-workshops/1-automatic-discovery/1-petclinic-monolith/images/petclinic-exercise.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of PetClinic Monolith Workshop</h1><article class=default><header class=headline></header><h1 id=installing-the-opentelemetry-collector>Installing the OpenTelemetry Collector</h1><p>The Splunk OpenTelemetry Collector is the core component of instrumenting infrastructure and applications. Its role is to collect and send:</p><ul><li>Infrastructure metrics (disk, CPU, memory, etc)</li><li>Application Performance Monitoring (APM) traces</li><li>Profiling data</li><li>Host and application logs</li></ul><details open class="box cstyle notices warning"><summary class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i>
Remove any existing OpenTelemetry Collectors</summary><div class=box-content><p>If you have completed the Splunk IM workshop, please ensure you have deleted the collector running in Kubernetes before continuing. This can be done by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div><p>The EC2 instance may already have an older version of the collector already installed. To uninstall the collector, run the following commands:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://dl.signalfx.com/splunk-otel-collector.sh &gt; /tmp/splunk-otel-collector.sh
</span></span><span class=line><span class=cl>sudo sh /tmp/splunk-otel-collector.sh --uninstall</span></span></code></pre></div></div></details><p>To ensure your instance is configured correctly, we need to confirm that the required environment variables for this workshop are set correctly. In your terminal run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/scripts/check_env.sh</span></span></code></pre></div><p>In the output check that all of the following environment variables are present and have values set. If any are missing, please contact your instructor:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>ACCESS_TOKEN
</span></span><span class=line><span class=cl>REALM
</span></span><span class=line><span class=cl>RUM_TOKEN
</span></span><span class=line><span class=cl>HEC_TOKEN
</span></span><span class=line><span class=cl>HEC_URL
</span></span><span class=line><span class=cl>INSTANCE</span></span></code></pre></div><p>We can then go ahead and install the Collector. Some additional parameters are passed to the install script, they are:</p><ul><li><code>--with-instrumentation</code> - This will install the agent from the Splunk distribution of OpenTelemetry Java, which is then loaded automatically when the PetClinic Java application starts up. No configuration is required!</li><li><code>--deployment-environment</code> - Sets the resource attribute <code>deployment.environment</code> to the value passed. This is used to filter views in the UI.</li><li><code>--enable-profiler</code> - Enables the profiler for the Java application. This will generate CPU profiles for the application.</li><li><code>--enable-profiler-memory</code> - Enables the profiler for the Java application. This will generate memory profiles for the application.</li><li><code>--enable-metrics</code> - Enables the exporting of Micrometer metrics</li><li><code>--hec-token</code> - Sets the HEC token for the collector to use</li><li><code>--hec-url</code> - Sets the HEC URL for the collector to use</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://dl.signalfx.com/splunk-otel-collector.sh &gt; /tmp/splunk-otel-collector.sh <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>sudo sh /tmp/splunk-otel-collector.sh --realm <span class=nv>$REALM</span> -- <span class=nv>$ACCESS_TOKEN</span> --mode agent --without-fluentd --with-instrumentation --deployment-environment <span class=nv>$INSTANCE</span>-petclinic --enable-profiler --enable-profiler-memory --enable-metrics --hec-token <span class=nv>$HEC_TOKEN</span> --hec-url <span class=nv>$HEC_URL</span></span></span></code></pre></div><p>Next, we will patch the collector to expose the hostname of the instance and not the AWS instance ID. This will make it easier to filter data in the UI:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo sed -i <span class=s1>&#39;s/gcp, ecs, ec2, azure, system/system, gcp, ecs, ec2, azure/g&#39;</span> /etc/otel/collector/agent_config.yaml</span></span></code></pre></div><p>Once the <code>agent_config.yaml</code> has been patched, you will need to restart the collector:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart splunk-otel-collector</span></span></code></pre></div><p>Once the installation is completed, you can navigate to the <strong>Hosts with agent installed</strong> dashboard to see the data from your host, <strong>Dashboards → Hosts with agent installed</strong>.</p><p>Use the dashboard filter and select <code>host.name</code> and type or select the hostname of your workshop instance (you can get this from the command prompt in your terminal session). Once you see data flowing for your host, we are then ready to get started with the APM component.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=building-the-spring-petclinic-application>Building the Spring PetClinic Application</h1><p>The first thing we need to set up APM is&mldr; well, an application. For this exercise, we will use the Spring PetClinic application. This is a very popular sample Java application built with the Spring framework (Springboot).</p><p>First, clone the PetClinic GitHub repository, and then we will compile, build, package and test the application:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/spring-projects/spring-petclinic</span></span></code></pre></div><p>Change into the <code>spring-petclinic</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> spring-petclinic</span></span></code></pre></div><p>Using Docker, start a MySQL database for PetClinic to use:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -d -e <span class=nv>MYSQL_USER</span><span class=o>=</span>petclinic -e <span class=nv>MYSQL_PASSWORD</span><span class=o>=</span>petclinic -e <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span>root -e <span class=nv>MYSQL_DATABASE</span><span class=o>=</span>petclinic -p 3306:3306 docker.io/biarms/mysql:5.7</span></span></code></pre></div><p>Next, we will start another container running Locust that will generate some simple traffic to the PetClinic application. Locust is a simple load-testing tool that can be used to generate traffic to a web application.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run --network<span class=o>=</span><span class=s2>&#34;host&#34;</span> -d -p 8090:8090 -v ~/workshop/petclinic:/mnt/locust docker.io/locustio/locust -f /mnt/locust/locustfile.py --headless -u <span class=m>1</span> -r <span class=m>1</span> -H http://127.0.0.1:8083</span></span></code></pre></div><p>Next, compile, build and package PetClinic using <code>maven</code>:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>This will take a few minutes the first time you run and will download a lot of dependencies before it compiles the application. Future builds will be a lot quicker.</p></div></details><p>Once the build completes, you need to obtain the public IP address of the instance you are running on. You can do this by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://ifconfig.me</span></span></code></pre></div><p>You will see an IP address returned, make a note of this as we will need it to validate that the application is running.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=automatic-discovery-and-configuration-for-java>Automatic discovery and configuration for Java</h1><p>You can now start the application with the following command. Notice that we are passing the <code>mysql</code> profile to the application, this will tell the application to use the MySQL database we started earlier. We are also setting the <code>otel.service.name</code> and <code>otel.resource.attributes</code> to a logical names using the instance name. These will also be used in the UI for filtering:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-env <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>You can validate the application is running by visiting <code>http://&lt;IP_ADDRESS>:8083</code> (replace <code>&lt;IP_ADDRESS></code> with the IP address you obtained earlier).</p><p>When we installed the collector we configured it to enable <strong>AlwaysOn Profiling</strong> and <strong>Metrics</strong>. This means that the collector will automatically generate CPU and Memory profiles for the application and send them to Splunk Observability Cloud.</p><p>When you start the PetClinic application you will see the collector automatically detect the application and instrument it for traces and profiling.</p><div class=tab-panel data-tab-group=27d9beea50399766b13d742c2b3c6c97><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=example-output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("27d9beea50399766b13d742c2b3c6c97","example-output")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div data-tab-item=example-output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/lib/splunk-instrumentation/splunk-otel-javaagent.jar
</span></span><span class=line><span class=cl>OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:58:970 +0000] [main] INFO io.opentelemetry.javaagent.tooling.VersionLogger - opentelemetry-javaagent - version: splunk-2.6.0-otel-2.6.0
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:730 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:730 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - Profiler configuration:
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:730 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                  splunk.profiler.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:731 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                splunk.profiler.directory : /tmp
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:731 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -       splunk.profiler.recording.duration : 20s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:731 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -               splunk.profiler.keep-files : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -            splunk.profiler.logs-endpoint : null
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -              otel.exporter.otlp.endpoint : null
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -           splunk.profiler.memory.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -        splunk.profiler.memory.event.rate : 150/s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.call.stack.interval : PT10S
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:733 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -  splunk.profiler.include.internal.stacks : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:733 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.tracing.stacks.only : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:733 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:733 +0000] [main] INFO com.splunk.opentelemetry.profiler.JfrActivator - Profiler is active.</span></span></code></pre></div></div></div></div></div><p>You can now visit the Splunk APM UI and examine the application components, traces, profiling, DB Query performance and metrics. From the left-hand menu click <strong>APM</strong> and then click the <strong>Environment</strong> dropdown and select your environment e.g. <code>&lt;INSTANCE>-petclinic</code> (where<code>&lt;INSTANCE></code> is replaced with the value you noted down earlier).</p><p>Once your validation is complete you can stop the application by pressing <code>Ctrl-c</code>.</p><p>Resource attributes can be added to every reported span. For example <code>version=0.314</code>. A comma-separated list of resource attributes can also be defined e.g. <code>key1=val1,key2=val2</code>.</p><p>Let&rsquo;s launch the PetClinic again using new resource attributes. Note, that adding resource attributes to the run command will override what was defined when we installed the collector. Let&rsquo;s add a new resource attribute <code>version=0.314</code>:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-env,version<span class=o>=</span>0.314 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>Back in the Splunk APM UI we can drill down on a recent trace and see the new <code>version</code> attribute in a span.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-real-user-monitoring>3. Real User Monitoring</h1><p>For the Real User Monitoring (RUM) instrumentation, we will add the Open Telemetry Javascript <a href=https://github.com/signalfx/splunk-otel-js-web rel=external target=_blank><strong>https://github.com/signalfx/splunk-otel-js-web</strong></a> snippet in the pages, we will use the wizard again <strong>Data Management → Add Integration → RUM Instrumentation → Browser Instrumentation</strong>.</p><p>Your instructor will inform you which token to use from the dropdown, click <strong>Next</strong>. Enter <strong>App name</strong> and <strong>Environment</strong> using the following syntax:</p><ul><li><code>&lt;INSTANCE>-petclinic-service</code> - replacing <code>&lt;INSTANCE></code> with the value you noted down earlier.</li><li><code>&lt;INSTANCE>-petclinic-env</code> - replacing <code>&lt;INSTANCE></code> with the value you noted down earlier.</li></ul><p>The wizard will then show a snippet of HTML code that needs to be placed at the top of the pages in the <code>&lt;head></code> section. The following is an example of the (do not use this snippet, use the one generated by the wizard):</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>/*
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>IMPORTANT: Replace the <span class=p>&lt;</span><span class=nt>version</span><span class=p>&gt;</span> placeholder in the src URL with a
</span></span><span class=line><span class=cl>version from https://github.com/signalfx/splunk-otel-js-web/releases
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*/
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>realm</span><span class=o>:</span> <span class=s2>&#34;eu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=s2>&#34;&lt;redacted&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>applicationName</span><span class=o>:</span> <span class=s2>&#34;petclinic-1be0-petclinic-service&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>deploymentEnvironment</span><span class=o>:</span> <span class=s2>&#34;petclinic-1be0-petclinic-env&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span></span></span></code></pre></div><p>The Spring PetClinic application uses a single HTML page as the &ldquo;layout&rdquo; page, that is reused across all pages of the application. This is the perfect location to insert the Splunk RUM Instrumentation Library as it will be loaded in all pages automatically.</p><p>Let&rsquo;s then edit the layout page:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi src/main/resources/templates/fragments/layout.html</span></span></code></pre></div><p>Next, insert the snippet we generated above in the <code>&lt;head></code> section of the page. Make sure you don&rsquo;t include the comment and replace <code>&lt;version></code> in the source URL to <code>latest</code> e.g.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!doctype html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>th:fragment</span><span class=o>=</span><span class=s>&#34;layout (template, menu)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>realm</span><span class=o>:</span> <span class=s2>&#34;eu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=s2>&#34;&lt;redacted&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>applicationName</span><span class=o>:</span> <span class=s2>&#34;petclinic-1be0-petclinic-service&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>deploymentEnvironment</span><span class=o>:</span> <span class=s2>&#34;petclinic-1be0-petclinic-env&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>...</span></span></code></pre></div><p>With the code changes complete, we need to rebuild the application and run it again. Run the <code>maven</code> command to compile/build/package PetClinic:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-env,version<span class=o>=</span>0.314 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>Then let&rsquo;s visit the application using a browser to generate real-user traffic <code>http://&lt;IP_ADDRESS>:8083</code>.</p><p>In RUM, filter down into the environment as defined in the RUM snippet above and click through to the dashboard.</p><p>When you drill down into a RUM trace you will see a link to APM in the spans. Clicking on the trace ID will take you to the corresponding APM trace for the current RUM trace.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-log-observer>4. Log Observer</h1><p>For the Splunk Log Observer component, the Splunk OpenTelemetry Collector automatically collects logs from the Spring PetClinic application and sends them to Splunk Observability Cloud using the OTLP exporter, anotating the log events with <code>trace_id</code>, <code>span_id</code> and trace flags.</p><p>Log Observer provides a real-time view of logs from your applications and infrastructure. It allows you to search, filter, and analyze logs to troubleshoot issues and monitor your environment.</p><p>Go back to the PetClinic web application and click on the <strong>Error</strong> link several times. This will generate some log messages in the PetClinic application logs.</p><p><a href=#R-image-8cc4a500ea5b233eac5c74e85bdc4326 class=lightbox-link><img alt="PetClinic Error" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/petclinic-error.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8cc4a500ea5b233eac5c74e85bdc4326><img alt="PetClinic Error" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/petclinic-error.png></a></p><p>From the left-hand menu click on <strong>Log Observer</strong> and ensure <strong>Index</strong> is set to <strong>splunk4rookies-workshop</strong>.</p><p>Next, click <strong>Add Filter</strong> search for the field <code>service.name</code> select the value <code>&lt;INSTANCE>-petclinic-service</code> and click <code>=</code> (include). You should now see only the log messages from your PetClinic application.</p><p>Select one of the log entries that were generated by clicking on the <strong>Error</strong> link in the PetClinic application. You will see the log message and the trace metadata that was automatically injected into the log message. Also, you will notice that Related Content is available for APM and Infrastructure.</p><p><a href=#R-image-b6c0d699945af14fffbe914df5503e75 class=lightbox-link><img alt="Log Observer" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log-observer.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b6c0d699945af14fffbe914df5503e75><img alt="Log Observer" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log-observer.png></a></p><p>This is the end of the workshop and we have certainly covered a lot of ground. At this point, you should have metrics, traces (APM & RUM), logs, database query performance and code profiling being reported into Splunk Observability Cloud and all without having to modify the PetClinic application code (well except for RUM).</p><p><strong>Congratulations!</strong></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=spring-petclinic-springboot-based-microservices-on-kubernetes>Spring PetClinic SpringBoot Based Microservices On Kubernetes</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>90 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Pieter Hagen</span></span><p>The goal of this workshop is to introduce the features of Splunk&rsquo;s <strong>automatic discovery and configuration</strong> for Java.</p><p>The workshop scenario will be created by installing a simple (<strong>un-instrumented</strong>) Java microservices application in Kubernetes.</p><p>By following the simple steps to install the Splunk OpenTelemetry Collector and enabling automatic discovery and configuration for existing Java based deployments you will learn how easy it is to send metrics, traces and logs to <strong>Splunk Observability Cloud</strong>.</p><details open class="box cstyle notices splunk"><summary class=box-label><i class="fa-fw fas fa-circle-info"></i>
Prerequisites</summary><div class=box-content><p><ul><li>Outbound SSH access to port <strong>2222</strong>.</li><li>Outbound HTTP access to port <strong>81</strong>.</li><li>Familiarity with the Linux command line.</li></ul></div></details><p>During this workshop we will cover the following components:</p><ul><li>Splunk Infrastructure Monitoring (<strong>IM</strong>)</li><li>Splunk automatic discovery and configuration for Java (<strong>APM</strong>)<ul><li>Database Query Performance</li><li>AlwaysOn Profiling</li></ul></li><li>Splunk Log Observer (<strong>LO</strong>)</li><li>Splunk Real User Monitoring (<strong>RUM</strong>)</li></ul><p><em>Splunk Synthetics is feeling a little left out here, but we cover that in other workshops</em> <i class="fa-fw fas fa-heart"></i></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 13, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of PetClinic Kubernetes Workshop</h1><article class=default><header class=headline></header><h1 id=architecture>Architecture</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>The Spring PetClinic Java application is a simple microservices application that consists of a frontend and backend services. The frontend service is a Spring Boot application that serves a web interface to interact with the backend services. The backend services are Spring Boot applications that serve RESTful API&rsquo;s to interact with a MySQL database.</p><p>By the end of this workshop, you will have a better understanding of how to enable <strong>automatic discovery and configuration</strong> for your Java-based applications running in Kubernetes.</p><p>The diagram below details the architecture of the Spring PetClinic Java application running in Kubernetes with the Splunk OpenTelemetry Operator and automatic discovery and configuration enabled.</p><p><a href=#R-image-8627bc5530e4e58dfe0d565d9d44e4a6 class=lightbox-link><img alt="Splunk Otel Architecture" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/auto-instrumentation-java-diagram.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8627bc5530e4e58dfe0d565d9d44e4a6><img alt="Splunk Otel Architecture" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/auto-instrumentation-java-diagram.png></a></p><hr><p>Based on the <a href=https://github.com/signalfx/splunk-otel-collector-chart/blob/main/examples/enable-operator-and-auto-instrumentation/spring-petclinic-java.md rel=external target=_blank><strong>example</strong></a> <strong>Josh Voravong</strong> created.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 27, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=preparation-of-the-workshop-instance>Preparation of the Workshop instance</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>The instructor will provide you with the login information for the instance that we will be using during the workshop.</p><p>When you first log into your instance, you will be greeted by the Splunk Logo as shown below. If you have any issues connecting to your workshop instance then please reach out to your Instructor.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ ssh -p 2222 splunk@&lt;ip-address&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>███████╗██████╗ ██╗     ██╗   ██╗███╗   ██╗██╗  ██╗    ██╗  
</span></span><span class=line><span class=cl>██╔════╝██╔══██╗██║     ██║   ██║████╗  ██║██║ ██╔╝    ╚██╗ 
</span></span><span class=line><span class=cl>███████╗██████╔╝██║     ██║   ██║██╔██╗ ██║█████╔╝      ╚██╗
</span></span><span class=line><span class=cl>╚════██║██╔═══╝ ██║     ██║   ██║██║╚██╗██║██╔═██╗      ██╔╝
</span></span><span class=line><span class=cl>███████║██║     ███████╗╚██████╔╝██║ ╚████║██║  ██╗    ██╔╝ 
</span></span><span class=line><span class=cl>╚══════╝╚═╝     ╚══════╝ ╚═════╝ ╚═╝  ╚═══╝╚═╝  ╚═╝    ╚═╝  
</span></span><span class=line><span class=cl>Last login: Mon Feb  5 11:04:54 2024 from [Redacted]
</span></span><span class=line><span class=cl>Waiting for cloud-init status...
</span></span><span class=line><span class=cl>Your instance is ready!
</span></span><span class=line><span class=cl>splunk@show-no-config-i-0d1b29d967cb2e6ff:~$ </span></span></code></pre></div><p>To ensure your instance is configured correctly, we need to confirm that the required environment variables for this workshop are set correctly. In your terminal run the following script and check that the environment variables are present and set with actual valid values:</p><div class=tab-panel data-tab-group=ee13844b443f0ab6f6439efb7cc4e29d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=script class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ee13844b443f0ab6f6439efb7cc4e29d","script")'>
<span class=tab-nav-text>Script</span>
</button>
<button data-tab-item=example-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("ee13844b443f0ab6f6439efb7cc4e29d","example-output")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div data-tab-item=script class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/check_env.sh</span></span></code></pre></div></div></div><div data-tab-item=example-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ACCESS_TOKEN</span> <span class=o>=</span> &lt;redacted&gt;
</span></span><span class=line><span class=cl><span class=nv>REALM</span> <span class=o>=</span> &lt;e.g. eu0, us1, us2, jp0, au0 etc.&gt;
</span></span><span class=line><span class=cl><span class=nv>RUM_TOKEN</span> <span class=o>=</span> &lt;redacted&gt;
</span></span><span class=line><span class=cl><span class=nv>HEC_TOKEN</span> <span class=o>=</span> &lt;redacted&gt;
</span></span><span class=line><span class=cl><span class=nv>HEC_URL</span> <span class=o>=</span> https://&lt;...&gt;/services/collector/event
</span></span><span class=line><span class=cl><span class=nv>INSTANCE</span> <span class=o>=</span> &lt;instance_name&gt;</span></span></code></pre></div></div></div></div></div><p>Please make a note of the <code>INSTANCE</code> environment variable value as this will used later to filter data in <strong>Splunk Observability Cloud</strong>.</p><p>For this workshop, <strong>all</strong> of the above are required. If any have values missing, please contact your Instructor.</p><details open class="box cstyle notices splunk"><summary class=box-label><i class="fa-fw fas fa-circle-info"></i>
Delete any existing OpenTelemetry Collectors</summary><div class=box-content><p>If you have previously completed a Splunk Observability workshop using this EC2 instance, you
need to ensure that any existing installation of the Splunk OpenTelemetry Collector is
deleted. This can be achieved by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 27, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. Preparation</h1><article class=default><header class=headline></header><h1 id=deploy-the-splunk-opentelemetry-collector>Deploy the Splunk OpenTelemetry Collector</h1><p>To get Observability signals (<strong>metrics, traces</strong> and <strong>logs</strong>) into <strong>Splunk Observability Cloud</strong> the Splunk OpenTelemetry Collector needs to be deployed into the Kubernetes cluster.</p><p>For this workshop, we will be using the Splunk OpenTelemetry Collector Helm Chart. First we need to add the Helm chart repository to Helm and update to ensure the latest version:</p><div class=tab-panel data-tab-group=88cc50a1502604ae6c615a23f25d8f56><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=install-helm-chart class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("88cc50a1502604ae6c615a23f25d8f56","install-helm-chart")'>
<span class=tab-nav-text>Install Helm Chart</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("88cc50a1502604ae6c615a23f25d8f56","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=install-helm-chart class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span class=o>&amp;&amp;</span> helm repo update</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Using ACCESS_TOKEN={REDACTED}
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>&#34;splunk-otel-collector-chart&#34; has been added to your repositories
</span></span><span class=line><span class=cl>Using ACCESS_TOKEN={REDACTED}
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>Hang tight while we grab the latest from your chart repositories...
</span></span><span class=line><span class=cl>...Successfully got an update from the &#34;splunk-otel-collector-chart&#34; chart repository
</span></span><span class=line><span class=cl>Update Complete. ⎈Happy Helming!⎈</span></span></code></pre></div></div></div></div></div><p><strong>Splunk Observability Cloud</strong> offers wizards in the UI to walk you through the setup of the OpenTelemetry Collector on Kubernetes, but in the interest of time, we will use the Helm install command below. Additional parameters are set to enable the operator and automatic discovery and configuration.</p><ul><li><code>--set="operator.enabled=true"</code> - this will install the Opentelemetry operator that will be used to handle automatic discovery and configuration.</li><li><code>--set="certmanager.enabled=true"</code> - this will install the required certificate manager for the operator.</li><li><code>--set="splunkObservability.profilingEnabled=true"</code> - this enables Code Profiling via the operator.</li></ul><p>To install the collector run the following command, do <strong>NOT</strong> edit this:</p><div class=tab-panel data-tab-group=048e23e7a1307c96e1b4efc10daa3c4a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-install class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("048e23e7a1307c96e1b4efc10daa3c4a","helm-install")'>
<span class=tab-nav-text>Helm Install</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("048e23e7a1307c96e1b4efc10daa3c4a","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=helm-install class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector --version 0.111.0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;operator.enabled=true&#34;</span>, <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;certmanager.enabled=true&#34;</span>, <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.profilingEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;agent.service.enabled=true&#34;</span>  <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;environment=</span><span class=nv>$INSTANCE</span><span class=s2>-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>LAST DEPLOYED: Fri Apr 19 09:39:54 2024
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: 1
</span></span><span class=line><span class=cl>NOTES:
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Platform endpoint &#34;https://http-inputs-o11y-workshop-eu0.splunkcloud.com:443/services/collector/event&#34;.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Observability realm eu0.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[INFO] You&#39;ve enabled the operator&#39;s auto-instrumentation feature (operator.enabled=true)! The operator can automatically instrument Kubernetes hosted applications.
</span></span><span class=line><span class=cl>  - Status: Instrumentation language maturity varies. See `operator.instrumentation.spec` and documentation for utilized instrumentation details.
</span></span><span class=line><span class=cl>  - Splunk Support: We offer full support for Splunk distributions and best-effort support for native OpenTelemetry distributions of auto-instrumentation libraries.</span></span></code></pre></div></div></div></div></div><p>Ensure the Pods are reported as <strong>Running</strong> before continuing (this typically takes around 30 seconds).</p><div class=tab-panel data-tab-group=706365617a36fe7885d8e9b58a3e4ae8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("706365617a36fe7885d8e9b58a3e4ae8","kubectl-get-pods")'>
<span class=tab-nav-text>kubectl get pods</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("706365617a36fe7885d8e9b58a3e4ae8","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods <span class=p>|</span> grep splunk-otel </span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>splunk-otel-collector-certmanager-cainjector-5c5dc4ff8f-95z49   1/1     Running   0          10m
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-6d95596898-vjxss              1/1     Running   0          10m
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-webhook-69f4ff754c-nghxz      1/1     Running   0          10m
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-6bd5567d95-5f8cj     1/1     Running   0          10m
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-tspd2                               1/1     Running   0          10m
</span></span><span class=line><span class=cl>splunk-otel-collector-operator-69d476cb7-j7zwd                  2/2     Running   0          10m</span></span></code></pre></div></div></div></div></div><p>Ensure there are no errors reported by the Splunk OpenTelemetry Collector (press <code>ctrl + c</code> to exit) or use the installed <strong>awesome</strong> <code>k9s</code> terminal UI for bonus points!</p><div class=tab-panel data-tab-group=c45b17ef88d3742effc327155da8a4bb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-logs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c45b17ef88d3742effc327155da8a4bb","kubectl-logs")'>
<span class=tab-nav-text>kubectl logs</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("c45b17ef88d3742effc327155da8a4bb","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector -f --container otel-collector</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2021-03-21T16:11:10.900Z        INFO    service/service.go:364  Starting receivers...
</span></span><span class=line><span class=cl>2021-03-21T16:11:10.900Z        INFO    builder/receivers_builder.go:70 Receiver is starting... {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;prometheus&#34;, &#34;component_name&#34;: &#34;prometheus&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:75 Receiver started.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;prometheus&#34;, &#34;component_name&#34;: &#34;prometheus&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:70 Receiver is starting... {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    k8sclusterreceiver@v0.21.0/watcher.go:195       Configured Kubernetes MetadataExporter  {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;, &#34;exporter_name&#34;: &#34;signalfx&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:75 Receiver started.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    healthcheck/handler.go:128      Health Check state change       {&#34;component_kind&#34;: &#34;extension&#34;, &#34;component_type&#34;: &#34;health_check&#34;, &#34;component_name&#34;: &#34;health_check&#34;, &#34;status&#34;: &#34;ready&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    service/service.go:267  Everything is ready. Begin running and processing data.
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    k8sclusterreceiver@v0.21.0/receiver.go:59       Starting shared informers and wait for initial cache sync.      {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.281Z        INFO    k8sclusterreceiver@v0.21.0/receiver.go:75       Completed syncing shared informer caches.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}</span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Deleting a failed installation</summary><div class=box-content><p>If you make an error installing the OpenTelemetry Collector you can start over by deleting the
installation with the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 20, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-the-petclinic-application>Deploy the PetClinic Application</h1><p>The first deployment of the application will be using prebuilt containers to give the base scenario: a regular Java microservices-based application running in Kubernetes that we want to start observing. So let&rsquo;s deploy the application:</p><div class=tab-panel data-tab-group=0330bc876d2e5581c5c4127c080ed180><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-apply class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("0330bc876d2e5581c5c4127c080ed180","kubectl-apply")'>
<span class=tab-nav-text>kubectl apply</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("0330bc876d2e5581c5c4127c080ed180","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-apply class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f ~/workshop/petclinic/petclinic-deploy.yaml</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>deployment.apps/config-server created
</span></span><span class=line><span class=cl>service/config-server created
</span></span><span class=line><span class=cl>deployment.apps/discovery-server created
</span></span><span class=line><span class=cl>service/discovery-server created
</span></span><span class=line><span class=cl>deployment.apps/api-gateway created
</span></span><span class=line><span class=cl>service/api-gateway created
</span></span><span class=line><span class=cl>service/api-gateway-external created
</span></span><span class=line><span class=cl>deployment.apps/customers-service created
</span></span><span class=line><span class=cl>service/customers-service created
</span></span><span class=line><span class=cl>deployment.apps/vets-service created
</span></span><span class=line><span class=cl>service/vets-service created
</span></span><span class=line><span class=cl>deployment.apps/visits-service created
</span></span><span class=line><span class=cl>service/visits-service created
</span></span><span class=line><span class=cl>deployment.apps/admin-server created
</span></span><span class=line><span class=cl>service/admin-server created
</span></span><span class=line><span class=cl>service/petclinic-db created
</span></span><span class=line><span class=cl>deployment.apps/petclinic-db created
</span></span><span class=line><span class=cl>configmap/petclinic-db-initdb-config created
</span></span><span class=line><span class=cl>deployment.apps/petclinic-loadgen-deployment created
</span></span><span class=line><span class=cl>configmap/scriptfile created</span></span></code></pre></div></div></div></div></div><p>At this point, we can verify the deployment by checking that the Pods are running. The containers need to be downloaded and started so this may take a couple of minutes.</p><div class=tab-panel data-tab-group=df666a257eecd5ca583407b37f16555c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("df666a257eecd5ca583407b37f16555c","kubectl-get-pods")'>
<span class=tab-nav-text>kubectl get pods</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("df666a257eecd5ca583407b37f16555c","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                            READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-dc744986b-z2gzw               1/1     Running   0          114s
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-cainjector-69546b87d6-d2fz2   1/1     Running   0          114s
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-webhook-78b59ffc88-r2j8x      1/1     Running   0          114s
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-655dcd9b6b-dcvkb     1/1     Running   0          114s
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-dg2vj                               1/1     Running   0          114s
</span></span><span class=line><span class=cl>splunk-otel-collector-operator-57cbb8d7b4-dk5wf                 2/2     Running   0          114s
</span></span><span class=line><span class=cl>petclinic-db-64d998bb66-2vzpn                                   1/1     Running   0          58s
</span></span><span class=line><span class=cl>api-gateway-d88bc765-jd5lg                                      1/1     Running   0          58s
</span></span><span class=line><span class=cl>visits-service-7f97b6c579-bh9zj                                 1/1     Running   0          58s
</span></span><span class=line><span class=cl>admin-server-76d8b956c5-mb2zv                                   1/1     Running   0          58s
</span></span><span class=line><span class=cl>customers-service-847db99f79-mzlg2                              1/1     Running   0          58s
</span></span><span class=line><span class=cl>vets-service-7bdcd7dd6d-2tcfd                                   1/1     Running   0          58s
</span></span><span class=line><span class=cl>petclinic-loadgen-deployment-5d69d7f4dd-xxkn4                   1/1     Running   0          58s
</span></span><span class=line><span class=cl>config-server-67f7876d48-qrsr5                                  1/1     Running   0          58s
</span></span><span class=line><span class=cl>discovery-server-554b45cfb-bqhgt                                1/1     Running   0          58s</span></span></code></pre></div></div></div></div></div><p>Make sure the output of <code>kubectl get pods</code> matches the output as shown above. Ensure all the services are shown as <strong>Running</strong> (or use <code>k9s</code> to continuously monitor the status).</p><p>To test the application you need to obtain the public IP address of the instance you are running on. You can do this by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://ifconfig.me</span></span></code></pre></div><p>You can validate if the application is running by visiting <strong>http://&lt;IP_ADDRESS>:81</strong> (replace <strong>&lt;IP_ADDRESS></strong> with the IP address you obtained above). You should see the PetClinic application running. The application is also running on ports <strong>80</strong> & <strong>443</strong> if you prefer to use those or port <strong>81</strong> is unreachable.</p><p><a href=#R-image-ae857c345d9879cf84ceac6482877d88 class=lightbox-link><img alt="Pet shop" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/petclinic.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ae857c345d9879cf84ceac6482877d88><img alt="Pet shop" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/petclinic.png></a></p><p>Make sure the application is working correctly by visiting the <strong>All Owners</strong> <strong>(1)</strong> and <strong>Veterinarians</strong> <strong>(2)</strong> tabs, you should get a list of names in each case.</p><p><a href=#R-image-6bde3fc1944bf17d493ccb83b7093b5f class=lightbox-link><img alt=owners class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/petclinic-owners.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6bde3fc1944bf17d493ccb83b7093b5f><img alt=owners class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/petclinic-owners.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 11, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=verify-kubernetes-cluster-metrics>Verify Kubernetes Cluster metrics</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Once the installation has been completed, you can log in to <strong>Splunk Observability Cloud</strong> and verify that the metrics are flowing in from your Kubernetes cluster.</p><p>From the left-hand menu click on <strong>Infrastructure</strong> and select <strong>Kubernetes</strong>, then select the <strong>Kubernetes nodes</strong> pane. Once you are in the <strong>Kubernetes nodes</strong> view, change the <strong>Time</strong> filter from <strong>-4h</strong> to the last 15 minutes <strong>(-15m)</strong> to focus on the latest data.</p><p>Next, from the list of clusters, select the cluster name of your workshop instance (you can get the unique part from your cluster name by using the <code>INSTANCE</code> from the output from the shell script you ran earlier). <strong>(1)</strong></p><p><a href=#R-image-66ba514ae4869a80ef39da1a06e3280a class=lightbox-link><img alt=NavigatorI class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/navigatorlist.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-66ba514ae4869a80ef39da1a06e3280a><img alt=NavigatorI class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/navigatorlist.png></a></p><p>You can now select your node by clicking on it name <strong>(1)</strong> in the node list.</p><p><a href=#R-image-2c77ac2a9d13422781eaa9a26bd0724b class=lightbox-link><img alt=NavigatorII class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/nodelist.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2c77ac2a9d13422781eaa9a26bd0724b><img alt=NavigatorII class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/nodelist.png></a></p><p>Open the <strong>Hierarchy Map</strong> by clicking on the <em>Hierarchy Map</em> <strong>(1)</strong> link in the gray pane to show the graphical representation of your node.</p><p><a href=#R-image-4e452bd15337e996c1474716a5db9ba4 class=lightbox-link><img alt=NavigatorII class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/hierarchymap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4e452bd15337e996c1474716a5db9ba4><img alt=NavigatorII class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/hierarchymap.png></a></p><p>You will now only have your cluster visible.
Scroll down the page to see the metrics coming in from your cluster. Locate the <strong>Node log events rate</strong> chart and click on a vertical bar to see the log entries coming in from your cluster.</p><p><a href=#R-image-28806f5da5ae113fa6c8b6c3d2f5fe6e class=lightbox-link><img alt=logs class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/k8s-peek-at-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-28806f5da5ae113fa6c8b6c3d2f5fe6e><img alt=logs class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/k8s-peek-at-logs.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 11, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=setting-up-automatic-discovery-and-configuration-for-apm>Setting up automatic discovery and configuration for APM</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>In this section we will enable <strong>automatic discovery and configuration</strong> for the Java services running in Kubernetes. This means that the OpenTelemetry Collector will look for Pod annotations that indicate that the Java application should be instrumented with the Splunk OpenTelemetry Java agent. This will allow us to get traces, spans, and profiling data from the Java services running on the cluster.</p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
automatic discovery and configuration</summary><div class=box-content><p>It is important to understand that automatic discovery and configuration is designed to get <strong>trace, span & profiling</strong> data out of your application, without requiring code changes or recompilation.</p><p>This is a great way to get started with APM, but it is <strong>not</strong> a replacement for manual instrumentation. Manual instrumentation allows you to add custom spans, tags, and logs to your application, which can provide more context and detail to your traces.</p></div></details><p>For Java applications the OpenTelemetry Collector will look for the annotation <code>instrumentation.opentelemetry.io/inject-java</code>.</p><p>The annotation can have the value set <code>true</code> or to the <code>namespace/daemonset</code> of the OpenTelemetry Collector e.g. <code>default/splunk-otel-collector</code>. This allows working across namespaces and what we will use in this workshop.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Using the deployment.yaml</summary><div class=box-content><p>If you want your Pods to send traces automatically, you can add the annotation to the <code>deployment.yaml</code> as shown below. This will add the instrumentation library during the initial deployment. To speed things up we have done that for the following Pods:</p><ul><li><strong>admin-server</strong></li><li><strong>config-server</strong></li><li><strong>discovery-server</strong></li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>admin-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/part-of</span><span class=p>:</span><span class=w> </span><span class=l>spring-petclinic</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>admin-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>admin-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>instrumentation.opentelemetry.io/inject-java</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;default/splunk-otel-collector&#34;</span></span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 4. Automatic discovery and configuration</h1><article class=default><header class=headline></header><h1 id=patching-the-deployment>Patching the Deployment</h1><p>To configure <strong>automatic discovery and configuration</strong> the deployments need to be patched to add the instrumentation annotation. Once patched, the OpenTelemetry Collector will inject the automatic discovery and configuration library and the Pods will be restarted in order to start sending traces and profiling data. First, confirm that the <code>api-gateway</code> does not have the <code>splunk-otel-java</code> image.</p><div class=tab-panel data-tab-group=084db789c6bda42a8ed31328f552119d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=describe-api-gateway class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("084db789c6bda42a8ed31328f552119d","describe-api-gateway")'>
<span class=tab-nav-text>Describe api-gateway</span>
</button>
<button data-tab-item=describe-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("084db789c6bda42a8ed31328f552119d","describe-output")'>
<span class=tab-nav-text>Describe Output</span></button></div><div class=tab-content-container><div data-tab-item=describe-api-gateway class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe pods api-gateway <span class=p>|</span> grep Image:</span></span></code></pre></div></div></div><div data-tab-item=describe-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Image:         quay.io/phagen/spring-petclinic-api-gateway:0.0.2</span></span></code></pre></div></div></div></div></div><p>Next, enable the Java automatic discovery and configuration for all of the services by adding the annotation to the deployments. The following command will patch the all deployments. This will trigger the OpenTelemetry Operator to inject the <code>splunk-otel-java</code> image into the Pods:</p><div class=tab-panel data-tab-group=81b72a9d46c44405552f62b7a11095ee><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=patch-all-petclinic-services class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("81b72a9d46c44405552f62b7a11095ee","patch-all-petclinic-services")'>
<span class=tab-nav-text>Patch all PetClinic services</span>
</button>
<button data-tab-item=patch-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("81b72a9d46c44405552f62b7a11095ee","patch-output")'>
<span class=tab-nav-text>Patch Output</span></button></div><div class=tab-content-container><div data-tab-item=patch-all-petclinic-services class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get deployments -l app.kubernetes.io/part-of<span class=o>=</span>spring-petclinic -o name <span class=p>|</span> xargs -I % kubectl patch % -p <span class=s2>&#34;{\&#34;spec\&#34;: {\&#34;template\&#34;:{\&#34;metadata\&#34;:{\&#34;annotations\&#34;:{\&#34;instrumentation.opentelemetry.io/inject-java\&#34;:\&#34;default/splunk-otel-collector\&#34;}}}}}&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=patch-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>deployment.apps/config-server patched (no change)
</span></span><span class=line><span class=cl>deployment.apps/admin-server patched (no change)
</span></span><span class=line><span class=cl>deployment.apps/customers-service patched
</span></span><span class=line><span class=cl>deployment.apps/visits-service patched
</span></span><span class=line><span class=cl>deployment.apps/discovery-server patched (no change)
</span></span><span class=line><span class=cl>deployment.apps/vets-service patched
</span></span><span class=line><span class=cl>deployment.apps/api-gateway patched</span></span></code></pre></div></div></div></div></div><p>There will be no change for the <strong>config-server</strong>, <strong>discovery-server</strong> and <strong>admin-server</strong> as these have already been patched.</p><p>To check the container image(s) of the <code>api-gateway</code> pod again, run the following command:</p><div class=tab-panel data-tab-group=9d6ffec83b8f09aa39ef693649881918><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=describe-api-gateway class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("9d6ffec83b8f09aa39ef693649881918","describe-api-gateway")'>
<span class=tab-nav-text>Describe api-gateway</span>
</button>
<button data-tab-item=describe-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("9d6ffec83b8f09aa39ef693649881918","describe-output")'>
<span class=tab-nav-text>Describe Output</span></button></div><div class=tab-content-container><div data-tab-item=describe-api-gateway class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe pods api-gateway <span class=p>|</span> grep Image:</span></span></code></pre></div></div></div><div data-tab-item=describe-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Image:         ghcr.io/signalfx/splunk-otel-java/splunk-otel-java:v1.30.0
</span></span><span class=line><span class=cl>Image:         quay.io/phagen/spring-petclinic-api-gateway:0.0.2</span></span></code></pre></div></div></div></div></div><p>A new image has been added to the <code>api-gateway</code> which will pull <code>splunk-otel-java</code> from <code>ghcr.io</code> (if you see two <code>api-gateway</code> containers, the original one is probably still terminating, so give it a few seconds).</p><p>Navigate back to the Kubernetes Navigator in <strong>Splunk Observability Cloud</strong>. After a couple of minutes you will see that the Pods are being restarted by the operator and the automatic discovery and configuration container will be added. This will look similar to the screenshot below:</p><p><a href=#R-image-d041c073446782c70e15ee282fe5b773 class=lightbox-link><img alt=restart class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/k8s-navigator-restarted-pods.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d041c073446782c70e15ee282fe5b773><img alt=restart class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/k8s-navigator-restarted-pods.png></a></p><p>Wait for the Pods to turn green in the Kubernetes Navigator, then go tho the next section.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=viewing-the-data-in-splunk-apm>Viewing the data in Splunk APM</h1><p>Log in to Splunk Observability Cloud, from the left-hand menu click on <a href=#R-image-d411b55e7562b62cf5d77eb220df4fc9 class=lightbox-link><img alt=APM class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../images/apm-icon.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d411b55e7562b62cf5d77eb220df4fc9><img alt=APM class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/apm-icon.png?classes=inline&height=25px"></a> <strong>APM</strong> to see the data generated by the traces from the newly instrumented services. Change the <strong>Environment</strong> filter <strong>(1)</strong> to the name of your workshop instance in the dropdown box (this will be <strong><code>&lt;INSTANCE>-workshop</code></strong> where <strong><code>INSTANCE</code></strong> is the value from the shell script you ran earlier) and make sure it is the only one selected.</p><p><a href=#R-image-84ea7f67bc24156f77f6031615c24ec6 class=lightbox-link><img alt=apm class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/zero-config-first-services-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-84ea7f67bc24156f77f6031615c24ec6><img alt=apm class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/zero-config-first-services-overview.png></a></p><p>You will see the name <strong>(2)</strong> of the <strong>api-gateway</strong> service and metrics in the Latency and Request & Errors charts (you can ignore the Critical Alert, as it is caused by the sudden request increase generated by the load generator). You will also see the rest of the services appear.</p><p>Once you see the Customer service, Vets service and Visits services like show in the screenshot above, let&rsquo;s click on the <strong>Service Map</strong> <strong>(3)</strong> pane to get ready for the next section.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=apm-features>APM Features</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>As we have seen in the previous section, once you enable <strong>automatic discovery and configuration</strong> on your services, traces are sent to <strong>Splunk Observability Cloud</strong>.</p><p>With these traces, Splunk will automatically generate <strong>Service Maps</strong> and <strong>RED Metrics</strong>. These are the first steps in understanding the behavior of your services and how they interact with each other.</p><p>In this next section, we are going to examine the traces themselves and what information they provide to help you understand the behavior of your services all without touching your code.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 5. APM Features</h1><article class=default><header class=headline></header><h1 id=apm-service-map>APM Service Map</h1><p><a href=#R-image-bd35cf0868af681034c91a00d841838f class=lightbox-link><img alt="apm map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/zero-config-first-services-map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bd35cf0868af681034c91a00d841838f><img alt="apm map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/zero-config-first-services-map.png></a></p><p>The above map shows all the interactions between all of the services. The map may still be in an interim state as it will take the Petclinic Microservice application a few minutes to start up and fully synchronize. Reducing the time filter to a custom time of <strong>2 minutes</strong> will help. You can click on the <strong>Refresh</strong> button <strong>(1)</strong> on the top right of the screen. The initial startup-related errors (red dots) will eventually disappear.</p><p>Next, let&rsquo;s examine the metrics that are available for each service that is instrumented and visit the request, error, and duration (RED) metrics Dashboard</p><p>For this exercise we are going to use a common scenario you would use if the service operation was showing high latency, or errors for example.</p><p>Select (click) on the <strong>Customer Service</strong> in the Dependency map <strong>(1)</strong>, then make sure the <code>customers-service</code> is selected in the <strong>Services</strong> dropdown box <strong>(2)</strong>. Next, select <code>GET /Owners</code> from the Operations dropdown <strong>(3</strong>)**.</p><p>This should give you the workflow with a filter on <code>GET /owners</code> <strong>(1)</strong> as shown below.</p><p><a href=#R-image-a3f62ea44617e8dde5f0d3a00c979bde class=lightbox-link><img alt="select a trace" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/select-workflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a3f62ea44617e8dde5f0d3a00c979bde><img alt="select a trace" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/select-workflow.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=apm-trace>APM Trace</h1><p>To pick a trace, select a line in the <code>Service Requests & Errors</code> chart <strong>(1)</strong>, when the dot appears click to get a list of sample traces:</p><p>Once you have the list of sample traces, click on the blue <strong>(2)</strong> Trace ID Link (make sure it has the same three services mentioned in the Service Column.)</p><p><a href=#R-image-f0fd4e0995d67d1135a986014451da55 class=lightbox-link><img alt=workflow-trace-pick class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/selecting-a-trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f0fd4e0995d67d1135a986014451da55><img alt=workflow-trace-pick class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/selecting-a-trace.png></a></p><p>This brings us the the Trace selected in the Waterfall view:</p><p>Here we find several sections:</p><ul><li>The actual Waterfall Pane <strong>(1)</strong>, where you see the trace and all the instrumented functions visible as spans, with their duration representation and order/relationship showing.</li><li>The Trace Info Pane <strong>(2)</strong>, by default, shows the selected Span information (highlighted with a box around the Span in the Waterfall Pane).</li><li>The Span Pane <strong>(3)</strong>, here you can find all the Tags that have been sent in the selected Span, You can scroll down to see all of them.</li><li>The process Pane, with tags related to the process that created the Span (scroll down to see as it is not in the screenshot).</li><li>The Trace Properties at the top of the right-hand pane by default is collapsed as shown.</li></ul><p><a href=#R-image-9a562287414af742290d63a833c236d8 class=lightbox-link><img alt=waterfall class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/waterfall-view.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9a562287414af742290d63a833c236d8><img alt=waterfall class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/waterfall-view.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=apm-span>APM Span</h1><p>While we examine our spans, let&rsquo;s look at several features that you get out of the box without code modifications when using <strong>automatic discovery and configuration</strong> on top of tracing:</p><p>First, in the Waterfall Pane, make sure the <code>customers-service:SELECT petclinic</code> or similar span is selected as shown in the screenshot below:</p><p><a href=#R-image-807a3984d893314f0ac66b10c118f298 class=lightbox-link><img alt=DB-query class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/db-query.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-807a3984d893314f0ac66b10c118f298><img alt=DB-query class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/db-query.png></a></p><ul><li>The basic latency information is shown as a bar for the instrumented function or call, in our example, it took 17.8 Milliseconds.</li><li>Several similar Spans <strong>(1)</strong>, are only visible if the span is repeated multiple times. In this case, there are 10 repeats in our example. (You can show/hide them all by clicking on the <code>10x</code> and all spans will show in order)</li><li><strong>Inferred Services</strong>: Calls made to external systems that are not instrumented, show up as a grey &lsquo;inferred&rsquo; span. The Inferred Service or span in our case here is a call to the Mysql Database <code>mysql:petclinic SELECT petclinic</code> <strong>(2)</strong> as shown above our selected span.</li><li><strong>Span Tags</strong>: In the Tag Pane, standard tags produced by the automatic discovery and configuration. In this case, the span is calling a Database, so it includes the <code>db.statement</code> tag <strong>(3)</strong>. This tag will hold the DB query statement and is used by the Database call performed during this span. This will be used by the DB-Query Performance feature. We look at DB-Query Performance in the next section.</li><li><strong>Always-on Profiling</strong>: <strong>IF</strong> the system is configured to and has captured Profiling data during a Span life cycle, it will show the number of Call Stacks captured in the Spans timeline (18 Call Stacks for the <code>customer-service:GET /owners</code> Span shown above). <strong>(4)</strong></li></ul><p>We will look at Profiling in the next section.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=service-centric-view>Service Centric View</h1><p>Splunk APM provide <strong>Service Centric Views</strong> that provide engineers a deep understanding of service performance in one centralized view. Now, across every service, engineers can quickly identify errors or bottlenecks from a service’s underlying infrastructure, pinpoint performance degradations from new deployments, and visualize the health of every third party dependency.</p><p>To see this dashboard for the <code>api-gateway</code>,Click on <strong>APM</strong> from the right hand menu bar and go to the <strong>Dependency Map</strong>. Make sure you have the <code>api-gateway</code> service selected in the Service Map, then click on the *<strong>View Service</strong> button in the top of the right-hand pane. This will bring you to the Service Centric View dashboard:</p><p><a href=#R-image-24c90f9240be1a7bb803d468cb60ae04 class=lightbox-link><img alt=service_maps class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/service-view.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-24c90f9240be1a7bb803d468cb60ae04><img alt=service_maps class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/service-view.png></a></p><p>This view, which is available for each of your instrumented services, offers an overview of <strong>Service metrics</strong>, <strong>Runtime metrics</strong> and <strong>Infrastructure metrics</strong>.</p><p>You can select the <strong>Back</strong> function of you browser to go back to the previous view.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=always-on-profiling--db-query-performance>Always-On Profiling & DB Query Performance</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>As we have seen in the previous chapter, you can trace your interactions between the various services using APM without touching your code, which will allow you to identify issues faster.</p><p>However, besides tracing <strong>automatic discovery and configuration</strong> offers additional features out of the box that can help you find issues even faster. In this section we are going to look at two of them:</p><ul><li><strong>Always-on Profiling and Java Metrics</strong></li><li><strong>Database Query Performance</strong></li></ul><p>If you want to dive deeper into Always-on Profiling or DB-Query performance, we have a separate Ninja Workshop called <a href=/observability-workshop/v5.76/en/scenarios/debug_problems/index.html><strong>Debug Problems in Microservices</strong></a> that you can follow.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 6. Advanced Features</h1><article class=default><header class=headline></header><h1 id=always-on-profiling--metrics>Always-On Profiling & Metrics</h1><p>When we installed the Splunk Distribution of the OpenTelemetry Collector using the Helm chart earlier, we configured it to enable <strong>AlwaysOn Profiling</strong> and <strong>Metrics</strong>. This means that the collector will automatically generate CPU and Memory profiles for the application and send them to Splunk Observability Cloud.</p><p>When you deploy the PetClinic application and set the annotation, the collector automatically detects the application and instruments it for traces and profiling. We can verify this by examining the startup logs of one of the Java containers we are instrumenting by running the following script:</p><p>The logs should show what flags were picked up by the Java automatic discovery and configuration:</p><p><div class=tab-panel data-tab-group=40a20162f632b41e13d92bf1b1911c73><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=run-the-script class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("40a20162f632b41e13d92bf1b1911c73","run-the-script")'>
<span class=tab-nav-text>Run the script</span>
</button>
<button data-tab-item=example-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("40a20162f632b41e13d92bf1b1911c73","example-output")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div data-tab-item=run-the-script class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0><code class=language-logs data-lang=logs>.  ~/workshop/petclinic/scripts/get_logs.sh</code></pre></div></div></div><div data-tab-item=example-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2024/02/15 09:42:00 Problem with dial: dial tcp 10.43.104.25:8761: connect: connection refused. Sleeping 1s
</span></span><span class=line><span class=cl>2024/02/15 09:42:01 Problem with dial: dial tcp 10.43.104.25:8761: connect: connection refused. Sleeping 1s
</span></span><span class=line><span class=cl>2024/02/15 09:42:02 Connected to tcp://discovery-server:8761
</span></span><span class=line><span class=cl>Picked up JAVA_TOOL_OPTIONS:  -javaagent:/otel-auto-instrumentation-java/javaagent.jar
</span></span><span class=line><span class=cl>Picked up _JAVA_OPTIONS: -Dspring.profiles.active=docker,mysql -Dsplunk.profiler.call.stack.interval=150
</span></span><span class=line><span class=cl>OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:03:056 +0000] [main] INFO io.opentelemetry.javaagent.tooling.VersionLogger - opentelemetry-javaagent - version: splunk-1.30.1-otel-1.32.1
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:03:768 +0000] [main] INFO com.splunk.javaagent.shaded.io.micrometer.core.instrument.push.PushMeterRegistry - publishing metrics for SignalFxMeterRegistry every 30s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:478 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:478 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - Profiler configuration:
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:480 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                  splunk.profiler.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:505 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                splunk.profiler.directory : /tmp
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:505 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -       splunk.profiler.recording.duration : 20s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:506 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -               splunk.profiler.keep-files : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:510 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -            splunk.profiler.logs-endpoint : http://10.13.2.38:4317
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:513 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -              otel.exporter.otlp.endpoint : http://10.13.2.38:4317
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:513 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -           splunk.profiler.memory.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:515 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -             splunk.profiler.tlab.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:516 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -        splunk.profiler.memory.event.rate : 150/s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:516 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.call.stack.interval : PT0.15S
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:517 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -  splunk.profiler.include.internal.stacks : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:517 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.tracing.stacks.only : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:517 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:518 +0000] [main] INFO com.splunk.opentelemetry.profiler.JfrActivator - Profiler is active.</span></span></code></pre></div></div></div></div></div>We are interested in the section written by the <code>com.splunk.opentelemetry.profiler.ConfigurationLogger</code> or the <strong>Profiling Configuration</strong>.</p><p>We can see the various settings you can control, some that are useful depending on your use case like the <code>splunk.profiler.directory</code> - The location where the agent writes the call stacks before sending them to Splunk. This may be different depending on how you configure your containers.</p><p>Another parameter you may want to change is <code>splunk.profiler.call.stack.interval</code> This is how often the system takes a CPU Stack trace. You may want to reduce this if you have short spans like we have in our application. (we kept the default as the spans in this demo application are extremely short, so Span may not always have a CPU Call Stack related to it.)</p><p>You can find how to set these parameters <a href=https://docs.splunk.com/observability/en/gdi/get-data-in/application/java/configuration/advanced-java-otel-configuration.html#profiling-configuration-java rel=external target=_blank>here</a>. Below, is how you set a higher collection rate for call stack in your <code>deployment.yaml</code>, exactly how to pass any JAVA option to the Java application running in your container:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>env</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_OPTIONS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;-Xdebug -Dsplunk.profiler.call.stack.interval=150&#34;</span></span></span></code></pre></div><p>If you don&rsquo;t see those lines as a result of the script, the startup may have taken too long and generated too many connection errors, try looking at the logs directly with <code>kubectl</code> or the <code>k9s</code> utility that is installed.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=always-on-profiling-in-the-trace-waterfall>Always-On Profiling in the Trace Waterfall</h1><p>Make sure you have your original (or similar) Trace & Span <strong>(1)</strong> selected in the APM Waterfall view and select <strong>Memory Stack Traces (2)</strong> from the right-hand pane:</p><p><a href=#R-image-faa728abd9402c57cb0799146c20ff19 class=lightbox-link><img alt="profiling from span" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/flamechart-in-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-faa728abd9402c57cb0799146c20ff19><img alt="profiling from span" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/flamechart-in-waterfall.png></a></p><p>The pane should show you the Memory Stack Trace Flame Graph <strong>(3)</strong>, you can scroll down and/or make the pane for a better view by dragging the right side of the pane.</p><p>As AlwaysOn Profiling is constantly taking snapshots, or stack traces, of your application’s code and reading through thousands of stack traces is not practical, AlwaysOn Profiling aggregates and summarizes profiling data, providing a convenient way to explore Call Stacks in a view called the <strong>Flame Graph</strong>. It represents a summary of all stack traces captured from your application. You can use the Flame Graph to discover which lines of code might be causing performance issues and to confirm whether the changes you make to the code have the intended effect.</p><p>To dive deeper into the Always-on Profiling, select Span <strong>(3)</strong> in the Profiling Pane under <strong>Memory Stack Traces</strong>
This will bring you to the Always-on Profiling main screen, with the Memory view pre-selected:</p><p><a href=#R-image-c84cce8289fa5dfc8d10c922f301c92a class=lightbox-link><img alt="Profiling main" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/profiling-memory.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c84cce8289fa5dfc8d10c922f301c92a><img alt="Profiling main" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/profiling-memory.png></a></p><ul><li>Time filter will be set to the time frame of the span we selected <strong>(1)</strong></li><li>Java Memory Metric Charts <strong>(2)</strong>, Allow you to <code>Monitor Heap Memory, Application Activity</code> like <code>Memory Allocation Rate</code> and <code>Garbage Collecting</code> Metrics.</li><li>Ability to focus/see metrics and Stack Traces only related to the Span <strong>(3)</strong>, This will filter out background activities running in the Java application if required.</li><li>Java Function calls identified. <strong>(4)</strong>, allowing you to drill down into the Methods called from that function.</li><li>The Flame Graph <strong>(5)</strong>, with the visualization of hierarchy based on the stack traces of the profiled service.</li><li>Ability to select the Service instance <strong>(6)</strong> in case the service spins up multiple version of it self.</li></ul><p>For further investigation the UI let&rsquo;s you grab the actual stack trace, by selecting a function and the relevant line from the flam chart, so you can use in your coding platform to go to the actual lines of code used at this point (depending of course on your preferred Coding platform)</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=database-query-performance>Database Query Performance</h1><p>With Database Query Performance, you can monitor the impact of your database queries on service availability directly in Splunk APM. This way, you can quickly identify long-running, un-optimized, or heavy queries and mitigate issues they might be causing, without having to instrument your databases.</p><p>To look at the performance of your database queries, make sure you are on the APM <strong>Service Map</strong> page either by going back in the browser or navigating to the APM section in the Menu bar, then click on the <strong>Service Map</strong> tile.
Select the inferred database service <code>mysql:petclinic</code> Inferred Database server in the Dependency map <strong>(1)</strong>, then scroll the right-hand pane to find the <strong>Database Query Performance</strong> Pane <strong>(2)</strong>.</p><p><a href=#R-image-088db7461200c149488e4d34dd4296cc class=lightbox-link><img alt="DB-query from map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/db-query-map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-088db7461200c149488e4d34dd4296cc><img alt="DB-query from map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/db-query-map.png></a></p><p>If the service you have selected in the map is indeed an (inferred) database server, this pane will populate with the top 90% (P90) database calls based on duration. To dive deeper into the db-query performance function click somewhere on the word <strong>Database Query Performance</strong> at the top of the pane.</p><p>This will bring us to the DB-query Performance overview screen:</p><p><a href=#R-image-870a14368de22178ea541d6af52232bc class=lightbox-link><img alt="DB-query full" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/db-query-full.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-870a14368de22178ea541d6af52232bc><img alt="DB-query full" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/db-query-full.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Database Query Normalization</summary><div class=box-content><p>By default, Splunk APM instrumentation sanitizes database queries to remove or mask sensible data, such as secrets or personally identifiable information (PII) from the <code>db.statements</code>. You can find how to turn off database query normalization <a href=https://docs.splunk.com/observability/en/apm/db-query-perf/db-perf-troubleshooting.html#turn-off-database-query-normalization rel=external target=_blank>here</a>.</p></div></details><p>This screen will show us all the Database queries <strong>(1)</strong> done towards our database from your application, based on the Traces & Spans sent to the Splunk Observability Cloud. Note that you can compare them across a time block or sort them on Total Time, P90 Latency & Requests <strong>(2)</strong>.</p><p>For each Database query in the list, we see the highest latency, the total number of calls during the time window and the number of requests per second <strong>(3)</strong>. This allows you to identify places where you might optimize your queries.</p><p>You can select traces containing Database Calls via the two charts in the right-hand pane <strong>(5)</strong>. Use the Tag Spotlight pane <strong>(6)</strong> to drill down what tags are related to the database calls, based on endpoints or tags.</p><p>If you need to see a detailed view of a query:</p><p><a href=#R-image-8d4c264dda3f175a01b51896571ddf17 class=lightbox-link><img alt=details class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/query-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8d4c264dda3f175a01b51896571ddf17><img alt=details class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/query-details.png></a></p><p>Click on the specific Query <strong>(1)</strong>, this wil give you a detailed query Details pane <strong>(2)</strong>, which you can use for more detailed investigations:</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=log-observer>Log Observer</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Up until this point, there have been no code changes, yet tracing, profiling and Database Query Performance data is being sent to Splunk Observability Cloud.</p><p>Next we will work with the <strong>Splunk Log Observer</strong> to the mix to obtain log data from the Spring PetClinic application.</p><p>The <strong>Splunk OpenTelemetry Collector</strong> automatically collects logs from the Spring PetClinic application and sends them to Splunk Observability Cloud using the OTLP exporter, annotating the log events with <code>trace_id</code>, <code>span_id</code> and trace flags.</p><p>The <strong>Splunk Log Observer</strong> is then used to view the logs and with the changes to the log format the platform can automatically correlate log information with services and traces.</p><p>This feature is called <a href=https://docs.splunk.com/observability/en/metrics-and-metadata/relatedcontent.html rel=external target=_blank><strong>Related Content</strong></a>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 7. Log Observer</h1><article class=default><header class=headline></header><h1 id=related-content>Related Content</h1><p>In the bottom pane is where any related content will be reported. In the screenshot below you can see that APM has found a trace that is related to this log line <strong>(1)</strong>:</p><p><a href=#R-image-c290415c5e66b27c6b0ca8b5da2b9f04 class=lightbox-link><img alt=RC class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/log-apm-rc.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c290415c5e66b27c6b0ca8b5da2b9f04><img alt=RC class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/log-apm-rc.png></a></p><p>By clicking <strong>(2)</strong> on <strong>Trace for 960432ac9f16b98be84618778905af50</strong> we will be taken to the waterfall in APM for this specific trace, where this log line was generated:</p><p><a href=#R-image-56e7e7a0691c0dd79e6f51a0da232c2a class=lightbox-link><img alt="waterfall logs" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/waterfall-with-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-56e7e7a0691c0dd79e6f51a0da232c2a><img alt="waterfall logs" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/waterfall-with-logs.png></a></p><p>Note that you now have a <strong>Related Content</strong> pane for Logs appear <strong>(1)</strong>. Clicking on this will take you back to Log Observer and will display all the log lines that are part of this trace.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=real-user-monitoring>Real User Monitoring</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>To enable Real User Monitoring (RUM) instrumentation for an application, you need to add the Open Telemetry Javascript <a href=https://github.com/signalfx/splunk-otel-js-web rel=external target=_blank><strong>https://github.com/signalfx/splunk-otel-js-web</strong></a> snippet to the code base.</p><p>The Spring PetClinic application uses a single <a href=https://github.com/spring-petclinic/spring-petclinic-microservices/blob/main/spring-petclinic-api-gateway/src/main/resources/static/index.html rel=external target=_blank><strong>index</strong></a> HTML page, that is reused across all views of the application. This is the perfect location to insert the Splunk RUM instrumentation library as it will be loaded for all pages automatically.</p><p>The <code>api-gateway</code> service is already running the instrumentation and sending RUM traces to Splunk Observability Cloud and we will review the data in the next section.</p><p>If you want you can verify the snippet, you can view the page source in your browser by right-clicking on the page and selecting <strong>View Page Source</strong>.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/env.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>  
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>realm</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_REALM</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Realm:&#39;</span><span class=p>,</span> <span class=nx>realm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>auth</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_AUTH</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>appName</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_APP_NAME</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>environmentName</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_ENVIRONMENT</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>realm</span> <span class=o>&amp;&amp;</span> <span class=nx>auth</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>realm</span><span class=o>:</span> <span class=nx>realm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=nx>auth</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>applicationName</span><span class=o>:</span> <span class=nx>appName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>deploymentEnvironment</span><span class=o>:</span> <span class=nx>environmentName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>version</span><span class=o>:</span> <span class=s1>&#39;1.0.0&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>            <span class=nx>SplunkSessionRecorder</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>app</span><span class=o>:</span> <span class=nx>appName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>realm</span><span class=o>:</span> <span class=nx>realm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=nx>auth</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>Provider</span> <span class=o>=</span> <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>provider</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>tracer</span><span class=o>=</span><span class=nx>Provider</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=s1>&#39;appModuleLoader&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Realm or auth is empty, provide default values or skip initialization
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Realm or auth is empty. Skipping Splunk Rum initialization.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>     <span class=c>&lt;!-- Section added for  RUM --&gt;</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 27, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 8. Real User Monitoring</h1><article class=default><header class=headline></header><h1 id=select-the-rum-view-for-the-petclinic-app>Select the RUM view for the Petclinic App</h1><p>Lets start a quick high level tour into RUM by clicking <strong>RUM</strong> in the left-hand menu. Then change the <strong>Environment</strong> filter <strong>(1)</strong> to the name of your workshop instance from the dropdown box, it will be <strong><code>&lt;INSTANCE>-workshop</code></strong> <strong>(1)</strong> (where <strong><code>INSTANCE</code></strong> is the value from the shell script you ran earlier). Make sure it is the only one selected.</p><p>Then change the <strong>App</strong> <strong>(2)</strong> dropdown box to the name of your app, it will be <strong><code>&lt;INSTANCE>-store</code></strong></p><p><a href=#R-image-df8286a67580bd1fe6527106382095d8 class=lightbox-link><img alt="rum select" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/rum-env-select.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-df8286a67580bd1fe6527106382095d8><img alt="rum select" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/rum-env-select.png></a></p><p>Once you have selected your <strong>Environment</strong> and <strong>App</strong>, you will see an overview page showing the RUM status of your App (if your Summary Dashboard is just a single row of numbers, you are looking at the condensed view. You can expand it by clicking on the <strong>> (1)</strong> in front of the Application name). If any JavaScript error occurred they will show up as shown below:</p><p><a href=#R-image-c335cb55290b872022ff7b4011d7f461 class=lightbox-link><img alt="rum overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/rum-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c335cb55290b872022ff7b4011d7f461><img alt="rum overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/rum-overview.png></a></p><p>To continue, click on the blue link (with your workshop name) to get to the details page, this will bring up a new dashboard view breaking down the interactions by UX Metrics, Front-end Health, Back-end Health and Custom Events and comparing them to historic metrics (1 hour by default).</p><p><a href=#R-image-1282d362e5b8c294dfbae21d23bdf46a class=lightbox-link><img alt="rum  main" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/rum-main.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1282d362e5b8c294dfbae21d23bdf46a><img alt="rum  main" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/rum-main.png></a>
Normally you have only one line inside the first chart, Click on the link that relates to your Petclinic shop,
http://198.19.249.202:81 in our example:</p><p>This will bring us to the Tag Spotlight page.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 11, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=rum-trace-waterfall-view--linking-to-apm>RUM trace Waterfall view & linking to APM</h1><p>In the TAG Spotlight view, you are presented with all the tags associated with the RUM data. Tags are key-value pairs that are used to identify the data. In this case, the tags are automatically generated by the OpenTelemetry instrumentation. The tags are used to filter the data and to create the charts and tables. The Tag Spotlight view allows you detect trends in behavior and to drill down into a user session.</p><p><a href=#R-image-8dfa6b587e450a1258aedd629d2a0f2b class=lightbox-link><img alt="RUM TAG" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/rum-tag-spotlight.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8dfa6b587e450a1258aedd629d2a0f2b><img alt="RUM TAG" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/rum-tag-spotlight.png></a></p><p>Click on User Sessions <strong>(1)</strong>, this will show you the list of user session that occurred during the time window.
We want to look at one of the session , so click on <em>Duration</em> <strong>(2)</strong> to sort on duration, and make sure you click on the link of one of the longer ones <strong>(3)</strong>:</p><p><a href=#R-image-0e403be24b5a983a9cef60d90206a6bb class=lightbox-link><img alt="User sessions" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/rum-user-sessions.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0e403be24b5a983a9cef60d90206a6bb><img alt="User sessions" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/rum-user-sessions.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 27, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=rum-trace-waterfall-view--linking-to-apm>RUM trace Waterfall view & linking to APM</h1><p>We are now looking at the RUM Trace waterfall, this will tell you what happened during the session on the user device as they visited the page of our petclinic application.</p><p>If you scroll down the waterfall find click on the <strong>#!/owners/details</strong> segment on the right <strong>(1)</strong>, you see a list of action that occurred during the handling of the Vets request. Note, that the HTTP request have a blue <strong>APM</strong> link before the return code. Pick one, and click on the APM link. This will show you the APM info for this Ser vice call to our Microservices in Kubernetes.</p><p><a href=#R-image-57934067cba2f23040e747a1f112e950 class=lightbox-link><img alt="rum apm link" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/rum-trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-57934067cba2f23040e747a1f112e950><img alt="rum apm link" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/rum-trace.png></a></p><p>Note , that there give you the information what happened during action in the Microservices, and if you want to drill down to verify what happened with the request, click on the Trace ID url.</p><p>This will show you the trace related to your request from RUM:</p><p><a href=#R-image-7e881dac46cf5103843d58a2fec8b28a class=lightbox-link><img alt="RUm-apm linked" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/rum-apm-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7e881dac46cf5103843d58a2fec8b28a><img alt="RUm-apm linked" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/rum-apm-waterfall.png></a></p><p>You can see that the entry point into your service now has a <strong>RUM (1)</strong> related content link added, allowing you to return back to your RUM session after you validated what happened in your Microservices.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=workshop-wrap-up->Workshop Wrap-up 🎁</h1><p>Congratulations, you have completed the <strong>Get the Most Out of Your Existing Kubernetes Java Applications Using Automatic Discovery and Configuration With OpenTelemetry</strong> workshop.</p><p>Today, you have learnt how easy it is to add Tracing, Code Profiling and Database Query Performance to your existing Java application in Kubernetes.</p><p>You immediately improved the observability of the application and infrastructure with out touching a line of code or configuration using <strong>Automatic Discovery and Configuration</strong>.</p><p>You also learnt that with simple configuration changes you can add even more observability (<strong>logging</strong> and <strong>RUM</strong>) to the application in order to provide end-to-end observability.</p><p><a href=#R-image-4e60a5d089187a3f8ff04dc8f0436518 class=lightbox-link><img alt=Champagne class="noborder lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.76/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/9-wrap-up/images/champagne.png?width=45vw" style=height:auto;width:45vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4e60a5d089187a3f8ff04dc8f0436518><img alt=Champagne class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.76/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/9-wrap-up/images/champagne.png?width=45vw"></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=monitoring-horizontal-pod-autoscaling-in-kubernetes>Monitoring Horizontal Pod Autoscaling in Kubernetes</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>45 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Robert Castley</span></span><p>This workshop will equip you with a basic understanding of monitoring Kubernetes using the Splunk OpenTelemetry Collector. During the workshop, you will deploy PHP/Apache and a load generator.</p><p>You will learn about OpenTelemetry Receivers, Kubernetes Namespaces, ReplicaSets, Kubernetes Horizontal Pod AutoScaling and how to monitor all this using the Splunk Observability Cloud. The main learnings from the workshop will be a better understanding of the Kubernetes Navigator (and Dashboards) in Splunk Observability Cloud as well as seeing Kubernetes metrics, events and Detectors.</p><p>For this workshop, Splunk has prepared an Ubuntu Linux instance in AWS/EC2 all pre-configured for you.</p><p>To get access to the instance that you will be using in the workshop, please visit the URL provided by the workshop leader.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Horizontal Pod Autoscaling</h1><article class=default><header class=headline></header><h1 id=deploying-the-opentelemetry-collector-in-kubernetes>Deploying the OpenTelemetry Collector in Kubernetes</h1><h2 id=1-connect-to-ec2-instance>1. Connect to EC2 instance</h2><p>You will be able to connect to the workshop instance by using SSH from your Mac, Linux or Windows device. Open the link to the sheet provided by your instructor. This sheet contains the IP addresses and the password for the workshop instances.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>Your workshop instance has been pre-configured with the correct <strong>Access Token</strong> and <strong>Realm</strong> for this workshop. There is no need for you to configure these.</p></div></details><h2 id=2-install-splunk-otel-using-helm>2. Install Splunk OTel using Helm</h2><p>Install the OpenTelemetry Collector using the Splunk Helm chart. First, add the Splunk Helm chart repository and update:</p><div class=tab-panel data-tab-group=f6744af79a1c4839c1358d88da5506a9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-repo-add class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("f6744af79a1c4839c1358d88da5506a9","helm-repo-add")'>
<span class=tab-nav-text>helm repo add</span>
</button>
<button data-tab-item=helm-repo-add-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("f6744af79a1c4839c1358d88da5506a9","helm-repo-add-output")'>
<span class=tab-nav-text>helm repo add output</span></button></div><div class=tab-content-container><div data-tab-item=helm-repo-add class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span class=o>&amp;&amp;</span> helm repo update</span></span></code></pre></div></div></div><div data-tab-item=helm-repo-add-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Using ACCESS_TOKEN=&lt;REDACTED&gt;
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>&#34;splunk-otel-collector-chart&#34; has been added to your repositories
</span></span><span class=line><span class=cl>Using ACCESS_TOKEN=&lt;REDACTED&gt;
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>Hang tight while we grab the latest from your chart repositories...
</span></span><span class=line><span class=cl>...Successfully got an update from the &#34;splunk-otel-collector-chart&#34; chart repository
</span></span><span class=line><span class=cl>Update Complete. ⎈Happy Helming!⎈</span></span></code></pre></div></div></div></div></div><p>Install the OpenTelemetry Collector Helm with the following commands, do <strong>NOT</strong> edit this:</p><div class=tab-panel data-tab-group=ed6fade2dc74569f16e6a553672175d0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-install class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ed6fade2dc74569f16e6a553672175d0","helm-install")'>
<span class=tab-nav-text>helm install</span></button></div><div class=tab-content-container><div data-tab-item=helm-install class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector --version 0.111.0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;logsEngine=otel&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml</span></span></code></pre></div></div></div></div></div><h2 id=3-verify-deployment>3. Verify Deployment</h2><p>You can monitor the progress of the deployment by running <code>kubectl get pods</code> which should typically report that the new pods are up and running after about 30 seconds.</p><p>Ensure the status is reported as <strong>Running</strong> before continuing.</p><div class=tab-panel data-tab-group=2f3c45ee05eb48f82a878c2f8f75f01c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2f3c45ee05eb48f82a878c2f8f75f01c","kubectl-get-pods")'>
<span class=tab-nav-text>kubectl get pods</span>
</button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2f3c45ee05eb48f82a878c2f8f75f01c","kubectl-get-pods-output")'>
<span class=tab-nav-text>kubectl get pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                          READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-pvstb                             2/2     Running   0          19s
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-6c454894f8-mqs8n   1/1     Running   0          19s</span></span></code></pre></div></div></div></div></div><p>Use the label set by the <code>helm</code> install to tail logs (You will need to press <code>ctrl + c</code> to exit).</p><div class=tab-panel data-tab-group=372f5cdc5363e5b39fbda7de604de793><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-logs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("372f5cdc5363e5b39fbda7de604de793","kubectl-logs")'>
<span class=tab-nav-text>kubectl logs</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector -f --container otel-collector</span></span></code></pre></div></div></div></div></div><p>Or use the installed <code>k9s</code> terminal UI.</p><p><a href=#R-image-af0db742a62b7aef82e812267260f51c class=lightbox-link><img alt=k9s class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/k9s.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af0db742a62b7aef82e812267260f51c><img alt=k9s class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/k9s.png></a></p><details open class="box cstyle notices warning"><summary class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i>
Deleting a failed installation</summary><div class=box-content><p>If you make an error installing the Splunk OpenTelemetry Collector you can start over by deleting the installation using:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 13, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=tour-of-the-kubernetes-navigator>Tour of the Kubernetes Navigator</h1><h2 id=1-cluster-vs-workload-view>1. Cluster vs Workload View</h2><p>The Kubernetes Navigator offers you two separate use cases to view your Kubernetes data.</p><ul><li>The <strong>K8s workloads</strong> are focusing on providing information in regards to workloads a.k.a. <em>your deployments</em>.</li><li>The <strong>K8s nodes</strong> are focusing on providing insight into the performance of clusters, nodes, pods and containers.</li></ul><p>You will initially select either view depending on your need (you can switch between the view on the fly if required). The most common one we will use in this workshop is the workload view and we will focus on that specifically.</p><h3 id=11-finding-your-k8s-cluster-name>1.1 Finding your K8s Cluster Name</h3><p>Your first task is to identify and find your cluster. The cluster will be named as determined by the preconfigured environment variable <code>INSTANCE</code>. To confirm the cluster name enter the following command in your terminal:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$INSTANCE</span>-k3s-cluster</span></span></code></pre></div><p>Please make a note of your cluster name as you will need this later in the workshop for filtering.</p><h2 id=2-workloads--workload-details-pane>2. Workloads & Workload Details Pane</h2><p>Go to the <strong>Infrastructure</strong> page in the Observability UI and select <strong>Kubernetes</strong>, this will offer you a set of Kubernetes services, one of them being the <strong>Kubernetes workloads</strong> pane. The pane will show a tiny graph giving you a bird&rsquo;s eye view of the load being handled across all workloads. Click on the <strong>Kubernetes workloads</strong> pane and you will be taken to the workload view.</p><p>Initially, you will see all the workloads for all clusters that are reported into your Observability Cloud Org. If an alert has fired for any of the workloads, it will be highlighted on the top right in the image below.</p><p><a href=#R-image-c24f2fd6f74f2256afe1daf4c80c594b class=lightbox-link><img alt=workloads class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/k8s-workloads-screen.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c24f2fd6f74f2256afe1daf4c80c594b><img alt=workloads class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/k8s-workloads-screen.png></a></p><p>Now, let&rsquo;s find your cluster by filtering on <strong>Cluster</strong> in the filter toolbar.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>You can enter a partial name into the search box, such as <code>emea-ws-7*</code>, to quickly find your Cluster.</p><p>Also, it&rsquo;s a very good idea to switch the default time from the default <strong>-4h</strong> back to the last 15 minutes (<strong>-15m</strong>).</p></div></details><p><a href=#R-image-773e753971e4ae387b0e170099dba2d3 class=lightbox-link><img alt=workloads-filter class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/k8s-workloads-filter.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-773e753971e4ae387b0e170099dba2d3><img alt=workloads-filter class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/k8s-workloads-filter.png></a></p><p>You will now just see data just for your own cluster.</p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>How many workloads are running & how many namespaces are in your Cluster?</p></div></details><h3 id=21-using-the-navigator-selection-chart>2.1 Using the Navigator Selection Chart</h3><p>By default, the <strong>Kubernetes Workloads</strong> table filters by <code># Pods Failed</code> grouped by <code>k8s.namespace.name</code>. Go ahead and expand the <code>default</code> namespace to see the workloads in the namespace.</p><p><a href=#R-image-2140dfe78b14c782ddb9d57ab838b8ae class=lightbox-link><img alt=k8s-workload-selection class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/workload-selection.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2140dfe78b14c782ddb9d57ab838b8ae><img alt=k8s-workload-selection class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/workload-selection.png></a></p><p>Now, let&rsquo;s change the list view to a heatmap view by selecting <strong>Map</strong> icon (next to the <strong>Table</strong> icon). Changing this option will result in the following visualization (or similar):</p><p><a href=#R-image-7ba1de3db0b0a9e1e69c9cf9f3be4c50 class=lightbox-link><img alt=k8s-Heat-map class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/workloads-heatmap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7ba1de3db0b0a9e1e69c9cf9f3be4c50><img alt=k8s-Heat-map class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/workloads-heatmap.png></a></p><p>In this view, you will note that each workload is now a colored square. These squares will change color according to the <strong>Color by</strong> option you select. The colors give a visual indication of health and/or usage. You can check the meaning by hovering over the <strong>legend</strong> exclamation icon <i class="fa-fw fas fa-exclamation-circle"></i> bottom right of the heatmaps.</p><p>Another valuable option in this screen is <strong>Find outliers</strong> which provides historical analytics of your clusters based on what is selected in the <strong>Color by</strong> dropdown.</p><p>Now, let&rsquo;s select the <strong>Network transferred (bytes)</strong> from the <strong>Color by</strong> drop-down box, then click on the <strong>Find outliers</strong> and change the <strong>Scope</strong> in the dialog to <strong>Per k8s.namespace.name</strong> and <strong>Deviation from Median</strong> as below:</p><p><a href=#R-image-ec8f79ddddfb06a5128d1c53e79539d5 class=lightbox-link><img alt=k8s-Heat-map class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/set-find-outliers.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ec8f79ddddfb06a5128d1c53e79539d5><img alt=k8s-Heat-map class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/set-find-outliers.png></a></p><p>The <strong>Find Outliers</strong> view is very useful when you need to view a selection of your workloads (or any service depending on the Navigator used) and quickly need to figure out if something has changed.</p><p>It will give you fast insight into items (workloads in our case) that are performing differently (both increased or decreased) which helps to make it easier to spot problems.</p><h3 id=22-the-deployment-overview-pane>2.2 The Deployment Overview pane</h3><p>The Deployment Overview pane gives you a quick insight into the status of your deployments. You can see at once if the pods of your deployments are Pending, Running, Succeeded, Failed or in an Unknown state.</p><p><a href=#R-image-a03bab1ad230042888ed426f9f88fdb0 class=lightbox-link><img alt=k8s-workload-overview class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/k8s-deployment-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a03bab1ad230042888ed426f9f88fdb0><img alt=k8s-workload-overview class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/k8s-deployment-overview.png></a></p><ul><li><em>Running:</em> Pod is deployed and in a running state</li><li><em>Pending:</em> Waiting to be deployed</li><li><em>Succeeded:</em> Pod has been deployed and completed its job and is finished</li><li><em>Failed:</em> Containers in the pod have run and returned some kind of error</li><li><em>Unknown:</em> Kubernetes isn&rsquo;t reporting any of the known states. (This may be during the starting or stopping of pods, for example).</li></ul><p>You can expand the Workload name by hovering your mouse on it, in case the name is longer than the chart allows.</p><p>To filter to a specific workload, you can click on three dots <strong>&mldr;</strong> next to the workload name in the <strong>k8s.workload.name</strong> column and choose <strong>Filter</strong> from the dropdown box:</p><p><a href=#R-image-6e7374dc9166c1bf2ae079960f274cc9 class=lightbox-link><img alt=workload-add-filter class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/workload-add-filter.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6e7374dc9166c1bf2ae079960f274cc9><img alt=workload-add-filter class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/workload-add-filter.png></a></p><p>This will add the selected workload to your filters. It would then list a single workload in the <strong>default</strong> namespace:</p><p><a href=#R-image-5cc30374af8d4769262e90ae7fa3a03f class=lightbox-link><img alt=workload-add-filter class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/heatmap-filter-down.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5cc30374af8d4769262e90ae7fa3a03f><img alt=workload-add-filter class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/heatmap-filter-down.png></a></p><p>From the Heatmap above find the <strong>splunk-otel-collector-k8s-cluster-receiver</strong> in the <strong>default</strong> namespace and click on the square to see more information about the workload:</p><p><a href=#R-image-80c55476baff8ef2cd9adb748f34798a class=lightbox-link><img alt=workload-add-filter class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/k8s-workload-detail.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-80c55476baff8ef2cd9adb748f34798a><img alt=workload-add-filter class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/k8s-workload-detail.png></a></p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What are the CPU request & CPU limit units for the otel-collector?</p></div></details><p>At this point, you can drill into the information of the pods, but that is outside the scope of this workshop.</p><h2 id=3-navigator-sidebar>3. Navigator Sidebar</h2><p>Later in the workshop, you will deploy an Apache server into your cluster which will display an icon in the <strong>Navigator Sidebar</strong>.</p><p>In navigators for Kubernetes, you can track dependent services and containers in the navigator sidebar. To get the most out of the navigator sidebar you configure the services you want to track by configuring an extra dimension called <code>service.name</code>. For this workshop, we have already configured the <code>extraDimensions</code> in the collector configuration for monitoring Apache e.g.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extraDimensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>service.name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><p>The Navigator Sidebar will expand and a link to the discovered service will be added as seen in the image below:</p><p><a href=#R-image-ed44e2af32527e85a5ba4316f6792326 class=lightbox-link><img alt=Pivotbar class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/pivotbar.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ed44e2af32527e85a5ba4316f6792326><img alt=Pivotbar class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/pivotbar.png></a></p><p>This will allow for easy switching between Navigators. The same applies to your Apache server instance, it will have a Navigator Sidebar allowing you to quickly jump back to the Kubernetes Navigator.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploying-phpapache>Deploying PHP/Apache</h1><h2 id=1-namespaces-in-kubernetes>1. Namespaces in Kubernetes</h2><p>Most of our customers will make use of some kind of private or public cloud service to run Kubernetes. They often choose to have only a few large Kubernetes clusters as it is easier to manage centrally.</p><p>Namespaces are a way to organize these large Kubernetes clusters into virtual sub-clusters. This can be helpful when different teams or projects share a Kubernetes cluster as this will give them the easy ability to just see and work with their resources.</p><p>Any number of namespaces are supported within a cluster, each logically separated from others but with the ability to communicate with each other. Components are only <strong>visible</strong> when selecting a namespace or when adding the <code>--all-namespaces</code> flag to <code>kubectl</code> instead of allowing you to view just the components relevant to your project by selecting your namespace.</p><p>Most customers will want to install the applications into a separate namespace. This workshop will follow that best practice.</p><h2 id=2--dns-and-services-in-kubernetes>2. DNS and Services in Kubernetes</h2><p>The Domain Name System (DNS) is a mechanism for linking various sorts of information with easy-to-remember names, such as IP addresses. Using a DNS system to translate request names into IP addresses makes it easy for end-users to reach their target domain name effortlessly.</p><p>Most Kubernetes clusters include an internal DNS service configured by default to offer a lightweight approach for service discovery. Even when Pods and Services are created, deleted, or shifted between nodes, built-in service discovery simplifies applications to identify and communicate with services on the Kubernetes clusters.</p><p>In short, the DNS system for Kubernetes will create a DNS entry for each Pod and Service. In general, a Pod has the following DNS resolution:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>pod-name.my-namespace.pod.cluster-domain.example</span></span></code></pre></div><p>For example, if a Pod in the <code>default</code> namespace has the Pod name <code>my_pod</code>, and the domain name for your cluster is <code>cluster.local</code>, then the Pod has a DNS name:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>my_pod.default.pod.cluster.local</span></span></code></pre></div><p>Any Pods exposed by a Service have the following DNS resolution available:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>my_pod.service-name.my-namespace.svc.cluster-domain.example</span></span></code></pre></div><p>More information can be found here: <a href=https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/ rel=external target=_blank><strong>DNS for Service and Pods</strong></a></p><h2 id=3-review-otel-receiver-for-phpapache>3. Review OTel receiver for PHP/Apache</h2><p>Inspect the YAML file <code>~/workshop/k3s/otel-apache.yaml</code> and validate the contents using the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/otel-apache.yaml</span></span></code></pre></div><p>This file contains the configuration for the OpenTelemetry agent to monitor the PHP/Apache deployment.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>agent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>smartagent/apache</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;port&#34; &amp;&amp; pod.name matches &#34;apache&#34; &amp;&amp; port == 80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>collectd/apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>http://php-apache-svc.apache.svc.cluster.local/server-status?auto</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>extraDimensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>service.name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><h2 id=4--observation-rules-in-the-opentelemetry-config>4. Observation Rules in the OpenTelemetry config</h2><p>The above file contains an observation rule for Apache using the OTel <code>receiver_creator</code>. This receiver can instantiate other receivers at runtime based on whether observed endpoints match a configured rule.</p><p>The configured rules will be evaluated for each endpoint discovered. If the rule evaluates to true, then the receiver for that rule will be started as configured against the matched endpoint.</p><p>In the file above we tell the OpenTelemetry agent to look for Pods that match the name <code>apache</code> and have port <code>80</code> open. Once found, the agent will configure an Apache receiver to read Apache metrics from the configured URL. Note, the K8s DNS-based URL in the above YAML for the service.</p><p>To use the Apache configuration, you can upgrade the existing Splunk OpenTelemetry Collector Helm chart to use the <code>otel-apache.yaml</code> file with the following command:</p><div class=tab-panel data-tab-group=228ba0bcf3e9717e8c3f957f2172bc6e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-upgrade class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("228ba0bcf3e9717e8c3f957f2172bc6e","helm-upgrade")'>
<span class=tab-nav-text>Helm Upgrade</span></button></div><div class=tab-content-container><div data-tab-item=helm-upgrade class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm upgrade splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;logsEngine=otel&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-apache.yaml</span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
NOTE</summary><div class=box-content><p>The <strong>REVISION</strong> number of the deployment has changed, which is a helpful way to keep track of your changes.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Release &#34;splunk-otel-collector&#34; has been upgraded. Happy Helming!
</span></span><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Mon Nov  4 14:56:25 2024
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: 2
</span></span><span class=line><span class=cl>TEST SUITE: None
</span></span><span class=line><span class=cl>NOTES:
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Platform endpoint &#34;https://http-inputs-workshop.splunkcloud.com:443/services/collector/event&#34;.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Observability realm eu0.</span></span></code></pre></div></div></details><h2 id=5-kubernetes-configmaps>5. Kubernetes ConfigMaps</h2><p>A ConfigMap is an object in Kubernetes consisting of key-value pairs that can be injected into your application. With a ConfigMap, you can separate configuration from your Pods.</p><p>Using ConfigMap, you can prevent hardcoding configuration data. ConfigMaps are useful for storing and sharing non-sensitive, unencrypted configuration information.</p><p>The OpenTelemetry collector/agent uses ConfigMaps to store the configuration of the agent and the K8s Cluster receiver. You can/will always verify the current configuration of an agent after a change by running the following commands:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get cm</span></span></code></pre></div><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>How many ConfigMaps are used by the collector?</p></div></details><p>When you have a list of ConfigMaps from the namespace, select the one for the <code>otel-agent</code> and view it with the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get cm splunk-otel-collector-otel-agent -o yaml</span></span></code></pre></div><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
NOTE</summary><div class=box-content><p>The option <code>-o yaml</code> will output the content of the ConfigMap in a readable YAML format.</p></div></details><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Is the configuration from <code>otel-apache.yaml</code> visible in the ConfigMap for the collector agent?</p></div></details><h2 id=6-review-phpapache-deployment-yaml>6. Review PHP/Apache deployment YAML</h2><p>Inspect the YAML file <code>~/workshop/k3s/php-apache.yaml</code> and validate the contents using the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/php-apache.yaml</span></span></code></pre></div><p>This file contains the configuration for the PHP/Apache deployment and will create a new StatefulSet with a single replica of the PHP/Apache image.</p><p>A stateless application does not care which network it is using, and it does not need permanent storage. Examples of stateless apps may include web servers such as Apache, Nginx, or Tomcat.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>StatefulSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>updateStrategy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>RollingUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;php-apache-svc&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>ghcr.io/splunk/php-apache:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;6&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache-svc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><h2 id=7-deploy-phpapache>7. Deploy PHP/Apache</h2><p>Create an <code>apache</code> namespace then deploy the PHP/Apache application to the cluster.</p><p>Create the <code>apache</code> namespace:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create namespace apache</span></span></code></pre></div><p>Deploy the PHP/Apache application:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/php-apache.yaml -n apache</span></span></code></pre></div><p>Ensure the deployment has been created:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get statefulset -n apache</span></span></code></pre></div><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What metrics for your Apache instance are being reported in the Apache Navigator?</p><p><strong>Tip:</strong> Use the Navigator Sidebar and click on the service name.</p></div></details><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Using Log Observer what is the issue with the PHP/Apache deployment?</p><p><strong>Tip:</strong> Adjust your filters to use: <code>object = php-apache-svc</code> and <code>k8s.cluster.name = &lt;your_cluster></code>.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=fix-phpapache-issue>Fix PHP/Apache Issue</h1><h2 id=1-kubernetes-resources>1. Kubernetes Resources</h2><p>Especially in Production Kubernetes Clusters, CPU and Memory are considered precious resources. Cluster Operators will normally require you to specify the amount of CPU and Memory your Pod or Service will require in the deployment, so they can have the Cluster automatically manage on which Node(s) your solution will be placed.</p><p>You do this by placing a Resource section in the deployment of your application/Pod</p><p><strong>Example:</strong></p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>limits</span><span class=p>:</span><span class=w>         </span><span class=c># Maximum amount of CPU &amp; memory for peek use</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8&#34;</span><span class=w>      </span><span class=c># Maximum of 8 cores of CPU allowed at for peek use</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8Mi&#34;</span><span class=w> </span><span class=c># Maximum allowed 8Mb of memory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>requests</span><span class=p>:</span><span class=w>       </span><span class=c># Request are the expected amount of CPU &amp; memory for normal use</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;6&#34;</span><span class=w>      </span><span class=c># Requesting 4 cores of a CPU</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4Mi&#34;</span><span class=w> </span><span class=c># Requesting 4Mb of memory</span></span></span></code></pre></div><p>More information can be found here: <a href=https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/ rel=external target=_blank><strong>Resource Management for Pods and Containers</strong></a></p><p>If your application or Pod will go over the limits set in your deployment, Kubernetes will kill and restart your Pod to protect the other applications on the Cluster.</p><p>Another scenario that you will run into is when there is not enough Memory or CPU on a Node. In that case, the Cluster will try to reschedule your Pod(s) on a different Node with more space.</p><p>If that fails, or if there is not enough space when you deploy your application, the Cluster will put your workload/deployment in schedule mode until there is enough room on any of the available Nodes to deploy the Pods according to their limits.</p><h2 id=2-fix-phpapache-deployment>2. Fix PHP/Apache Deployment</h2><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Before we start, let&rsquo;s check the current status of the PHP/Apache deployment. Under <strong>Alerts & Detectors</strong> which detector has fired? Where else can you find this information?</p></div></details><p>To fix the PHP/Apache StatefulSet, edit <code>~/workshop/k3s/php-apache.yaml</code> using the following commands to reduce the CPU resources:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim ~/workshop/k3s/php-apache.yaml</span></span></code></pre></div><p>Find the resources section and reduce the CPU limits to <strong>1</strong> and the CPU requests to <strong>0.5</strong>:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.5&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4Mi&#34;</span></span></span></code></pre></div><p>Save the changes you have made. (Hint: Use <code>Esc</code> followed by <code>:wq!</code> to save your changes).</p><p>Now, we must delete the existing StatefulSet and re-create it. StatefulSets are immutable, so we must delete the existing one and re-create it with the new changes.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete statefulset php-apache -n apache</span></span></code></pre></div><p>Now, deploy your changes:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/php-apache.yaml -n apache</span></span></code></pre></div><h2 id=3-validate-the-changes>3. Validate the changes</h2><p>You can validate the changes have been applied by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe statefulset php-apache -n apache</span></span></code></pre></div><p>Validate the Pod is now running in Splunk Observability Cloud.</p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Is the <strong>Apache Web Servers</strong> dashboard showing any data now?</p><p><strong>Tip:</strong> Don&rsquo;t forget to use filters and time frames to narrow down your data.</p></div></details><p>Monitor the Apache web servers Navigator dashboard for a few minutes.</p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What is happening with the # Hosts reporting chart?</p></div></details><h2 id=4-fix-the-memory-issue>4. Fix the memory issue</h2><p>If you navigate back to the Apache dashboard, you will notice that metrics are no longer coming in. We have another resource issue and this time we are Out of Memory. Let&rsquo;s edit the stateful set and increase the memory to what is shown in the image below:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl edit statefulset php-apache -n apache</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>16Mi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=l>500m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>12Mi</span></span></span></code></pre></div><p>Save the changes you have made.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-exclamation"></i>
Hint</summary><div class=box-content><p><code>kubectl edit</code> will open the contents in the <code>vi</code> editor, use <code>Esc</code> followed by <code>:wq!</code> to save your changes.</p></div></details><p>Because StatefulSets are immutable, we must delete the existing Pod and let the StatefulSet re-create it with the new changes.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete pod php-apache-0 -n apache</span></span></code></pre></div><p>Validate the changes have been applied by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe statefulset php-apache -n apache</span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-load-generator>Deploy Load Generator</h1><p>Now let&rsquo;s apply some load against the <code>php-apache</code> pod. To do this, you will need to start a different Pod to act as a client. The container within the client Pod runs in an infinite loop, sending HTTP GETs to the <code>php-apache</code> service.</p><h2 id=1-review-loadgen-yaml>1. Review loadgen YAML</h2><p>Inspect the YAML file <code>~/workshop/k3s/loadgen.yaml</code> and validate the contents using the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/loadgen.yaml</span></span></code></pre></div><p>This file contains the configuration for the load generator and will create a new ReplicaSet with two replicas of the load generator image.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ReplicaSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>infinite-calls</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>/bin/sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- -<span class=l>c</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;while true; do wget -q -O- http://php-apache-svc.apache.svc.cluster.local; done&#34;</span></span></span></code></pre></div><h2 id=2-create-a-new-namespace>2. Create a new namespace</h2><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl create namespace loadgen</span></span></code></pre></div><h2 id=3-deploy-the-loadgen-yaml>3. Deploy the loadgen YAML</h2><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/loadgen.yaml --namespace loadgen</span></span></code></pre></div><p>Once you have deployed the load generator, you can see the Pods running in the <code>loadgen</code> namespace. Use previous similar commands to check the status of the Pods from the command line.</p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Which metrics in the Apache Navigator have now significantly increased?</p></div></details><h2 id=4-scale-the-load-generator>4. Scale the load generator</h2><p>A ReplicaSet is a process that runs multiple instances of a Pod and keeps the specified number of Pods constant. Its purpose is to maintain the specified number of Pod instances running in a cluster at any given time to prevent users from losing access to their application when a Pod fails or is inaccessible.</p><p>ReplicaSet helps bring up a new instance of a Pod when the existing one fails, scale it up when the running instances are not up to the specified number, and scale down or delete Pods if another instance with the same label is created. A ReplicaSet ensures that a specified number of Pod replicas are running continuously and helps with load-balancing in case of an increase in resource usage.</p><p>Let&rsquo;s scale our ReplicaSet to 4 replicas using the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl scale replicaset/loadgen --replicas 4 -n loadgen</span></span></code></pre></div><p>Validate the replicas are running from both the command line and Splunk Observability Cloud:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl get replicaset loadgen -n loadgen</span></span></code></pre></div><p><a href=#R-image-1efc3ef5b2a92324f8150588b5110204 class=lightbox-link><img alt=ReplicaSet class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/k8s-workload-replicaset.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1efc3ef5b2a92324f8150588b5110204><img alt=ReplicaSet class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/k8s-workload-replicaset.png></a></p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What impact can you see in the Apache Navigator?</p></div></details><p>Let the load generator run for around 2-3 minutes and keep observing the metrics in the Kubernetes Navigator and the Apache Navigator.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=setup-horizontal-pod-autoscaling-hpa>Setup Horizontal Pod Autoscaling (HPA)</h1><p>In Kubernetes, a HorizontalPodAutoscaler automatically updates a workload resource (such as a Deployment or StatefulSet), to automatically scale the workload to match demand.</p><p>Horizontal scaling means that the response to increased load is to deploy more Pods. This is different from vertical scaling, which for Kubernetes would mean assigning more resources (for example: memory or CPU) to the Pods that are already running for the workload.</p><p>If the load decreases, and the number of Pods is above the configured minimum, the HorizontalPodAutoscaler instructs the workload resource (the Deployment, StatefulSet, or other similar resource) to scale back down.</p><h2 id=1-setup-hpa>1. Setup HPA</h2><p>Inspect the <code>~/workshop/k3s/hpa.yaml</code> file and validate the contents using the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/hpa.yaml</span></span></code></pre></div><p>This file contains the configuration for the Horizontal Pod Autoscaler and will create a new HPA for the <code>php-apache</code> deployment.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>autoscaling/v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>HorizontalPodAutoscaler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>maxReplicas</span><span class=p>:</span><span class=w> </span><span class=m>4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cpu</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>target</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class=m>50</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Utilization</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>memory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>target</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class=m>75</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Utilization</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>minReplicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>scaleTargetRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>StatefulSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><p>Once deployed, <code>php-apache</code> will autoscale when either the average CPU usage goes above 50% or the average memory usage for the deployment goes above 75%, with a minimum of 1 pod and a maximum of 4 pods.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/hpa.yaml</span></span></code></pre></div><h2 id=2-validate-hpa>2. Validate HPA</h2><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl get hpa -n apache</span></span></code></pre></div><p>Go to the <strong>Workloads</strong> or <strong>Node Detail</strong> tab in Kubernetes and check the HPA deployment.</p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>How many additional <code>php-apache-x</code> pods have been created?</p></div></details><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Which metrics in the Apache Navigator have significantly increased again?</p></div></details><h2 id=3-increase-the-hpa-replica-count>3. Increase the HPA replica count</h2><p>Increase the <code>maxReplicas</code> to 8</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl edit hpa php-apache -n apache</span></span></code></pre></div><p>Save the changes you have made. (Hint: Use <code>Esc</code> followed by <code>:wq!</code> to save your changes).</p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Questions</summary><div class=box-content><ol><li><p>How many pods are now running?</p></li><li><p>How many are pending?</p></li><li><p>Why are they pending?</p></li></ol></div></details><p><strong>Congratulations!</strong> You have completed the workshop.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=making-your-observability-cloud-native-with-opentelemetry>Making Your Observability Cloud Native With OpenTelemetry</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>1 hour</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Robert Castley</span></span><h2 id=abstract>Abstract</h2><p>Organizations getting started with OpenTelemetry may begin by sending data directly to an observability backend. While this works well for initial testing, using the OpenTelemetry collector as part of your observability architecture provides numerous benefits and is recommended for any production deployment.</p><p>In this workshop, we will be focusing on using the OpenTelemetry collector and starting with the fundamentals of configuring the receivers, processors, and exporters ready to use with Splunk Observability Cloud. The journey will take attendees from novices to being able to start adding custom components to help solve for their business observability needs for their distributed platform.</p><h3 id=ninja-sections>Ninja Sections</h3><p>Throughout the workshop there will be expandable <span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong> Sections</span></span>, these will be more hands on and go into further technical detail that you can explore within the workshop or in your own time.</p><p>Please note that the content in these sections may go out of date due to the frequent development being made to the OpenTelemetry project. Links will be provided in the event details are out of sync, please let us know if you spot something that needs updating.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Test Me!</span></span></summary><div class=box-content><p><strong>By completing this workshop you will officially be an OpenTelemetry Collector Ninja!</strong></p></div></details><hr><h2 id=target-audience>Target Audience</h2><p>This interactive workshop is for developers and system administrators who are interested in learning more about architecture and deployment of the OpenTelemetry Collector.</p><h2 id=prerequisites>Prerequisites</h2><ul><li>Attendees should have a basic understanding of data collection</li><li>Command line and vim/vi experience.</li><li>A instance/host/VM running Ubuntu 20.04 LTS or 22.04 LTS.<ul><li>Minimum requirements are an AWS/EC2 t2.micro (1 CPU, 1GB RAM, 8GB Storage)</li></ul></li></ul><h2 id=learning-objectives>Learning Objectives</h2><p>By the end of this talk, attendees will be able to:</p><ul><li>Understand the components of OpenTelemetry</li><li>Use receivers, processors, and exporters to collect and analyze data</li><li>Identify the benefits of using OpenTelemetry</li><li>Build a custom component to solve their business needs</li></ul><h2 id=opentelemetry-architecture>OpenTelemetry Architecture</h2><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of OpenTelemetry Collector</h1><article class=default><header class=headline></header><h1 id=installing-opentelemetry-collector-contrib>Installing OpenTelemetry Collector Contrib</h1><h2 id=download-the-opentelemetry-collector-contrib-distribution>Download the OpenTelemetry Collector Contrib distribution</h2><p>The first step in installing the Open Telemetry Collector is downloading it. For our lab, we will use the <code>wget</code> command to download the <code>.deb</code> package from the OpenTelemetry Github repository.</p><p>Obtain the <code>.deb</code> package for your platform from the <a href=https://github.com/open-telemetry/opentelemetry-collector-releases/releases rel=external target=_blank><strong>OpenTelemetry Collector Contrib releases page</strong></a></p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v0.111.0/otelcol-contrib_0.111.0_linux_amd64.deb</span></span></code></pre></div><h2 id=install-the-opentelemetry-collector-contrib-distribution>Install the OpenTelemetry Collector Contrib distribution</h2><p>Install the <code>.deb</code> package using <code>dpkg</code>. Take a look at the <strong>dpkg Output</strong> tab below to see what the example output of a successful install will look like:</p><div class=tab-panel data-tab-group=9effe174b95098cf6519f4b9bc734428><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=install class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("9effe174b95098cf6519f4b9bc734428","install")'>
<span class=tab-nav-text>Install</span>
</button>
<button data-tab-item=dpkg-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("9effe174b95098cf6519f4b9bc734428","dpkg-output")'>
<span class=tab-nav-text>dpkg Output</span></button></div><div class=tab-content-container><div data-tab-item=install class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo dpkg -i otelcol-contrib_0.111.0_linux_amd64.deb</span></span></code></pre></div></div></div><div data-tab-item=dpkg-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Selecting previously unselected package otelcol-contrib.
</span></span><span class=line><span class=cl>(Reading database ... 89232 files and directories currently installed.)
</span></span><span class=line><span class=cl>Preparing to unpack otelcol-contrib_0.111.0_linux_amd64.deb ...
</span></span><span class=line><span class=cl>Unpacking otelcol-contrib (0.111.0) ...
</span></span><span class=line><span class=cl>Setting up otelcol-contrib (0.111.0) ...
</span></span><span class=line><span class=cl>Created symlink /etc/systemd/system/multi-user.target.wants/otelcol-contrib.service → /lib/systemd/system/otelcol-contrib.service.</span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Installation</h1><article class=default><header class=headline></header><h1 id=installing-opentelemetry-collector-contrib>Installing OpenTelemetry Collector Contrib</h1><h2 id=confirm-the-collector-is-running>Confirm the Collector is running</h2><p>The collector should now be running. We will verify this as root using <code>systemctl</code> command. To exit the status just press <code>q</code>.</p><div class=tab-panel data-tab-group=4c38def8cfbb3b57fbd642cfd6f86cd2><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("4c38def8cfbb3b57fbd642cfd6f86cd2","command")'>
<span class=tab-nav-text>Command</span>
</button>
<button data-tab-item=status-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("4c38def8cfbb3b57fbd642cfd6f86cd2","status-output")'>
<span class=tab-nav-text>Status Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl status otelcol-contrib</span></span></code></pre></div></div></div><div data-tab-item=status-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>● otelcol-contrib.service - OpenTelemetry Collector Contrib
</span></span><span class=line><span class=cl>     Loaded: loaded (/lib/systemd/system/otelcol-contrib.service; enabled; vendor preset: enabled)
</span></span><span class=line><span class=cl>     Active: active (running) since Mon 2024-10-07 10:27:49 BST; 52s ago
</span></span><span class=line><span class=cl>   Main PID: 17113 (otelcol-contrib)
</span></span><span class=line><span class=cl>      Tasks: 13 (limit: 19238)
</span></span><span class=line><span class=cl>     Memory: 34.8M
</span></span><span class=line><span class=cl>        CPU: 155ms
</span></span><span class=line><span class=cl>     CGroup: /system.slice/otelcol-contrib.service
</span></span><span class=line><span class=cl>             └─17113 /usr/bin/otelcol-contrib --config=/etc/otelcol-contrib/config.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: Descriptor:
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:      -&gt; Name: up
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:      -&gt; Description: The scraping was successful
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:      -&gt; Unit:
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:      -&gt; DataType: Gauge
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: NumberDataPoints #0
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: StartTimestamp: 1970-01-01 00:00:00 +0000 UTC
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: Timestamp: 2024-10-07 09:28:36.942 +0000 UTC
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: Value: 1.000000
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:         {&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;metrics&#34;, &#34;name&#34;: &#34;debug&#34;}</span></span></code></pre></div></div></div></div></div><p>Because we will be making multiple configuration file changes, setting environment variables and restarting the collector, we need to stop the collector service and disable it from starting on boot.</p><div class=tab-panel data-tab-group=23fcf2b4fca6a4fea9ed1d2012df5e2c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("23fcf2b4fca6a4fea9ed1d2012df5e2c","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl stop otelcol-contrib <span class=o>&amp;&amp;</span> sudo systemctl disable otelcol-contrib</span></span></code></pre></div></div></div></div></div><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Build your own collector using Open Telemetry Collector Builder (ocb)</span></span></summary><div class=box-content><p>For this part we will require the following installed on your system:</p><ul><li><p>Golang (latest version)</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /tmp
</span></span><span class=line><span class=cl>wget https://golang.org/dl/go1.20.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>sudo tar -C /usr/local -xzf go1.20.linux-amd64.tar.gz</span></span></code></pre></div><p>Edit <code>.profile</code> and add the following environment variables:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOROOT</span><span class=o>=</span>/usr/local/go
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOPATH</span><span class=o>=</span><span class=nv>$HOME</span>/go
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$GOPATH</span>/bin:<span class=nv>$GOROOT</span>/bin:<span class=nv>$PATH</span></span></span></code></pre></div><p>Renew your shell session:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>source</span> ~/.profile</span></span></code></pre></div><p>Check Go version:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go version</span></span></code></pre></div></li><li><p>ocb installed</p><ul><li><p>Download the ocb binary from the <a href=https://github.com/open-telemetry/opentelemetry-collector/releases/tag/cmd%2Fbuilder%2Fv0.80.0 rel=external target=_blank>project releases</a>
and run the following commands:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mv ocb_0.80.0_darwin_arm64 /usr/bin/ocb
</span></span><span class=line><span class=cl>chmod <span class=m>755</span> /usr/bin/ocb</span></span></code></pre></div><p>An alternative approach would be to use the golang tool chain to build the binary locally by doing:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go install go.opentelemetry.io/collector/cmd/builder@v0.80.0
</span></span><span class=line><span class=cl>mv <span class=k>$(</span>go env GOPATH<span class=k>)</span>/bin/builder /usr/bin/ocb</span></span></code></pre></div></li></ul></li><li><p>(Optional) Docker</p></li></ul><h2 id=why-build-your-own-collector>Why build your own collector?</h2><p>The default distribution of the collector (core and contrib) either contains too much or too little in what they have to offer.</p><p>It is also not advised to run the contrib collector in your production environments due to the amount of components installed which more than likely are not needed by your deployment.</p><h2 id=benefits-of-building-your-own-collector>Benefits of building your own collector?</h2><p>When creating your own collector binaries, (commonly referred to as distribution), means you build what you need.</p><p>The benefits of this are:</p><ol><li>Smaller sized binaries</li><li>Can use existing go scanners for vulnerabilities</li><li>Include internal components that can tie in with your organization</li></ol><h2 id=considerations-for-building-your-collector>Considerations for building your collector?</h2><p>Now, this would not be a 🥷 Ninja zone if it didn&rsquo;t come with some drawbacks:</p><ol><li>Go experience is recommended if not required</li><li><strong>No</strong> Splunk support</li><li>Responsibility for distribution and lifecycle management</li></ol><p>It is important to note that the project is working towards stability but it does not mean changes made will not break your workflow. The team at Splunk provides increased support and a higher level of stability so they can provide a curated experience helping you with your deployment needs.</p><h2 id=the-ninja-zone>The Ninja Zone</h2><p>Once you have all the required tools installed to get started, you will need to create a new file named <code>otelcol-builder.yaml</code> and we will follow this directory structure:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>└── otelcol-builder.yaml</span></span></code></pre></div><p>Once we have the file created, we need to add a list of components for it to install with some additional metadata.</p><p>For this example, we are going to create a builder manifest that will install only the components we need for the introduction config:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>dist</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otelcol-ninja</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>A custom build of the Open Telemetry Collector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>output_path</span><span class=p>:</span><span class=w> </span><span class=l>./dist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/extension/ballastextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/extension/zpagesextension  v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/httpforwarder v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/healthcheckextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/loggingexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/splunkhecexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/signalfxexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/sapmexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/batchprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/memorylimiterprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/receiver/otlpreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/hostmetricsreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/jaegerreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/prometheusreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/zipkinreceiver v0.80.0</span></span></span></code></pre></div><p>Once the yaml file has been updated for the <em>ocb</em>, then run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ocb --config<span class=o>=</span>otelcol-builder.yaml</span></span></code></pre></div><p>Which leave you with the following directory structure:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>├── dist
</span></span><span class=line><span class=cl>│   ├── components.go
</span></span><span class=line><span class=cl>│   ├── components_test.go
</span></span><span class=line><span class=cl>│   ├── go.mod
</span></span><span class=line><span class=cl>│   ├── go.sum
</span></span><span class=line><span class=cl>│   ├── main.go
</span></span><span class=line><span class=cl>│   ├── main_others.go
</span></span><span class=line><span class=cl>│   ├── main_windows.go
</span></span><span class=line><span class=cl>│   └── otelcol-ninja
</span></span><span class=line><span class=cl>└── otelcol-builder.yaml</span></span></code></pre></div><h3 id=references>References</h3><ol><li><a href=https://opentelemetry.io/docs/collector/custom-collector/ rel=external target=_blank>https://opentelemetry.io/docs/collector/custom-collector/</a></li></ol></div></details><hr><h2 id=default-configuration>Default configuration</h2><p>OpenTelemetry is configured through YAML files. These files have default configurations that we can modify to meet our needs. Let&rsquo;s look at the default configuration that is supplied:</p><div class=tab-panel data-tab-group=4eb44cc118d0989de125bb37b1c37fd9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("4eb44cc118d0989de125bb37b1c37fd9","command")'>
<span class=tab-nav-text>Command</span>
</button>
<button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("4eb44cc118d0989de125bb37b1c37fd9","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" linenos=table><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div><p>Congratulations! You have successfully downloaded and installed the OpenTelemetry Collector. You are well on your way to becoming an OTel Ninja. But first let&rsquo;s walk through configuration files and different distributions of the OpenTelemetry Collector.</p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>Splunk does provide its own, fully supported, distribution of the OpenTelemetry Collector. This distribution is available to install from the <a href=https://github.com/signalfx/splunk-otel-collector rel=external target=_blank><strong>Splunk GitHub Repository</strong></a> or via a wizard in Splunk Observability Cloud that will build out a simple installation script to copy and paste. This distribution includes many additional features and enhancements that are not available in the OpenTelemetry Collector Contrib distribution.</p><ul><li>The Splunk Distribution of the OpenTelemetry Collector is production-tested; it is in use by the majority of customers in their production environments.</li><li>Customers that use our distribution can receive direct help from official Splunk support within SLAs.</li><li>Customers can use or migrate to the Splunk Distribution of the OpenTelemetry Collector without worrying about future breaking changes to its core configuration experience for metrics and traces collection (OpenTelemetry logs collection configuration is in beta). There may be breaking changes to the Collector&rsquo;s metrics.</li></ul></div></details><p>We will now walk through each section of the configuration file and modify it to send host metrics to Splunk Observability Cloud.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><p>Now that we have the OpenTelemetry Collector installed, let&rsquo;s take a look at extensions for the OpenTelemetry Collector. Extensions are optional and available primarily for tasks that do not involve processing telemetry data. Examples of extensions include health monitoring, service discovery, and data forwarding.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;: &#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style E fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. Extensions</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><h2 id=health-check>Health Check</h2><p>Extensions are configured in the same <code>config.yaml</code> file that we referenced in the installation step. Let&rsquo;s edit the <code>config.yaml</code> file and configure the extensions. Note that the <strong>pprof</strong> and <strong>zpages</strong> extensions are already configured in the default <code>config.yaml</code> file. For the purpose of this workshop, we will only be updating the <strong>health_check</strong> extension to expose the port on all network interfaces on which we can access the health of the collector.</p><div class=tab-panel data-tab-group=5adf61ec020dcc7d2e44f7385e5307e5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5adf61ec020dcc7d2e44f7385e5307e5","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=41fe88e4ec30f137e73ae65da7366e81><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=extensions-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("41fe88e4ec30f137e73ae65da7366e81","extensions-configuration")'>
<span class=tab-nav-text>Extensions Configuration</span></button></div><div class=tab-content-container><div data-tab-item=extensions-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines=3><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span></span></span></code></pre></div></div></div></div></div><p>Start the collector:</p><div class=tab-panel data-tab-group=63d096ae5621638c26a8aab64bd82028><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("63d096ae5621638c26a8aab64bd82028","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol-contrib --config<span class=o>=</span>file:/etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><p>This extension enables an HTTP URL that can be probed to check the status of the OpenTelemetry Collector. This extension can be used as a liveness and/or readiness probe on Kubernetes. To learn more about the <code>curl</code> command, check out the <a href=https://curl.se/docs/manpage.html rel=external target=_blank>curl man page</a>.</p><p>Open a new terminal session and SSH into your instance to run the following command:</p><div class=tab-panel data-tab-group=7a22cd93adcf7a8be3140ab6e63c1a5a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=curl-command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7a22cd93adcf7a8be3140ab6e63c1a5a","curl-command")'>
<span class=tab-nav-text>curl Command</span>
</button>
<button data-tab-item=curl-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7a22cd93adcf7a8be3140ab6e63c1a5a","curl-output")'>
<span class=tab-nav-text>curl Output</span></button></div><div class=tab-content-container><div data-tab-item=curl-command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:13133</span></span></code></pre></div></div></div><div data-tab-item=curl-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{&#34;status&#34;:&#34;Server available&#34;,&#34;upSince&#34;:&#34;2024-10-07T11:00:08.004685295+01:00&#34;,&#34;uptime&#34;:&#34;12.56420005s&#34;}</span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><h2 id=performance-profiler>Performance Profiler</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/extension/pprofextension/README.md rel=external target=_blank><strong>Performance Profiler</strong></a> extension enables the golang net/http/pprof endpoint. This is typically used by developers to collect performance profiles and investigate issues with the service. <strong>We will not be covering this in this workshop</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><h2 id=zpages>zPages</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/extension/zpagesextension/README.md rel=external target=_blank><strong>zPages</strong></a> are an in-process alternative to external exporters. When included, they collect and aggregate tracing and metrics information in the background; this data is served on web pages when requested. zPages are an extremely useful diagnostic feature to ensure the collector is running as expected.</p><div class=tab-panel data-tab-group=89f69f932852a8fc0eb2147f3d4efa52><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=servicez class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("89f69f932852a8fc0eb2147f3d4efa52","servicez")'>
<span class=tab-nav-text>ServiceZ</span>
</button>
<button data-tab-item=pipelinez class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("89f69f932852a8fc0eb2147f3d4efa52","pipelinez")'>
<span class=tab-nav-text>PipelineZ</span>
</button>
<button data-tab-item=extensionz class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("89f69f932852a8fc0eb2147f3d4efa52","extensionz")'>
<span class=tab-nav-text>ExtensionZ</span></button></div><div class=tab-content-container><div data-tab-item=servicez class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>ServiceZ</strong> gives an overview of the collector services and quick access to the pipelinez, extensionz, and featurez zPages. The page also provides build and runtime information.</p><p>Example URL: <a href=http://localhost:55679/debug/servicez rel=external target=_blank><strong>http://localhost:55679/debug/servicez</strong></a> (change <code>localhost</code> to reflect your own environment).</p><p><a href=#R-image-4866dc58848b27dfbf3fc6df41bb9ce6 class=lightbox-link><img alt=ServiceZ class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/servicez.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4866dc58848b27dfbf3fc6df41bb9ce6><img alt=ServiceZ class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/servicez.png></a></p></div></div><div data-tab-item=pipelinez class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>PipelineZ</strong> provides insights on the running pipelines running in the collector. You can find information on type, if data is mutated, and you can also see information on the receivers, processors and exporters that are used for each pipeline.</p><p>Example URL: <a href=http://localhost:55679/debug/pipelinez rel=external target=_blank><strong>http://localhost:55679/debug/pipelinez</strong></a> (change <code>localhost</code> to reflect your own environment).</p><p><a href=#R-image-0e18f233e04c8efee7b2d20d01ee89bc class=lightbox-link><img alt=PipelineZ class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/pipelinez.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0e18f233e04c8efee7b2d20d01ee89bc><img alt=PipelineZ class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/pipelinez.png></a></p></div></div><div data-tab-item=extensionz class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>ExtensionZ</strong> shows the extensions that are active in the collector.</p><p>Example URL: <a href=http://localhost:55679/debug/extensionz rel=external target=_blank><strong>http://localhost:55679/debug/extensionz</strong></a> (change <code>localhost</code> to reflect your own environment).</p><p><a href=#R-image-0bee819501420d49399a053811014a7c class=lightbox-link><img alt=ExtensionZ class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/extensionz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0bee819501420d49399a053811014a7c><img alt=ExtensionZ class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/extensionz.png></a></p></div></div></div></div><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Improve data durability with storage extension</span></span></summary><div class=box-content><p>For this, we will need to validate that our distribution has the <code>file_storage</code> extension installed. This can be done by running the command <code>otelcol-contrib components</code> which should show results like:</p><div class=tab-panel data-tab-group=5a36c64fa296dbfa22c7794bfcbe1b74><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=truncated-output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5a36c64fa296dbfa22c7794bfcbe1b74","truncated-output")'>
<span class=tab-nav-text>Truncated Output</span>
</button>
<button data-tab-item=full-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("5a36c64fa296dbfa22c7794bfcbe1b74","full-output")'>
<span class=tab-nav-text>Full Output</span></button></div><div class=tab-content-container><div data-tab-item=truncated-output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># ... truncated for clarity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>file_storage</span></span></span></code></pre></div></div></div><div data-tab-item=full-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>buildinfo</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=l>otelcol-contrib</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>OpenTelemetry Collector Contrib</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus_simple</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>influxdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>purefa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>purefb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>receiver_creator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mongodbatlas</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>vcenter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>snmp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>expvar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jmx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>skywalking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>udplog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>carbon</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafkametrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memcached</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>windowseventlog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsecscontainermetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>iis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mysql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nsxt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>aerospike</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>elasticsearch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>httpcheck</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8sobjects</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mongodb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>hostmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>statsd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsxray</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cloudfoundry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>collectd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>couchdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kubeletstats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>journald</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>riak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>splunk_hec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>active_directory_ds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscloudwatch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sqlquery</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>windowsperfcounters</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>flinkmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudpubsub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>podman_stats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>wavefront</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_events</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>postgresql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>rabbitmq</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sapm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sqlserver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>solace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tcplog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscontainerinsightreceiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsfirehose</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bigip</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>filelog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudspanner</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cloudflare</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>docker_stats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pulsar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zipkin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>opencensus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azureeventhub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>fluentforward</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlpjsonfile</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>syslog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cumulativetodelta</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>groupbyattrs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>groupbytrace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8sattributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>experimental_metricsgeneration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>metricstransform</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>routing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>deltatorate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>spanmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>span</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>redaction</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>servicegraph</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>transform</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>filter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>probabilistic_sampler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tail_sampling</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>carbon</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>f5cloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mezmo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>skywalking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsxray</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>dynatrace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>loki</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azuredataexplorer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azuremonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>instana</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>loadbalancing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sentry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>splunk_hec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tanzuobservability</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zipkin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>alibabacloud_logservice</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>clickhouse</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheusremotewrite</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscloudwatchlogs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudpubsub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger_thrift</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logzio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sapm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sumologic</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlemanagedprometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>opencensus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awskinesis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>coralogix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>influxdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logicmonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tencentcloud_logservice</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsemf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>elasticsearch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pulsar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zpages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bearertokenauth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>oidc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>host_observer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sigv4auth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>file_storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memory_ballast</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>health_check</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>oauth2client</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsproxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>http_forwarder</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaegerremotesampling</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_observer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pprof</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>asapclient</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>basicauth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>headers_setter</span></span></span></code></pre></div></div></div></div></div><p>This extension provides exporters the ability to queue data to disk in the event that exporter is unable to send data to the configured endpoint.</p><p>In order to configure the extension, you will need to update your config to include the information below. First, be sure to create a /tmp/otel-data directory and give it read/write permissions:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file_storage</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=l>/tmp/otel-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>compaction</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=l>/tmp/otel-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_start</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_rebound</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rebound_needed_threshold_mib</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rebound_trigger_threshold_mib</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ... truncated for clarity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages, file_storage]</span></span></span></code></pre></div><h2 id=why-queue-data-to-disk>Why queue data to disk?</h2><p>This allows the collector to weather network interruptions (and even collector restarts) to ensure data is sent to the upstream provider.</p><h2 id=considerations-for-queuing-data-to-disk>Considerations for queuing data to disk?</h2><p>There is a potential that this could impact data throughput performance due to disk performance.</p><h3 id=references>References</h3><ol><li><a href=https://community.splunk.com/t5/Community-Blog/Data-Persistence-in-the-OpenTelemetry-Collector/ba-p/624583 rel=external target=_blank>https://community.splunk.com/t5/Community-Blog/Data-Persistence-in-the-OpenTelemetry-Collector/ba-p/624583</a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/storage/filestorage rel=external target=_blank>https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/storage/filestorage</a></li></ol></div></details><hr><h2 id=configuration-check-in>Configuration Check-in</h2><p>Now that we&rsquo;ve covered extensions, let&rsquo;s check our configuration changes.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=fe23ca95f12f7f8b56a18159eb051be3><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("fe23ca95f12f7f8b56a18159eb051be3","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines=5 linenos=table><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=hl><span class=lnt> 5
</span></span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><p>Now that we have reviewed extensions, let&rsquo;s dive into the data pipeline portion of the workshop. A pipeline defines a path the data follows in the Collector starting from reception, moving to further processing or modification, and finally exiting the Collector via exporters.</p><p>The data pipeline in the OpenTelemetry Collector is made up of <strong>receivers</strong>, <strong>processors</strong>, and <strong>exporters</strong>. We will first start with receivers.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><p>Welcome to the receiver portion of the workshop! This is the starting point of the data pipeline of the OpenTelemetry Collector. Let&rsquo;s dive in.</p><p>A receiver, which can be push or pull based, is how data gets into the Collector. Receivers may support one or more data sources. Generally, a receiver accepts data in a specified format, translates it into the internal format and passes it to processors and exporters defined in the applicable pipelines.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style M fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. Receivers</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><h2 id=host-metrics-receiver>Host Metrics Receiver</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/hostmetricsreceiver/README.md rel=external target=_blank><strong>The Host Metrics Receiver</strong></a> generates metrics about the host system scraped from various sources. This is intended to be used when the collector is deployed as an agent which is what we will be doing in this workshop.</p><p>Let&rsquo;s update the <code>/etc/otel-contrib/config.yaml</code> file and configure the <strong>hostmetrics</strong> receiver. Insert the following YAML under the <strong>receivers</strong> section, taking care to indent by two spaces.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otelcol-contrib/config.yaml</span></span></code></pre></div><div class=tab-panel data-tab-group=f18be7750eff1ef5168595a76d27866e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=host-metrics-receiver-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("f18be7750eff1ef5168595a76d27866e","host-metrics-receiver-configuration")'>
<span class=tab-nav-text>Host Metrics Receiver Configuration</span></button></div><div class=tab-content-container><div data-tab-item=host-metrics-receiver-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines=2-22><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># process:</span></span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><h2 id=prometheus-receiver>Prometheus Receiver</h2><p>You will also notice another receiver called <strong>prometheus</strong>. <a href=https://prometheus.io/docs/introduction/overview/ rel=external target=_blank><strong>Prometheus</strong></a> is an open-source toolkit used by the OpenTelemetry Collector. This receiver is used to scrape metrics from the OpenTelemetry Collector itself. These metrics can then be used to monitor the health of the collector.</p><p>Let&rsquo;s modify the <code>prometheus</code> receiver to clearly show that it is for collecting metrics from the collector itself. By changing the name of the receiver from <code>prometheus</code> to <code>prometheus/internal</code>, it is now much clearer as to what that receiver is doing. Update the configuration file to look like this:</p><div class=tab-panel data-tab-group=232752e07aae3f6b25657d773a87140f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=prometheus-receiver-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("232752e07aae3f6b25657d773a87140f","prometheus-receiver-configuration")'>
<span class=tab-nav-text>Prometheus Receiver Configuration</span></button></div><div class=tab-content-container><div data-tab-item=prometheus-receiver-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines=1><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class="line hl"><span class=cl><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span></span></span></code></pre></div></div></div></div></div><h2 id=example-dashboard---prometheus-metrics>Example Dashboard - Prometheus metrics</h2><p>The following screenshot shows an example dashboard of some of the metrics the Prometheus internal receiver collects from the OpenTelemetry Collector. Here, we can see accepted and sent spans, metrics and log records.</p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>The following screenshot is an out-of-the-box (OOTB) dashboard from Splunk Observability Cloud that allows you to easily monitor your Splunk OpenTelemetry Collector install base.</p></div></details><p><a href=#R-image-074307b15c8338e392b7c49c294591c2 class=lightbox-link><img alt=otel-charts class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/otel-charts.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-074307b15c8338e392b7c49c294591c2><img alt=otel-charts class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/otel-charts.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><h2 id=other-receivers>Other Receivers</h2><p>You will notice in the default configuration there are other receivers: <strong>otlp</strong>, <strong>opencensus</strong>, <strong>jaeger</strong> and <strong>zipkin</strong>. These are used to receive telemetry data from other sources. We will not be covering these receivers in this workshop and they can be left as they are.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Create receivers dynamically</span></span></summary><div class=box-content><p>To help observe short lived tasks like docker containers, kubernetes pods, or ssh sessions, we can use the <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator rel=external target=_blank>receiver creator</a> with <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/observer rel=external target=_blank>observer extensions</a> to create a new receiver as these services start up.</p><h2 id=what-do-we-need>What do we need?</h2><p>In order to start using the receiver creator and its associated observer extensions, they will need to be part of your collector build manifest.</p><p>See <a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/1-installation/index.html>installation</a> for the details.</p><h2 id=things-to-consider>Things to consider?</h2><p>Some short lived tasks may require additional configuration such as <em>username</em>, and <em>password</em>.
These values can be referenced via <a href=https://opentelemetry.io/docs/collector/configuration/#configuration-environment-variables rel=external target=_blank>environment variables</a>,
or use a scheme expand syntax such as <code>${file:./path/to/database/password}</code>.
Please adhere to your organisation&rsquo;s secret practices when taking this route.</p><h2 id=the-ninja-zone>The Ninja Zone</h2><p>There are only two things needed for this ninja zone:</p><ol><li>Make sure you have added receiver creater and observer extensions to the builder manifest.</li><li>Create the config that can be used to match against discovered endpoints.</li></ol><p>To create the templated configurations, you can do the following:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>watch_observers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>host_observer]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;port&#34; &amp;&amp; port == 6379</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>${env:HOST_REDIS_PASSWORD}</span></span></span></code></pre></div><p>For more examples, refer to these <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator#examples rel=external target=_blank>receiver creator&rsquo;s examples</a>.</p></div></details><hr><h2 id=configuration-check-in>Configuration Check-in</h2><p>We&rsquo;ve now covered receivers, so let&rsquo;s now check our configuration changes.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=4f1a1efc963e3542507e51da1c19e1b8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("4f1a1efc963e3542507e51da1c19e1b8","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines="13-33 45" linenos=table><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=hl><span class=lnt>13
</span></span><span class=hl><span class=lnt>14
</span></span><span class=hl><span class=lnt>15
</span></span><span class=hl><span class=lnt>16
</span></span><span class=hl><span class=lnt>17
</span></span><span class=hl><span class=lnt>18
</span></span><span class=hl><span class=lnt>19
</span></span><span class=hl><span class=lnt>20
</span></span><span class=hl><span class=lnt>21
</span></span><span class=hl><span class=lnt>22
</span></span><span class=hl><span class=lnt>23
</span></span><span class=hl><span class=lnt>24
</span></span><span class=hl><span class=lnt>25
</span></span><span class=hl><span class=lnt>26
</span></span><span class=hl><span class=lnt>27
</span></span><span class=hl><span class=lnt>28
</span></span><span class=hl><span class=lnt>29
</span></span><span class=hl><span class=lnt>30
</span></span><span class=hl><span class=lnt>31
</span></span><span class=hl><span class=lnt>32
</span></span><span class=hl><span class=lnt>33
</span></span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=hl><span class=lnt>45
</span></span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><p>Now that we have reviewed how data gets into the OpenTelemetry Collector through receivers, let&rsquo;s now take a look at how the Collector processes the received data.</p><details open class="box cstyle notices warning"><summary class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>As the <code>/etc/otelcol-contrib/config.yaml</code> is not complete, please <strong>do not</strong> attempt to restart the collector at this point.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><p><a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/README.md rel=external target=_blank><strong>Processors</strong></a> are run on data between being received and being exported. Processors are optional though some are recommended. There are <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor rel=external target=_blank><strong>a large number of processors</strong></a> included in the OpenTelemetry contrib Collector.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style Processors fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 4. Processors</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><h2 id=batch-processor>Batch Processor</h2><p>By default, only the <strong>batch</strong> processor is enabled. This processor is used to batch up data before it is exported. This is useful for reducing the number of network calls made to exporters. For this workshop, we will inherit the following defaults which are hard-coded into the Collector:</p><ul><li><code>send_batch_size</code> (default = 8192): Number of spans, metric data points, or log records after which a batch will be sent regardless of the timeout. send_batch_size acts as a trigger and does not affect the size of the batch. If you need to enforce batch size limits sent to the next component in the pipeline see send_batch_max_size.</li><li><code>timeout</code> (default = 200ms): Time duration after which a batch will be sent regardless of size. If set to zero, send_batch_size is ignored as data will be sent immediately, subject to only send_batch_max_size.</li><li><code>send_batch_max_size</code> (default = 0): The upper limit of the batch size. 0 means no upper limit on the batch size. This property ensures that larger batches are split into smaller units. It must be greater than or equal to send_batch_size.</li></ul><p>For more information on the Batch processor, see the <a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/batchprocessor/README.md rel=external target=_blank><strong>Batch Processor documentation</strong></a>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><h2 id=resource-detection-processor>Resource Detection Processor</h2><p>The <strong>resourcedetection</strong> processor can be used to detect resource information from the host and append or override the resource value in telemetry data with this information.</p><p>By default, the hostname is set to the FQDN if possible, otherwise, the hostname provided by the OS is used as a fallback. This logic can be changed from using using the <code>hostname_sources</code> configuration option. To avoid getting the FQDN and use the hostname provided by the OS, we will set the <code>hostname_sources</code> to <code>os</code>.</p><div class=tab-panel data-tab-group=dd331fcf737e79be4765f5939f756910><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=system-resource-detection-processor-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("dd331fcf737e79be4765f5939f756910","system-resource-detection-processor-configuration")'>
<span class=tab-nav-text>System Resource Detection Processor Configuration</span></button></div><div class=tab-content-container><div data-tab-item=system-resource-detection-processor-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines=3-7><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span></span></span></code></pre></div></div></div></div></div><p>If the workshop instance is running on an AWS/EC2 instance we can gather the following tags from the EC2 metadata API (this is not available on other platforms).</p><ul><li><code>cloud.provider ("aws")</code></li><li><code>cloud.platform ("aws_ec2")</code></li><li><code>cloud.account.id</code></li><li><code>cloud.region</code></li><li><code>cloud.availability_zone</code></li><li><code>host.id</code></li><li><code>host.image.id</code></li><li><code>host.name</code></li><li><code>host.type</code></li></ul><p>We will create another processor to append these tags to our metrics.</p><div class=tab-panel data-tab-group=8d62203f2eb4e67f8d8dc57d2157af1f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=ec2-resource-detection-processor-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8d62203f2eb4e67f8d8dc57d2157af1f","ec2-resource-detection-processor-configuration")'>
<span class=tab-nav-text>EC2 Resource Detection Processor Configuration</span></button></div><div class=tab-content-container><div data-tab-item=ec2-resource-detection-processor-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines=7-8><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span></span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><h2 id=attributes-processor>Attributes Processor</h2><p>The attributes processor modifies attributes of a span, log, or metric. This processor also supports the ability to filter and match input data to determine if they should be included or excluded for specified actions.</p><p>It takes a list of actions that are performed in the order specified in the config. The supported actions are:</p><ul><li><code>insert</code>: Inserts a new attribute in input data where the key does not already exist.</li><li><code>update</code>: Updates an attribute in input data where the key does exist.</li><li><code>upsert</code>: Performs insert or update. Inserts a new attribute in input data where the key does not already exist and updates an attribute in input data where the key does exist.</li><li><code>delete</code>: Deletes an attribute from the input data.</li><li><code>hash</code>: Hashes (SHA1) an existing attribute value.</li><li><code>extract</code>: Extracts values using a regular expression rule from the input key to target keys specified in the rule. If a target key already exists, it will be overridden.</li></ul><p>We are going to create an attributes processor to <code>insert</code> a new attribute to all our host metrics called <code>participant.name</code> with a value of your name e.g. <code>marge_simpson</code>.</p><details open class="box cstyle notices warning"><summary class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>Ensure you replace <code>INSERT_YOUR_NAME_HERE</code> with your name and also ensure you <strong>do not</strong> use spaces in your name.</p></div></details><p>Later on in the workshop, we will use this attribute to filter our metrics in Splunk Observability Cloud.</p><div class=tab-panel data-tab-group=57da2d812e2fab3d3613384acdd651ed><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=attributes-processor-configuration class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("57da2d812e2fab3d3613384acdd651ed","attributes-processor-configuration")'>
<span class=tab-nav-text>Attributes Processor Configuration</span></button></div><div class=tab-content-container><div data-tab-item=attributes-processor-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines=9-13><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span></span></span></code></pre></div></div></div></div></div><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Using connectors to gain internal insights</span></span></summary><div class=box-content><p>One of the most recent additions to the collector was the notion of a <a href=https://opentelemetry.io/docs/collector/configuration/#connectors rel=external target=_blank><strong>connector</strong></a>, which allows you to join the output of one pipeline to the input of another pipeline.</p><p>An example of how this is beneficial is that some services emit metrics based on the amount of datapoints being exported, the number of logs containing an error status,
or the amount of data being sent from one deployment environment. The count connector helps address this for you out of the box.</p><h2 id=why-a-connector-instead-of-a-processor>Why a connector instead of a processor?</h2><p>A processor is limited in what additional data it can produce considering it has to pass on the data it has processed making it hard to expose additional information. Connectors do not have to emit the data they receive which means they provide an opportunity to create the insights we are after.</p><p>For example, a connector could be made to count the number of logs, metrics, and traces that do not have the deployment environment attribute.</p><p>A very simple example with the output of being able to break down data usage by deployment environment.</p><h2 id=considerations-with-connectors>Considerations with connectors</h2><p>A connector only accepts data exported from one pipeline and receiver by another pipeline, this means you may have to consider how you construct your collector config to take advantage of it.</p><h2 id=references>References</h2><ol><li><a href=https://opentelemetry.io/docs/collector/configuration/#connectors rel=external target=_blank><strong>https://opentelemetry.io/docs/collector/configuration/#connectors</strong></a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector rel=external target=_blank><strong>https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector</strong></a></li></ol></div></details><hr><h2 id=configuration-check-in>Configuration Check-in</h2><p>That&rsquo;s processors covered, let&rsquo;s check our configuration changes.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=9885ae6d6d3aabfbc9b0f7e3797fe32a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("9885ae6d6d3aabfbc9b0f7e3797fe32a","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines=69-79 linenos=table><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=hl><span class=lnt> 69
</span></span><span class=hl><span class=lnt> 70
</span></span><span class=hl><span class=lnt> 71
</span></span><span class=hl><span class=lnt> 72
</span></span><span class=hl><span class=lnt> 73
</span></span><span class=hl><span class=lnt> 74
</span></span><span class=hl><span class=lnt> 75
</span></span><span class=hl><span class=lnt> 76
</span></span><span class=hl><span class=lnt> 77
</span></span><span class=hl><span class=lnt> 78
</span></span><span class=hl><span class=lnt> 79
</span></span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-exporters>OpenTelemetry Collector Exporters</h1><p>An exporter, which can be push or pull-based, is how you send data to one or more backends/destinations. Exporters may support one or more data sources.</p><p>For this workshop, we will be using the <a href=https://opentelemetry.io/docs/specs/otel/protocol/exporter/ rel=external target=_blank><strong>otlphttp</strong></a> exporter. The OpenTelemetry Protocol (OTLP) is a vendor-neutral, standardised protocol for transmitting telemetry data. The OTLP exporter sends data to a server that implements the OTLP protocol. The OTLP exporter supports both <a href=https://grpc.io/ rel=external target=_blank><strong>gRPC</strong></a> and <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Overview rel=external target=_blank><strong>HTTP</strong></a>/<a href=https://www.json.org/json-en.html rel=external target=_blank><strong>JSON</strong></a> protocols.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style Exporters fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 5. Exporters</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-exporters>OpenTelemetry Collector Exporters</h1><h2 id=otlp-http-exporter>OTLP HTTP Exporter</h2><p>To send metrics over HTTP to Splunk Observability Cloud, we will need to configure the <strong>otlphttp</strong> exporter.</p><p>Let&rsquo;s edit our <code>/etc/otelcol-contrib/config.yaml</code> file and configure the <strong>otlphttp</strong> exporter. Insert the following YAML under the <strong>exporters</strong> section, taking care to indent by two spaces e.g.</p><p>We will also change the verbosity of the logging exporter to prevent the disk from filling up. The default of <code>detailed</code> is very noisy.</p><div class="highlight wrap-code" hl_lines=3-4><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=l>otlphttp/splunk:</span></span></span></code></pre></div><p>Next, we need to define the <code>metrics_endpoint</code> and configure the target URL.</p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>If you are an attendee at a Splunk-hosted workshop, the instance you are using has already been configured with a Realm environment variable. We will reference that environment variable in our configuration file. Otherwise, you will need to create a new environment variable and set the Realm e.g.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span><span class=s2>&#34;us1&#34;</span></span></span></code></pre></div></div></details><p>The URL to use is <code>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</code>. (Splunk has Realms in key geographical locations around the world for data residency).</p><p>The <strong>otlphttp</strong> exporter can also be configured to send traces and logs by defining a target URL for <code>traces_endpoint</code> and <code>logs_endpoint</code> respectively. Configuring these is outside the scope of this workshop.</p><div class="highlight wrap-code" hl_lines=5><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span></span></span></code></pre></div><p>By default, <code>gzip</code> compression is enabled for all endpoints. This can be disabled by setting <code>compression: none</code> in the exporter configuration. We will leave compression enabled for this workshop and accept the default as this is the most efficient way to send data.</p><p>To send metrics to Splunk Observability Cloud, we need to use an Access Token. This can be done by creating a new token in the Splunk Observability Cloud UI. For more information on how to create a token, see <a href=https://docs.splunk.com/Observability/admin/authentication-tokens/org-tokens.html rel=external target=_blank>Create a token</a>. The token needs to be of type <strong>INGEST</strong>.</p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>If you are an attendee at a Splunk-hosted workshop, the instance you are using has already been configured with an Access Token (which has been set as an environment variable). We will reference that environment variable in our configuration file. Otherwise, you will need to create a new token and set it as an environment variable e.g.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span>&lt;replace-with-your-token&gt;</span></span></code></pre></div></div></details><p>The token is defined in the configuration file by inserting <code>X-SF-TOKEN: ${env:ACCESS_TOKEN}</code> under a <code>headers:</code> section:</p><div class="highlight wrap-code" hl_lines=6-8><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>X-SF-TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span></span></span></code></pre></div><h2 id=configuration-check-in>Configuration Check-in</h2><p>Now that we&rsquo;ve covered exporters, let&rsquo;s check our configuration changes:</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=112306de311e639bf87ee15e01058588><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("112306de311e639bf87ee15e01058588","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" hl_lines=83-87 linenos=table><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=hl><span class=lnt> 83
</span></span><span class=hl><span class=lnt> 84
</span></span><span class=hl><span class=lnt> 85
</span></span><span class=hl><span class=lnt> 86
</span></span><span class=hl><span class=lnt> 87
</span></span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>X-SF-Token</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><p>Of course, you can easily configure the <code>metrics_endpoint</code> to point to any other solution that supports the <strong>OTLP</strong> protocol.</p><p>Next, we need to enable the receivers, processors and exporters we have just configured in the service section of the <code>config.yaml</code>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><p>The <strong>Service</strong> section is used to configure what components are enabled in the Collector based on the configuration found in the receivers, processors, exporters, and extensions sections.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>If a component is configured, but not defined within the <strong>Service</strong> section then it is <strong>not</strong> enabled.</p></div></details><p>The service section consists of three sub-sections:</p><ul><li>extensions</li><li>pipelines</li><li>telemetry</li></ul><p>In the default configuration, the extension section has been configured to enable <code>health_check</code>, <code>pprof</code> and <code>zpages</code>, which we configured in the Extensions module earlier.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></div><p>So lets configure our Metric Pipeline!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 6. Service</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=hostmetrics-receiver>Hostmetrics Receiver</h2><p>If you recall from the Receivers portion of the workshop, we defined the <a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/3-receivers/index.html#host-metrics-receiver><strong>Host Metrics Receiver</strong></a> to generate metrics about the host system, which are scraped from various sources. To enable the receiver, we must include the <code>hostmetrics</code> receiver in the metrics pipeline.</p><p>In the <code>metrics</code> pipeline, add <code>hostmetrics</code> to the metrics <code>receivers</code> section.</p><div class="highlight wrap-code" hl_lines=11><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=prometheus-internal-receiver>Prometheus Internal Receiver</h2><p>Earlier in the workshop, we also renamed the <code>prometheus</code> receiver to reflect that is was collecting metrics internal to the collector, renaming it to <code>prometheus/internal</code>.</p><p>We now need to enable the <code>prometheus/internal</code> receiver under the metrics pipeline. Update the <code>receivers</code> section to include <code>prometheus/internal</code> under the <code>metrics</code> pipeline:</p><div class="highlight wrap-code" hl_lines=11><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=resource-detection-processor>Resource Detection Processor</h2><p>We also added <code>resourcedetection/system</code> and <code>resourcedetection/ec2</code> processors so that the collector can capture the instance hostname and AWS/EC2 metadata. We now need to enable these two processors under the metrics pipeline.</p><p>Update the <code>processors</code> section to include <code>resourcedetection/system</code> and <code>resourcedetection/ec2</code> under the <code>metrics</code> pipeline:</p><div class="highlight wrap-code" hl_lines=12><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=attributes-processor>Attributes Processor</h2><p>Also in the Processors section of this workshop, we added the <code>attributes/conf</code> processor so that the collector will insert a new attribute called <code>participant.name</code> to all the metrics. We now need to enable this under the metrics pipeline.</p><p>Update the <code>processors</code> section to include <code>attributes/conf</code> under the <code>metrics</code> pipeline:</p><div class="highlight wrap-code" hl_lines=12><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=otlp-http-exporter>OTLP HTTP Exporter</h2><p>In the Exporters section of the workshop, we configured the <code>otlphttp</code> exporter to send metrics to Splunk Observability Cloud. We now need to enable this under the metrics pipeline.</p><p>Update the <code>exporters</code> section to include <code>otlphttp/splunk</code> under the <code>metrics</code> pipeline:</p><div class="highlight wrap-code" hl_lines=13><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug, otlphttp/splunk]</span></span></span></code></pre></div><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Observing the collector internals</span></span></summary><div class=box-content><p>The collector captures internal signals about its behavior this also includes additional signals from running components.
The reason for this is that components that make decisions about the flow of data need a way to surface that information
as metrics or traces.</p><h2 id=why-monitor-the-collector>Why monitor the collector?</h2><p>This is somewhat of a chicken and egg problem of, &ldquo;Who is watching the watcher?&rdquo;, but it is important that we can surface this information. Another interesting part of the collector&rsquo;s history is that it existed before the Go metrics&rsquo; SDK was considered stable so the collector exposes a Prometheus endpoint to provide this functionality for the time being.</p><h2 id=considerations>Considerations</h2><p>Monitoring the internal usage of each running collector in your organization can contribute a significant amount of new Metric Time Series (MTS). The Splunk distribution has curated these metrics for you and would be able to help forecast the expected increases.</p><h2 id=the-ninja-zone>The Ninja Zone</h2><p>To expose the internal observability of the collector, some additional settings can be adjusted:</p><div class=tab-panel data-tab-group=595b97303f99127c6918f599628d91fd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=telemetry-schema class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("595b97303f99127c6918f599628d91fd","telemetry-schema")'>
<span class=tab-nav-text>telemetry schema</span>
</button>
<button data-tab-item=example-configyml class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("595b97303f99127c6918f599628d91fd","example-configyml")'>
<span class=tab-nav-text>example-config.yml</span></button></div><div class=tab-content-container><div data-tab-item=telemetry-schema class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>telemetry</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>&lt;info|warn|error&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>development</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>encoding</span><span class=p>:</span><span class=w> </span><span class=l>&lt;console|json&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_caller</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_stacktrace</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>output_paths</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>&lt;stdout|stderr&gt;, paths...]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>error_output_paths</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>&lt;stdout|stderr&gt;, paths...]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>initial_fields</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>&lt;none|basic|normal|detailed&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Address binds the promethues endpoint to scrape</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>&lt;hostname:port&gt;</span></span></span></code></pre></div></div></div><div data-tab-item=example-configyml class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>telemetry</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>info</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>encoding</span><span class=p>:</span><span class=w> </span><span class=l>json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_stacktrace</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>initial_fields</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>instance.name</span><span class=p>:</span><span class=w> </span><span class=l>${env:INSTANCE}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>localhost:8888 </span></span></span></code></pre></div></div></div></div></div><h2 id=references>References</h2><ol><li><a href=https://opentelemetry.io/docs/collector/configuration/#service rel=external target=_blank>https://opentelemetry.io/docs/collector/configuration/#service</a></li></ol></div></details><hr><h2 id=final-configuration>Final configuration</h2><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your final configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=7743121da6507e445f5c84c65726dfd0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7743121da6507e445f5c84c65726dfd0","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" linenos=table><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>X-SF-Token</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug, otlphttp/splunk]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>It is recommended that you validate your configuration file before restarting the collector. You can do this by pasting the contents of your <code>config.yaml</code> file into <strong><a href=https://www.otelbin.io/ rel=external target=_blank>otelbin.io</a></strong>.</p><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><strong>Screenshot</strong></span><span class=badge-content style=background-color:green>OTelBin</span></span></summary><div class=box-content><p><a href=#R-image-405d2f40dc84f427180cf1f8279de5ef class=lightbox-link><img alt=otelbin-validator class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/otelbin.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-405d2f40dc84f427180cf1f8279de5ef><img alt=otelbin-validator class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/otelbin.png></a></p></div></details></div></details><p>Now that we have a working configuration, let&rsquo;s start the collector and then check to see what <a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/2-extensions/index.html#zpages>zPages</a> is reporting.</p><div class=tab-panel data-tab-group=8ce2dc6bdfb8314175057cefdd20d5a0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8ce2dc6bdfb8314175057cefdd20d5a0","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol-contrib --config<span class=o>=</span>file:/etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><p>Open up zPages in your browser: <a href=http://localhost:55679/debug/pipelinez rel=external target=_blank><strong>http://localhost:55679/debug/pipelinez</strong></a> (change <code>localhost</code> to reflect your own environment).
<a href=#R-image-1527e978c739d9c51b1dcd13651b1615 class=lightbox-link><img alt=pipelinez-full-config class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/pipelinez-full-config.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1527e978c739d9c51b1dcd13651b1615><img alt=pipelinez-full-config class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/pipelinez-full-config.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 17, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=data-visualisations>Data Visualisations</h1><h2 id=splunk-observability-cloud>Splunk Observability Cloud</h2><p>Now that we have configured the OpenTelemetry Collector to send metrics to Splunk Observability Cloud, let&rsquo;s take a look at the data in Splunk Observability Cloud. If you have not received an invite to Splunk Observability Cloud, your instructor will provide you with login credentials.</p><p>Before that, let&rsquo;s make things a little more interesting and run a stress test on the instance. This in turn will light up the dashboards.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install stress
</span></span><span class=line><span class=cl><span class=k>while</span> true<span class=p>;</span> <span class=k>do</span> stress -c <span class=m>2</span> -t 40<span class=p>;</span> stress -d <span class=m>5</span> -t 40<span class=p>;</span> stress -m <span class=m>20</span> -t 40<span class=p>;</span> <span class=k>done</span></span></span></code></pre></div><p>Once you are logged into Splunk Observability Cloud, using the left-hand navigation, navigate to <strong>Dashboards</strong> from the main menu. This will take you to the Teams view. At the top of this view click on <strong>All Dashboards</strong> :</p><p><a href=#R-image-c6fec1a88dfa32e8498af3bb36840c37 class=lightbox-link><img alt=menu-dashboards class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/menu-dashboards.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c6fec1a88dfa32e8498af3bb36840c37><img alt=menu-dashboards class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/menu-dashboards.png></a></p><p>In the search box, search for <strong>OTel Contrib</strong>:</p><p><a href=#R-image-0b14123e732144f4b75447ec491a4562 class=lightbox-link><img alt=search-dashboards class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/search-dashboards.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0b14123e732144f4b75447ec491a4562><img alt=search-dashboards class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/search-dashboards.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>If the dashboard does not exist, then your instructor will be able to quickly add it. If you are not attending a Splunk hosted version of this workshop then the Dashboard Group to import can be found at the bottom of this page.</p></div></details><p>Click on the <strong>OTel Contrib Dashboard</strong> dashboard to open it, next click in the <strong>Participant Name</strong> box, at the top of the dashboard, and select the name you configured for <code>participant.name</code> in the <code>config.yaml</code> in the drop-down list or start typing the name to search for it:</p><p><a href=#R-image-f7eb0d3c2c7477f7b879a69baea39a87 class=lightbox-link><img alt=select-conf-attendee-name class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/select-participant-name.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f7eb0d3c2c7477f7b879a69baea39a87><img alt=select-conf-attendee-name class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/select-participant-name.png></a></p><p>You can now see the host metrics for the host upon which you configured the OpenTelemetry Collector.</p><p><a href=#R-image-4998b9677a3f104af0535b73aadab651 class=lightbox-link><img alt=participant-dashboard class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/participant-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4998b9677a3f104af0535b73aadab651><img alt=participant-dashboard class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/participant-dashboard.png></a></p><details open class="box cstyle attachments info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Download Dashboard Group JSON for importing</summary><ul class="attachments-files box-content"><li><a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/7-visualisation/OpenTelemetry-Contrib-Dashboard-Group.json>OpenTelemetry-Contrib-Dashboard-Group.json</a> (40 KB)</li></ul></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=developing-a-custom-component>Developing a custom component</h2><p>Building a component for the Open Telemetry Collector requires three key parts:</p><ol><li>The Configuration - <em>What values are exposed to the user to configure</em></li><li>The Factory - <em>Make the component using the provided values</em></li><li>The Business Logic - <em>What the component needs to do</em></li></ol><p>For this, we will use the example of building a component that works with Jenkins so that we can track important DevOps metrics of our project(s).</p><p>The metrics we are looking to measure are:</p><ol><li>Lead time for changes - <em>&ldquo;How long it takes for a commit to get into production&rdquo;</em></li><li>Change failure rate - <em>&ldquo;The percentage of deployments causing a failure in production&rdquo;</em></li><li>Deployment frequency - <em>&ldquo;How often a [team] successfully releases to production&rdquo;</em></li><li>Mean time to recover - <em>&ldquo;How long does it take for a [team] to recover from a failure in production&rdquo;</em></li></ol><p>These indicators were identified Google&rsquo;s DevOps Research and Assesment (DORA)[^1] team to help
show performance of a software development team. The reason for choosing <em>Jenkins CI</em> is that we remain in the same Open Source Software ecosystem which we can serve as the example for the vendor managed CI tools to adopt in future.</p><h2 id=instrument-vs-component>Instrument Vs Component</h2><p>There is something to consider when improving level of Observability within your organisation
since there are some trade offs that get made.</p><table><thead><tr><th style=text-align:left></th><th style=text-align:left>Pros</th><th style=text-align:left>Cons</th></tr></thead><tbody><tr><td style=text-align:left><strong>(Auto) Instrumented</strong></td><td style=text-align:left>Does not require an external API to be monitored in order to observe the system.</td><td style=text-align:left>Changing instrumentation requires changes to the project.</td></tr><tr><td style=text-align:left></td><td style=text-align:left>Gives system owners/developers to make changes in their observability.</td><td style=text-align:left>Requires additional runtime dependancies.</td></tr><tr><td style=text-align:left></td><td style=text-align:left>Understands system context and can corrolate captured data with <em>Exemplars</em>.</td><td style=text-align:left>Can impact performance of the system.</td></tr><tr><td style=text-align:left><strong>Component</strong></td><td style=text-align:left>- Changes to data names or semantics can be rolled out independently of the system&rsquo;s release cycle.</td><td style=text-align:left>Breaking API changes require a coordinated release between system and collector.</td></tr><tr><td style=text-align:left></td><td style=text-align:left>Updating/extending data collected is a seemless user facing change.</td><td style=text-align:left>Captured data semantics can unexpectedly break that does not align with a new system release.</td></tr><tr><td style=text-align:left></td><td style=text-align:left>Does not require the supporting teams to have a deep understanding of observability practice.</td><td style=text-align:left>Strictly external / exposed information can be surfaced from the system.</td></tr></tbody></table><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 8. Develop</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=project-setup-hahahugoshortcode109s0hbhb>Project Setup <span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong></span></span></h2><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>The time to finish this section of the workshop can vary depending on experience.</p><p>A complete solution can be found <a href=https://github.com/splunk/collector-workshop-example rel=external target=_blank><strong>here</strong></a> in case you&rsquo;re stuck or want to follow
along with the instructor.</p></div></details><p>To get started developing the new <em>Jenkins CI</em> receiver, we first need to set up a Golang project.
The steps to create your new Golang project is:</p><ol><li>Create a new directory named <code>${HOME}/go/src/jenkinscireceiver</code> and change into it<ol><li>The actual directory name or location is not strict, you can choose your own development directory to make it in.</li></ol></li><li>Initialize the golang module by going <code>go mod init splunk.conf/workshop/example/jenkinscireceiver</code><ol><li>This will create a file named <code>go.mod</code> which is used to track our direct and indirect dependencies</li><li>Eventually, there will be a <code>go.sum</code> which is the checksum value of the dependencies being imported.</li></ol></li></ol><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your go.mod</span></span></summary><div class=box-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>module splunk.conf/workshop/example/jenkinscireceiver
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>go 1.20</span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=building-the-configuration>Building The Configuration</h2><p>The configuration portion of the component is how the user is able to have their inputs over the component,
so the values that is used for the configuration need to be:</p><ol><li>Intuitive for users to understand what that field controls</li><li>Be explicit in what is required and what is optional</li><li>Reuse common names and fields</li><li>Keep the options simple</li></ol><div class=tab-panel data-tab-group=400479e017cc52107889ef37fee36612><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=bad-config class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("400479e017cc52107889ef37fee36612","bad-config")'>
<span class=tab-nav-text>bad config</span>
</button>
<button data-tab-item=good-config class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("400479e017cc52107889ef37fee36612","good-config")'>
<span class=tab-nav-text>good config</span></button></div><div class=tab-content-container><div data-tab-item=bad-config class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jenkins_server_addr</span><span class=p>:</span><span class=w> </span><span class=l>hostname</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jenkins_server_api_port</span><span class=p>:</span><span class=w> </span><span class=m>8089</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>filter_builds_by</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-awesome-build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class=l>amber</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>track</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.1</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.2</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.3</span><span class=p>:</span><span class=w> </span><span class=kc>no</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.4</span><span class=p>:</span><span class=w> </span><span class=kc>no</span></span></span></code></pre></div></div></div><div data-tab-item=good-config class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Required Values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=l>http://my-jenkins-server:8089</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>auth</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>authenticator</span><span class=p>:</span><span class=w> </span><span class=l>basicauth/jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Optional Values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.3</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.4</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div></div></div></div></div><p>The bad configuration highlights how doing the opposite of the recommendations of configuration practices impacts the usability
of the component. It doesn&rsquo;t make it clear what field values should be, it includes features that can be pushed to existing processors,
and the field naming is not consistent with other components that exist in the collector.</p><p>The good configuration keeps the required values simple, reuses field names from other components, and ensures the component focuses on
just the interaction between Jenkins and the collector.</p><p>The code tab shows how much is required to be added by us and what is already provided for us by shared libraries within the collector.
These will be explained in more detail once we get to the business logic. The configuration should start off small and will change
once the business logic has started to include additional features that is needed.</p><h2 id=write-the-code>Write the code</h2><p>In order to implement the code needed for the configuration, we are going to create a new file named <code>config.go</code> with the following content:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HTTPClientSettings contains all the values
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that are commonly shared across all HTTP interactions
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// performed by the collector.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>confighttp</span><span class=p>.</span><span class=nx>HTTPClientSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ScraperControllerSettings will allow us to schedule 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// how often to check for updates to builds.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// MetricsBuilderConfig contains all the metrics
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that can be configured.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=component-review>Component Review</h2><p>To recap the type of component we will need to capture metrics from Jenkins:</p><div class=tab-panel data-tab-group=7866dff98d69f23e359e676740f64664><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=extension class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7866dff98d69f23e359e676740f64664","extension")'>
<span class=tab-nav-text>Extension</span>
</button>
<button data-tab-item=receiver class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7866dff98d69f23e359e676740f64664","receiver")'>
<span class=tab-nav-text>Receiver</span>
</button>
<button data-tab-item=processor class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7866dff98d69f23e359e676740f64664","processor")'>
<span class=tab-nav-text>Processor</span>
</button>
<button data-tab-item=exporter class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7866dff98d69f23e359e676740f64664","exporter")'>
<span class=tab-nav-text>Exporter</span>
</button>
<button data-tab-item=ninja-connectors class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7866dff98d69f23e359e676740f64664","ninja-connectors")'>
<span class=tab-nav-text><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Connectors</span></span></span></button></div><div class=tab-content-container><div data-tab-item=extension class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p>The business use case an extension helps solves for are:</p><ol><li>Having shared functionality that requires runtime configuration</li><li>Indirectly helps with observing the runtime of the collector</li></ol><p>See <a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/2-extensions/index.html><strong>Extensions Overview</strong></a> for more details.</p></div></div><div data-tab-item=receiver class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The business use case a receiver solves for:</p><ul><li>Fetching data from a remote source</li><li>Receiving data from remote source(s)</li></ul><p>This is commonly referred to <em>pull</em> vs <em>push</em> based data collection, and you read more about the details in the <a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/3-receivers/index.html>Receiver Overview</a>.</p></div></div><div data-tab-item=processor class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The business use case a processor solves for is:</p><ul><li>Adding or removing data, fields, or values</li><li>Observing and making decisions on the data</li><li>Buffering, queueing, and reordering</li></ul><p>The thing to keep in mind is the data type flowing through a processor needs to forward
the same data type to its downstream components. Read through <a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/4-processors/index.html>Processor Overview</a> for the details.</p></div></div><div data-tab-item=exporter class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The business use case an exporter solves for:</p><ul><li>Send the data to a tool, service, or storage</li></ul><p>The OpenTelemetry collector does not want to be &ldquo;backend&rdquo;, an all-in-one observability suite, but rather
keep to the principles that founded OpenTelemetry to begin with; A vendor agnostic Observability for all.
To help revisit the details, please read through <a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/5-exporters/index.html><strong>Exporter Overview</strong></a>.</p></div></div><div data-tab-item=ninja-connectors class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>This is a component type that was missed in the workshop since it is a relatively new addition to the collector, but the best way to think about a connector is that it is like a processor that allows it to be used across different telemetry types and pipelines. Meaning that a connector can accept data as logs, and output metrics, or accept metrics from one pipeline and provide metrics on the data it has observed.</p><p>The business case that a connector solves for:</p><ul><li>Converting from different telemetry types<ul><li>logs to metrics</li><li>traces to metrics</li><li>metrics to logs</li></ul></li><li>Observing incoming data and producing its own data<ul><li>Accepting metrics and generating analytical metrics of the data.</li></ul></li></ul><p>There was a brief overview within the <strong>Ninja</strong> section as part of the <a href=/observability-workshop/v5.76/en/ninja-workshops/3-opentelemetry-collector/4-processors/index.html>Processor Overview</a>,
and be sure what the project for updates for new connector components.</p></div></div></div></div><p>From the component overviews, it is clear that developing a pull-based receiver for Jenkins.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h3 id=designing-the-metrics>Designing The Metrics</h3><p>To help define and export the metrics captured by our receiver, we will be using, <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/cmd/mdatagen rel=external target=_blank><strong>mdatagen</strong></a>, a tool developed for the collector that turns YAML defined metrics into code.</p><div class=tab-panel data-tab-group=b0c6b4c549a00eaf0b3d661a2585a999><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=metadatayaml class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b0c6b4c549a00eaf0b3d661a2585a999","metadatayaml")'>
<span class=tab-nav-text>metadata.yaml</span>
</button>
<button data-tab-item=gengo class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("b0c6b4c549a00eaf0b3d661a2585a999","gengo")'>
<span class=tab-nav-text>gen.go</span></button></div><div class=tab-content-container><div data-tab-item=metadatayaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Type defines the name to reference the component</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># in the configuration file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Status defines the component type and the stability level</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class=l>receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stability</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>development</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>metrics]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Attributes are the expected fields reported</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># with the exported values.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>job.name</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The name of the associated Jenkins job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>job.status</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Shows if the job had passed, or failed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enum</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>failed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>success</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>unknown</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Metrics defines all the pontentially exported values from this receiver. </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.jobs.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Provides a count of the total number of configured jobs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{Count}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.job.duration</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Show the duration of the job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.status</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.job.commit_delta</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The calculation difference of the time job was finished minus commit timestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.status</span></span></span></code></pre></div></div></div><div data-tab-item=gengo class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// To generate the additional code needed to capture metrics, 
</span></span></span><span class=line><span class=cl><span class=c1>// the following command to be run from the shell:
</span></span></span><span class=line><span class=cl><span class=c1>//  go generate -x ./...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>//go:generate go run github.com/open-telemetry/opentelemetry-collector-contrib/cmd/mdatagen@v0.80.0 metadata.yaml
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// There is no code defined within this file.
</span></span></span></code></pre></div></div></div></div></div><p>Create these files within the project folder before continuing onto the next section.</p><h2 id=building-the-factory>Building The Factory</h2><p>The Factory is a software design pattern that effectively allows for an object, in this case a <code>jenkinscireceiver</code>, to be created dynamically with the provided configuration. To use a more real-world example, it would be going to a phone store, asking for a phone
that matches your exact description, and then providing it to you.</p><p>Run the following command <code>go generate -x ./...</code> , it will create a new folder, <code>jenkinscireceiver/internal/metadata</code>, that contains all code required to export the defined metrics. The required code is:</p><div class=tab-panel data-tab-group=8ebff40f2869c0c56e689a3ced1e3326><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=factorygo class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8ebff40f2869c0c56e689a3ced1e3326","factorygo")'>
<span class=tab-nav-text>factory.go</span>
</button>
<button data-tab-item=configgo class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("8ebff40f2869c0c56e689a3ced1e3326","configgo")'>
<span class=tab-nav-text>config.go</span>
</button>
<button data-tab-item=scrapergo class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("8ebff40f2869c0c56e689a3ced1e3326","scrapergo")'>
<span class=tab-nav-text>scraper.go</span>
</button>
<button data-tab-item=build-configyaml class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("8ebff40f2869c0c56e689a3ced1e3326","build-configyaml")'>
<span class=tab-nav-text>build-config.yaml</span>
</button>
<button data-tab-item=project-layout class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("8ebff40f2869c0c56e689a3ced1e3326","project-layout")'>
<span class=tab-nav-text>project layout</span></button></div><div class=tab-content-container><div data-tab-item=factorygo class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;errors&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/component&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewFactory</span><span class=p>()</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>Factory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>receiver</span><span class=p>.</span><span class=nf>NewFactory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>newDefaultConfig</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>receiver</span><span class=p>.</span><span class=nf>WithMetrics</span><span class=p>(</span><span class=nx>newMetricsReceiver</span><span class=p>,</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsStability</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newMetricsReceiver</span><span class=p>(</span><span class=nx>_</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>,</span> <span class=nx>cfg</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>consumer</span> <span class=nx>consumer</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>)</span> <span class=p>(</span><span class=nx>receiver</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Convert the configuration into the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>conf</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>cfg</span><span class=p>.(</span><span class=o>*</span><span class=nx>Config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>!</span><span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;can not convert config&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>sc</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>conf</span><span class=p>,</span> <span class=nx>set</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraperControllerReceiver</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=o>&amp;</span><span class=nx>conf</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>set</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>consumer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>AddScraper</span><span class=p>(</span><span class=nx>sc</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=configgo class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HTTPClientSettings contains all the values
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that are commonly shared across all HTTP interactions
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// performed by the collector.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>confighttp</span><span class=p>.</span><span class=nx>HTTPClientSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ScraperControllerSettings will allow us to schedule 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// how often to check for updates to builds.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// MetricsBuilderConfig contains all the metrics
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that can be configured.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newDefaultConfig</span><span class=p>()</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Config</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&amp;</span><span class=nx>Config</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ScraperControllerSettings</span><span class=p>:</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewDefaultScraperControllerSettings</span><span class=p>(</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>HTTPClientSettings</span><span class=p>:</span>        <span class=nx>confighttp</span><span class=p>.</span><span class=nf>NewDefaultHTTPClientSettings</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>MetricsBuilderConfig</span><span class=p>:</span>      <span class=nx>metadata</span><span class=p>.</span><span class=nf>DefaultMetricsBuilderConfig</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=scrapergo class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>scraper</span> <span class=kd>struct</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>)</span> <span class=p>(</span><span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>Scraper</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Create a our scraper with our values 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span> <span class=o>:=</span> <span class=nx>scraper</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// To be filled in later
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraper</span><span class=p>(</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span> <span class=nx>s</span><span class=p>.</span><span class=nx>scrape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>pmetrics</span><span class=p>.</span><span class=nf>NewMetrics</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=build-configyaml class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>dist</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otelcol</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Conf workshop collector&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>output_path</span><span class=p>:</span><span class=w> </span><span class=l>./dist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=l>v0.0.0-experimental</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/basicauthextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/healthcheckextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/receiver/otlpreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/jaegerreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/prometheusreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>splunk.conf/workshop/example/jenkinscireceiver v0.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./jenkinscireceiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/batchprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/loggingexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlphttpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># This replace is a go directive that allows for redefine</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># where to fetch the code to use since the default would be from a remote project.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>replaces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=l>splunk.conf/workshop/example/jenkinscireceiver =&gt; ./jenkinscireceiver</span></span></span></code></pre></div></div></div><div data-tab-item=project-layout class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>├── build-config.yaml
</span></span><span class=line><span class=cl>└── jenkinscireceiver
</span></span><span class=line><span class=cl>    ├── go.mod
</span></span><span class=line><span class=cl>    ├── config.go
</span></span><span class=line><span class=cl>    ├── factory.go
</span></span><span class=line><span class=cl>    ├── scraper.go
</span></span><span class=line><span class=cl>    └── internal
</span></span><span class=line><span class=cl>      └── metadata</span></span></code></pre></div></div></div></div></div><p>Once you have written these files into the project with the expected contents run, <code>go mod tidy</code>, which will fetch all the remote dependencies and update <code>go.mod</code> and generate the <code>go.sum</code> files.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=building-the-business-logic>Building The Business Logic</h2><p>At this point, we have a custom component that currently does nothing so we need to add in the required
logic to capture this data from Jenkins.</p><p>From this point, the steps that we need to take are:</p><ol><li>Create a client that connect to Jenkins</li><li>Capture all the configured jobs</li><li>Report the status of the last build for the configured job</li><li>Calculate the time difference between commit timestamp and job completion.</li></ol><p>The changes will be made to <code>scraper.go</code>.</p><div class=tab-panel data-tab-group=35e7524fd051c56c50df541a86cc5dcb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=add-jenkins-client class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("35e7524fd051c56c50df541a86cc5dcb","add-jenkins-client")'>
<span class=tab-nav-text><ol><li>Add Jenkins client</li></ol></span></button>
<button data-tab-item=capture-all-configured-jobs class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("35e7524fd051c56c50df541a86cc5dcb","capture-all-configured-jobs")'>
<span class=tab-nav-text><ol start=2><li>Capture all configured jobs</li></ol></span></button>
<button data-tab-item=report-the-status-of-each-job class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("35e7524fd051c56c50df541a86cc5dcb","report-the-status-of-each-job")'>
<span class=tab-nav-text><ol start=3><li>Report the status of each job</li></ol></span></button>
<button data-tab-item=report-the-delta class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("35e7524fd051c56c50df541a86cc5dcb","report-the-delta")'>
<span class=tab-nav-text><ol start=4><li>Report the delta</li></ol></span></button></div><div class=tab-content-container><div data-tab-item=add-jenkins-client class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p>To be able to connect to the Jenkins server, we will be using the package,
<a href=https://pkg.go.dev/github.com/yosida95/golang-jenkins rel=external target=_blank>&ldquo;github.com/yosida95/golang-jenkins&rdquo;</a>,
which provides the functionality required to read data from the jenkins server.</p><p>Then we are going to utilise some of the helper functions from the,
<a href=https://pkg.go.dev/go.opentelemetry.io/collector/receiver/scraperhelper rel=external target=_blank>&ldquo;go.opentelemetry.io/collector/receiver/scraperhelper&rdquo;</a> ,
library to create a start function so that we can connect to the Jenkins server once component has finished starting.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>jenkins</span> <span class=s>&#34;github.com/yosida95/golang-jenkins&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/component&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/pdata/pmetric&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>scraper</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>mb</span>     <span class=o>*</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilder</span>
</span></span><span class=line><span class=cl>    <span class=nx>client</span> <span class=o>*</span><span class=nx>jenkins</span><span class=p>.</span><span class=nx>Jenkins</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>)</span> <span class=p>(</span><span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>Scraper</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>scraper</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>mb</span> <span class=p>:</span> <span class=nx>metadata</span><span class=p>.</span><span class=nf>NewMetricsBuilder</span><span class=p>(</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span><span class=p>,</span> <span class=nx>set</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraper</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>scrape</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>WithStart</span><span class=p>(</span><span class=kd>func</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>h</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Host</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>client</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>cfg</span><span class=p>.</span><span class=nf>ToClient</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>set</span><span class=p>.</span><span class=nx>TelemetrySettings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=c1>// The collector provides a means of injecting authentication
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// on our behalf, so this will ignore the libraries approach
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// and use the configured http client with authentication.
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>s</span><span class=p>.</span><span class=nx>client</span> <span class=p>=</span> <span class=nx>jenkins</span><span class=p>.</span><span class=nf>NewJenkins</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>Endpoint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>SetHTTPClient</span><span class=p>(</span><span class=nx>client</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nf>NewMetrics</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>This finishes all the setup code that is required in order to initialise a Jenkins receiver.</p></div></div><div data-tab-item=capture-all-configured-jobs class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>From this point on, we will be focuses on the <code>scrape</code> method that has been waiting to be filled in.
This method will be run on each interval that is configured within the configuration (by default, every minute).</p><p>The reason we want to capture the number of jobs configured so we can see the growth of our Jenkins server,
and measure of many projects have onboarded. To do this we will call the jenkins client to list all jobs,
and if it reports an error, return that with no metrics, otherwise, emit the data from the metric builder.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// all captured data points within this scrape have the same value. 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=report-the-status-of-each-job class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>In the last step, we were able to capture all jobs ands report the number of jobs
there was. Within this step, we are going to examine each job and use the report values
to capture metrics.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// all captured data points within this scrape have the same value. 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>job</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>jobs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure we have valid results to start off with
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>build</span>  <span class=p>=</span> <span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// This will check the result of the job, however,
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// since the only defined attributes are 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// `success`, `failure`, and `unknown`. 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// it is assume that anything did not finish 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// with a success or failure to be an unknown status.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=nx>build</span><span class=p>.</span><span class=nx>Result</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;aborted&#34;</span><span class=p>,</span> <span class=s>&#34;not_built&#34;</span><span class=p>,</span> <span class=s>&#34;unstable&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;success&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusSuccess</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;failure&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusFailed</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobDurationDataPoint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>now</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>int64</span><span class=p>(</span><span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span><span class=p>.</span><span class=nx>Duration</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>job</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=report-the-delta class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The final step is to calculate how long it took from
commit to job completion to help infer our DORA metrics.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// all captured data points within this scrape have the same value. 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>job</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>jobs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure we have valid results to start off with
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>build</span>  <span class=p>=</span> <span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Previous step here
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure that the `ChangeSet` has values
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// set so there is a valid value for us to reference
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>build</span><span class=p>.</span><span class=nx>ChangeSet</span><span class=p>.</span><span class=nx>Items</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Making the assumption that the first changeset
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// item is the most recent change.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>change</span> <span class=o>:=</span> <span class=nx>build</span><span class=p>.</span><span class=nx>ChangeSet</span><span class=p>.</span><span class=nx>Items</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Record the difference from the build time
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// compared against the change timestamp.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobCommitDeltaDataPoint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>now</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>int64</span><span class=p>(</span><span class=nx>build</span><span class=p>.</span><span class=nx>Timestamp</span><span class=o>-</span><span class=nx>change</span><span class=p>.</span><span class=nx>Timestamp</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>job</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>Once all of these steps have been completed, you now have built a custom Jenkins CI receiver!</p><h2 id=whats-next>Whats next?</h2><p>There are more than likely features that would be desired from component that you can think of, like:</p><ul><li>Can I include the branch name that the job used?</li><li>Can I include the project name for the job?</li><li>How I calculate the collective job durations for project?</li><li>How do I validate the changes work?</li></ul><p>Please take this time to play around, break it, change things around, or even try to capture logs from the builds.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=splunk-synthetic-scripting>Splunk Synthetic Scripting</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>45 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Robert Castley</span></span><p>Proactively monitor the performance of your web app before problems affect your users. With <strong>Splunk Synthetic Monitoring</strong>, technical and business teams create detailed tests to proactively monitor the speed and reliability of websites, web apps, and resources over time, at any stage in the development cycle.</p><p><strong>Splunk Synthetic Monitoring</strong> offers the most comprehensive and in-depth capabilities for uptime and web performance optimization as part of the only complete observability suite, Splunk Observability Cloud.</p><p>Easily set up monitoring for APIs, service endpoints and end-user experience. With <strong>Splunk Synthetic Monitoring</strong>, go beyond basic uptime and performance monitoring and focus on proactively finding and fixing issues, optimizing web performance, and ensuring customers get the best user experience.</p><p>With <strong>Splunk Synthetic Monitoring</strong> you can:</p><ul><li>Detect and resolve issues fast across critical user flows, business transactions and API endpoints</li><li>Prevent web performance issues from affecting customers with an intelligent web optimization engine</li><li>And improve the performance of all page resources and third-party dependencies</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Splunk Synthetic Scripting</h1><article class=default><header class=headline></header><h1 id=1-real-browser-test>1. Real Browser Test</h1><h2 id=introduction>Introduction</h2><p>This workshop walks you through using the <a href=https://developer.chrome.com/docs/devtools/recorder/ rel=external target=_blank>Chrome DevTools Recorder</a> to create a synthetic transaction against a Splunk demonstration instance.</p><p>The exported JSON from the Chrome DevTools Recorder will then be used to create a Splunk Synthetic Monitoring Real Browser Test.</p><p>In addition, you will also get to learn other Splunk Synthetic Monitoring checks like <a href=https://docs.splunk.com/Observability/synthetics/api-test/api-test.html rel=external target=_blank>API Test</a> and <a href=https://docs.splunk.com/Observability/synthetics/uptime-test/uptime-test.html rel=external target=_blank>Uptime Test</a>.</p><h2 id=pre-requisites>Pre-requisites</h2><ul><li>Google Chrome Browser installed</li><li>Access to Splunk Observability Cloud</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Real Browser Test</h1><article class=default><header class=headline></header><h1 id=11-recording-a-test>1.1 Recording a test</h1><h2 id=open-the-starting-url>Open the starting URL</h2><p>Open the starting URL for the workshop in Chrome. Click on the appropriate link below to open the site in a new tab.</p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>The starting URL for the workshop is different for <strong>EMEA</strong> and <strong>AMER/APAC</strong>. Please use the correct URL for your region.</p><div class=tab-panel data-tab-group=34c954fb4902b5ec356c0fcf902e6756><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=emea-workshop-url class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("34c954fb4902b5ec356c0fcf902e6756","emea-workshop-url")'>
<span class=tab-nav-text>EMEA Workshop URL</span>
</button>
<button data-tab-item=amerapac-workshop-url class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("34c954fb4902b5ec356c0fcf902e6756","amerapac-workshop-url")'>
<span class=tab-nav-text>AMER/APAC Workshop URL</span></button></div><div class=tab-content-container><div data-tab-item=emea-workshop-url class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><a href=https://online-boutique-eu.splunko11y.com/ rel=external target=_blank>https://online-boutique-eu.splunko11y.com/</a></p></div></div><div data-tab-item=amerapac-workshop-url class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><a href=https://online-boutique-us.splunko11y.com/ rel=external target=_blank>https://online-boutique-us.splunko11y.com/</a></p></div></div></div></div></div></details><h2 id=open-the-chrome-devtools-recorder>Open the Chrome DevTools Recorder</h2><p>Next, open the Developer Tools (in the new tab that was opened above) by pressing <code>Ctrl + Shift + I</code> on Windows or <code>Cmd + Option + I</code> on a Mac, then select <strong>Recorder</strong> from the top-level menu or the <strong>More tools</strong> flyout menu.</p><p><a href=#R-image-2a8970bcc3d11233debe2844b3978317 class=lightbox-link><img alt="Open Recorder" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/open-recorder.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2a8970bcc3d11233debe2844b3978317><img alt="Open Recorder" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/open-recorder.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>Site elements might change depending on viewport width. Before recording, set your browser window to the correct width for the test you want to create (Desktop, Tablet, or Mobile). Change the DevTools &ldquo;dock side&rdquo; to pop out as a separate window if it helps.</p></div></details><h2 id=create-a-new-recording>Create a new recording</h2><p>With the Recorder panel open in the DevTools window. Click on the <span class="btn cstyle blue"><span><span class=title>Create a new recording</span></span></span> button to start.</p><p><a href=#R-image-dd80afa054881eb2cdf003d677181f43 class=lightbox-link><img alt=Recorder class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/recorder.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dd80afa054881eb2cdf003d677181f43><img alt=Recorder class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/recorder.png></a></p><p>For the <strong>Recording Name</strong> use your initials to prefix the name of the recording e.g. <strong><code>&lt;your initials></code> - Online Boutique</strong>. Click on <strong>Start Recording</strong> to start recording your actions.</p><p><a href=#R-image-f366393a0e49c420edec1df5ba9f7991 class=lightbox-link><img alt="Recording Name" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/recording-name.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f366393a0e49c420edec1df5ba9f7991><img alt="Recording Name" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/recording-name.png></a></p><p>Now that we are recording, complete the following actions on the site:</p><ul><li>Click on <strong>Vintage Camera Lens</strong></li><li>Click on <strong>Add to Cart</strong></li><li>Click on <strong>Place Order</strong></li><li>Click on <strong>End recording</strong> in the Recorder panel.</li></ul><p><a href=#R-image-c4693fb497215740539f23de00415772 class=lightbox-link><img alt="End Recording" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/end-recording.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c4693fb497215740539f23de00415772><img alt="End Recording" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/end-recording.png></a></p><h2 id=exporting-the-recording>Exporting the recording</h2><p>Click on the <strong>Export</strong> button:</p><p><a href=#R-image-731114acc2e25d381c8328816392ebee class=lightbox-link><img alt="Export button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/export-button.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-731114acc2e25d381c8328816392ebee><img alt="Export button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/export-button.png></a></p><p>Select <strong>JSON</strong> as the format, then click on <strong>Save</strong></p><p><a href=#R-image-039533dd0b9cca1e82869b39c5208647 class=lightbox-link><img alt="Export JSON" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/export-json.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-039533dd0b9cca1e82869b39c5208647><img alt="Export JSON" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/export-json.png></a></p><p><a href=#R-image-2dac50e5e46a1b4a9fcc4ae720013689 class=lightbox-link><img alt="Save JSON" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/save-json.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2dac50e5e46a1b4a9fcc4ae720013689><img alt="Save JSON" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/save-json.png></a></p><p><strong>Congratulations!</strong> You have successfully created a recording using the Chrome DevTools Recorder. Next, we will use this recording to create a Real Browser Test in Splunk Synthetic Monitoring.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
Click here to view the JSON file</summary><div class=box-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;RWC - Online Boutique&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;setViewport&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;width&#34;</span><span class=p>:</span> <span class=mi>1430</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;height&#34;</span><span class=p>:</span> <span class=mi>1016</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;deviceScaleFactor&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;isMobile&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;hasTouch&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;isLandscape&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;Online Boutique&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;div:nth-of-type(2) &gt; div:nth-of-type(2) a &gt; div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div/div/div[2]/div[2]/div/a/div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/div:nth-of-type(2) &gt; div:nth-of-type(2) a &gt; div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mi>170</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mi>180</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/product/66VCHSJNUP&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;aria/ADD TO CART&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div[1]/div/div[2]/div/form/div/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;text/Add to Cart&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mf>35.0078125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mf>46.4140625</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/cart&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;aria/PLACE ORDER&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;div &gt; div &gt; div.py-3 button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div/div/div[4]/div/form/div[4]/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/div &gt; div &gt; div.py-3 button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;text/Place order&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mf>29.8125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mf>66.8203125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/cart/checkout&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=12-create-real-browser-test>1.2 Create Real Browser Test</h1><p>In Splunk Observability Cloud, navigate to <strong>Synthetics</strong> and click on <span class="btn cstyle blue"><span><span class=title>Add new test</span></span></span>.</p><p>From the dropdown select <strong>Browser test</strong>.</p><p><a href=#R-image-7a7060bc77d603f8c3deddc17dd2591f class=lightbox-link><img alt="Add new test" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/add-new-test.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a7060bc77d603f8c3deddc17dd2591f><img alt="Add new test" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/add-new-test.png></a></p><p>You will then be presented with the <strong>Browser test content</strong> configuration page.</p><p><a href=#R-image-407e55307961cebebf6182b6d618c7c9 class=lightbox-link><img alt="New Test" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/new-test.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-407e55307961cebebf6182b6d618c7c9><img alt="New Test" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/new-test.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=13-import-json>1.3 Import JSON</h1><p>To begin configuring our test, we need to import the JSON that we exported from the Chrome DevTools Recorder. To enable the <span class="btn cstyle transparent"><span><span class=title><strong>Import</strong></span></span></span> button, we must first give our test a name e.g. <strong><code>&lt;your initials></code> - Online Boutique</strong>.</p><p><a href=#R-image-c84173973303a941fbfc8962d847ea1a class=lightbox-link><img alt=Import class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/import.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c84173973303a941fbfc8962d847ea1a><img alt=Import class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/import.png></a></p><p>Once the <span class="btn cstyle transparent"><span><span class=title><strong>Import</strong></span></span></span> button is enabled, click on it and either drop the JSON file that you exported from the Chrome DevTools Recorder or upload the file.</p><p><a href=#R-image-bbc6ed6b6976d99e1e6d095851fd468d class=lightbox-link><img alt="Import JSON" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/import-json.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bbc6ed6b6976d99e1e6d095851fd468d><img alt="Import JSON" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/import-json.png></a></p><p>Once the JSON file has been uploaded, click on <span class="btn cstyle blue"><span><span class=title>Continue to edit steps</span></span></span></p><p><a href=#R-image-d181d3c92363da3443afe919d6e33c80 class=lightbox-link><img alt="Import Complete" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/import-complete.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d181d3c92363da3443afe919d6e33c80><img alt="Import Complete" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/import-complete.png></a></p><p><a href=#R-image-ec43a272e7278726d3a34533c87e8eea class=lightbox-link><img alt="Edit Steps" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/edit-steps.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ec43a272e7278726d3a34533c87e8eea><img alt="Edit Steps" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/edit-steps.png></a></p><p>Before we make any edits to the test, let&rsquo;s first configure the settings, click on <span class="btn cstyle blue"><span><span class=title>&lt; Return to test</span></span></span></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=14-settings>1.4 Settings</h1><p>The simple settings allow you to configure the basics of the test:</p><ul><li><strong>Name</strong>: The name of the test (e.g. RWC - Online Boutique).</li><li><strong>Details</strong>:<ul><li><strong>Locations</strong>: The locations where the test will run from.</li><li><strong>Device</strong>: Emulate different devices and connection speeds. Also, the viewport will be adjusted to match the chosen device.</li><li><strong>Frequency</strong>: How often the test will run.</li><li><strong>Round-robin</strong>: If multiple locations are selected, the test will run from one location at a time, rather than all locations at once.</li><li><strong>Active</strong>: Set the test to active or inactive.</li></ul></li></ul><p>![Return to Test]For this workshop, we will configure the locations that we wish to monitor from. Click in the <strong>Locations</strong> field and you will be presented with a list of global locations (over 50 in total).</p><p><a href=#R-image-58c350e9e4f284814280f669bdcfea9d class=lightbox-link><img alt="Global Locations" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/global-locations.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-58c350e9e4f284814280f669bdcfea9d><img alt="Global Locations" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/global-locations.png></a></p><p>Select the following locations:</p><ul><li><strong>AWS - N. Virginia</strong></li><li><strong>AWS - London</strong></li><li><strong>AWS - Melbourne</strong></li></ul><p>Once complete, scroll down and click on Click on <span class="btn cstyle blue"><span><span class=title>Submit</span></span></span> to save the test.</p><p>The test will now be scheduled to run every 5 minutes from the 3 locations that we have selected. This does take a few minutes for the schedule to be created.</p><p>So whilst we wait for the test to be scheduled, click on <span class="btn cstyle transparent"><span><span class=title>Edit test</span></span></span> so we can go through the Advanced settings.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=15-advanced-settings>1.5 Advanced Settings</h1><p>Click on <strong>Advanced</strong>, these settings are optional and can be used to further configure the test.</p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>In the case of this workshop, we will <strong>not</strong> be using any of these settings as this is for informational purposes only.</p></div></details><p><a href=#R-image-ac51099cbf8aee9456161e1d0bd9f551 class=lightbox-link><img alt="Advanced Settings" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/advanced-settings.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ac51099cbf8aee9456161e1d0bd9f551><img alt="Advanced Settings" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/advanced-settings.png></a></p><ul><li><strong>Security</strong>:<ul><li><strong>TLS/SSL validation</strong>: When activated, this feature is used to enforce the validation of expired, invalid hostname, or untrusted issuer on SSL/TLS certificates.</li><li><strong>Authentication</strong>: Add credentials to authenticate with sites that require additional security protocols, for example from within a corporate network. By using <a href=https://docs.splunk.com/Observability/synthetics/test-config/global-variables.html rel=external target=_blank>concealed global variables</a> in the Authentication field, you create an additional layer of security for your credentials and simplify the ability to share credentials across checks.</li></ul></li><li><strong>Custom Content</strong>:<ul><li><strong>Custom headers</strong>: Specify custom headers to send with each request. For example, you can add a header in your request to filter out requests from analytics on the back end by sending a specific header in the requests. You can also use custom headers to set cookies.</li><li><strong>Cookies</strong>: Set cookies in the browser before the test starts. For example, to prevent a popup modal from randomly appearing and interfering with your test, you can set cookies. Any cookies that are set will apply to the domain of the starting URL of the check. Splunk Synthetics Monitoring uses the public suffix list to determine the domain.</li><li><strong>Host overrides</strong>: Add host override rules to reroute requests from one host to another. For example, you can create a host override to test an existing production site against page resources loaded from a development site or a specific CDN edge node.</li></ul></li></ul><p>Next, we will edit the test steps to provide more meaningful names for each step.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=16-edit-test-steps>1.6 Edit test steps</h1><p>To edit the steps click on the <span class="btn cstyle transparent"><span><span class=title>+ Edit steps or synthetic transactions</span></span></span> button. From here, we are going to give meaningful names to each step.</p><p><a href=#R-image-d4e02056cd2d9a1a67d39aea0b3881dc class=lightbox-link><img alt="Edit steps" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/edit-steps.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d4e02056cd2d9a1a67d39aea0b3881dc><img alt="Edit steps" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/edit-steps.png></a></p><p>For each of the four steps, we are going to give them a meaningful name.</p><ul><li><strong>Step 1</strong> replace the text <strong>Go to URL</strong> with <strong>HomePage - Online Boutique</strong></li><li><strong>Step 2</strong> enter the text <strong>Select Vintage Camera Lens</strong>.</li><li><strong>Step 3</strong> enter <strong>Add to Cart</strong>.</li><li><strong>Step 4</strong> enter <strong>Place Order</strong>.</li></ul><p><a href=#R-image-9ccbe79118a2c46bec49beedc48558e6 class=lightbox-link><img alt="Step names" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/step-names.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9ccbe79118a2c46bec49beedc48558e6><img alt="Step names" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/step-names.png></a></p><p>Click <span class="btn cstyle blue"><span><span class=title>&lt; Return to test</span></span></span> to return to the test configuration page and click <span class="btn cstyle blue"><span><span class=title>Save</span></span></span> to save the test.</p><p>You will be returned to the test dashboard where you will see test results start to appear.</p><p><a href=#R-image-b90149b7bd752e14e5ec225950f52eab class=lightbox-link><img alt=Scatterplot class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/scatterplot.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b90149b7bd752e14e5ec225950f52eab><img alt=Scatterplot class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/scatterplot.png></a></p><p><strong>Congratulations!</strong> You have successfully created a Real Browser Test in Splunk Synthetic Monitoring. Next, we will look into a test result in more detail.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=17-view-test-results>1.7 View test results</h1><p>In the Scatterplot from the previous step, click on one of the dots to drill into the test run data. Preferably, select the most recent test run (farthest to the right).</p><p><a href=#R-image-99c237b116473ccd109427c1df73d41a class=lightbox-link><img alt=Drilldown class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/drilldown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-99c237b116473ccd109427c1df73d41a><img alt=Drilldown class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/drilldown.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=api-test>API Test</h1><p>The API Test provides a flexible way to check the functionality and performance of API endpoints. The shift toward API-first development has magnified the necessity to monitor the back-end services that provide your core front-end functionality.</p><p>Whether you&rsquo;re interested in testing the multi-step API interactions or you want to gain visibility into the performance of your endpoints, the API Test can help you accomplish your goals.</p><p><a href=#R-image-06c27250c472209dd51f058d93b1ad64 class=lightbox-link><img alt="API test result" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../img/api-test-result.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-06c27250c472209dd51f058d93b1ad64><img alt="API test result" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../img/api-test-result.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. API Test</h1><article class=default><header class=headline></header><h1 id=global-variables>Global Variables</h1><h2 id=global-variables>Global Variables</h2><p>View the global variable that we&rsquo;ll use to perform our API test. Click on <strong>Global Variables</strong> under the cog. The global variable named <code>env.encoded_auth</code> will be the one that we&rsquo;ll use to build the spotify API transaction.</p><p><a href=#R-image-af091da7bd10ca175c5c10be2dddc69c class=lightbox-link><img alt=placeholder class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/global-variables.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af091da7bd10ca175c5c10be2dddc69c><img alt=placeholder class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/global-variables.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-new-api-test>Create new API test</h1><h2 id=create-a-new-api-test>Create a new API test</h2><p>Create a new API test by clicking on the <span class="btn cstyle blue"><span><span class=title>Add new test</span></span></span> button and select <strong>API test</strong> from the dropdown. Name the test using <strong>your initials</strong> followed by <strong>Spotify API</strong> e.g. <strong>RWC - Spotify API</strong></p><p><a href=#R-image-1493824f082d4d74d5fd9057ab2eb55f class=lightbox-link><img alt=placeholder class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/new-api-check.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1493824f082d4d74d5fd9057ab2eb55f><img alt=placeholder class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/new-api-check.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=authentication-request>Authentication Request</h1><h2 id=add-authentication-request>Add Authentication Request</h2><p>Click on <span class="btn cstyle transparent"><span><span class=title>+ Add requests</span></span></span> and enter the request step name e.g. <strong>Authenticate with Spotify API</strong>.</p><p><a href=#R-image-325202d28eaf10888a8c19c51f398458 class=lightbox-link><img alt=placeholder class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/add-request.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-325202d28eaf10888a8c19c51f398458><img alt=placeholder class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/add-request.png></a></p><p>Expand the Request section, from the drop-down change the request method to <strong>POST</strong> and enter the following URL:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://accounts.spotify.com/api/token</span></span></code></pre></div><p>In the <strong>Payload body</strong> section enter the following:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>grant_type=client_credentials</span></span></code></pre></div><p>Next, add two request headers with the following key/value pairings:</p><ul><li><strong>CONTENT-TYPE: application/x-www-form-urlencoded</strong></li><li><strong>AUTHORIZATION: Basic {{env.encoded_auth}}</strong></li></ul><p>Expand the <strong>Validation</strong> section and add the following extraction:</p><ul><li><strong>Extract</strong> from <strong>Response body</strong> <strong>JSON</strong> <strong>$.access_token</strong> <strong>as</strong> <strong>access_token</strong>.</li></ul><p>This will parse the JSON payload that is received from the Spotify API, extract the access token and store it as a custom variable.</p><p><a href=#R-image-9bb7a84d3e45d416c819fddd464f5575 class=lightbox-link><img alt="Add payload token" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/add-payload-token.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9bb7a84d3e45d416c819fddd464f5575><img alt="Add payload token" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/add-payload-token.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=search-request>Search Request</h1><h2 id=add-search-request>Add Search Request</h2><p>Click on <span class="btn cstyle transparent"><span><span class=title>+ Add Request</span></span></span> to add the next step. Name the step <strong>Search for Tracks named &ldquo;Up around the bend&rdquo;</strong>.</p><p>Expand the <strong>Request</strong> section and change the request method to <strong>GET</strong> and enter the following URL:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://api.spotify.com/v1/search?q=Up%20around%20the%20bend&amp;type=track&amp;offset=0&amp;limit=5</span></span></code></pre></div><p>Next, add two request headers with the following key/value pairings:</p><ul><li><strong>CONTENT-TYPE: application/json</strong></li><li><strong>AUTHORIZATION: Bearer {{custom.access_token}}</strong></li></ul><p><a href=#R-image-61c3f7a91fe652edfe37d0a1ce73816d class=lightbox-link><img alt="Add search request" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/add-search-request.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-61c3f7a91fe652edfe37d0a1ce73816d><img alt="Add search request" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/add-search-request.png></a></p><p>Expand the <strong>Validation</strong> section and add the following extraction:</p><ul><li><strong>Extract</strong> from <strong>Response body</strong> <strong>JSON</strong> <strong>$.tracks.items[0].id</strong> <strong>as</strong> <strong>track.id</strong>.</li></ul><p><a href=#R-image-e7cf08f1b7706ea927cbf46104da3b41 class=lightbox-link><img alt="Add search payload" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/add-search-payload.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e7cf08f1b7706ea927cbf46104da3b41><img alt="Add search payload" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/add-search-payload.png></a></p><p>Click on <span class="btn cstyle blue"><span><span class=title>< Return to test</span></span></span> to return to the test configuration page. And then click <span class="btn cstyle blue"><span><span class=title>Save</span></span></span> to save the API test.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=view-results>View results</h1><h2 id=view-results>View results</h2><p>Wait for a few minutes for the test to provision and run. Once you see the test has run successfully, click on the run to view the test results:</p><p><a href=#R-image-7556d9985bb43eb5fde47321465fb192 class=lightbox-link><img alt="API test result" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../img/api-test-result.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7556d9985bb43eb5fde47321465fb192><img alt="API test result" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../img/api-test-result.png></a></p><h2 id=6-resources>6. Resources</h2><ul><li><p><a href=https://docs.splunk.com/Observability/synthetics/api-test/set-up-api-test.html rel=external target=_blank>How to Create an API Test</a></p></li><li><p><a href=https://docs.splunk.com/Observability/synthetics/api-test/api-test.html rel=external target=_blank>API Test Overview</a></p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=distributed-tracing-for-aws-lambda-functions>Distributed Tracing for AWS Lambda Functions</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>45 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Guy-Francis Kono</span></span><p>This workshop will equip you to build a distributed trace for a small serverless application that runs on AWS Lambda, producing and consuming a message via AWS Kinesis.</p><p>First, we will see how OpenTelemetry&rsquo;s auto-instrumentation captures traces and exports them to your target of choice.</p><p>Then, we will see how we can enable context propagation with manual instrumentation.</p><p>For this workshop Splunk has prepared an Ubuntu Linux instance in AWS/EC2 all pre-configured for you. To get access to that instance, please visit the URL provided by the workshop leader.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 16, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Lambda Tracing</h1><article class=default><header class=headline></header><h1 id=setup>Setup</h1><p><a href=#R-image-d9f402824a96aba31bda069b9067dd77 class=lightbox-link><img alt="Lambda application, not yet manually instrumented" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/01-Architecture.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d9f402824a96aba31bda069b9067dd77><img alt="Lambda application, not yet manually instrumented" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/01-Architecture.png></a></p><h2 id=prerequisites>Prerequisites</h2><h3 id=observability-workshop-instance>Observability Workshop Instance</h3><p>The Observability Workshop is most often completed on a Splunk-issued and preconfigured EC2 instance running Ubuntu.</p><p>Your workshop instructor will provide you with the credentials to your assigned workshop instance.</p><p>Your instance should have the following environment variables already set:</p><ul><li><strong>ACCESS_TOKEN</strong></li><li><strong>REALM</strong><ul><li><em>These are the Splunk Observability Cloud <strong>Access Token</strong> and <strong>Realm</strong> for your workshop.</em></li><li><em>They will be used by the OpenTelemetry Collector to forward your data to the correct Splunk Observability Cloud organization.</em></li></ul></li></ul><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p><em>Alternatively, you can deploy a local observability workshop instance using Multipass.</em></p></div></details><h3 id=aws-command-line-interface-awscli>AWS Command Line Interface (awscli)</h3><p>The AWS Command Line Interface, or <code>awscli</code>, is an API used to interact with AWS resources. In this workshop, it is used by certain scripts to interact with the resource you&rsquo;ll deploy.</p><p>Your Splunk-issued workshop instance should already have the <strong>awscli</strong> installed.</p><ul><li><p>Check if the <strong>aws</strong> command is installed on your instance with the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>which aws</span></span></code></pre></div><ul><li><em>The expected output would be <strong>/usr/local/bin/aws</strong></em></li></ul></li><li><p>If the <strong>aws</strong> command is not installed on your instance, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install awscli</span></span></code></pre></div></li></ul><h3 id=terraform>Terraform</h3><p>Terraform is an Infrastructure as Code (IaC) platform, used to deploy, manage and destroy resource by defining them in configuration files. Terraform employs HCL to define those resources, and supports multiple providers for various platforms and technologies.</p><p>We will be using Terraform at the command line in this workshop to deploy the following resources:</p><ol><li>AWS API Gateway</li><li>Lambda Functions</li><li>Kinesis Stream</li><li>CloudWatch Log Groups</li><li>S3 Bucket<ul><li><em>and other supporting resources</em></li></ul></li></ol><p>Your Splunk-issued workshop instance should already have <strong>terraform</strong> installed.</p><ul><li><p>Check if the <strong>terraform</strong> command is installed on your instance:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>which terraform</span></span></code></pre></div><ul><li><em>The expected output would be <strong>/usr/local/bin/terraform</strong></em></li></ul></li><li><p>If the <strong>terraform</strong> command is not installed on your instance, follow Terraform&rsquo;s recommended installation commands listed below:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget -O- https://apt.releases.hashicorp.com/gpg <span class=p>|</span> sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com </span><span class=k>$(</span>lsb_release -cs<span class=k>)</span><span class=s2> main&#34;</span> <span class=p>|</span> sudo tee /etc/apt/sources.list.d/hashicorp.list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo apt update <span class=o>&amp;&amp;</span> sudo apt install terraform</span></span></code></pre></div></li></ul><h3 id=workshop-directory-o11y-lambda-workshop>Workshop Directory (o11y-lambda-workshop)</h3><p>The Workshop Directory <code>o11y-lambda-workshop</code> is a repository that contains all the configuration files and scripts to complete both the auto-instrumentation and manual instrumentation of the example Lambda-based application we will be using today.</p><ul><li><p>Confirm you have the workshop directory in your home directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> <span class=o>&amp;&amp;</span> ls</span></span></code></pre></div><ul><li><em>The expected output would include <strong>o11y-lambda-workshop</strong></em></li></ul></li><li><p>If the <strong>o11y-lambda-workshop</strong> directory is not in your home directory, clone it with the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/gkono-splunk/o11y-lambda-workshop.git</span></span></code></pre></div></li></ul><h3 id=aws--terraform-variables>AWS & Terraform Variables</h3><h4 id=aws>AWS</h4><p>The AWS CLI requires that you have credentials to be able to access and manage resources deployed by their services. Both Terraform and the Python scripts in this workshop require these variables to perform their tasks.</p><ul><li><p>Configure the <strong>awscli</strong> with the <em><strong>access key ID</strong></em>, <em><strong>secret access key</strong></em> and <em><strong>region</strong></em> for this workshop:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws configure</span></span></code></pre></div><ul><li><em>This command should provide a prompt similar to the one below:</em><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>AWS Access Key ID <span class=o>[</span>None<span class=o>]</span>: XXXXXXXXXXXXXXXX
</span></span><span class=line><span class=cl>AWS Secret Acces Key <span class=o>[</span>None<span class=o>]</span>: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</span></span><span class=line><span class=cl>Default region name <span class=o>[</span>None<span class=o>]</span>: us-east-1
</span></span><span class=line><span class=cl>Default outoput format <span class=o>[</span>None<span class=o>]</span>:</span></span></code></pre></div></li></ul></li><li><p>If the <strong>awscli</strong> is not configured on your instance, run the following command and provide the values your instructor would provide you with.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws configure</span></span></code></pre></div></li></ul><h4 id=terraform-1>Terraform</h4><p>Terraform supports the passing of variables to ensure sensitive or dynamic data is not hard-coded in your .tf configuration files, as well as to make those values reusable throughout your resource definitions.</p><p>In our workshop, Terraform requires variables necessary for deploying the Lambda functions with the right values for the OpenTelemetry Lambda layer; For the ingest values for Splunk Observability Cloud; And to make your environment and resources unique and immediatley recognizable.</p><p>Terraform variables are defined in the following manner:</p><ul><li>Define the variables in your <em><strong>main.tf</strong></em> file or a <em><strong>variables.tf</strong></em></li><li>Set the values for those variables in either of the following ways:<ul><li>setting environment variables at the host level, with the same variable names as in their definition, and with <em><strong>TF_VAR</strong></em>_ as a prefix</li><li>setting the values for your variables in a <em><strong>terraform.tfvars</strong></em> file</li><li>passing the values as arguments when running terraform apply</li></ul></li></ul><p>We will be using a combination of <em><strong>variables.tf</strong></em> and <em><strong>terraform.tfvars</strong></em> files to set our variables in this workshop.</p><ul><li>Using either <strong>vi</strong> or <strong>nano</strong>, open the <em><strong>terraform.tfvars</strong></em> file in either the <strong>auto</strong> or <strong>manual</strong> directory<div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi ~/o11y-lambda-workshop/auto/terraform.tfvars</span></span></code></pre></div></li><li>Set the variables with their values. Replace the <strong>CHANGEME</strong> placeholders with those provided by your instructor.<div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>o11y_access_token</span> <span class=o>=</span> <span class=s2>&#34;CHANGEME&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>o11y_realm</span>        <span class=o>=</span> <span class=s2>&#34;CHANGEME&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>otel_lambda_layer</span> <span class=o>=</span> <span class=o>[</span><span class=s2>&#34;CHANGEME&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>prefix</span>            <span class=o>=</span> <span class=s2>&#34;CHANGEME&#34;</span></span></span></code></pre></div><ul><li><em>Ensure you change only the placeholders, leaving the quotes and brackets intact, where applicable.</em></li><li><em>The <em><strong>prefix</strong></em> is a unique identifier you can choose for yourself, to make your resources distinct from other participants&rsquo; resources. We suggest using a short form of your name, for example.</em></li><li><em>Also, please only lowercase letters for the <strong>prefix</strong>. Certain resouces in AWS, such as S3, would through an error if you use uppercase letters.</em></li></ul></li><li>Save your file and exit the editor.</li><li>Finally, copy the <em><strong>terraform.tfvars</strong></em> file you just edited to the other directory.<div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp ~/o11y-lambda-workshop/auto/terraform.tfvars ~/o11y-lambda-workshop/manual</span></span></code></pre></div><ul><li><em>We do this as we will be using the same values for both the autoinstrumentation and manual instrumentation protions of the workshop</em></li></ul></li></ul><h3 id=file-permissions>File Permissions</h3><p>While all other files are fine as they are, the <strong>send_message.py</strong> script in both the <code>auto</code> and <code>manual</code> will have to be executed as part of our workshop. As a result, it needs to have the appropriate permissions to run as expected. Follow these instructions to set them.</p><ul><li><p>First, ensure you are in the <code>o11y-lambda-workshop</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-workshop</span></span></code></pre></div></li><li><p>Next, run the following command to set executable permissions on the <code>send_message.py</code> script:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chmod <span class=m>755</span> auto/send_message.py manual/send_message.py</span></span></code></pre></div></li></ul><p>Now that we&rsquo;ve squared off the prerequisites, we can get started with the workshop!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 29, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=auto-instrumentation>Auto-Instrumentation</h1><p>The first part of our workshop will demonstrate how auto-instrumentation with OpenTelemetry allows the OpenTelemetry Collector to auto-detect what language your function is written in, and start capturing traces for those functions.</p><h3 id=the-auto-instrumentation-workshop-directory--contents>The Auto-Instrumentation Workshop Directory & Contents</h3><p>First, let us take a look at the <code>o11y-lambda-workshop/auto</code> directory, and some of its files. This is where all the content for the auto-instrumentation portion of our workshop resides.</p><h4 id=the-auto-directory>The <code>auto</code> Directory</h4><ul><li><p>Run the following command to get into the <strong>o11y-lambda-workshop/auto</strong> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-workshop/auto</span></span></code></pre></div></li><li><p>Inspect the contents of this directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls</span></span></code></pre></div><ul><li><p><em>The output should include the following files and directories:</em></p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>handler             outputs.tf          terraform.tf        variables.tf
</span></span><span class=line><span class=cl>main.tf             send_message.py     terraform.tfvars</span></span></code></pre></div></li><li><p><em>The output should include the following files and directories:</em></p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>get_logs.py    main.tf       send_message.py
</span></span><span class=line><span class=cl>handler        outputs.tf    terraform.tf</span></span></code></pre></div></li></ul></li></ul><h4 id=the-maintf-file>The <code>main.tf</code> file</h4><ul><li>Take a closer look at the <code>main.tf</code> file:<div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat main.tf</span></span></code></pre></div></li></ul><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Questions</summary><div class=box-content><ul><li>Can you identify which AWS resources are being created by this template?</li><li>Can you identify where OpenTelemetry instrumentation is being set up?<ul><li><em>Hint: study the lambda function definitions</em></li></ul></li><li>Can you determine which instrumentation information is being provided by the environment variables we set earlier?</li></ul></div></details><p>You should see a section where the environment variables for each lambda function are being set.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>environment <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>variables</span> <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>SPLUNK_ACCESS_TOKEN</span> <span class=o>=</span> var.o11y_access_token
</span></span><span class=line><span class=cl>    <span class=nv>SPLUNK_REALM</span> <span class=o>=</span> var.o11y_realm
</span></span><span class=line><span class=cl>    <span class=nv>OTEL_SERVICE_NAME</span> <span class=o>=</span> <span class=s2>&#34;producer-lambda&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>OTEL_RESOURCE_ATTRIBUTES</span> <span class=o>=</span> <span class=s2>&#34;deployment.environment=</span><span class=si>${</span><span class=nv>var</span><span class=p>.prefix</span><span class=si>}</span><span class=s2>-lambda-shop&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>AWS_LAMBDA_EXEC_WRAPPER</span> <span class=o>=</span> <span class=s2>&#34;/opt/nodejs-otel-handler&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>KINESIS_STREAM</span> <span class=o>=</span> aws_kinesis_stream.lambda_streamer.name
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><p>By using these environment variables, we are configuring our auto-instrumentation in a few ways:</p><ul><li><p>We are setting environment variables to inform the OpenTelemetry collector of which Splunk Observability Cloud organization we would like to have our data exported to.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>SPLUNK_ACCESS_TOKEN</span> <span class=o>=</span> var.o11y_access_token
</span></span><span class=line><span class=cl><span class=nv>SPLUNK_ACCESS_TOKEN</span> <span class=o>=</span> var.o11y_realm</span></span></code></pre></div></li><li><p>We are also setting variables that help OpenTelemetry identify our function/service, as well as the environment/application it is a part of.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>OTEL_SERVICE_NAME</span> <span class=o>=</span> <span class=s2>&#34;producer-lambda&#34;</span> <span class=c1># consumer-lambda in the case of the consumer function</span>
</span></span><span class=line><span class=cl><span class=nv>OTEL_RESOURCE_ATTRIBUTES</span> <span class=o>=</span> <span class=s2>&#34;deployment.environment=</span><span class=si>${</span><span class=nv>var</span><span class=p>.prefix</span><span class=si>}</span><span class=s2>-lambda-shop&#34;</span></span></span></code></pre></div></li><li><p>We are setting an environment variable that lets OpenTelemetry know what wrappers it needs to apply to our function&rsquo;s handler so as to capture trace data automatically, based on our code language.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>AWS_LAMBDA_EXEC_WRAPPER - <span class=s2>&#34;/opt/nodejs-otel-handler&#34;</span></span></span></code></pre></div></li><li><p>In the case of the <code>producer-lambda</code> function, we are setting an environment variable to let the function know what Kinesis Stream to put our record to.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>KINESIS_STREAM</span> <span class=o>=</span> aws_kinesis_stream.lambda_streamer.name</span></span></code></pre></div></li><li><p>These values are sourced from the environment variables we set in the Prerequisites section, as well as resources that will be deployed as a part of this Terraform configuration file.</p></li></ul><p>You should also see an argument for setting the Splunk OpenTelemetry Lambda layer on each function</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>layers</span> <span class=o>=</span> var.otel_lambda_layer</span></span></code></pre></div><ul><li><p>The OpenTelemetry Lambda layer is a package that contains the libraries and dependencies necessary to collector, process and export telemetry data for Lambda functions at the moment of invocation.</p></li><li><p>While there is a general OTel Lambda layer that has all the libraries and dependencies for all OpenTelemetry-supported languages, there are also language-specific Lambda layers, to help make your function even more lightweight.</p><ul><li><em>You can see the relevant Splunk OpenTelemetry Lambda layer ARNs (Amazon Resource Name) and latest versions for each AWS region <a href=https://github.com/signalfx/lambda-layer-versions/blob/main/splunk-apm/splunk-apm.md rel=external target=_blank>HERE</a></em></li></ul></li></ul><h4 id=the-producermjs-file>The <code>producer.mjs</code> file</h4><p>Next, let&rsquo;s take a look at the <code>producer-lambda</code> function code:</p><ul><li>Run the following command to view the contents of the <code>producer.mjs</code> file:<div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/o11y-lambda-workshop/auto/handler/producer.mjs</span></span></code></pre></div><ul><li>This NodeJS module contains the code for the producer function.</li><li>Essentially, this function receives a message, and puts that message as a record to the targeted Kinesis Stream</li></ul></li></ul><h3 id=deploying-the-lambda-functions--generating-trace-data>Deploying the Lambda Functions & Generating Trace Data</h3><p>Now that we are familiar with the contents of our <code>auto</code> directory, we can deploy the resources for our workshop, and generate some trace data from our Lambda functions.</p><h4 id=initialize-terraform-in-the-auto-directory>Initialize Terraform in the <code>auto</code> directory</h4><p>In order to deploy the resources defined in the <code>main.tf</code> file, you first need to make sure that Terraform is initialized in the same folder as that file.</p><ul><li><p>Ensure you are in the <code>auto</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/o11y-lambda-workshop/auto</strong></em></li></ul></li><li><p>If you are not in the <code>auto</code> directory, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-workshop/auto</span></span></code></pre></div></li><li><p>Run the following command to initialize Terraform in this directory</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform init</span></span></code></pre></div><ul><li>This command will create a number of elements in the same folder:<ul><li><code>.terraform.lock.hcl</code> file: to record the providers it will use to provide resources</li><li><code>.terraform</code> directory: to store the provider configurations</li></ul></li><li>In addition to the above files, when terraform is run using the <code>apply</code> subcommand, the <code>terraform.tfstate</code> file will be created to track the state of your deployed resources.</li><li>These enable Terraform to manage the creation, state and destruction of resources, as defined within the <code>main.tf</code> file of the <code>auto</code> directory</li></ul></li></ul><h4 id=deploy-the-lambda-functions-and-other-aws-resources>Deploy the Lambda functions and other AWS resources</h4><p>Once we&rsquo;ve initialized Terraform in this directory, we can go ahead and deploy our resources.</p><ul><li><p>First, run the <strong>terraform plan</strong> command to ensure that Terraform will be able to create your resources without encountering any issues.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform plan</span></span></code></pre></div><ul><li><em>This will result in a plan to deploy resources and output some data, which you can review to ensure everything will work as intended.</em></li><li><em>Do note that a number of the values shown in the plan will be known post-creation, or are masked for security purposes.</em></li></ul></li><li><p>Next, run the <strong>terraform apply</strong> command to deploy the Lambda functions and other supporting resources from the <strong>main.tf</strong> file:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform apply</span></span></code></pre></div><ul><li><p><em>Respond <strong>yes</strong> when you see the <strong>Enter a value:</strong> prompt</em></p></li><li><p>This will result in the following outputs:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Outputs:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>base_url</span> <span class=o>=</span> <span class=s2>&#34;https://______.amazonaws.com/serverless_stage/producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_function_name</span> <span class=o>=</span> <span class=s2>&#34;_____-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_log_group_arn</span> <span class=o>=</span> <span class=s2>&#34;arn:aws:logs:us-east-1:############:log-group:/aws/lambda/______-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_log_group_name</span> <span class=o>=</span> <span class=s2>&#34;/aws/lambda/______-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>environment</span> <span class=o>=</span> <span class=s2>&#34;______-lambda-shop&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>lambda_bucket_name</span> <span class=o>=</span> <span class=s2>&#34;lambda-shop-______-______&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_function_name</span> <span class=o>=</span> <span class=s2>&#34;______-producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_log_group_arn</span> <span class=o>=</span> <span class=s2>&#34;arn:aws:logs:us-east-1:############:log-group:/aws/lambda/______-producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_log_group_name</span> <span class=o>=</span> <span class=s2>&#34;/aws/lambda/______-producer&#34;</span></span></span></code></pre></div><ul><li><em>Terraform outputs are defined in the <strong>outputs.tf</strong> file.</em></li><li><em>These outputs will be used programmatically in other parts of our workshop, as well.</em></li></ul></li></ul></li></ul><h4 id=send-some-traffic-to-the-producer-lambda-url-base_url>Send some traffic to the <code>producer-lambda</code> URL (<code>base_url</code>)</h4><p>To start getting some traces from our deployed Lambda functions, we would need to generate some traffic. We will send a message to our <code>producer-lambda</code> function&rsquo;s endpoint, which should be put as a record into our Kinesis Stream, and then pulled from the Stream by the <code>consumer-lambda</code> function.</p><ul><li><p>Ensure you are in the <code>auto</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/o11y-lambda-workshop/auto</strong></em></li></ul></li><li><p>If you are not in the <code>auto</code> directory, run the following command</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-workshop/auto</span></span></code></pre></div></li></ul><p>The <code>send_message.py</code> script is a Python script that will take input at the command line, add it to a JSON dictionary, and send it to your <code>producer-lambda</code> function&rsquo;s endpoint repeatedly, as part of a while loop.</p><ul><li><p>Run the <code>send_message.py</code> script as a background process</p><ul><li><em>It requires the <code>--name</code> and <code>--superpower</code> arguments</em></li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nohup ./send_message.py --name CHANGEME --superpower CHANGEME <span class=p>&amp;</span></span></span></code></pre></div><ul><li>You should see an output similar to the following if your message is successful<div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span> <span class=m>79829</span>
</span></span><span class=line><span class=cl>user@host manual % appending output to nohup.out</span></span></code></pre></div><ul><li><em>The two most import bits of information here are:</em><ul><li><em>The process ID on the first line (<code>79829</code> in the case of my example), and</em></li><li><em>The <code>appending output to nohup.out</code> message</em></li></ul></li><li><em>The <code>nohup</code> command ensures the script will not hang up when sent to the background. It also captures the curl output from our command in a nohup.out file in the same folder as the one you&rsquo;re currently in.</em></li><li><em>The <code>&</code> tells our shell process to run this process in the background, thus freeing our shell to run other commands.</em></li></ul></li></ul></li><li><p>Next, check the contents of the <code>response.logs</code> file, to ensure your output confirms your requests to your <code>producer-lambda</code> endpoint are successful:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat response.logs</span></span></code></pre></div><ul><li>You should see the following output among the lines printed to your screen if your message is successful:</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Message placed in the Event Stream: {prefix}-lambda_stream&#34;</span><span class=o>}</span></span></span></code></pre></div><ul><li>If unsuccessful, you will see:</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Internal server error&#34;</span><span class=o>}</span></span></span></code></pre></div></li></ul><details open class="box cstyle notices important"><summary class=box-label><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>If this occurs, ask one of the workshop facilitators for assistance.</p></div></details><h4 id=view-the-lambda-function-logs>View the Lambda Function Logs</h4><p>Next, let&rsquo;s take a look at the logs for our Lambda functions.</p><ul><li><p>To view your <strong>producer-lambda</strong> logs, check the <strong>producer.logs</strong> file:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat producer.logs</span></span></code></pre></div></li><li><p>To view your <strong>consumer-lambda</strong> logs, check the <strong>consumer.logs</strong> file:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat consumer.logs</span></span></code></pre></div></li></ul><p>Examine the logs carefully.</p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><ul><li>Do you see OpenTelemetry being loaded? Look out for the lines with <code>splunk-extension-wrapper</code><ul><li><ul><li><em>Consider running <code>head -n 50 producer.logs</code> or <code>head -n 50 consumer.logs</code> to see the <strong>splunk-extension-wrapper</strong> being loaded.</em></li></ul></li></ul></li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 29, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=splunk-apm-lambda-functions--traces>Splunk APM, Lambda Functions & Traces</h1><p>The Lambda functions should be generating a sizeable amount of trace data, which we would need to take a look at. Through the combination of environment variables and the OpenTelemetry Lambda layer configured in the resource definition for our Lambda functions, we should now be ready to view our functions and traces in Splunk APM.</p><h4 id=view-your-environment-name-in-the-splunk-apm-overview>View your Environment name in the Splunk APM Overview</h4><p>Let&rsquo;s start by making sure that Splunk APM is aware of our <code>Environment</code> from the trace data it is receiving. This is the <code>deployment.name</code> we set as part of the <code>OTEL_RESOURCE_ATTRIBUTES</code> variable we set on our Lambda function definitions in <code>main.tf</code>. It was also one of the outputs from the <code>terraform apply</code> command we ran earlier.</p><p>In Splunk Observability Cloud:</p><ul><li><p>Click on the <code>APM</code> Button from the Main Menu on the left. This will take you to the Splunk APM Overview.</p></li><li><p>Select your APM Environment from the <code>Environment:</code> dropdown.</p><ul><li><em>Your APM environment should be in the <code>PREFIX-lambda-shop</code> format, where the <code>PREFIX</code> is obtained from the environment variable you set in the Prerequisites section</em></li></ul></li></ul><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>It may take a few minutes for your traces to appear in Splunk APM. Try hitting refresh on your browser until you find your environment name in the list of environments.</p></div></details><p><a href=#R-image-62a2c7bba7a14dc4115924a07fe8faed class=lightbox-link><img alt="Splunk APM, Environment Name" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/02-Auto-APM-EnvironmentName.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-62a2c7bba7a14dc4115924a07fe8faed><img alt="Splunk APM, Environment Name" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/02-Auto-APM-EnvironmentName.png></a></p><h4 id=view-your-environments-service-map>View your Environment&rsquo;s Service Map</h4><p>Once you&rsquo;ve selected your Environment name from the Environment drop down, you can take a look at the Service Map for your Lambda functions.</p><ul><li>Click the <code>Service Map</code> Button on the right side of the APM Overview page. This will take you to your Service Map view.</li></ul><p><a href=#R-image-f7780a99e03b6b8cf45639ae25a89f9b class=lightbox-link><img alt="Splunk APM, Service Map Button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/03-Auto-ServiceMapButton.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f7780a99e03b6b8cf45639ae25a89f9b><img alt="Splunk APM, Service Map Button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/03-Auto-ServiceMapButton.png></a></p><p>You should be able to see the <code>producer-lambda</code> function and the call it is making to the Kinesis Stream to put your record.</p><p><a href=#R-image-1f6495a649b87b99a5a0a5d7f22cce10 class=lightbox-link><img alt="Splunk APM, Service Map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/04-Auto-ServiceMap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1f6495a649b87b99a5a0a5d7f22cce10><img alt="Splunk APM, Service Map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/04-Auto-ServiceMap.png></a></p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What about your <code>consumer-lambda</code> function?</p></div></details><h4 id=explore-the-traces-from-your-lambda-functions>Explore the Traces from your Lambda Functions</h4><ul><li>Click the <code>Traces</code> button to view the Trace Analyzer.</li></ul><p><a href=#R-image-c1a9bfeb90d3f83e5ed8ba1df515d1ce class=lightbox-link><img alt="Splunk APM, Trace Button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/05-Auto-TraceButton.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c1a9bfeb90d3f83e5ed8ba1df515d1ce><img alt="Splunk APM, Trace Button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/05-Auto-TraceButton.png></a></p><p>On this page, we can see the traces that have been ingested from the OpenTelemetry Lambda layer of your <code>producer-lambda</code> function.</p><p><a href=#R-image-21f809d9b826ed445462afe53ef04cd2 class=lightbox-link><img alt="Splunk APM, Trace Analyzer" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/06-Auto-TraceAnalyzer.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-21f809d9b826ed445462afe53ef04cd2><img alt="Splunk APM, Trace Analyzer" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/06-Auto-TraceAnalyzer.png></a></p><ul><li>Select a trace from the list to examine by clicking on its hyperlinked <code>Trace ID</code>.</li></ul><p><a href=#R-image-b27ce15221a4640647f364f3fcd4a837 class=lightbox-link><img alt="Splunk APM, Trace and Spans" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/07-Auto-TraceNSpans.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b27ce15221a4640647f364f3fcd4a837><img alt="Splunk APM, Trace and Spans" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/07-Auto-TraceNSpans.png></a></p><p>We can see that the <code>producer-lambda</code> function is putting a record into the Kinesis Stream. But the action of the <code>consumer-lambda</code> function is missing!</p><p>This is because the trace context is not being propagated. Trace context propagation is not supported out-of-the-box by Kinesis service at the time of this workshop. Our distributed trace stops at the Kinesis service, and because its context isn&rsquo;t automatically propagated through the stream, we can&rsquo;t see any further.</p><p>Not yet, at least&mldr;</p><p>Let&rsquo;s see how we work around this in the next section of this workshop. But before that, let&rsquo;s clean up after ourselves!</p><h3 id=clean-up>Clean Up</h3><p>The resources we deployed as part of this auto-instrumenation exercise need to be cleaned. Likewise, the script that was generating traffice against our <code>producer-lambda</code> endpoint needs to be stopped, if it&rsquo;s still running. Follow the below steps to clean up.</p><h4 id=kill-the-send_message>Kill the <code>send_message</code></h4><ul><li><p>If the <code>send_message.py</code> script is still running, stop it with the follwing commands:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>fg</span></span></code></pre></div><ul><li>This brings your background process to the foreground.</li><li>Next you can hit <code>[CONTROL-C]</code> to kill the process.</li></ul></li></ul><h4 id=destroy-all-aws-resources>Destroy all AWS resources</h4><p>Terraform is great at managing the state of our resources individually, and as a deployment. It can even update deployed resources with any changes to their definitions. But to start afresh, we will destroy the resources and redeploy them as part of the manual instrumentation portion of this workshop.</p><p>Please follow these steps to destroy your resources:</p><ul><li><p>Ensure you are in the <code>auto</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/o11y-lambda-workshop/auto</strong></em></li></ul></li><li><p>If you are not in the <code>auto</code> directory, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-workshop/auto</span></span></code></pre></div></li><li><p>Destroy the Lambda functions and other AWS resources you deployed earlier:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform destroy</span></span></code></pre></div><ul><li>respond <code>yes</code> when you see the <code>Enter a value:</code> prompt</li><li>This will result in the resources being destroyed, leaving you with a clean environment</li></ul></li></ul><p>This process will leave you with the files and directories created as a result of our activity. Do not worry about those.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 29, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=manual-instrumentation>Manual Instrumentation</h1><p>The second part of our workshop will focus on demonstrating how manual instrumentation with OpenTelemetry empowers us to enhance telemetry collection. More specifically, in our case, it will enable us to propagate trace context data from the <code>producer-lambda</code> function to the <code>consumer-lambda</code> function, thus enabling us to see the relationship between the two functions, even across Kinesis Stream, which currently does not support automatic context propagation.</p><h3 id=the-manual-instrumentation-workshop-directory--contents>The Manual Instrumentation Workshop Directory & Contents</h3><p>Once again, we will first start by taking a look at our operating directory, and some of its files. This time, it will be <code>o11y-lambda-workshop/manual</code> directory. This is where all the content for the manual instrumentation portion of our workshop resides.</p><h4 id=the-manual-directory>The <code>manual</code> directory</h4><ul><li><p>Run the following command to get into the <code>o11y-lambda-workshop/manual</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-workshop/manual</span></span></code></pre></div></li><li><p>Inspect the contents of this directory with the <code>ls</code> command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls</span></span></code></pre></div><ul><li><p><em>The output should include the following files and directories:</em></p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>handler             outputs.tf          terraform.tf        variables.tf
</span></span><span class=line><span class=cl>main.tf             send_message.py     terraform.tfvars</span></span></code></pre></div></li></ul></li></ul><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Do you see any difference between this directory and the auto directory when you first started?</p></div></details><h4 id=compare-auto-and-manual-files>Compare <code>auto</code> and <code>manual</code> files</h4><p>Let&rsquo;s make sure that all these files that LOOK the same, are actually the same.</p><ul><li><p>Compare the <code>main.tf</code> files in the <code>auto</code> and <code>manual</code> directories:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>diff ~/o11y-lambda-workshop/auto/main.tf ~/o11y-lambda-workshop/manual/main.tf</span></span></code></pre></div><ul><li>There is no difference! <em>(Well, there shouldn&rsquo;t be. Ask your workshop facilitator to assist you if there is)</em></li></ul></li><li><p>Now, let&rsquo;s compare the <code>producer.mjs</code> files:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>diff ~/o11y-lambda-workshop/auto/handler/producer.mjs ~/o11y-lambda-workshop/manual/handler/producer.mjs</span></span></code></pre></div><ul><li>There&rsquo;s quite a few differences here!</li></ul></li><li><p>You may wish to view the entire file and examine its content</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/o11y-lambda-workshop/handler/producer.mjs</span></span></code></pre></div><ul><li>Notice how we are now importing some OpenTelemetry objects directly into our function to handle some of the manual instrumentation tasks we require.</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>context</span><span class=p>,</span> <span class=nx>propagation</span><span class=p>,</span> <span class=nx>trace</span><span class=p>,</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;@opentelemetry/api&#34;</span><span class=p>;</span></span></span></code></pre></div><ul><li>We are importing the following objects from <a href=https://www.npmjs.com/package/@opentelemetry/api rel=external target=_blank>@opentelemetry/api</a> to propagate our context in our producer function:<ul><li>context</li><li>propagation</li><li>trace</li></ul></li></ul></li><li><p>Finally, compare the <code>consumer.mjs</code> files:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>diff ~/o11y-lambda-workshop/auto/handler/consumer.mjs ~/o11y-lambda-workshop/manual/handler/consumer.mjs</span></span></code></pre></div><ul><li><p>Here also, there are a few differences of note. Let&rsquo;s take a closer look</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat handler/consumer.mjs</span></span></code></pre></div><ul><li>In this file, we are importing the following <a href=https://www.npmjs.com/package/@opentelemetry/api rel=external target=_blank>@opentelemetry/api</a> objects:<ul><li>propagation</li><li>trace</li><li>ROOT_CONTEXT</li></ul></li><li>We use these to extract the trace context that was propagated from the producer function</li><li>Then to add new span attributes based on our <code>name</code> and <code>superpower</code> to the extracted trace context</li></ul></li></ul></li></ul><h4 id=propagating-the-trace-context-from-the-producer-function>Propagating the Trace Context from the Producer Function</h4><p>The below code executes the following steps inside the producer function:</p><ol><li>Get the tracer for this trace</li><li>Initialize a context carrier object</li><li>Inject the context of the active span into the carrier object</li><li>Modify the record we are about to pu on our Kinesis stream to include the carrier that will carry the active span&rsquo;s context to the consumer</li></ol><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>context</span><span class=p>,</span> <span class=nx>propagation</span><span class=p>,</span> <span class=nx>trace</span><span class=p>,</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;@opentelemetry/api&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tracer</span> <span class=o>=</span> <span class=nx>trace</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=s1>&#39;lambda-app&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>tracer</span><span class=p>.</span><span class=nx>startActiveSpan</span><span class=p>(</span><span class=s1>&#39;put-record&#39;</span><span class=p>,</span> <span class=kr>async</span><span class=p>(</span><span class=nx>span</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>carrier</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>    <span class=nx>propagation</span><span class=p>.</span><span class=nx>inject</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>active</span><span class=p>(),</span> <span class=nx>carrier</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>eventBody</span> <span class=o>=</span> <span class=nx>Buffer</span><span class=p>.</span><span class=nx>from</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span> <span class=s1>&#39;base64&#39;</span><span class=p>).</span><span class=nx>toString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=s2>&#34;{\&#34;tracecontext\&#34;: &#34;</span> <span class=o>+</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>carrier</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;, \&#34;record\&#34;: &#34;</span> <span class=o>+</span> <span class=nx>eventBody</span> <span class=o>+</span> <span class=s2>&#34;}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=sb>`Record with Trace Context added:
</span></span></span><span class=line><span class=cl><span class=sb>      </span><span class=si>${</span><span class=nx>data</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>await</span> <span class=nx>kinesis</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=nx>PutRecordCommand</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>StreamName</span><span class=o>:</span> <span class=nx>streamName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>PartitionKey</span><span class=o>:</span> <span class=s2>&#34;1234&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>Data</span><span class=o>:</span> <span class=nx>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>        <span class=nx>message</span> <span class=o>=</span> <span class=sb>`Message placed in the Event Stream: </span><span class=si>${</span><span class=nx>streamName</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>      <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=nx>span</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span></span></span></code></pre></div><h4 id=extracting-trace-context-in-the-consumer-function>Extracting Trace Context in the Consumer Function</h4><p>The below code executes the following steps inside the consumer function:</p><ol><li>Extract the context that we obtained from <code>producer-lambda</code> into a carrier object.</li><li>Extract the tracer from current context.</li><li>Start a new span with the tracer within the extracted context.</li><li>Bonus: Add extra attributes to your span, including custom ones with the values from your message!</li><li>Once completed, end the span.</li></ol><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>propagation</span><span class=p>,</span> <span class=nx>trace</span><span class=p>,</span> <span class=nx>ROOT_CONTEXT</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;@opentelemetry/api&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>carrier</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span> <span class=nx>message</span> <span class=p>).</span><span class=nx>tracecontext</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>parentContext</span> <span class=o>=</span> <span class=nx>propagation</span><span class=p>.</span><span class=nx>extract</span><span class=p>(</span><span class=nx>ROOT_CONTEXT</span><span class=p>,</span> <span class=nx>carrier</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>tracer</span> <span class=o>=</span> <span class=nx>trace</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>OTEL_SERVICE_NAME</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>span</span> <span class=o>=</span> <span class=nx>tracer</span><span class=p>.</span><span class=nx>startSpan</span><span class=p>(</span><span class=s2>&#34;Kinesis.getRecord&#34;</span><span class=p>,</span> <span class=kc>undefined</span><span class=p>,</span> <span class=nx>parentContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;span.kind&#34;</span><span class=p>,</span> <span class=s2>&#34;server&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>body</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span> <span class=nx>message</span> <span class=p>).</span><span class=nx>record</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>body</span><span class=p>.</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;custom.tag.name&#34;</span><span class=p>,</span> <span class=nx>body</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>body</span><span class=p>.</span><span class=nx>superpower</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;custom.tag.superpower&#34;</span><span class=p>,</span> <span class=nx>body</span><span class=p>.</span><span class=nx>superpower</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>      <span class=nx>span</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span></span></span></code></pre></div><p>Now let&rsquo;s see the different this makes!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 29, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploying-lambda-functions--generating-trace-data>Deploying Lambda Functions & Generating Trace Data</h1><p>Now that we know how to apply manual instrumentation to the functions and services we wish to capture trace data for, let&rsquo;s go about deploying our Lambda functions again, and generating traffic against our <code>producer-lambda</code> endpoint.</p><h4 id=initialize-terraform-in-the-manual-directory>Initialize Terraform in the <code>manual</code> directory</h4><p>Seeing as we&rsquo;re in a new directory, we will need to initialize Terraform here once again.</p><ul><li><p>Ensure you are in the <code>manual</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/o11y-lambda-workshop/manual</strong></em></li></ul></li><li><p>If you are not in the <code>manual</code> directory, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-workshop/manual</span></span></code></pre></div></li><li><p>Run the following command to initialize Terraform in this directory</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform init</span></span></code></pre></div></li></ul><h4 id=deploy-the-lambda-functions-and-other-aws-resources>Deploy the Lambda functions and other AWS resources</h4><p>Let&rsquo;s go ahead and deploy those resources again as well!</p><ul><li><p>Run the <strong>terraform plan</strong> command, ensuring there are no issues.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform plan</span></span></code></pre></div></li><li><p>Follow up with the <strong>terraform apply</strong> command to deploy the Lambda functions and other supporting resources from the <strong>main.tf</strong> file:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform apply</span></span></code></pre></div><ul><li><p><em>Respond <strong>yes</strong> when you see the <strong>Enter a value:</strong> prompt</em></p></li><li><p>This will result in the following outputs:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Outputs:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>base_url</span> <span class=o>=</span> <span class=s2>&#34;https://______.amazonaws.com/serverless_stage/producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_function_name</span> <span class=o>=</span> <span class=s2>&#34;_____-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_log_group_arn</span> <span class=o>=</span> <span class=s2>&#34;arn:aws:logs:us-east-1:############:log-group:/aws/lambda/______-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_log_group_name</span> <span class=o>=</span> <span class=s2>&#34;/aws/lambda/______-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>environment</span> <span class=o>=</span> <span class=s2>&#34;______-lambda-shop&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>lambda_bucket_name</span> <span class=o>=</span> <span class=s2>&#34;lambda-shop-______-______&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_function_name</span> <span class=o>=</span> <span class=s2>&#34;______-producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_log_group_arn</span> <span class=o>=</span> <span class=s2>&#34;arn:aws:logs:us-east-1:############:log-group:/aws/lambda/______-producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_log_group_name</span> <span class=o>=</span> <span class=s2>&#34;/aws/lambda/______-producer&#34;</span></span></span></code></pre></div></li></ul></li></ul><p>As you can tell, aside from the first portion of the base_url and the log gropu ARNs, the output should be largely the same as when you ran the auto-instrumentation portion of this workshop up to this same point.</p><h4 id=send-some-traffic-to-the-producer-lambda-endpoint-base_url>Send some traffic to the <code>producer-lambda</code> endpoint (base_url)</h4><p>Once more, we will send our <code>name</code> and <code>superpower</code> as a message to our endpoint. This will then be added to a record in our Kinesis Stream, along with our trace context.</p><ul><li><p>Ensure you are in the <code>manual</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/o11y-lambda-workshop/manual</strong></em></li></ul></li><li><p>If you are not in the <code>manual</code> directory, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-workshop/manual</span></span></code></pre></div></li><li><p>Run the <code>send_message.py</code> script as a background process:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nohup ./send_message.py --name CHANGEME --superpower CHANGEME <span class=p>&amp;</span></span></span></code></pre></div></li><li><p>Next, check the contents of the response.logs file for successful calls to our<strong>producer-lambda</strong> endpoint:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat response.logs</span></span></code></pre></div><ul><li><p>You should see the following output among the lines printed to your screen if your message is successful:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Message placed in the Event Stream: hostname-eventStream&#34;</span><span class=o>}</span></span></span></code></pre></div></li><li><p>If unsuccessful, you will see:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Internal server error&#34;</span><span class=o>}</span></span></span></code></pre></div></li></ul></li></ul><details open class="box cstyle notices important"><summary class=box-label><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>If this occurs, ask one of the workshop facilitators for assistance.</p></div></details><h4 id=view-the-lambda-function-logs>View the Lambda Function Logs</h4><p>Let&rsquo;s see what our logs look like now.</p><ul><li><p>Check the <strong>producer.logs</strong> file:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat producer.logs</span></span></code></pre></div></li><li><p>And the <strong>consumer.logs</strong> file:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat consumer.logs</span></span></code></pre></div></li></ul><p>Examine the logs carefully.</p><h5 id=_workshop-question_><em>Workshop Question</em></h5><blockquote><p>Do you notice the difference?</p></blockquote><h4 id=copy-the-trace-id-from-the-consumer-lambda-logs>Copy the Trace ID from the <code>consumer-lambda</code> logs</h4><p>This time around, we can see that the consumer-lambda log group is logging our message as a <code>record</code> together with the <code>tracecontext</code> that we propagated.</p><p>To copy the Trace ID:</p><ul><li>Take a look at one of the <code>Kinesis Message</code> logs. Within it, there is a <code>data</code> dictionary</li><li>Take a closer look at <code>data</code> to see the nested <code>tracecontext</code> dictionary</li><li>Within the <code>tracecontext</code> dictionary, there is a <code>traceparent</code> key-value pair</li><li>The <code>traceparent</code> key-value pair holds the Trace ID we seek<ul><li>There are 4 groups of values, separated by <code>-</code>. The Trace ID is the 2nd group of characters</li></ul></li><li><strong>Copy the Trace ID, and save it.</strong> We will need it for a later step in this workshop</li></ul><p><a href=#R-image-1e4f36f73e1b52753e961b6e846580c7 class=lightbox-link><img alt="Lambda Consumer Logs, Manual Instruamentation" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/08-Manual-ConsumerLogs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1e4f36f73e1b52753e961b6e846580c7><img alt="Lambda Consumer Logs, Manual Instruamentation" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/08-Manual-ConsumerLogs.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 29, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=splunk-apm-lambda-functions-and-traces-again>Splunk APM, Lambda Functions and Traces, Again!</h1><p>In order to see the result of our context propagation outside of the logs, we&rsquo;ll once again consult the <a href=https://app.us1.signalfx.com/#/apm rel=external target=_blank>Splunk APM UI</a>.</p><h4 id=view-your-lambda-functions-in-the-splunk-apm-service-map>View your Lambda Functions in the Splunk APM Service Map</h4><p>Let&rsquo;s take a look at the Service Map for our environment in APM once again.</p><p>In Splunk Observability Cloud:</p><ul><li><p>Click on the <code>APM</code> Button in the Main Menu.</p></li><li><p>Select your APM Environment from the <code>Environment:</code> dropdown.</p></li><li><p>Click the <code>Service Map</code> Button on the right side of the APM Overview page. This will take you to your Service Map view.</p></li></ul><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p><em>Reminder: It may take a few minutes for your traces to appear in Splunk APM. Try hitting refresh on your browser until you find your environment name in the list of environments.</em></p></div></details><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Notice the difference?</p></div></details><ul><li>You should be able to see the <code>producer-lambda</code> and <code>consumer-lambda</code> functions linked by the propagated context this time!</li></ul><p><a href=#R-image-4cfa4244ef8bca1aaccf6dba86eeb3a0 class=lightbox-link><img alt="Splunk APM, Service Map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/09-Manual-ServiceMap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4cfa4244ef8bca1aaccf6dba86eeb3a0><img alt="Splunk APM, Service Map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/09-Manual-ServiceMap.png></a></p><h4 id=explore-a-lambda-trace-by-trace-id>Explore a Lambda Trace by Trace ID</h4><p>Next, we will take another look at a trace related to our Environment.</p><ul><li>Paste the Trace ID you copied from the consumer function&rsquo;s logs into the <code>View Trace ID</code> search box under Traces and click <code>Go</code></li></ul><p><a href=#R-image-63f51d8f61ccb39f4952af0a8a490c87 class=lightbox-link><img alt="Splunk APM, Trace Button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/10-Manual-TraceButton.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-63f51d8f61ccb39f4952af0a8a490c87><img alt="Splunk APM, Trace Button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/10-Manual-TraceButton.png></a></p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>The Trace ID was a part of the trace context that we propagated.</p></div></details><p>You can read up on two of the most common propagation standards:</p><ol><li><a href=https:///www.w3.org/TR/trace-context/#traceparent-header rel=external target=_blank>W3C</a></li><li><a href=https://github.com/openzipkin/b3-propagation#overall-process rel=external target=_blank>B3</a></li></ol><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Which one are we using?</p><ul><li><em>The Splunk Distribution of Opentelemetry JS, which supports our NodeJS functions, <a href=https://docs.splunk.com/observability/en/gdi/get-data-in/application/nodejs/splunk-nodejs-otel-distribution.html#defaults-of-the-splunk-distribution-of-opentelemetry-js rel=external target=_blank>defaults</a> to the <code>W3C</code> standard</em></li></ul></div></details><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Bonus Question: What happens if we mix and match the W3C and B3 headers?</p></div></details><p><a href=#R-image-bdf95af6a85b25f795b1b1182867a7ee class=lightbox-link><img alt="Splunk APM, Trace by ID" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/11-Manual-TraceByID.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bdf95af6a85b25f795b1b1182867a7ee><img alt="Splunk APM, Trace by ID" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/11-Manual-TraceByID.png></a></p><p>Click on the <code>consumer-lambda</code> span.</p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Can you find the attributes from your message?</p></div></details><p><a href=#R-image-f65fac3c3cdaf7178298b87c43374962 class=lightbox-link><img alt="Splunk APM, Span Tags" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/12-Manual-SpanTags.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f65fac3c3cdaf7178298b87c43374962><img alt="Splunk APM, Span Tags" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/12-Manual-SpanTags.png></a></p><h3 id=clean-up>Clean Up</h3><p>We are finally at the end of our workshop. Kindly clean up after yourself!</p><h4 id=kill-the-send_message>Kill the <code>send_message</code></h4><ul><li><p>If the <code>send_message.py</code> script is still running, stop it with the follwing commands:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>fg</span></span></code></pre></div><ul><li>This brings your background process to the foreground.</li><li>Next you can hit <code>[CONTROL-C]</code> to kill the process.</li></ul></li></ul><h4 id=destroy-all-aws-resources>Destroy all AWS resources</h4><p>Terraform is great at managing the state of our resources individually, and as a deployment. It can even update deployed resources with any changes to their definitions. But to start afresh, we will destroy the resources and redeploy them as part of the manual instrumentation portion of this workshop.</p><p>Please follow these steps to destroy your resources:</p><ul><li><p>Ensure you are in the <code>manual</code> directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/o11y-lambda-workshop/manual</strong></em></li></ul></li><li><p>If you are not in the <code>manual</code> directory, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-workshop/manual</span></span></code></pre></div></li><li><p>Destroy the Lambda functions and other AWS resources you deployed earlier:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform destroy</span></span></code></pre></div><ul><li>respond <code>yes</code> when you see the <code>Enter a value:</code> prompt</li><li>This will result in the resources being destroyed, leaving you with a clean environment</li></ul></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 17, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=conclusion>Conclusion</h1><p>Congratulations on finishing the Lambda Tracing Workshop! You have seen how we can complement auto-instrumentation with manual steps to have the <code>producer-lambda</code> function&rsquo;s context be sent to the <code>consumer-lambda</code> function via a record in a Kinesis stream. This allowed us to build the expected Distributed Trace, and to contextualize the relationship between both functions in Splunk APM.</p><p><a href=#R-image-8ab24acf9afab47705a048d110fbe4e5 class=lightbox-link><img alt="Lambda application, fully instrumented" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/13-Architecture_Instrumented.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8ab24acf9afab47705a048d110fbe4e5><img alt="Lambda application, fully instrumented" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/13-Architecture_Instrumented.png></a></p><p>You can now build out a trace manually by linking two different functions together. This comes in handy when your auto-instrumentation, or 3rd-party systems, do not support context propagation out of the box, or when you wish to add custom attributes to a trace for more relevant trace analaysis.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 16, 2024</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=scenarios>Scenarios</h1><ul class="children children-li children-sort-"><li><a href=/observability-workshop/v5.76/en/scenarios/optimize_monitoring/index.html>Optimize Cloud Monitoring</a><p>This scenario is for ITOps teams managing a hybrid infrastructure that need to troubleshoot cloud-native performance issues, by correlating real-time metrics with logs to troubleshoot faster, improve MTTD/MTTR, and optimize costs.</p></li><li><a href=/observability-workshop/v5.76/en/scenarios/debug_problems/index.html>Debug Problems in Microservices</a><p>This scenario helps engineering teams identify and fix issues caused by planned and unplanned changes to their microservices-based applications.</p></li><li><a href=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/index.html>Optimize End User Experiences</a><p>Use Splunk Real User Monitoring (RUM) and Synthetics to get insight into end user experience, and proactively test scenarios to improve that experience.</p></li><li><a href=/observability-workshop/v5.76/en/scenarios/self_service_observability/index.html>Self-Service Observability</a><p>This scenario helps platform engineering (or central tools) teams enable engineers with self-service observability tooling at scale, so developers and SREs can spend less time managing their toolchain and more time building and delivering cool software.</p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Scenarios</h1><article class=default><header class=headline></header><h1 id=optimize-cloud-monitoring>Optimize Cloud Monitoring</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>The elasticity of cloud architectures means that monitoring artifacts must scale elastically as well, breaking the paradigm of purpose-built monitoring assets. As a result, administrative overhead, visibility gaps, and tech debt skyrocket while MTTR slows. This typically happens for three reasons:</p><ul><li><strong>Complex and Inefficient Data Management</strong>: Infrastructure data is scattered across multiple tools with inconsistent naming conventions, leading to fragmented views and poor metadata and labelling. Managing multiple agents and data flows adds to the complexity.</li><li><strong>Inadequate Monitoring and Troubleshooting Experience</strong>: Slow data visualization and troubleshooting, cluttered with bespoke dashboards and manual correlations, are hindered further by the lack of monitoring tools for ephemeral technologies like Kubernetes and serverless functions.</li><li><strong>Operational and Scaling Challenges</strong>: Manual onboarding, user management, and chargeback processes, along with the need for extensive data summarization, slow down operations and inflate administrative tasks, complicating data collection and scalability.</li></ul><p>To address these challenges you need a way to:</p><ul><li><strong>Standardize Data Collection and Tags</strong>: Centralized monitoring with a single, open-source agent to apply uniform naming standards and ensure metadata for visibility. Optimize data collection and use a monitoring-as-code approach for consistent collection and tagging.</li><li><strong>Reuse Content Across Teams</strong>: Streamline new IT infrastructure onboarding and user management with templates and automation. Utilize out-of-the-box dashboards, alerts, and self-service tools to enable content reuse, ensuring uniform monitoring and reducing manual effort.</li><li><strong>Improve Timeliness of Alerts</strong>: Utilize highly performant open source data collection, combined with real-time streaming-based data analytics and alerting, to enhance the timeliness of notifications. Automatically configured alerts for common problem patterns (AutoDetect) and minimal yet effective monitoring dashboards and alerts will ensure rapid response to emerging issues, minimizing potential disruptions.</li><li><strong>Correlate Infrastructure Metrics and Logs</strong>: Achieve full monitoring coverage of all IT infrastructure by enabling seamless correlation between infrastructure metrics and logs. High-performing data visualization and a single source of truth for data, dashboards, and alerts will simplify the correlation process, allowing for more effective troubleshooting and analysis of the IT environment.</li></ul><p>In this workshop, we&rsquo;ll explore:</p><ul><li>How to standardize data collection and tags using <strong>OpenTelemetry</strong>.</li><li>How to reuse content across teams.</li><li>How to improve timelines of alerts.</li><li>How to correlate infrastructure metrics and logs.</li></ul><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (◀️) and right (▶️) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 3, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Optimize Cloud Monitoring</h1><article class=default><header class=headline></header><h1 id=getting-started>Getting Started</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>During this <em><strong>technical</strong></em> Optimize Cloud Monitoring Workshop, you will build out an environment based on a <a href=https://k3s.io/ rel=external target=_blank>lightweight</a> Kubernetes<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> cluster.</p><p>To simplify the workshop modules, a pre-configured AWS/EC2 instance is provided.</p><p>The instance is pre-configured with all the software required to deploy the Splunk OpenTelemetry Connector<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> and the microservices-based OpenTelemetry Demo Application<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> in Kubernetes which has been instrumented using OpenTelemetry to send metrics, traces, spans and logs.</p><p>This workshop will introduce you to the benefits of standardized data collection, how content can be re-used across teams, correlating metrics and logs, and creating detectors to fire alerts. By the end of these technical workshops, you will have a good understanding of some of the key features and capabilities of the Splunk Observability Cloud.</p><p>Here are the instructions on how to access your pre-configured <a href=/observability-workshop/v5.76/en/scenarios/optimize_monitoring/1-getting-started/1-access-ec2/index.html>AWS/EC2 instance</a></p><p><a href=#R-image-45845aa3804d33eb19934604580369ea class=lightbox-link><img alt="Splunk Architecture" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/architecture.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-45845aa3804d33eb19934604580369ea><img alt="Splunk Architecture" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/architecture.png></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/ rel=external target=_blank><strong>Kubernetes</strong></a> is a portable, extensible, open-source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://opentelemetry.io/ rel=external target=_blank><strong>OpenTelemetry Collector</strong></a> offers a vendor-agnostic implementation on how to receive, process and export telemetry data. In addition, it removes the need to run, operate and maintain multiple agents/collectors to support open-source telemetry data formats (e.g. Jaeger, Prometheus, etc.) sending to multiple open-source or commercial back-ends.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>The <a href=https://opentelemetry.io/docs/demo/ rel=external target=_blank><strong>OpenTelemetry Demo Application</strong></a> is a microservice-based distributed system intended to illustrate the implementation of OpenTelemetry in a near real-world environment.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Getting Started</h1><article class=default><header class=headline></header><h1 id=how-to-connect-to-your-workshop-environment>How to connect to your workshop environment</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><ol><li>How to retrieve the IP address of the AWS/EC2 instance assigned to you.</li><li>Connect to your instance using SSH, Putty<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> or your web browser.</li><li>Verify your connection to your AWS/EC2 cloud instance.</li><li>Using Putty (Optional)</li><li>Using Multipass (Optional)</li></ol><hr><h2 id=1-awsec2-ip-address>1. AWS/EC2 IP Address</h2><p>In preparation for the workshop, Splunk has prepared an Ubuntu Linux instance in AWS/EC2.</p><p>To get access to the instance that you will be using in the workshop please visit the URL to access the Google Sheet provided by the workshop leader.</p><p>Search for your AWS/EC2 instance by looking for your first and last name, as provided during registration for this workshop.</p><p><a href=#R-image-726af820b1f43dc5da42e05de0e30469 class=lightbox-link><img alt="attendee spreadsheet" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/spreadsheet-info.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-726af820b1f43dc5da42e05de0e30469><img alt="attendee spreadsheet" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/spreadsheet-info.png></a></p><p>Find your allocated IP address, SSH command (for Mac OS, Linux and the latest Windows versions) and password to enable you to connect to your workshop instance.</p><p>It also has the Browser Access URL that you can use in case you cannot connect via SSH or Putty - see <a href=/observability-workshop/v5.76/en/scenarios/optimize_monitoring/1-getting-started/1-access-ec2/index.html#4-web-browser-all>EC2 access via Web browser</a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Important</summary><div class=box-content><p>Please use SSH or Putty to gain access to your EC2 instance if possible and
make a note of the IP address as you will need this during the workshop.</p></div></details><h2 id=2-ssh-mac-oslinux>2. SSH (Mac OS/Linux)</h2><p>Most attendees will be able to connect to the workshop by using SSH from their Mac or Linux device, or on Windows 10 and above.</p><p>To use SSH, open a terminal on your system and type <code>ssh splunk@x.x.x.x</code> (replacing x.x.x.x with the IP address found in Step #1).</p><p><a href=#R-image-163cb86246a6fdfb60451b5c5abb38ac class=lightbox-link><img alt="ssh login" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/ssh-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-163cb86246a6fdfb60451b5c5abb38ac><img alt="ssh login" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/ssh-1.png></a></p><p>When prompted <strong><code>Are you sure you want to continue connecting (yes/no/[fingerprint])?</code></strong> please type <strong><code>yes</code></strong>.</p><p><a href=#R-image-2881a32fc86d2cda0d73a15639e80a87 class=lightbox-link><img alt="ssh password" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/ssh-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2881a32fc86d2cda0d73a15639e80a87><img alt="ssh password" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/ssh-2.png></a></p><p>Enter the password provided in the Google Sheet from Step #1.</p><p>Upon successful login, you will be presented with the Splunk logo and the Linux prompt.</p><p><a href=#R-image-cd4b5825a0de8cd76788adb21a499614 class=lightbox-link><img alt="ssh connected" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/ssh-3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cd4b5825a0de8cd76788adb21a499614><img alt="ssh connected" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/ssh-3.png></a></p><h2 id=3-ssh-windows-10-and-above>3. SSH (Windows 10 and above)</h2><p>The procedure described above is the same on Windows 10, and the commands can be executed either in the Windows Command Prompt or PowerShell.
However, Windows regards its SSH Client as an &ldquo;optional feature&rdquo;, which might need to be enabled.</p><p>You can verify if SSH is enabled by simply executing <code>ssh</code></p><p>If you are shown a help text on how to use the SSH command (like shown in the screenshot below), you are all set.</p><p><a href=#R-image-16e9f6201a04dd0593f373dd20ec7139 class=lightbox-link><img alt="Windows SSH enabled" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/windows-ssh-enabled-feedback.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-16e9f6201a04dd0593f373dd20ec7139><img alt="Windows SSH enabled" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/windows-ssh-enabled-feedback.png></a></p><p>If the result of executing the command looks something like the screenshot below, you want to enable the &ldquo;OpenSSH Client&rdquo; feature manually.</p><p><a href=#R-image-bb7bd6e7f900d0885dfba1431a94d9b5 class=lightbox-link><img alt="Windows SSH disabled" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/windows-ssh-disabled-feedback.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bb7bd6e7f900d0885dfba1431a94d9b5><img alt="Windows SSH disabled" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/windows-ssh-disabled-feedback.png></a></p><p>To do that, open the &ldquo;Settings&rdquo; menu, and click on &ldquo;Apps&rdquo;. While in the &ldquo;Apps & features&rdquo; section, click on &ldquo;Optional features&rdquo;.</p><p><a href=#R-image-96e1318facf329531a362902c64d9b7b class=lightbox-link><img alt="Windows Apps Settings" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/windows-gui-optionalfeatures.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-96e1318facf329531a362902c64d9b7b><img alt="Windows Apps Settings" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/windows-gui-optionalfeatures.png></a></p><p>Here, you are presented with a list of installed features. On the top, you see a button with a plus icon to &ldquo;Add a feature&rdquo;. Click it.
In the search input field, type &ldquo;OpenSSH&rdquo;, and find a feature called &ldquo;OpenSSH Client&rdquo;, or respectively, &ldquo;OpenSSH Client (Beta)&rdquo;, click on it, and click the &ldquo;Install&rdquo;-button.</p><p><a href=#R-image-3824f38b5fd3ef89b1359e0b1aa3fd27 class=lightbox-link><img alt="Windows Enable OpenSSH Client" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/windows-enable-openssh-client.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3824f38b5fd3ef89b1359e0b1aa3fd27><img alt="Windows Enable OpenSSH Client" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/windows-enable-openssh-client.png></a></p><p>Now you are set! In case you are not able to access the provided instance despite enabling the OpenSSH feature, please do not shy away from reaching
out to the course instructor, either via chat or directly.</p><p>At this point you are ready to continue and <a href=../gdi/index.html>start the workshop</a></p><hr><h2 id=4-putty-for-windows-versions-prior-to-windows-10>4. Putty (For Windows Versions prior to Windows 10)</h2><p>If you do not have SSH pre-installed or if you are on a Windows system, the best option is to install Putty which you can find <a href=https://www.putty.org/ rel=external target=_blank>here.</a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Important</summary><div class=box-content><p>If you <strong>cannot</strong> install Putty, please go to <a href=/observability-workshop/v5.76/en/scenarios/optimize_monitoring/1-getting-started/1-access-ec2/index.html#4-web-browser-all>Web Browser (All)</a>.</p></div></details><p>Open Putty and enter in the <strong>Host Name (or IP address)</strong> field the IP address provided in the Google Sheet.</p><p>You can optionally save your settings by providing a name and pressing <strong>Save</strong>.</p><p><a href=#R-image-51ff57465392f467eb2d86d687208f3b class=lightbox-link><img alt=putty-2 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/putty-settings.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-51ff57465392f467eb2d86d687208f3b><img alt=putty-2 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/putty-settings.png></a></p><p>To then login to your instance click on the <strong>Open</strong> button as shown above.</p><p>If this is the first time connecting to your AWS/EC2 workshop instance, you will be presented with a security dialogue, please click <strong>Yes</strong>.</p><p><a href=#R-image-1b7d054d9fa74b550250376005ca1416 class=lightbox-link><img alt=putty-3 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/putty-security.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1b7d054d9fa74b550250376005ca1416><img alt=putty-3 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/putty-security.png></a></p><p>Once connected, login in as <strong>splunk</strong> and the password is the one provided in the Google Sheet.</p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-07a355951d34b4b47659966abe17d6e4 class=lightbox-link><img alt=putty-4 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/putty-loggedin.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-07a355951d34b4b47659966abe17d6e4><img alt=putty-4 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/putty-loggedin.png></a></p><p>At this point, you are ready to continue and <a href=../gdi/index.html>start the workshop</a></p><hr><h2 id=5-web-browser-all>5. Web Browser (All)</h2><p>If you are blocked from using SSH (Port 22) or unable to install Putty you may be able to connect to the workshop instance by using a web browser.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>This assumes that access to port 6501 is not restricted by your company&rsquo;s firewall.</p></div></details><p>Open your web browser and type <strong><a href=http://x.x.x.x:6501 rel=external target=_blank>http://x.x.x.x:6501</a></strong> (where X.X.X.X is the IP address from the Google Sheet).</p><p><a href=#R-image-10e69c14fc2d536c6c1d98dfb6c5841d class=lightbox-link><img alt=http-6501 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images//shellinabox-url.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-10e69c14fc2d536c6c1d98dfb6c5841d><img alt=http-6501 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images//shellinabox-url.png></a></p><p>Once connected, login in as <strong>splunk</strong> and the password is the one provided in the Google Sheet.</p><p><a href=#R-image-377615783c1201dc16dc7d795ccf3a56 class=lightbox-link><img alt=http-connect class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images//shellinabox-connect.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-377615783c1201dc16dc7d795ccf3a56><img alt=http-connect class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images//shellinabox-connect.png></a></p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-00e6c4e031834b7631f53155336b5309 class=lightbox-link><img alt="web login" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images//shellinabox-login.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-00e6c4e031834b7631f53155336b5309><img alt="web login" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images//shellinabox-login.png></a></p><p>Unlike when you are using regular SSH, <em>copy and paste</em> does require a few extra steps to complete when using a browser session. This is due to cross browser restrictions.</p><p>When the workshop asks you to copy instructions into your terminal, please do the following:</p><p><em>Copy the instruction as normal, but when ready to paste it in the web terminal, choose <strong>Paste from the browser</strong> as show below:</em></p><p><a href=#R-image-b522d0a1787d86493ce7c558e5b488a0 class=lightbox-link><img alt="web paste 1" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images//shellinabox-paste-browser.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b522d0a1787d86493ce7c558e5b488a0><img alt="web paste 1" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images//shellinabox-paste-browser.png></a></p><p>This will open a dialogue box asking for the text to be pasted into the web terminal:</p><p><a href=#R-image-84f61ca7559888e40e90379a51480e81 class=lightbox-link><img alt="web paste 3" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images//shellinabox-example-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-84f61ca7559888e40e90379a51480e81><img alt="web paste 3" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images//shellinabox-example-1.png></a></p><p>Paste the text in the text box as shown, then press <strong>OK</strong> to complete the copy and paste process.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>Unlike regular SSH connection, the web browser has a 60-second time out, and you will be disconnected, and a <strong>Connect</strong> button will be shown in the center of the web terminal.</p><p>Simply click the <strong>Connect</strong> button and you will be reconnected and will be able to continue.</p></div></details><p><a href=#R-image-948bb727bd45d1741abec6c20382e234 class=lightbox-link><img alt="web reconnect" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images//shellinabox-reconnect.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-948bb727bd45d1741abec6c20382e234><img alt="web reconnect" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images//shellinabox-reconnect.png></a></p><p>At this point, you are ready to continue and <a href=../gdi/index.html>start the workshop</a>.</p><hr><h2 id=6-multipass-all>6. Multipass (All)</h2><p>If you are unable to access AWS but want to install software locally, follow the instructions for <a href=https://github.com/splunk/observability-workshop/blob/main/multipass/README.md rel=external target=_blank>using Multipass</a>.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.chiark.greenend.org.uk/~sgtatham/putty/ rel=external target=_blank>Download Putty</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-opentelemetry-demo-applciation>Deploy OpenTelemetry Demo Applciation</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><h2 id=introduction>Introduction</h2><p>For this workshop, we&rsquo;ll be using the <strong>OpenTelemetry Demo Application</strong> running in Kubernetes. This application is for an online retailer and includes more than a dozen services written in many different languages. While metrics, traces, and logs are being collected from this application, this workshop is primarily focused on how <strong>Splunk Observability Cloud</strong> can be used to more efficiently monitor infrastructure.</p><h2 id=pre-requisites>Pre-requisites</h2><ul><li>You should have access to the EC2 instance provided in section <a href=/observability-workshop/v5.76/en/scenarios/optimize_monitoring/1-getting-started/1-access-ec2/index.html>1.1 Access AWS/EC2 Instance</a></li></ul><h2 id=initial-steps>Initial Steps</h2><p>The initial setup can be completed by executing the following steps on the command line of your EC2 instance.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/optimize-cloud-monitoring <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>./deploy-application.sh</span></span></code></pre></div><p>You&rsquo;ll be asked to enter your favorite city. This will be used in the OpenTelemetry Collector configuration as a <strong>custom tag</strong> to show how easy it is to add additional context to your observability data.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>Custom tagging will be covered in more detail in the <a href=../standardize_data_collection/>Standardize Data Collection</a> section of this workshop.</p></div></details><p><a href=#R-image-949edbd2f15d0d96550171b1d35182c3 class=lightbox-link><img alt="Enter Favorite City" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/favorite-city.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-949edbd2f15d0d96550171b1d35182c3><img alt="Enter Favorite City" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/favorite-city.png?width=40vw"></a></p><p><strong>Your application should now be running and sending data to Splunk Observability Cloud. You&rsquo;ll dig into the data in the next section.</strong></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=standardize-data-collection>Standardize Data Collection</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><h2 id=why-standards-matter>Why Standards Matter</h2><p>As cloud adoption grows, we often face requests to support new technologies within a diverse landscape, posing challenges in delivering timely content. Take, for instance, a team containerizing five workloads on AWS requiring EKS visibility. Usually, this involves assisting with integration setup, configuring metadata, and creating dashboards and alerts—a process that&rsquo;s both time-consuming and increases administrative overhead and technical debt.</p><p><strong>Splunk Observability Cloud</strong> was designed to handle customers with a diverse set of technical requirements and stacks – from monolithic to microservices architectures, from homegrown applications to Software-as-a-Service.</p><p>Splunk offers a native experience for OpenTelemetry, which means OTel is the preferred way to get data into Splunk.
Between Splunk’s integrations and the OpenTelemetry community, there are a number of integrations available to easily collect from diverse infrastructure and applications. This includes both on-prem systems like VMWare and as well as guided integrations with cloud vendors, centralizing these hybrid environments.</p><p><a href=#R-image-a08fb6061f573d1857379eefc5303327 class=lightbox-link><img alt="Splunk Observability Cloud Integrations" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../images/integrations.png?width=50vw" style=height:auto;width:50vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a08fb6061f573d1857379eefc5303327><img alt="Splunk Observability Cloud Integrations" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../images/integrations.png?width=50vw"></a></p><p>For someone like a Splunk admin, the OpenTelemetry Collector can additionally be deployed to a Splunk Universal Forwarder as a <a href=https://splunkbase.splunk.com/app/7125 rel=external target=_blank>Technical Add-on</a>. This enables fast roll-out and centralized configuration management using the Splunk Deployment Server.
Let’s assume that the same team adopting Kubernetes is going to deploy a cluster for each one of our B2B customers. I’ll show you how to make a simple modification to the OpenTelemetry collector to add the customerID, and then use mirrored dashboards to allow any of our SRE teams to easily see the customer they care about.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. Standardize Data Collection</h1><article class=default><header class=headline></header><h1 id=what-are-tags>What Are Tags?</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>Tags are key-value pairs that provide additional metadata about metrics, spans in a trace, or logs allowing you to enrich the context of the data you send to <strong>Splunk Observability Cloud</strong>. Many tags are collected by default such as hostname or OS type. Custom tags can be used to provide environment or application-specific context. Examples of custom tags include:</p><h6 id=infrastructure-specific-attributes>Infrastructure specific attributes</h6><ul><li>What data center a host is in</li><li>What services are hosted on an instance</li><li>What team is responsible for a set of hosts</li></ul><h6 id=application-specific-attributes>Application specific attributes</h6><ul><li>What Application Version is running</li><li>Feature flags or experimental identifiers</li><li>Tenant ID in multi-tenant applications</li></ul><h6 id=user-related-attributes>User related attributes</h6><ul><li>User ID</li><li>User role (e.g. admin, guest, subscriber)</li><li>User geographical location (e.g. country, city, region)</li></ul><h6 id=there-are-two-ways-to-add-tags-to-your-data>There are two ways to add tags to your data</h6><ul><li>Add tags as OpenTelemetry attributes to metrics, traces, and logs when you send data to the Splunk Distribution of OpenTelemetry Collector. This option lets you add spans in bulk.</li><li>Instrument your application to create span tags. This option gives you the most flexibility at the per-application level.</li></ul><h3 id=why-are-tags-so-important>Why are tags so important?</h3><p>Tags are essential for an application to be truly observable. Tags add context to the traces to help us understand why some users get a great experience and others don&rsquo;t. Powerful features in <strong>Splunk Observability Cloud</strong> utilize tags to help you jump quickly to the root cause.</p><p><strong>Contextual Information:</strong> Tags provide additional context to the metrics, traces, and logs allowing developers and operators to understand the behavior and characteristics of infrastructure and traced operations.</p><p><strong>Filtering and Aggregation:</strong> Tags enable filtering and aggregation of collected data. By attaching tags, users can filter and aggregate data based on specific criteria. This filtering and aggregation help in identifying patterns, diagnosing issues, and gaining insights into system behavior.</p><p><strong>Correlation and Analysis:</strong> Tags facilitate correlation between metrics and other telemetry data, such as traces and logs. By including common identifiers or contextual information as tags, users can correlate metrics, traces, and logs enabling comprehensive analysis and troubleshooting of distributed systems.</p><p><strong>Customization and Flexibility:</strong> OpenTelemetry allows developers to define custom tags based on their application requirements. This flexibility enables developers to capture domain-specific metadata or contextual information that is crucial for understanding the behavior of their applications.</p><h3 id=attributes-vs-tags>Attributes vs. Tags</h3><p>A note about terminology before we proceed. While this workshop is about <strong>tags</strong>, and this is the terminology we use in <strong>Splunk Observability Cloud</strong>, OpenTelemetry uses the term <strong>attributes</strong> instead. So when you see tags mentioned throughout this workshop, you can treat them as synonymous with attributes.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=adding-context-with-tags>Adding Context With Tags</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>When you <a href=../getting_started/2-deploy-application/>deployed the OpenTelemetry Demo Application</a> in the <a href=../getting_started/>Getting Started</a> section of this workshop, you were asked to enter your favorite city. For this workshop, we&rsquo;ll be using that to show the value of custom tags.</p><p>For this workshop, the OpenTelemetry collector is pre-configured to use the city you provided as a custom tag called <code>store.location</code> which will be used to emulate Kubernetes Clusters running in different geographic locations. We&rsquo;ll use this tag as a filter to show how you can use Out-of-the-Box integration dashboards to quickly create views for specific teams, applications, or other attributes about your environment. Efficiently enabling content to be reused across teams without increasing technical debt.</p><p>Here is the OpenTelemetry Collector configuration used to add the <code>store.location</code> tag to all of the data sent to this collector. This means any metrics, traces, or logs will contain the <code>store.location</code> tag which can then be used to search, filter, or correlate this value.</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>If you&rsquo;re interested in a deeper dive on the <strong>OpenTelemetry Collector</strong>, head over to the <a href=/observability-workshop/v5.76/en/scenarios/self_service_observability/index.html><strong>Self Service Observability</strong></a> workshop where you can get hands-on with configuring the collector or the <a href=../../../../other/5-opentelemetry-collector><strong>OpenTelemetry Collector Ninja Workshop</strong></a> where you&rsquo;ll dissect the inner workings of each collector component.</p></div></details><p><a href=#R-image-52e798adb9740a8fd00df597f14eb987 class=lightbox-link><img alt="OpenTelemetry Collector Configuration" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/otel-config.png?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-52e798adb9740a8fd00df597f14eb987><img alt="OpenTelemetry Collector Configuration" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/otel-config.png?width=60vw"></a></p><p>While this example uses a hard-coded value for the tag, parameterized values can also be used, allowing you to customize the tags dynamically based on the context of each host, application, or operation. This flexibility enables you to capture relevant metadata, user-specific details, or system parameters, providing a rich context for metrics, tracing, and log data while enhancing the observability of your distributed systems.</p><p>Now that you have the appropriate context, which as we&rsquo;ve established is critical to Observability, let&rsquo;s head over to <strong>Splunk Observability Cloud</strong> and see how we can use the data we&rsquo;ve just configured.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=reuse-content-across-teams>Reuse Content Across Teams</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>In today&rsquo;s rapidly evolving technological landscape, where hybrid and cloud environments are becoming the norm, the need for effective monitoring and troubleshooting solutions has never been more critical. However, managing the elasticity and complexity of these modern infrastructures poses a significant challenge for teams across various industries. One of the primary pain points encountered in this endeavor is the inadequacy of existing monitoring and troubleshooting experiences.</p><p>Traditional monitoring approaches often fall short in addressing the intricacies of hybrid and cloud environments. Teams frequently encounter slow data visualization and troubleshooting processes, compounded by the clutter of bespoke yet similar dashboards and the manual correlation of data from disparate sources. This cumbersome workflow is made worse by the absence of monitoring tools tailored to ephemeral technologies such as containers, orchestrators like Kubernetes, and serverless functions.</p><p><a href=#R-image-1d478ecc3e32a33a924f182035a87093 class=lightbox-link><img alt="Infrastructure Overview in Splunk Observability Cloud" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../images/infra-overview.png?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1d478ecc3e32a33a924f182035a87093><img alt="Infrastructure Overview in Splunk Observability Cloud" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../images/infra-overview.png?width=60vw"></a></p><p>In this section, we&rsquo;ll cover how <strong>Splunk Observability Cloud</strong> provides out-of-the-box content for every integration. Not only do the out-of-the-box dashboards provide rich visibility into the infrastructure that is being monitored they can also be mirrored. This is important because it enables you to create standard dashboards for use by teams throughout your organization. This allows all teams to see any changes to the charts in the dashboard, and members of each team can set dashboard variables and filter customizations relevant to their requirements.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. Reuse Content Across Teams</h1><article class=default><header class=headline></header><h1 id=infrastrcuture-navigators>Infrastrcuture Navigators</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>Splunk Infrastructure Monitoring (IM) is a market-leading monitoring and observability service for hybrid cloud environments. Built on a patented streaming architecture, it provides a <strong>real-time</strong> solution for engineering teams to visualize and analyze performance across infrastructure, services, and applications in a fraction of the time and with greater accuracy than traditional solutions.</p><p><strong>300+ Easy-to-use OOTB content:</strong> Pre-built navigators and dashboards, deliver immediate visualizations of your entire environment so that you can interact with all your data in real time.<br><strong>Kubernetes navigator:</strong> Provides an instant, comprehensive out-of-the-box hierarchical view of nodes, pods, and containers. Ramp up even the most novice Kubernetes user with easy-to-understand interactive cluster maps.<br><strong>AutoDetect alerts and detectors:</strong> Automatically identify the most important metrics, out-of-the-box, to create alert conditions for detectors that accurately alert from the moment telemetry data is ingested and use real-time alerting capabilities for important notifications in seconds.<br><strong>Log views in dashboards:</strong> Combine log messages and real-time metrics on one page with common filters and time controls for faster in-context troubleshooting.<br><strong>Metrics pipeline management:</strong> Control metrics volume at the point of ingest without re-instrumentation with a set of aggregation and data-dropping rules to store and analyze only the needed data. Reduce metrics volume and optimize observability spend.</p><p><a href=#R-image-914bbda9664739415792ace39c538cf2 class=lightbox-link><img alt="Infrastructure Overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/infra-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-914bbda9664739415792ace39c538cf2><img alt="Infrastructure Overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/infra-overview.png></a></p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise: Find your Kubernetes Cluster</summary><div class=box-content><ul><li>From the <strong>Splunk Observability Cloud</strong> homepage, click the <a href=#R-image-25113fc629ba6ca2a18304b7160e26e1 class=lightbox-link><img alt=Infrastructure class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../images/infra-button.png?height=20px&classes=inline" style=height:20px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-25113fc629ba6ca2a18304b7160e26e1><img alt=Infrastructure class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/infra-button.png?height=20px&classes=inline"></a> button -> <strong>Kubernetes</strong> -> <strong>K8s nodes</strong></li><li>First, use the <a href=#R-image-827f84eafdb0c2571b33c48af1a47a5f class=lightbox-link><img alt="k8s filter" class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../images/k8s-add-filter.png?classes=inline" style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-827f84eafdb0c2571b33c48af1a47a5f><img alt="k8s filter" class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/k8s-add-filter.png?classes=inline"></a> option to pick your cluster.</li><li>From the filter drop-down box, use the <code>store.location</code> value you entered when deploying the application.</li><li>You then can start typing the city you used which should also appear in the drop-down values. Select yours and make sure just the one for your workshop is highlighted with a <a href=#R-image-a037927a9d009ec759c41e60f11e962b class=lightbox-link><img alt="blue tick" class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../images/select-checkmark.png?classes=inline&width=30px" style=height:auto;width:30px></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a037927a9d009ec759c41e60f11e962b><img alt="blue tick" class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/select-checkmark.png?classes=inline&width=30px"></a>.</li><li>Click the <span class="btn cstyle blue"><span><span class=title>Apply Filter</span></span></span> button to focus on our Cluster.</li></ul><p><a href=#R-image-41a253d39d8b1b1f8de5f8ca7fca4c9c class=lightbox-link><img alt="Kubernetes Navigator" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/k8s-nav.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-41a253d39d8b1b1f8de5f8ca7fca4c9c><img alt="Kubernetes Navigator" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/k8s-nav.png></a></p><ul><li>You should now have your Kubernetes Cluster visible</li><li>Here we can see all of the different components of the cluster (Nodes, Pods, etc), each of which has relevant metrics associated with it. On the right side, you can also see what services are running in the cluster.</li></ul><p><strong>Before moving to the next section, take some time to explore the Kubernetes Navigator to see the data that is available Out of the Box.</strong></p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=dashboard-cloning>Dashboard Cloning</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>ITOps teams responsible for monitoring fleets of infrastructure frequently find themselves manually creating dashboards to visualize and analyze metrics, traces, and log data emanating from rapidly changing cloud-native workloads hosted in Kubernetes and serverless architectures, alongside existing on-premises systems. Moreover, due to the absence of a standardized troubleshooting workflow, teams often resort to creating numerous custom dashboards, each resembling the other in structure and content. As a result, administrative overhead skyrockets and MTTR slows.</p><p>To address this, you can use the out-of-the-box dashboards available in <strong>Splunk Observability Cloud</strong> for each and every integration. These dashboards are filterable and can be used for ad hoc troubleshooting or as a templated approach to getting users the information they need without having to start from scratch. Not only do the out-of-the-box dashboards provide rich visibility into the infrastructure that is being monitored they can also be cloned.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise: Create a Mirrored Dashboard</summary><div class=box-content><ol><li>In <strong>Splunk Observability Cloud</strong>, click the Global Search <a href=#R-image-b0121e906491e408be259ae12a234a62 class=lightbox-link><img alt=Search class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../images/search.png?height=20px&classes=inline" style=height:20px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b0121e906491e408be259ae12a234a62><img alt=Search class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/search.png?height=20px&classes=inline"></a> button. (Global Search can be used to quickly find content)</li><li>Search for <strong>Pods</strong> and select <strong>K8s pods (Kubernetes)</strong>
<a href=#R-image-0761cca6c2c3488d13e3d5131b95d291 class=lightbox-link><img alt=Search class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/search-k8s-pods.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0761cca6c2c3488d13e3d5131b95d291><img alt=Search class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/search-k8s-pods.png></a></li><li>This will take you to the out-of-the-box Kubernetes Pods dashboard which we will use as a template for mirroring dashboards.</li><li>In the upper right corner of the dashboard click the <strong>Dashboard actions</strong> button (3 horizontal dots) -> Click <strong>Save As&mldr;</strong>
<a href=#R-image-6678662964983e8a719558beb9d957e9 class=lightbox-link><img alt=Search class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/k8s-pod-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6678662964983e8a719558beb9d957e9><img alt=Search class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/k8s-pod-dashboard.png></a></li><li>Enter a dashboard name (i.e. <strong>Kubernetes Pods Dashboard</strong>)</li><li>Under <strong>Dashboard group</strong> search for your e-mail address and select it.</li><li>Click <strong>Save</strong></li></ol><p><strong>Note:</strong> Every Observability Cloud user who has set a password and logged in at least once, gets a user dashboard group and user dashboard. Your user dashboard group is your individual workspace within Observability Cloud.</p><p><a href=#R-image-b31177baeffe96be01c45ba395d6b56a class=lightbox-link><img alt="Save Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/save-dashboard.png?height=400px" style=height:400px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b31177baeffe96be01c45ba395d6b56a><img alt="Save Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/save-dashboard.png?height=400px"></a></p><p>After saving, you will be taken to the newly created dashboard in the Dashboard Group for your user. This is an example of cloning an out-of-the-box dashboard which can be further customized and enables users to quickly build role, application, or environment relevant views.</p><p>Custom dashboards are meant to be used by multiple people and usually represent a curated set of charts that you want to make accessible to a broad cross-section of your organization. They are typically organized by service, team, or environment.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=dashboard-mirroring>Dashboard Mirroring</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>Not only do the out-of-the-box dashboards provide rich visibility into the infrastructure that is being monitored they can also be mirrored. This is important because it enables you to create standard dashboards for use by teams throughout your organization. This allows all teams to see any changes to the charts in the dashboard, and members of each team can set dashboard variables and filter customizations relevant to their requirements.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise: Create a Mirrored Dashboard</summary><div class=box-content><ol><li><p>While on the Kubernetes Pods dashboard, you created in the previous step, In the upper right corner of the dashboard click the <strong>Dashboard actions</strong> button (3 horizontal dots) -> Click <strong>Add a mirror&mldr;</strong>. A configuration modal for the Dashboard Mirror will open.</p><p><a href=#R-image-a3404b5c769952780186943dddf87517 class=lightbox-link><img alt="Mirror Dashboard Menu" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/mirror-dashboard-menu.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a3404b5c769952780186943dddf87517><img alt="Mirror Dashboard Menu" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/mirror-dashboard-menu.png?width=40vw"></a></p></li><li><p>Under <strong>My dashboard group</strong> search for your e-mail address and select it.</p></li><li><p>(Optional) Modify the dashboard in <strong>Dashboard name override</strong> name.</p></li><li><p>(Optional) Add a dashboard description in <strong>Dashboard description override</strong>.</p></li><li><p>Under <strong>Default filter overrides</strong> search for <code>k8s.cluster.name</code> and select the name of your Kubernetes cluster.</p></li><li><p>Under <strong>Default filter overrides</strong> search for <code>store.location</code> and select the city you entered during the workshop setup.
<a href=#R-image-9d67d6f02dbe7a526bc307dc8eb26ee7 class=lightbox-link><img alt="Mirror Dashboard Config" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/mirror-dashboard-config.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9d67d6f02dbe7a526bc307dc8eb26ee7><img alt="Mirror Dashboard Config" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/mirror-dashboard-config.png?width=40vw"></a></p></li><li><p>Click <strong>Save</strong></p></li></ol><p>You will now be taken to the newly created dashboard which is a mirror of the Kubernetes Pods dashboard you created in the previous section. Any changes to the original dashboard will be reflected in this dashboard as well. This allows teams to have a consistent yet specific view of the systems they care about and any modifications or updates can be applied in a single location, significantly minimizing the effort needed when compared to updating each individual dashboard.</p><p>In the next section, you&rsquo;ll add a new logs-based chart to the original dashboard and see how the dashboard mirror is automatically updated as well.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=correlate-metrics-and-logs>Correlate Metrics and Logs</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>1 minute</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>Correlating infrastructure metrics and logs is often a challenging task, primarily due to inconsistencies in naming conventions across various data sources, including hosts operating on different systems. However, leveraging the capabilities of <strong>OpenTelemetry</strong> can significantly simplify this process. With OpenTelemetry&rsquo;s robust framework, which offers rich metadata and attribution, metrics, traces, and logs can seamlessly correlate using standardized field names. This automated correlation not only alleviates the burden of manual effort but also enhances the overall observability of the system.</p><p>By aligning metrics and logs based on common field names, teams gain deeper insights into system performance, enabling more efficient troubleshooting, proactive monitoring, and optimization of resources. In this workshop section, we&rsquo;ll explore the importance of correlating metrics with logs and demonstrate how Splunk <strong>Observability Cloud</strong> empowers teams to unlock additional value from their observability data.</p><p><a href=#R-image-7d50ef956e38f46cb05ab116f9ca2612 class=lightbox-link><img alt="Log Observer" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log-observer.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7d50ef956e38f46cb05ab116f9ca2612><img alt="Log Observer" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log-observer.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 4. Correlate Metrics and Logs</h1><article class=default><header class=headline></header><h1 id=correlate-metrics-and-logs>Correlate Metrics and Logs</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>In this section, we&rsquo;ll dive into the seamless correlation of metrics and logs facilitated by the robust naming standards offered by <strong>OpenTelemetry</strong>. By harnessing the power of OpenTelemetry within <strong>Splunk Observability Cloud</strong>, we&rsquo;ll demonstrate how troubleshooting issues becomes significantly more efficient for Site Reliability Engineers (SREs) and operators. With this integration, contextualizing data across various telemetry sources no longer demands manual effort to correlate information. Instead, SREs and operators gain immediate access to the pertinent context they need, allowing them to swiftly pinpoint and resolve issues, improving system reliability and performance.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise: View pod logs</summary><div class=box-content><p>The <strong>Kubernetes Pods Dashboard</strong> you created in the previous section already includes a chart that contains all of the pod logs for your Kubernetes Cluster. The log entries are split by container in this stacked bar chart. To view specific log entries perform the following steps:</p><ol><li><p>On the <strong>Kubernetes Pods Dashboard</strong> click on one of the bar charts. A modal will open with the most recent log entries for the container you&rsquo;ve selected.</p><p><a href=#R-image-31ac2a0188f767353a3df7a51dd298cc class=lightbox-link><img alt="K8s pod logs" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/k8s-pod-logs.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-31ac2a0188f767353a3df7a51dd298cc><img alt="K8s pod logs" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/k8s-pod-logs.png?width=40vw"></a></p></li><li><p>Click one of the log entries.</p><p><a href=#R-image-84595220528e67088edfbbb8f1abaaf1 class=lightbox-link><img alt="K8s pod log event" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/k8s-pod-log-event.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-84595220528e67088edfbbb8f1abaaf1><img alt="K8s pod log event" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/k8s-pod-log-event.png?width=40vw"></a></p><p>Here we can see the entire log event with all of the fields and values. You can search for specific field names or values within the event itself using the <strong>Search for fields</strong> bar in the event.</p></li><li><p>Enter the city you configured during the application deployment</p><p><a href=#R-image-62fa7da17d7b9a82ff24a9e1967cf2ca class=lightbox-link><img alt="K8s pod log field search" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/k8s-pod-log-field-search.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-62fa7da17d7b9a82ff24a9e1967cf2ca><img alt="K8s pod log field search" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/k8s-pod-log-field-search.png?width=40vw"></a></p><p>The event will now be filtered to the <code>store.location</code> field. This feature is great for exploring large log entries for specific fields and values unique to your environment or to search for keywords like <code>Error</code> or <code>Failure</code>.</p></li><li><p>Close the event using the <code>X</code> in the upper right corner.</p></li><li><p>Click the <strong>Chart actions</strong> (three horizontal dots) on the <strong>Pod log event rate</strong> chart</p></li><li><p>Click <strong>View in Log Observer</strong></p></li></ol><p><a href=#R-image-c90239d998417743ec08ccba98fffb1b class=lightbox-link><img alt="View in Log Observer" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/k8s-pod-loc.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c90239d998417743ec08ccba98fffb1b><img alt="View in Log Observer" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/k8s-pod-loc.png?width=40vw"></a></p><p>This will take us to <strong>Log Observer</strong>. In the next section, you&rsquo;ll create a chart based on log events and add it to the <strong>K8s Pod Dashboard</strong> you cloned in section <a href=../../3-reuse-content-across-teams/2-clone-dashboards>3.2 Dashboard Cloning</a>. You&rsquo;ll also see how this new chart is automatically added to the mirrored dashboard you created in section <a href=../../3-reuse-content-across-teams/3-mirror-dashboards>3.3 Dashboard Mirroring</a>.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-log-based-chart>Create Log-based Chart</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>In Log Observer, you can perform codeless queries on logs to detect the source of problems in your systems. You can also extract fields from logs to set up log processing rules and transform your data as it arrives or send data to Infinite Logging S3 buckets for future use. See <a href=https://docs.splunk.com/observability/en/logs/get-started-logs.html#logobserverfeatures rel=external target=_blank>What can I do with Log Observer?</a> to learn more about Log Observer capabilities.</p><p>In this section, you&rsquo;ll create a chart filtered to logs that include errors which will be added to the <strong>K8s Pod Dashboard</strong> you cloned in section <a href=../../3-reuse-content-across-teams/2-clone-dashboards>3.2 Dashboard Cloning</a>.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise: Create Log-based Chart</summary><div class=box-content><p>Because you drilled into <strong>Log Observer</strong> from the <strong>K8s Pod Dashboard</strong> in the previous section, the dashboard will already be filtered to your cluster and store location using the <code>k8s.cluster.name</code> and <code>store.location</code> fields and the bar chart is split by <code>k8s.pod.name</code>. To filter the dashboard to only logs that contain errors complete the following steps:</p><p><strong>Log Observer</strong> can be filtered using Keywords or specific key-value pairs.</p><ol><li><p>In <strong>Log Observer</strong> click <strong>Add Filter</strong> along the top.</p></li><li><p>Make sure you&rsquo;ve selected <strong>Fields</strong> as the filter type and enter <code>severity</code> in the <strong>Find a field&mldr;</strong> search bar.</p></li><li><p>Select <code>severity</code> from the fields list.</p><p>You should now see a list of severities and the number of log entries for each.</p></li><li><p>Under <strong>Top values</strong>, hover over Error and click the <code>=</code> button to apply the filter.</p><p><a href=#R-image-492a8e831167a29b1903c3929db8a09b class=lightbox-link><img alt="Log Observer: Filter errors" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/loc-filter-errors.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-492a8e831167a29b1903c3929db8a09b><img alt="Log Observer: Filter errors" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/loc-filter-errors.png?width=40vw"></a></p><p>The dashboard will now be filtered to only log entries with a severity of Error and the bar chart will be split by the Kubernetes Pod that contains the errors. Next, you&rsquo;ll save the chart on your <strong>Kubernetes Pods Dashboard</strong>.</p></li><li><p>In the upper right corner of the <strong>Log Observer</strong> dashboard click <strong>Save</strong>.</p></li><li><p>Select <strong>Save to Dashboard</strong>.</p></li><li><p>In the <strong>Chart name</strong> field enter a name for your chart.</p></li><li><p>(Optional) In the <strong>Chart description</strong> field enter a description for your chart.</p><p><a href=#R-image-0812a8ff85b979dc08f82c229a8ff9a1 class=lightbox-link><img alt="Log Observer: Save Chart Name" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/loc-save-chart-name.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0812a8ff85b979dc08f82c229a8ff9a1><img alt="Log Observer: Save Chart Name" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/loc-save-chart-name.png?width=40vw"></a></p></li><li><p>Click <strong>Select Dashboard</strong> and search for the name of the Dashboard you cloned in section <a href=../../3-reuse-content-across-teams/2-clone-dashboards>3.2 Dashboard Cloning</a>.</p></li><li><p>Select the dashboard in the Dashboard Group for your email address.</p><p><a href=#R-image-214eef58517449f8be04377ad281d1ba class=lightbox-link><img alt="Log Observer: Select Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/loc-select-dashboard.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-214eef58517449f8be04377ad281d1ba><img alt="Log Observer: Select Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/loc-select-dashboard.png?width=40vw"></a></p></li><li><p>Click <strong>OK</strong></p></li><li><p>For the <strong>Chart type</strong> select <strong>Log timeline</strong></p></li><li><p>Click <strong>Save and go to the dashboard</strong></p></li></ol><p>You will now be taken to your <strong>Kubernetes Pods Dashboard</strong> where you should see the chart you just created for pod errors.</p><p><a href=#R-image-24c2dc77af880b187eaa09ed24faac1b class=lightbox-link><img alt="Log Errors Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/k8s-pod-log-error-chart.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-24c2dc77af880b187eaa09ed24faac1b><img alt="Log Errors Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/k8s-pod-log-error-chart.png?width=40vw"></a></p><p>Because you updated the original <strong>Kubernetes Pods Dashboard</strong>, your mirrored dashboard will also include this chart as well! You can see this by clicking the mirrored version of your dashboard along the top of the Dashboard Group for your user.</p><p><a href=#R-image-9754de0efa6e1dfa427a1aac70fcb1c9 class=lightbox-link><img alt="Log Errors Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/k8s-pod-select-dashboard.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9754de0efa6e1dfa427a1aac70fcb1c9><img alt="Log Errors Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/k8s-pod-select-dashboard.png?width=40vw"></a></p><p><strong>Now that you&rsquo;ve seen how data can be reused across teams by cloning the dashboard, creating dashboard mirrors and how metrics can easily be correlated with logs, let&rsquo;s take a look at how to create alerts so your teams can be notified when there is an issue with their infrastructure, services, or applications.</strong></p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=improve-timeliness-of-alerts>Improve Timeliness of Alerts</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>1 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>When monitoring hybrid and cloud environments, ensuring timely alerts for critical infrastructure and applications poses a significant challenge. Typically, this involves crafting intricate queries, meticulously scheduling searches, and managing alerts across various monitoring solutions. Moreover, the proliferation of disparate alerts generated from identical data sources often results in unnecessary duplication, contributing to alert fatigue and noise within the monitoring ecosystem.</p><p>In this section, we&rsquo;ll explore how Splunk Observability Cloud addresses these challenges by enabling the effortless creation of alert criteria. Leveraging its 10-second default data collection capability, alerts can be triggered swiftly, surpassing the timeliness achieved by traditional monitoring tools. This enhanced responsiveness not only reduces Mean Time to Detect (MTTD) but also accelerates Mean Time to Resolve (MTTR), ensuring that critical issues are promptly identified and remediated.</p><p><a href=#R-image-51cd617ac91a0bc3d58967848b50b014 class=lightbox-link><img alt="Detector Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/detector-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-51cd617ac91a0bc3d58967848b50b014><img alt="Detector Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/detector-dashboard.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 5. Improve Timeliness of Alerts</h1><article class=default><header class=headline></header><h1 id=create-custom-detector>Create Custom Detector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>Splunk Observability Cloud provides detectors, events, alerts, and notifications to keep you informed when certain criteria are met. There are a number of pre-built <strong>AutoDetect Detectors</strong> that automatically surface when common problem patterns occur, such as when an EC2 instance’s CPU utilization is expected to reach its limit. Additionally, you can also create custom detectors if you want something more optimized or specific. For example, you want a message sent to a Slack channel or to an email address for the Ops team that manages this Kubernetes cluster when Memory Utilization on their pods has reached 85%.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise: Create Custom Detector</summary><div class=box-content><p>In this section you&rsquo;ll create a detector on <strong>Pod Memory Utilization</strong> which will trigger if utilization surpasses 85%</p><ol><li><p>On the <strong>Kubernetes Pods Dashboard</strong> you cloned in section <a href=../../3-reuse-content-across-teams/2-clone-dashboards>3.2 Dashboard Cloning</a>, click the <strong>Get Alerts</strong> button (bell icon) for the <strong>Memory usage (%)</strong> chart -> Click <strong>New detector from chart</strong>.</p><p><a href=#R-image-5ed2cb74428344b49818a369f3f8bb98 class=lightbox-link><img alt="New Detector from Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/new-detector.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5ed2cb74428344b49818a369f3f8bb98><img alt="New Detector from Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/new-detector.png?width=40vw"></a></p></li><li><p>In the <strong>Create detector</strong> add your initials to the detector name.</p><p><a href=#R-image-1445acaf1c89664ef37404d27ddd7641 class=lightbox-link><img alt="Create Detector: Update Detector Name" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/create-detector-name.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1445acaf1c89664ef37404d27ddd7641><img alt="Create Detector: Update Detector Name" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/create-detector-name.png?width=40vw"></a></p></li><li><p>Click <strong>Create alert rule</strong>.</p><p>These conditions are expressed as one or more rules that trigger an alert when the conditions in the rules are met. Importantly, multiple rules can be included in the same detector configuration which minimizes the total number of alerts that need to be created and maintained. You can see which signal this detector will alert on by the bell icon in the <strong>Alert On</strong> column. In this case, this detector will alert on the Memory Utilization for the pods running in this Kubernetes cluster.</p><p><a href=#R-image-26616103527a8d3f64955d1c48e367fb class=lightbox-link><img alt="Alert Signal" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/alert-signals.png?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-26616103527a8d3f64955d1c48e367fb><img alt="Alert Signal" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/alert-signals.png?width=60vw"></a></p></li><li><p>Click <strong>Proceed To Alert Conditions</strong>.</p><p>Many pre-built alert conditions can be applied to the metric you want to alert on. This could be as simple as a static threshold or something more complex, for example, is memory usage deviating from the historical baseline across any of your 50,000 containers?</p><p><a href=#R-image-62e0f7997ec22882dbc67c4027b5a515 class=lightbox-link><img alt="Alert Conditions" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/alert-conditions.png?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-62e0f7997ec22882dbc67c4027b5a515><img alt="Alert Conditions" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/alert-conditions.png?width=60vw"></a></p></li><li><p>Select <strong>Static Threshold</strong>.</p></li><li><p>Click <strong>Proceed To Alert Settings</strong>.</p><p>In this case, you want the alert to trigger if any pods exceed 85% memory utilization. Once you’ve set the alert condition, the configuration is back-tested against the historical data so you can confirm that the alert configuration is accurate, meaning will the alert trigger on the criteria you’ve defined? This is also a great way to confirm if the alert generates too much noise.</p><p><a href=#R-image-e66fbc0924d77e2a5913dbb57676c548 class=lightbox-link><img alt="Alert Settings" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/alert-settings.png?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e66fbc0924d77e2a5913dbb57676c548><img alt="Alert Settings" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/alert-settings.png?width=60vw"></a></p></li><li><p>Enter 85 in the <strong>Threshold</strong> field.</p></li><li><p>Click <strong>Proceed To Alert Message</strong>.</p><p>Next, you can set the severity for this alert, you can include links to runbooks and short tips on how to respond, and you can customize the message that is included in the alert details. The message can include parameterized fields from the actual data, for example, in this case, you may want to include which Kubernetes node the pod is running on, or the <code>store.location</code> configured when you deployed the application, to provide additional context.</p><p><a href=#R-image-7a343716835348d556b84137bde897ac class=lightbox-link><img alt="Alert Message" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/alert-message.png?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a343716835348d556b84137bde897ac><img alt="Alert Message" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/alert-message.png?width=60vw"></a></p></li><li><p>Click <strong>Proceed To Alert Recipients</strong>.</p><p>You can choose where you want this alert to be sent when it triggers. This could be to a team, specific email addresses, or to other systems such as ServiceNow, Slack, Splunk On-Call or Splunk ITSI. You can also have the alert execute a webhook which enables me to leverage automation or to integrate with many other systems such as homegrown ticketing tools. <strong>For the purpose of this workshop do not include a recipient</strong></p><p><a href=#R-image-6dd70b475cdf4d10abd9016e72515be2 class=lightbox-link><img alt="Alert Recipients" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/alert-recipients.png?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6dd70b475cdf4d10abd9016e72515be2><img alt="Alert Recipients" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/alert-recipients.png?width=60vw"></a></p></li><li><p>Click <strong>Proceed To Alert Activation</strong>.</p><p><a href=#R-image-9358fff5c99027f951d660bcad7dc0c3 class=lightbox-link><img alt="Activate Alert" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/alert-activate-alert.png?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9358fff5c99027f951d660bcad7dc0c3><img alt="Activate Alert" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/alert-activate-alert.png?width=60vw"></a></p></li><li><p>Click <strong>Activate Alert</strong>.</p><p><a href=#R-image-fd8d942048a4f995a2b0cf99254a6ed3 class=lightbox-link><img alt="Activate Alert Message" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/alert-activation.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fd8d942048a4f995a2b0cf99254a6ed3><img alt="Activate Alert Message" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/alert-activation.png?width=40vw"></a></p><p>You will receive a warning because no recipients were included in the Notification Policy for this detector. This can be warning can be dismissed.</p></li><li><p>Click <strong>Save</strong>.</p><p><a href=#R-image-32c6333099ce923fc4fbf46f4e88437f class=lightbox-link><img alt="Activate Alert Message" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/alert-new-detector.png?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-32c6333099ce923fc4fbf46f4e88437f><img alt="Activate Alert Message" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/alert-new-detector.png?width=60vw"></a></p><p>You will be taken to your newly created detector where you can see any triggered alerts.</p></li><li><p>In the upper right corner, Click <strong>Close</strong> to close the Detector.</p></li></ol><p>The detector status and any triggered alerts will automatically be included in the chart because this detector was configured for this chart.</p><p><a href=#R-image-7963668119f45eb948c389efddc6ce17 class=lightbox-link><img alt="Alert Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/alert-chart.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7963668119f45eb948c389efddc6ce17><img alt="Alert Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/alert-chart.png?width=40vw"></a></p><p><strong>Congratulations! You&rsquo;ve successfully created a detector that will trigger if pod memory utilization exceeds 85%. After a few minutes, the detector should trigger some alerts. You can click the detector name in the chart to view the triggered alerts.</strong></p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=conclusion>Conclusion</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>1 minute</span>
</span>&nbsp;<p>Today you’ve seen how Splunk Observability Cloud can help you overcome many of the challenges you face monitoring hybrid and cloud environments. You’ve demonstrated how <strong>Splunk Observability Cloud</strong> streamlines operations with standardized data collection and tags, ensuring consistency across all IT infrastructure. The Unified Service Telemetry has been a game-changer, providing in-context metrics, logs, and trace data that make troubleshooting swift and efficient. By enabling the reuse of content across teams, you’re minimizing technical debt and bolstering the performance of our monitoring systems.</p><h2 id=happy-splunking>Happy Splunking!</h2><p><a href=#R-image-d33b01128815a3f60a132c2630e030f4 class=lightbox-link><img alt="Dancing Buttercup" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../images/Splunk-dancing-buttercup-GIF-103.gif?width=30vw" style=height:auto;width:30vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d33b01128815a3f60a132c2630e030f4><img alt="Dancing Buttercup" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../images/Splunk-dancing-buttercup-GIF-103.gif?width=30vw"></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 4, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=debug-problems-in-microservices>Debug Problems in Microservices</h1><ul class="children children-li children-sort-"><li><a href=/observability-workshop/v5.76/en/scenarios/debug_problems/tagging/index.html>Tagging Workshop</a><p>This workshop shows how tags can be used to reduce the time required for SREs to isolate issues across services, so they know which team to engage to troubleshoot the issue further, and can provide context to help engineering get a head start on debugging.</p></li><li><a href=/observability-workshop/v5.76/en/scenarios/debug_problems/profiling/index.html>Profiling Workshop</a><p>This workshop shows how Database Query Performance and AlwaysOn Profiling can be used to reduce the time required for engineers to debug problems in microservices.</p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Debug Problems in Microservices</h1><article class=default><header class=headline></header><h1 id=tagging-workshop>Tagging Workshop</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Derek Mitchell</span></span><p><strong>Splunk Observability Cloud</strong> includes powerful features that dramatically reduce the time required for SREs to isolate issues across services, so they know which team to engage to troubleshoot the issue further, and can provide context to help engineering get a head start on debugging.</p><p>Unlocking these features requires tags to be included with your application traces. But how do you know which tags are the most valuable and how do you capture them?</p><p>In this workshop, we&rsquo;ll explore:</p><ul><li>What are <strong>tags</strong> and why are they such a critical part of making an application observable.</li><li>How to use <a href=https://opentelemetry.io rel=external target=_blank><strong>OpenTelemetry</strong></a> to capture tags of interest from your application.</li><li>How to index tags in <strong>Splunk Observability Cloud</strong> and the differences between <strong>Troubleshooting MetricSets</strong> and <strong>Monitoring MetricSets</strong>.</li><li>How to utilize tags in <strong>Splunk Observability Cloud</strong> to find “unknown unknowns” using the <strong>Tag Spotlight</strong> and <strong>Dynamic Service Map</strong> features.</li><li>How to utilize tags for alerting and dashboards.</li></ul><p>The workshop uses a simple microservices-based application to illustrate these concepts. Let&rsquo;s get started!</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (◀️) and right (▶️) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Tagging Workshop</h1><article class=default><header class=headline></header><h1 id=build-the-sample-application>Build the Sample Application</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>For this workshop, we&rsquo;ll be using a microservices-based application. This application is for an online retailer and normally includes more than a dozen services. However, to keep the workshop simple, we&rsquo;ll be focusing on two services used by the retailer as part of their payment processing workflow: the credit check service and the credit processor service.</p><h2 id=pre-requisites>Pre-requisites</h2><p>You will start with an EC2 instance and perform some <a href=/observability-workshop/v5.76/en/scenarios/debug_problems/tagging/1-build-application/index.html#initial-steps>initial steps</a> in order to get to the following state:</p><ul><li>Deploy the <strong>Splunk distribution of the OpenTelemetry Collector</strong></li><li>Build and deploy <code>creditcheckservice</code> and <code>creditprocessorservice</code></li><li>Deploy a load generator to send traffic to the services</li></ul><h2 id=initial-steps>Initial Steps</h2><p>The initial setup can be completed by executing the following steps on the command line of your EC2 instance:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> workshop/tagging
</span></span><span class=line><span class=cl>./0-deploy-collector-with-services.sh</span></span></code></pre></div><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Java</summary><div class=box-content><p>There are implementations in multiple languages available for <code>creditcheckservice</code>.
Run</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./0-deploy-collector-with-services.sh java</span></span></code></pre></div><p>to pick Java over Python.</p></div></details><h2 id=view-your-application-in-splunk-observability-cloud>View your application in Splunk Observability Cloud</h2><p>Now that the setup is complete, let&rsquo;s confirm that it&rsquo;s sending data to <strong>Splunk Observability Cloud</strong>. Note that when the application is deployed for the first time, it may take a few minutes for the data to appear.</p><p>Navigate to APM, then use the Environment dropdown to select your environment (i.e. <code>tagging-workshop-instancename</code>).</p><p>If everything was deployed correctly, you should see <code>creditprocessorservice</code> and <code>creditcheckservice</code> displayed in the list of services:</p><p><a href=#R-image-3ea39a3adadea1e147e0232db1e506aa class=lightbox-link><img alt="APM Overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm_overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3ea39a3adadea1e147e0232db1e506aa><img alt="APM Overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm_overview.png></a></p><p>Click on <strong>Explore</strong> on the right-hand side to view the service map. We can see that the <code>creditcheckservice</code> makes calls to the <code>creditprocessorservice</code>, with an average response time of at least 3 seconds:</p><p><a href=#R-image-0a9209bf2d226515d946e8ce7921582e class=lightbox-link><img alt="Service Map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/service_map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a9209bf2d226515d946e8ce7921582e><img alt="Service Map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/service_map.png></a></p><p>Next, click on <strong>Traces</strong> on the right-hand side to see the traces captured for this application. You&rsquo;ll see that some traces run relatively fast (i.e. just a few milliseconds), whereas others take a few seconds.</p><p><a href=#R-image-762b67fc32566af4e2f80869c8422061 class=lightbox-link><img alt=Traces class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/traces.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-762b67fc32566af4e2f80869c8422061><img alt=Traces class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/traces.png></a></p><p>If you toggle <strong>Errors only</strong> to <code>on</code>, you&rsquo;ll also notice that some traces have errors:</p><p><a href=#R-image-b32e73727ba4f502f953f9c76941cbde class=lightbox-link><img alt=Traces class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/traces_with_errors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b32e73727ba4f502f953f9c76941cbde><img alt=Traces class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/traces_with_errors.png></a></p><p>Toggle <strong>Errors only</strong> back to <code>off</code> and sort the traces by duration, then click on one of the longer running traces. In this example, the trace took five seconds, and we can see that most of the time was spent calling the <code>/runCreditCheck</code> operation, which is part of the <code>creditprocessorservice</code>.</p><p><a href=#R-image-8a56e695054bfb7e21e186dbe55ecb04 class=lightbox-link><img alt="Long Running Trace" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/long_running_trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8a56e695054bfb7e21e186dbe55ecb04><img alt="Long Running Trace" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/long_running_trace.png></a></p><p>Currently, we don&rsquo;t have enough details in our traces to understand why some requests finish in a few milliseconds, and others take several seconds. To provide the best possible customer experience, this will be critical for us to understand.</p><p>We also don&rsquo;t have enough information to understand why some requests result in errors, and others don&rsquo;t. For example, if we look at one of the error traces, we can see that the error occurs when the <code>creditprocessorservice</code> attempts to call another service named <code>otherservice</code>. But why do some requests results in a call to <code>otherservice</code>, and others don&rsquo;t?</p><p><a href=#R-image-28a959a15091da518b5b8234d03fe73d class=lightbox-link><img alt="Trace with Errors" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/error_trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-28a959a15091da518b5b8234d03fe73d><img alt="Trace with Errors" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/error_trace.png></a></p><p>We&rsquo;ll explore these questions and more in the workshop.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=what-are-tags>What are Tags?</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;<p>To understand why some requests have errors or slow performance, we&rsquo;ll need to add context to our traces. We&rsquo;ll do this by adding tags. But first, let&rsquo;s take a moment to discuss what tags are, and why they&rsquo;re so important for observability.</p><h2 id=what-are-tags>What are tags?</h2><p>Tags are key-value pairs that provide additional metadata about spans in a trace, allowing you to enrich the context of the spans you send to Splunk APM.</p><p>For example, a payment processing application would find it helpful to track:</p><ul><li>The payment type used (i.e. credit card, gift card, etc.)</li><li>The ID of the customer that requested the payment</li></ul><p>This way, if errors or performance issues occur while processing the payment, we have the context we need for troubleshooting.</p><p>While some tags can be added with the OpenTelemetry collector, the ones we’ll be working with in this workshop are more granular, and are added by application developers using the OpenTelemetry API.</p><h2 id=attributes-vs-tags>Attributes vs. Tags</h2><p>A note about terminology before we proceed. While this workshop is about <strong>tags</strong>, and this is the terminology we use in <strong>Splunk Observability Cloud</strong>, OpenTelemetry uses the term <strong>attributes</strong> instead. So when you see tags mentioned throughout this workshop, you can treat them as synonymous with attributes.</p><h2 id=why-are-tags-so-important>Why are tags so important?</h2><p>Tags are essential for an application to be truly observable. As we saw with our credit check service, some users are having a great experience: fast with no errors. But other users get a slow experience or encounter errors.</p><p>Tags add the context to the traces to help us understand why some users get a great experience and others don&rsquo;t. And powerful features in <strong>Splunk Observability Cloud</strong> utilize tags to help you jump quickly to root cause.</p><h2 id=sneak-peak-tag-spotlight>Sneak Peak: Tag Spotlight</h2><p><strong>Tag Spotlight</strong> uses tags to discover trends that contribute to high latency or error rates:</p><p><a href=#R-image-7a852b553cfdd5f94f797605180b62c4 class=lightbox-link><img alt="Tag Spotlight Preview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/tag_spotlight_preview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a852b553cfdd5f94f797605180b62c4><img alt="Tag Spotlight Preview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/tag_spotlight_preview.png></a></p><p>The screenshot above provides an example of Tag Spotlight from another application.</p><p>Splunk has analyzed all of the tags included as part of traces that involve the payment service.</p><p>It tells us very quickly whether some tag values have more errors than others.</p><p>If we look at the version tag, we can see that version 350.10 of the service has a 100% error rate, whereas version 350.9 of the service has no errors at all:</p><p><a href=#R-image-144c9b547123b6a38f1c7741bdef4b35 class=lightbox-link><img alt="Tag Spotlight Preview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/tag_spotlight_preview_details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-144c9b547123b6a38f1c7741bdef4b35><img alt="Tag Spotlight Preview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/tag_spotlight_preview_details.png></a></p><p>We’ll be using Tag Spotlight with the credit check service later on in the workshop, once we’ve captured some tags of our own.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=capture-tags-with-opentelemetry>Capture Tags with OpenTelemetry</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>Please proceed to one of the subsections for Java or Python. Ask your instructor for the one used during the workshop!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. Capture Tags with OpenTelemetry</h1><article class=default><header class=headline></header><h1 id=1-capture-tags---java>1. Capture Tags - Java</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>Let&rsquo;s add some tags to our traces, so we can find out why some customers receive a poor experience from our application.</p><h2 id=identify-useful-tags>Identify Useful Tags</h2><p>We&rsquo;ll start by reviewing the code for the <code>creditCheck</code> function of <code>creditcheckservice</code> (which can be found in the file <code>/home/splunk/workshop/tagging/creditcheckservice-java/src/main/java/com/example/creditcheckservice/CreditCheckController.java</code>):</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/check&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=nf>creditCheck</span><span class=p>(</span><span class=nd>@RequestParam</span><span class=p>(</span><span class=s>&#34;customernum&#34;</span><span class=p>)</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>customerNum</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Get Credit Score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>creditScore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>creditScoreUrl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;http://creditprocessorservice:8899/getScore?customernum=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>customerNum</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>creditScore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Integer</span><span class=p>.</span><span class=na>parseInt</span><span class=p>(</span><span class=n>restTemplate</span><span class=p>.</span><span class=na>getForObject</span><span class=p>(</span><span class=n>creditScoreUrl</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>class</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>HttpClientErrorException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>status</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>INTERNAL_SERVER_ERROR</span><span class=p>).</span><span class=na>body</span><span class=p>(</span><span class=s>&#34;Error getting credit score&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>creditScoreCategory</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getCreditCategoryFromScore</span><span class=p>(</span><span class=n>creditScore</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Run Credit Check</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>creditCheckUrl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;http://creditprocessorservice:8899/runCreditCheck?customernum=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>customerNum</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&amp;score=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>creditScore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>checkResult</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>checkResult</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>restTemplate</span><span class=p>.</span><span class=na>getForObject</span><span class=p>(</span><span class=n>creditCheckUrl</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>HttpClientErrorException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>status</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>INTERNAL_SERVER_ERROR</span><span class=p>).</span><span class=na>body</span><span class=p>(</span><span class=s>&#34;Error running credit check&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>ok</span><span class=p>(</span><span class=n>checkResult</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></div><p>We can see that this function accepts a <strong>customer number</strong> as an input. This would be helpful to capture as part of a trace. What else would be helpful?</p><p>Well, the <strong>credit score</strong> returned for this customer by the <code>creditprocessorservice</code> may be interesting (we want to ensure we don&rsquo;t capture any PII data though). It would also be helpful to capture the <strong>credit score category</strong>, and the <strong>credit check result</strong>.</p><p>Great, we&rsquo;ve identified four tags to capture from this service that could help with our investigation. But how do we capture these?</p><h2 id=capture-tags>Capture Tags</h2><p>We start by adding OpenTelemetry imports to the top of the <code>CreditCheckController.java</code> file:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>io.opentelemetry.api.trace.Span</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>io.opentelemetry.instrumentation.annotations.WithSpan</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>io.opentelemetry.instrumentation.annotations.SpanAttribute</span><span class=p>;</span></span></span></code></pre></div><p>Next, we use the <code>@WithSpan</code> annotation to produce a span for <code>creditCheck</code>:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/check&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@WithSpan</span><span class=w> </span><span class=c1>// ADDED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=nf>creditCheck</span><span class=p>(</span><span class=nd>@RequestParam</span><span class=p>(</span><span class=s>&#34;customernum&#34;</span><span class=p>)</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>customerNum</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span></span></span></code></pre></div><p>We can now get a reference to the current span and add an attribute (aka tag) to it:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>creditScoreUrl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;http://creditprocessorservice:8899/getScore?customernum=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>customerNum</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>creditScore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Integer</span><span class=p>.</span><span class=na>parseInt</span><span class=p>(</span><span class=n>restTemplate</span><span class=p>.</span><span class=na>getForObject</span><span class=p>(</span><span class=n>creditScoreUrl</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>class</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>HttpClientErrorException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>status</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>INTERNAL_SERVER_ERROR</span><span class=p>).</span><span class=na>body</span><span class=p>(</span><span class=s>&#34;Error getting credit score&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Span</span><span class=w> </span><span class=n>currentSpan</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Span</span><span class=p>.</span><span class=na>current</span><span class=p>();</span><span class=w> </span><span class=c1>// ADDED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>currentSpan</span><span class=p>.</span><span class=na>setAttribute</span><span class=p>(</span><span class=s>&#34;credit.score&#34;</span><span class=p>,</span><span class=w> </span><span class=n>creditScore</span><span class=p>);</span><span class=w> </span><span class=c1>// ADDED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>...</span></span></span></code></pre></div><p>That was pretty easy, right? Let&rsquo;s capture some more, with the final result looking like this:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/check&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@WithSpan</span><span class=p>(</span><span class=n>kind</span><span class=o>=</span><span class=n>SpanKind</span><span class=p>.</span><span class=na>SERVER</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=nf>creditCheck</span><span class=p>(</span><span class=nd>@RequestParam</span><span class=p>(</span><span class=s>&#34;customernum&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                          </span><span class=nd>@SpanAttribute</span><span class=p>(</span><span class=s>&#34;customer.num&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                          </span><span class=n>String</span><span class=w> </span><span class=n>customerNum</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Get Credit Score</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>creditScore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>creditScoreUrl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;http://creditprocessorservice:8899/getScore?customernum=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>customerNum</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>creditScore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Integer</span><span class=p>.</span><span class=na>parseInt</span><span class=p>(</span><span class=n>restTemplate</span><span class=p>.</span><span class=na>getForObject</span><span class=p>(</span><span class=n>creditScoreUrl</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>class</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>HttpClientErrorException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>status</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>INTERNAL_SERVER_ERROR</span><span class=p>).</span><span class=na>body</span><span class=p>(</span><span class=s>&#34;Error getting credit score&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Span</span><span class=w> </span><span class=n>currentSpan</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Span</span><span class=p>.</span><span class=na>current</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>currentSpan</span><span class=p>.</span><span class=na>setAttribute</span><span class=p>(</span><span class=s>&#34;credit.score&#34;</span><span class=p>,</span><span class=w> </span><span class=n>creditScore</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>creditScoreCategory</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getCreditCategoryFromScore</span><span class=p>(</span><span class=n>creditScore</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>currentSpan</span><span class=p>.</span><span class=na>setAttribute</span><span class=p>(</span><span class=s>&#34;credit.score.category&#34;</span><span class=p>,</span><span class=w> </span><span class=n>creditScoreCategory</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Run Credit Check</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>creditCheckUrl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;http://creditprocessorservice:8899/runCreditCheck?customernum=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>customerNum</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&amp;score=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>creditScore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>checkResult</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>checkResult</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>restTemplate</span><span class=p>.</span><span class=na>getForObject</span><span class=p>(</span><span class=n>creditCheckUrl</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>HttpClientErrorException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>status</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>INTERNAL_SERVER_ERROR</span><span class=p>).</span><span class=na>body</span><span class=p>(</span><span class=s>&#34;Error running credit check&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>currentSpan</span><span class=p>.</span><span class=na>setAttribute</span><span class=p>(</span><span class=s>&#34;credit.check.result&#34;</span><span class=p>,</span><span class=w> </span><span class=n>checkResult</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>ok</span><span class=p>(</span><span class=n>checkResult</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></div><h2 id=redeploy-service>Redeploy Service</h2><p>Once these changes are made, let&rsquo;s run the following script to rebuild the Docker image used for <code>creditcheckservice</code> and redeploy it to our Kubernetes cluster:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./5-redeploy-creditcheckservice.sh java</span></span></code></pre></div><h2 id=confirm-tag-is-captured-successfully>Confirm Tag is Captured Successfully</h2><p>After a few minutes, return to <strong>Splunk Observability Cloud</strong> and load one of the latest traces to confirm that the tags were captured successfully (hint: sort by the timestamp to find the latest traces):</p><p><strong><a href=#R-image-e9b7b04db25f6b8169663f9c4e7c0f3e class=lightbox-link><img alt="Trace with Attributes" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/trace_with_attributes_java.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e9b7b04db25f6b8169663f9c4e7c0f3e><img alt="Trace with Attributes" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/trace_with_attributes_java.png></a></strong></p><p>Well done, you&rsquo;ve leveled up your OpenTelemetry game and have added context to traces using tags.</p><p>Next, we&rsquo;re ready to see how you can use these tags with <strong>Splunk Observability Cloud</strong>!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 18, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=2-capture-tags---python>2. Capture Tags - Python</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>Let&rsquo;s add some tags to our traces, so we can find out why some customers receive a poor experience from our application.</p><h2 id=identify-useful-tags>Identify Useful Tags</h2><p>We&rsquo;ll start by reviewing the code for the <code>credit_check</code> function of <code>creditcheckservice</code> (which can be found in the <code>/home/splunk/workshop/tagging/creditcheckservice-py/main.py</code> file):</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/check&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>credit_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>customerNum</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;customernum&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Get Credit Score</span>
</span></span><span class=line><span class=cl>    <span class=n>creditScoreReq</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;http://creditprocessorservice:8899/getScore?customernum=&#34;</span> <span class=o>+</span> <span class=n>customerNum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>creditScoreReq</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>creditScore</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>creditScoreReq</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>creditScoreCategory</span> <span class=o>=</span> <span class=n>getCreditCategoryFromScore</span><span class=p>(</span><span class=n>creditScore</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Run Credit Check</span>
</span></span><span class=line><span class=cl>    <span class=n>creditCheckReq</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;http://creditprocessorservice:8899/runCreditCheck?customernum=&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>customerNum</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;&amp;score=&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>creditScore</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>creditCheckReq</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>checkResult</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>creditCheckReq</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>checkResult</span></span></span></code></pre></div><p>We can see that this function accepts a <strong>customer number</strong> as an input. This would be helpful to capture as part of a trace. What else would be helpful?</p><p>Well, the <strong>credit score</strong> returned for this customer by the <code>creditprocessorservice</code> may be interesting (we want to ensure we don&rsquo;t capture any PII data though). It would also be helpful to capture the <strong>credit score category</strong>, and the <strong>credit check result</strong>.</p><p>Great, we&rsquo;ve identified four tags to capture from this service that could help with our investigation. But how do we capture these?</p><h2 id=capture-tags>Capture Tags</h2><p>We start by adding importing the trace module by adding an import statement to the top of the <code>creditcheckservice-py/main.py</code> file:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>waitress</span> <span class=kn>import</span> <span class=n>serve</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry</span> <span class=kn>import</span> <span class=n>trace</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl><span class=o>...</span></span></span></code></pre></div><p>Next, we need to get a reference to the current span so we can add an attribute (aka tag) to it:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>credit_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span> <span class=o>=</span> <span class=n>trace</span><span class=o>.</span><span class=n>get_current_span</span><span class=p>()</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>    <span class=n>customerNum</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;customernum&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;customer.num&#34;</span><span class=p>,</span> <span class=n>customerNum</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl><span class=o>...</span></span></span></code></pre></div><p>That was pretty easy, right? Let&rsquo;s capture some more, with the final result looking like this:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>credit_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span> <span class=o>=</span> <span class=n>trace</span><span class=o>.</span><span class=n>get_current_span</span><span class=p>()</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>    <span class=n>customerNum</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;customernum&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;customer.num&#34;</span><span class=p>,</span> <span class=n>customerNum</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Get Credit Score</span>
</span></span><span class=line><span class=cl>    <span class=n>creditScoreReq</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;http://creditprocessorservice:8899/getScore?customernum=&#34;</span> <span class=o>+</span> <span class=n>customerNum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>creditScoreReq</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>creditScore</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>creditScoreReq</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;credit.score&#34;</span><span class=p>,</span> <span class=n>creditScore</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>creditScoreCategory</span> <span class=o>=</span> <span class=n>getCreditCategoryFromScore</span><span class=p>(</span><span class=n>creditScore</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;credit.score.category&#34;</span><span class=p>,</span> <span class=n>creditScoreCategory</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Run Credit Check</span>
</span></span><span class=line><span class=cl>    <span class=n>creditCheckReq</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;http://creditprocessorservice:8899/runCreditCheck?customernum=&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>customerNum</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;&amp;score=&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>creditScore</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>creditCheckReq</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>checkResult</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>creditCheckReq</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;credit.check.result&#34;</span><span class=p>,</span> <span class=n>checkResult</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>checkResult</span></span></span></code></pre></div><h2 id=redeploy-service>Redeploy Service</h2><p>Once these changes are made, let&rsquo;s run the following script to rebuild the Docker image used for <code>creditcheckservice</code> and redeploy it to our Kubernetes cluster:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./5-redeploy-creditcheckservice.sh</span></span></code></pre></div><h2 id=confirm-tag-is-captured-successfully>Confirm Tag is Captured Successfully</h2><p>After a few minutes, return to <strong>Splunk Observability Cloud</strong> and load one of the latest traces to confirm that the tags were captured successfully (hint: sort by the timestamp to find the latest traces):</p><p><strong><a href=#R-image-647d7e634fb938061d3c18a4d30fb5d4 class=lightbox-link><img alt="Trace with Attributes" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/trace_with_attributes.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-647d7e634fb938061d3c18a4d30fb5d4><img alt="Trace with Attributes" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/trace_with_attributes.png></a></strong></p><p>Well done, you&rsquo;ve leveled up your OpenTelemetry game and have added context to traces using tags.</p><p>Next, we&rsquo;re ready to see how you can use these tags with <strong>Splunk Observability Cloud</strong>!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 18, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=explore-trace-data>Explore Trace Data</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>Now that we&rsquo;ve captured several tags from our application, let&rsquo;s explore some of the trace data we&rsquo;ve captured that include this additional context, and see if we can identify what&rsquo;s causing a poor user experience in some cases.</p><h2 id=use-trace-analyzer>Use Trace Analyzer</h2><p>Navigate to <strong>APM</strong>, then select <strong>Traces</strong>. This takes us to the <strong>Trace Analyzer</strong>, where we can add filters to search for traces of interest. For example, we can filter on traces where the credit score starts with <code>7</code>:</p><p><a href=#R-image-0a5bf71bb9f5995c5c607d82ad9559a5 class=lightbox-link><img alt="Credit Check Starts with Seven" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/credit_score_starts_with_seven.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a5bf71bb9f5995c5c607d82ad9559a5><img alt="Credit Check Starts with Seven" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/credit_score_starts_with_seven.png></a></p><p>If you load one of these traces, you&rsquo;ll see that the credit score indeed starts with seven.</p><p>We can apply similar filters for the customer number, credit score category, and credit score result.</p><h2 id=explore-traces-with-errors>Explore Traces With Errors</h2><p>Let&rsquo;s remove the credit score filter and toggle <strong>Errors only</strong> to on, which results in a list of only those traces where an error occurred:</p><p><a href=#R-image-af4fdd3c1797b4439a49a59f9d1dfe88 class=lightbox-link><img alt="Traces with Errors Only" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/traces_errors_only.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af4fdd3c1797b4439a49a59f9d1dfe88><img alt="Traces with Errors Only" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/traces_errors_only.png></a></p><p>Click on a few of these traces, and look at the tags we captured. Do you notice any patterns?</p><p>Next, toggle <strong>Errors only</strong> to off, and sort traces by duration. Look at a few of the slowest running traces, and compare them to the fastest running traces. Do you notice any patterns?</p><p>If you found a pattern that explains the slow performance and errors - great job! But keep in mind that this is a difficult way to troubleshoot, as it requires you to look through many traces and mentally keep track of what you saw, so you can identify a pattern.</p><p>Thankfully, <strong>Splunk Observability Cloud</strong> provides a more efficient way to do this, which we&rsquo;ll explore next.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=index-tags>Index Tags</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=index-tags>Index Tags</h2><p>To use advanced features in <strong>Splunk Observability Cloud</strong> such as <strong>Tag Spotlight</strong>, we&rsquo;ll need to first index one or more tags.</p><p>To do this, navigate to <strong>Settings</strong> -> <strong>APM MetricSets</strong>. Then click the <strong>+ New MetricSet</strong> button.</p><p>Let&rsquo;s index the <code>credit.score.category</code> tag by entering the following details (<strong>note</strong>: since everyone in the workshop is using the same organization, the instructor will do this step on your behalf):</p><p><a href=#R-image-37a8e41d085027ab9faf03dc89d43c8d class=lightbox-link><img alt="Create Troubleshooting MetricSet" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/create_troubleshooting_metric_set.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-37a8e41d085027ab9faf03dc89d43c8d><img alt="Create Troubleshooting MetricSet" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/create_troubleshooting_metric_set.png></a></p><p>Click <strong>Start Analysis</strong> to proceed.</p><p>The tag will appear in the list of <strong>Pending MetricSets</strong> while analysis is performed.</p><p><a href=#R-image-c5d6dce509de56afa4c27e963b84a3e3 class=lightbox-link><img alt="Pending MetricSets" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/pending_metric_set.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c5d6dce509de56afa4c27e963b84a3e3><img alt="Pending MetricSets" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/pending_metric_set.png></a></p><p>Once analysis is complete, click on the checkmark in the <strong>Actions</strong> column.</p><p><a href=#R-image-17c86db48c9033abe55ff53e0a0dd484 class=lightbox-link><img alt="MetricSet Configuraiton Applied" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/metricset_config_applied.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-17c86db48c9033abe55ff53e0a0dd484><img alt="MetricSet Configuraiton Applied" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/metricset_config_applied.png></a></p><h2 id=how-to-choose-tags-for-indexing>How to choose tags for indexing</h2><p>Why did we choose to index the <code>credit.score.category</code> tag and not the others?</p><p>To understand this, let&rsquo;s review the primary use cases for tags:</p><ul><li>Filtering</li><li>Grouping</li></ul><h3 id=filtering>Filtering</h3><p>With the filtering use case, we can use the <strong>Trace Analyzer</strong> capability of <strong>Splunk Observability Cloud</strong> to filter on traces that match a particular tag value.</p><p>We saw an example of this earlier, when we filtered on traces where the credit score started with <code>7</code>.</p><p>Or if a customer calls in to complain about slow service, we could use <strong>Trace Analyzer</strong> to locate all traces with that particular customer number.</p><p>Tags used for filtering use cases are generally high-cardinality, meaning that there could be thousands or even hundreds of thousands of unique values. In fact, <strong>Splunk Observability Cloud</strong> can handle an effectively infinite number of unique tag values! Filtering using these tags allows us to rapidly locate the traces of interest.</p><p>Note that we aren&rsquo;t required to index tags to use them for filtering with <strong>Trace Analyzer</strong>.</p><h3 id=grouping>Grouping</h3><p>With the grouping use case, we can use <strong>Trace Analyzer</strong> to group traces by a particular tag.</p><p>But we can also go beyond this and surface trends for tags that we collect using the powerful <strong>Tag Spotlight</strong> feature in <strong>Splunk Observability Cloud</strong>, which we’ll see in action shortly.</p><p>Tags used for grouping use cases should be low to medium-cardinality, with hundreds of unique values.</p><p>For custom tags to be used with <strong>Tag Spotlight</strong>, they first need to be indexed.</p><p>We decided to index the <code>credit.score.category</code> tag because it has a few distinct values that would be useful for grouping. In contrast, the customer number and credit score tags have hundreds or thousands of unique values, and are more valuable for filtering use cases rather than grouping.</p><h2 id=troubleshooting-vs-monitoring-metricsets>Troubleshooting vs. Monitoring MetricSets</h2><p>You may have noticed that, to index this tag, we created something called a <strong>Troubleshooting MetricSet</strong>. It&rsquo;s named this way because a Troubleshooting MetricSet, or TMS, allows us to troubleshoot issues with this tag using features such as <strong>Tag Spotlight</strong>.</p><p>You may have also noticed that there&rsquo;s another option which we didn&rsquo;t choose called a <strong>Monitoring MetricSet</strong> (or MMS). Monitoring MetricSets go beyond troubleshooting and allow us to use tags for alerting and dashboards. We&rsquo;ll explore this concept later in the workshop.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=use-tags-for-troubleshooting>Use Tags for Troubleshooting</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=using-tag-spotlight>Using Tag Spotlight</h2><p>Now that we&rsquo;ve indexed the <code>credit.score.category</code> tag, we can use it with <strong>Tag Spotlight</strong> to troubleshoot our application.</p><p>Navigate to <strong>APM</strong> then click on <strong>Tag Spotlight</strong> on the right-hand side. Ensure the <code>creditcheckservice</code> service is selected from the <strong>Service</strong> drop-down (if not already selected).</p><p>With <strong>Tag Spotlight</strong>, we can see 100% of credit score requests that result in a score of <code>impossible</code> have an error, yet requests for all other credit score types have no errors at all!</p><p><strong><a href=#R-image-34bb40b3b75609c4dfd748c438c50b90 class=lightbox-link><img alt="Tag Spotlight with Errors" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/tag_spotlight_errors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-34bb40b3b75609c4dfd748c438c50b90><img alt="Tag Spotlight with Errors" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/tag_spotlight_errors.png></a></strong></p><p>This illustrates the power of <strong>Tag Spotlight</strong>! Finding this pattern would be time-consuming without it, as we&rsquo;d have to manually look through hundreds of traces to identify the pattern (and even then, there&rsquo;s no guarantee we&rsquo;d find it).</p><p>We&rsquo;ve looked at errors, but what about latency? Let&rsquo;s click on <strong>Latency</strong> near the top of the screen to find out.</p><p>Here, we can see that the requests with a <code>poor</code> credit score request are running slowly, with P50, P90, and P99 times of around 3 seconds, which is too long for our users to wait, and much slower than other requests.</p><p>We can also see that some requests with an <code>exceptional</code> credit score request are running slowly, with P99 times of around 5 seconds, though the P50 response time is relatively quick.</p><p><strong><a href=#R-image-c13414a185ffd78c939394632ac62e97 class=lightbox-link><img alt="Tag Spotlight with Latency" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/tag_spotlight_latency.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c13414a185ffd78c939394632ac62e97><img alt="Tag Spotlight with Latency" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/tag_spotlight_latency.png></a></strong></p><h2 id=using-dynamic-service-maps>Using Dynamic Service Maps</h2><p>Now that we know the credit score category associated with the request can impact performance and error rates, let&rsquo;s explore another feature that utilizes indexed tags: <strong>Dynamic Service Maps</strong>.</p><p>With Dynamic Service Maps, we can breakdown a particular service by a tag. For example, let&rsquo;s click on <strong>APM</strong>, then click <strong>Explore</strong> to view the service map.</p><p>Click on <code>creditcheckservice</code>. Then, on the right-hand menu, click on the drop-down that says <strong>Breakdown</strong>, and select the <code>credit.score.category</code> tag.</p><p>At this point, the service map is updated dynamically, and we can see the performance of requests hitting <code>creditcheckservice</code> broken down by the credit score category:</p><p><strong><a href=#R-image-63812b42d00988e1c9a363a3ef5d4d95 class=lightbox-link><img alt="Service Map Breakdown" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/service_map_breakdown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-63812b42d00988e1c9a363a3ef5d4d95><img alt="Service Map Breakdown" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/service_map_breakdown.png></a></strong></p><p>This view makes it clear that performance for <code>good</code> and <code>fair</code> credit scores is excellent, while <code>poor</code> and <code>exceptional</code> scores are much slower, and <code>impossible</code> scores result in errors.</p><h2 id=summary>Summary</h2><p><strong>Tag Spotlight</strong> has uncovered several interesting patterns for the engineers that own this service to explore further:</p><ul><li>Why are all the <code>impossible</code> credit score requests resulting in error?</li><li>Why are all the <code>poor</code> credit score requests running slowly?</li><li>Why do some of the <code>exceptional</code> requests run slowly?</li></ul><p>As an SRE, passing this context to the engineering team would be extremely helpful for their investigation, as it would allow them to track down the issue much more quickly than if we simply told them that the service was &ldquo;sometimes slow&rdquo;.</p><p>If you&rsquo;re curious, have a look at the source code for the <code>creditprocessorservice</code>. You&rsquo;ll see that requests with impossible, poor, and exceptional credit scores are handled differently, thus resulting in the differences in error rates and latency that we uncovered.</p><p>The behavior we saw with our application is typical for modern cloud-native applications, where different inputs passed to a service lead to different code paths, some of which result in slower performance or errors. For example, in a real credit check service, requests resulting in low credit scores may be sent to another downstream service to further evaluate risk, and may perform more slowly than requests resulting in higher scores, or encounter higher error rates.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=use-tags-for-monitoring>Use Tags for Monitoring</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>Earlier, we created a <strong>Troubleshooting Metric Set</strong> on the <code>credit.score.category</code> tag, which allowed us to use <strong>Tag Spotlight</strong> with that tag and identify a pattern to explain why some users received a poor experience.</p><p>In this section of the workshop, we&rsquo;ll explore a related concept: <strong>Monitoring MetricSets</strong>.</p><h2 id=what-are-monitoring-metricsets>What are Monitoring MetricSets?</h2><p><strong>Monitoring MetricSets</strong> go beyond troubleshooting and allow us to use tags for alerting, dashboards and SLOs.</p><h2 id=create-a-monitoring-metricset>Create a Monitoring MetricSet</h2><p>(<strong>note</strong>: <em>your workshop instructor will do the following for you, but observe the steps</em>)</p><p>Let&rsquo;s navigate to <strong>Settings</strong> -> <strong>APM MetricSets</strong>, and click the edit button (i.e. the little pencil) beside the MetricSet for <code>credit.score.category</code>.</p><p><a href=#R-image-e20a6bbda5eeafe6a21f374d9460d9ab class=lightbox-link><img alt="edit APM MetricSet" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/edit_apm_metricset.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e20a6bbda5eeafe6a21f374d9460d9ab><img alt="edit APM MetricSet" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/edit_apm_metricset.png></a></p><p>Check the box beside <strong>Also create Monitoring MetricSet</strong> then click <strong>Start Analysis</strong></p><p><a href=#R-image-a07fd4c842c9b57295e52d40dfc08902 class=lightbox-link><img alt="Monitoring MetricSet" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/monitoring_metricset.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a07fd4c842c9b57295e52d40dfc08902><img alt="Monitoring MetricSet" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/monitoring_metricset.png></a></p><p>The <code>credit.score.category</code> tag appears again as a <strong>Pending MetricSet</strong>. After a few moments, a checkmark should appear. Click this checkmark to enable the <strong>Pending MetricSet</strong>.</p><p><a href=#R-image-8f4ad321e1004be092eb3b93336ac648 class=lightbox-link><img alt="pending APM MetricSet" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/update_pending_apm_metricset.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8f4ad321e1004be092eb3b93336ac648><img alt="pending APM MetricSet" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/update_pending_apm_metricset.png></a></p><h2 id=using-monitoring-metricsets>Using Monitoring MetricSets</h2><p>This mechanism creates a new dimension from the tag on a bunch of metrics that can be used to filter these metrics based on the values of that new dimension. <strong>Important</strong>: To differentiate between the original and the copy, the dots in the tag name are replaced by underscores for the new dimension. With that the metrics become a dimension named <code>credit_score_category</code> and not <code>credit.score.category</code>.</p><p>Next, let&rsquo;s explore how we can use this <strong>Monitoring MetricSet</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 7. Use Tags for Monitoring</h1><article class=default><header class=headline></header><h1 id=use-tags-with-dashboards>Use Tags with Dashboards</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h3 id=dashboards>Dashboards</h3><p>Navigate to <strong>Metric Finder</strong>, then type in the name of the tag, which is <code>credit_score_category</code> (remember that the dots in the tag name were replaced by underscores when the Monitoring MetricSet was created). You&rsquo;ll see that multiple metrics include this tag as a dimension:</p><p><a href=#R-image-5db0ccde4c2c904b432a822cee6f390e class=lightbox-link><img alt="Metric Finder" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/metric_finder.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5db0ccde4c2c904b432a822cee6f390e><img alt="Metric Finder" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/metric_finder.png></a></p><p>By default, <strong>Splunk Observability Cloud</strong> calculates several metrics using the trace data it receives. See <a href=https://docs.splunk.com/observability/en/apm/span-tags/metricsets.html rel=external target=_blank>Learn about MetricSets in APM</a> for more details.</p><p>By creating an MMS, <code>credit_score_category</code> was added as a dimension to these metrics, which means that this dimension can now be used for alerting and dashboards.</p><p>To see how, let&rsquo;s click on the metric named <code>service.request.duration.ns.p99</code>, which brings up the following chart:</p><p><a href=#R-image-8ec18567b74932926970e1af43af8c73 class=lightbox-link><img alt="Service Request Duration" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/service_request_duration_chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8ec18567b74932926970e1af43af8c73><img alt="Service Request Duration" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/service_request_duration_chart.png></a></p><p>Add filters for <code>sf_environment</code>, <code>sf_service</code>, and <code>sf_dimensionalized</code>. Then set the <strong>Extrapolation policy</strong> to <code>Last value</code> and the <strong>Display units</strong> to <code>Nanosecond</code>:</p><p><a href=#R-image-d6f94b20bde1f2251610be6b68d45ca7 class=lightbox-link><img alt="Chart with Seconds" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/chart_settings.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d6f94b20bde1f2251610be6b68d45ca7><img alt="Chart with Seconds" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/chart_settings.png></a></p><p>With these settings, the chart allows us to visualize the service request duration by credit score category:</p><p><a href=#R-image-c643ba74d8a3bfe0e25c5a2785b36299 class=lightbox-link><img alt="Duration by Credit Score" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/duration_by_credit_score.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c643ba74d8a3bfe0e25c5a2785b36299><img alt="Duration by Credit Score" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/duration_by_credit_score.png></a></p><p>Now we can see the duration by credit score category. In my example, the red line represents the <code>exceptional</code> category, and we can see that the duration for these requests sometimes goes all the way up to 5 seconds.</p><p>The orange represents the <code>very good</code> category, and has very fast response times.</p><p>The green line represents the <code>poor</code> category, and has response times between 2-3 seconds.</p><p>It may be useful to save this chart on a dashboard for future reference. To do this, click on the <strong>Save as&mldr;</strong> button and provide a name for the chart:</p><p><a href=#R-image-ff9843e9f685d890cd2188d5778111c3 class=lightbox-link><img alt="Save Chart As" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/save_chart_as.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ff9843e9f685d890cd2188d5778111c3><img alt="Save Chart As" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/save_chart_as.png></a></p><p>When asked which dashboard to save the chart to, let&rsquo;s create a <strong>new</strong> one named <code>Credit Check Service - Your Name</code> (substituting your actual name):</p><p><a href=#R-image-84a3459f9c7d7731bf5c8452c8a0f969 class=lightbox-link><img alt="Save Chart As" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/create_dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-84a3459f9c7d7731bf5c8452c8a0f969><img alt="Save Chart As" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/create_dashboard.png></a></p><p>Now we can see the chart on our dashboard, and can add more charts as needed to monitor our credit check service:</p><p><a href=#R-image-423cfde55a36f6160455a412a230b026 class=lightbox-link><img alt="Credit Check Service Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/credit_check_service_dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-423cfde55a36f6160455a412a230b026><img alt="Credit Check Service Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/credit_check_service_dashboard.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=use-tags-with-alerting>Use Tags with Alerting</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;<h3 id=alerts>Alerts</h3><p>It&rsquo;s great that we have a dashboard to monitor the response times of the credit check service by credit score, but we don&rsquo;t want to stare at a dashboard all day.</p><p>Let&rsquo;s create an alert so we can be notified proactively if customers with <code>exceptional</code> credit scores encounter slow requests.</p><p>To create this alert, click on the little bell on the top right-hand corner of the chart, then select <strong>New detector from chart</strong>:</p><p><a href=#R-image-6037d7dd43c8654ec0997c4181fc61c4 class=lightbox-link><img alt="New Detector From Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/new_detector_from_chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6037d7dd43c8654ec0997c4181fc61c4><img alt="New Detector From Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/new_detector_from_chart.png></a></p><p>Let&rsquo;s call the detector <code>Latency by Credit Score Category</code>. Set the environment to your environment name (i.e. <code>tagging-workshop-yourname</code>) then select <code>creditcheckservice</code> as the service. Since we only want to look at performance for customers with <code>exceptional</code> credit scores, add a filter using the <code>credit_score_category</code> dimension and select <code>exceptional</code>:</p><p><a href=#R-image-39b1f7b1d3cf4def965271a0fd685aea class=lightbox-link><img alt="Create New Detector" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/create_new_detector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-39b1f7b1d3cf4def965271a0fd685aea><img alt="Create New Detector" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/create_new_detector.png></a></p><p>As an alert condition instead of &ldquo;<strong>Static threshold</strong>&rdquo; we want to select &ldquo;<strong>Sudden Change</strong>&rdquo; to make the example more vivid.</p><p><a href=#R-image-d6083d7006daabf44834e1ebf85d2e97 class=lightbox-link><img alt="Alert Condition: Sudden Change" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/alert_condition_suddenchange.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d6083d7006daabf44834e1ebf85d2e97><img alt="Alert Condition: Sudden Change" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/alert_condition_suddenchange.png></a></p><p>We can then set the remainder of the alert details as we normally would. The key thing to remember here is that without capturing a tag with the credit score category and indexing it, we wouldn&rsquo;t be able to alert at this granular level, but would instead be forced to bucket all customers together, regardless of their importance to the business.</p><p>Unless you want to get notified, we do not need to finish this wizard. You can just close the wizard by clicking the <strong>X</strong> on the top right corner of the wizard pop-up.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=use-tags-with-service-level-objectives>Use Tags with Service Level Objectives</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>We can now use the created Monitoring MetricSet together with Service Level Objectives a similar way we used them with dashboards and detectors/alerts before. For that we want to be clear about some key concepts:</p><h2 id=key-concepts-of-service-level-monitoring>Key Concepts of Service Level Monitoring</h2><p>(<a href=/observability-workshop/v5.76/en/scenarios/debug_problems/tagging/7-alerting-dashboards-slos/3-slos/index.html#creating-a-new-service-level-objective>skip</a> if you know this)</p><table><thead><tr><th style=text-align:left>Concept</th><th style=text-align:left>Definition</th><th style=text-align:left>Examples</th></tr></thead><tbody><tr><td style=text-align:left>Service level indicator (SLI)</td><td style=text-align:left>An SLI is a quantitative measurement showing some health of a service, expressed as a metric or combination of metrics.</td><td style=text-align:left><em>Availability SLI</em>: Proportion of requests that resulted in a successful response<br><em>Performance SLI</em>: Proportion of requests that loaded in &lt; 100 ms</td></tr><tr><td style=text-align:left>Service level objective (SLO)</td><td style=text-align:left>An SLO defines a target for an SLI and a compliance period over which that target must be met. An SLO contains 3 elements: an SLI, a target, and a compliance period. Compliance periods can be calendar, such as monthly, or rolling, such as past 30 days.</td><td style=text-align:left><em>Availability SLI over a calendar period</em>: Our service must respond successfully to 95% of requests in a month<br><em>Performance SLI over a rolling period</em>: Our service must respond to 99% of requests in &lt; 100 ms over a 7-day period</td></tr><tr><td style=text-align:left>Service level agreement (SLA)</td><td style=text-align:left>An SLA is a contractual agreement that indicates service levels your users can expect from your organization. If an SLA is not met, there can be financial consequences.</td><td style=text-align:left>A customer service SLA indicates that 90% of support requests received on a normal support day must have a response within 6 hours.</td></tr><tr><td style=text-align:left>Error budget</td><td style=text-align:left>A measurement of how your SLI performs relative to your SLO over a period of time. Error budget measures the difference between actual and desired performance. It determines how unreliable your service might be during this period and serves as a signal when you need to take corrective action.</td><td style=text-align:left>Our service can respond to 1% of requests in >100 ms over a 7 day period.</td></tr><tr><td style=text-align:left>Burn rate</td><td style=text-align:left>A unitless measurement of how quickly a service consumes the error budget during the compliance window of the SLO. Burn rate makes the SLO and error budget actionable, showing service owners when a current incident is serious enough to page an on-call responder.</td><td style=text-align:left>For an SLO with a 30-day compliance window, a constant burn rate of 1 means your error budget is used up in exactly 30 days.</td></tr></tbody></table><h2 id=creating-a-new-service-level-objective>Creating a new Service Level Objective</h2><p>There is an easy to follow wizard to create a new Service Level Objective (SLO). In the left navigation just follow the link &ldquo;<strong>Detectors & SLOs</strong>&rdquo;. From there select the third tab &ldquo;<strong>SLOs</strong>&rdquo; and click the blue button to the right that says &ldquo;<strong>Create SLO</strong>&rdquo;.</p><p><a href=#R-image-670d2defb38f5c7f90ccde89af44b651 class=lightbox-link><img alt="Create new SLO" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/slo_0_create.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-670d2defb38f5c7f90ccde89af44b651><img alt="Create new SLO" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/slo_0_create.png></a></p><p>The wizard guides you through some easy steps. And if everything during the previous steps worked out, you will have no problems here. ;)</p><p>In our case we want to use <code>Service & endpoint</code> as our <strong>Metric type</strong> instead of <code>Custom metric</code>. We filter the <strong>Environment</strong> down to the environment that we are using during this workshop (i.e. <code>tagging-workshop-yourname</code>) and select the <code>creditcheckservice</code> from the <strong>Service and endpoint</strong> list. Our <strong>Indicator type</strong> for this workshop will be <code>Request latency</code> and not <code>Request success</code>.</p><p>Now we can select our <strong>Filters</strong>. Since we are using the <code>Request latency</code> as the <strong>Indicator type</strong> and that is a metric of the APM Service, we can filter on <code>credit.score.category</code>. Feel free to try out what happens, when you set the <strong>Indicator type</strong> to <code>Request success</code>.</p><p>Today we are only interested in our <code>exceptional</code> credit scores. So please select that as the filter.</p><p><a href=#R-image-04d46c4554b1528b34ac46917cf90b20 class=lightbox-link><img alt="Choose Service or Metric for SLO" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/slo_1_choose.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-04d46c4554b1528b34ac46917cf90b20><img alt="Choose Service or Metric for SLO" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/slo_1_choose.png></a></p><p>In the next step we define the objective we want to reach. For the <code>Request latency</code> type, we define the <strong>Target (%)</strong>, the <strong>Latency (ms)</strong> and the <strong>Compliance Window</strong>. Please set these to <code>99</code>, <code>100</code> and <code>Last 7 days</code>. This will give us a good idea what we are achieving already.</p><p>Here we will already be in shock or play around with the numbers to make it not so scary. Feel free to play around with the numbers to see how well we achieve the objective and how much we have left to burn.</p><p><a href=#R-image-bc43097eca3f082776993894ea6a263c class=lightbox-link><img alt="Define Objective for SLO" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/slo_2_define_objective.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bc43097eca3f082776993894ea6a263c><img alt="Define Objective for SLO" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/slo_2_define_objective.png></a></p><p>The third step gives us the chance to alert (aka annoy) people who should be aware about these SLOs to initiate countermeasures. These &ldquo;people&rdquo; can also be mechanism like ITSM systems or webhooks to initiate automatic remediation steps.</p><p>Activate all categories you want to alert on and add recipients to the different alerts.</p><p><a href=#R-image-20caf4ff223a10f6199051e92c835561 class=lightbox-link><img alt="Define Alerting for SLO" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/slo_3_define_alerting.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-20caf4ff223a10f6199051e92c835561><img alt="Define Alerting for SLO" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/slo_3_define_alerting.png></a></p><p>The next step is only the naming for this SLO. Have your own naming convention ready for this. In our case we would just name it <code>creditchceckservice:score:exceptional:YOURNAME</code> and click the <strong>Create</strong>-button <strong>BUT</strong> you can also <strong>just cancel the wizard</strong> by clicking anything in the left navigation and confirming to <strong>Discard changes</strong>.</p><p><a href=#R-image-07171390486900f6f96b2ca36ca5c316 class=lightbox-link><img alt="Name and Save the SLO" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/slo_4_name_and_save.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-07171390486900f6f96b2ca36ca5c316><img alt="Name and Save the SLO" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/slo_4_name_and_save.png></a></p><p>And with that we have (<em>nearly</em>) successfully created an SLO including the alerting in case we might miss or goals.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=summary>Summary</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>In this workshop, we learned the following:</p><ul><li>What are tags and why are they such a critical part of making an application observable?</li><li>How to use <a href=https://opentelemetry.io rel=external target=_blank><strong>OpenTelemetry</strong></a> to capture tags of interest from your application.</li><li>How to index tags in <strong>Splunk Observability Cloud</strong> and the differences between <strong>Troubleshooting MetricSets</strong> and <strong>Monitoring MetricSets</strong>.</li><li>How to utilize tags in <strong>Splunk Observability Cloud</strong> to find “unknown unknowns” using the <strong>Tag Spotlight</strong> and <strong>Dynamic Service Map</strong> features.</li><li>How to utilize tags for dashboards, alerting and service level objectives.</li></ul><p>Collecting tags aligned with the best practices shared in this workshop will let you get even more value from the data you’re sending to <strong>Splunk Observability Cloud</strong>. Now that you’ve completed this workshop, you have the knowledge you need to start collecting tags from your own applications!</p><p>To get started with capturing tags today, check out <a href=https://docs.splunk.com/observability/en/apm/span-tags/add-context-trace-span.html#instrument-your-application-code-to-add-tags-to-spans rel=external target=_blank>how to add tags in various supported languages</a>, and then <a href=https://docs.splunk.com/observability/en/apm/span-tags/index-span-tags.html#apm-index-span-tags rel=external target=_blank>how to use them to create Troubleshooting MetricSets</a> so they can be analyzed in Tag Spotlight. For more help, feel free to <a href=https://www.splunk.com/en_us/about-splunk/contact-us.html rel=external target=_blank>ask a Splunk Expert</a>.</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip for Workshop Facilitator(s)</summary><div class=box-content><p>Once the workshop is complete, remember to delete the APM MetricSet you created earlier for the <code>credit.score.category</code> tag.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=profiling-workshop>Profiling Workshop</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Derek Mitchell</span></span><p><strong>Service Maps</strong> and <strong>Traces</strong> are extremely valuable in determining what service an issue resides in. And related log data helps provide detail on why issues are occurring in that service.</p><p>But engineers sometimes need to go even deeper to debug a problem that’s occurring in one of their services.</p><p>This is where features such as Splunk&rsquo;s <strong>AlwaysOn Profiling</strong> and <strong>Database Query Performance</strong> come in.</p><p><strong>AlwaysOn Profiling</strong> continuously collects stack traces so that you can discover which lines in your code are consuming the most CPU and memory.</p><p>And <strong>Database Query Performance</strong> can quickly identify long-running, unoptimized, or heavy queries and mitigate issues they might be causing.</p><p>In this workshop, we&rsquo;ll explore:</p><ul><li>How to debug an application with several performance issues.</li><li>How to use <strong>Database Query Performance</strong> to find slow-running queries that impact application performance.</li><li>How to enable <strong>AlwaysOn Profiling</strong> and use it to find the code that consumes the most CPU and memory.</li><li>How to apply fixes based on findings from <strong>Splunk Observability Cloud</strong> and verify the result.</li></ul><p>The workshop uses a Java-based application called <code>The Door Game</code> hosted in Kubernetes. Let&rsquo;s get started!</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (◀️) and right (▶️) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Profiling Workshop</h1><article class=default><header class=headline></header><h1 id=build-the-sample-application>Build the Sample Application</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>For this workshop, we&rsquo;ll be using a Java-based application called <code>The Door Game</code>. It will be hosted in Kubernetes.</p><h2 id=pre-requisites>Pre-requisites</h2><p>You will start with an EC2 instance and perform some <a href=/observability-workshop/v5.76/en/scenarios/debug_problems/profiling/1-build-application/index.html#initial-steps>initial steps</a> in order to get to the following state:</p><ul><li>Deploy the <strong>Splunk distribution of the OpenTelemetry Collector</strong></li><li>Deploy the MySQL database container and populate data</li><li>Build and deploy the <code>doorgame</code> application container</li></ul><h2 id=initial-steps>Initial Steps</h2><p>The initial setup can be completed by executing the following steps on the command line of your EC2 instance.</p><p>You&rsquo;ll be asked to enter a name for your environment. Please use <code>profiling-workshop-yourname</code> (where <code>yourname</code> is replaced by your actual name).</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> workshop/profiling
</span></span><span class=line><span class=cl>./1-deploy-otel-collector.sh
</span></span><span class=line><span class=cl>./2-deploy-mysql.sh
</span></span><span class=line><span class=cl>./3-deploy-doorgame.sh</span></span></code></pre></div><h2 id=lets-play-the-door-game>Let&rsquo;s Play The Door Game</h2><p>Now that the application is deployed, let&rsquo;s play with it and generate some observability data.</p><p>Get the external IP address for your application instance using the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe svc doorgame <span class=p>|</span> grep <span class=s2>&#34;LoadBalancer Ingress&#34;</span></span></span></code></pre></div><p>The output should look like the following:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>LoadBalancer Ingress:     52.23.184.60</span></span></code></pre></div><p>You should be able to access The Door Game application by pointing your browser to port 81 of the provided IP address. For example:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>http://52.23.184.60:81</span></span></code></pre></div><p>You should be met with The Door Game intro screen:</p><p><a href=#R-image-2bf18933f5384da63c9a4fc036ac0f1a class=lightbox-link><img alt="Door Game Welcome Screen" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/door_game_initial_screen.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2bf18933f5384da63c9a4fc036ac0f1a><img alt="Door Game Welcome Screen" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/door_game_initial_screen.png></a></p><p>Click <code>Let's Play</code> to start the game:</p><p><a href=#R-image-35ced663f49c6f5553cd5772c06757a6 class=lightbox-link><img alt="Let&rsquo;s Play" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/lets_play.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-35ced663f49c6f5553cd5772c06757a6><img alt="Let&rsquo;s Play" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/lets_play.png></a></p><p>Did you notice that it took a long time after clicking <code>Let's Play</code> before we could actually start playing the game?</p><p>Let&rsquo;s use <strong>Splunk Observability Cloud</strong> to determine why the application startup is so slow.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=troubleshoot-game-startup>Troubleshoot Game Startup</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Let&rsquo;s use <strong>Splunk Observability Cloud</strong> to determine why the game started so slowly.</p><h2 id=view-your-application-in-splunk-observability-cloud>View your application in Splunk Observability Cloud</h2><p>Note: when the application is deployed for the first time, it may take a few minutes for the data to appear.</p><p>Navigate to APM, then use the Environment dropdown to select your environment (i.e. <code>profiling-workshop-name</code>).</p><p>If everything was deployed correctly, you should see <code>doorgame</code> displayed in the list of services:</p><p><a href=#R-image-678fe21b8bef77be3bc5748cd55e0799 class=lightbox-link><img alt="APM Overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm_overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-678fe21b8bef77be3bc5748cd55e0799><img alt="APM Overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm_overview.png></a></p><p>Click on <strong>Explore</strong> on the right-hand side to view the service map. We should the <code>doorgame</code> application on the service map:</p><p><a href=#R-image-b2b83986f070911d7bf58d715fc06ad1 class=lightbox-link><img alt="Service Map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/service_map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b2b83986f070911d7bf58d715fc06ad1><img alt="Service Map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/service_map.png></a></p><p>Notice how the majority of the time is being spent in the MySQL database. We can get more details by clicking on <strong>Database Query Performance</strong> on the right-hand side.</p><p><a href=#R-image-9cefd10a05cf8f6672d1931aee5316ec class=lightbox-link><img alt="Database Query Performance" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/db_query_performance.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9cefd10a05cf8f6672d1931aee5316ec><img alt="Database Query Performance" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/db_query_performance.png></a></p><p>This view shows the SQL queries that took the most amount of time. Ensure that the <strong>Compare to</strong> dropdown is set to <code>None</code>, so we can focus on current performance.</p><p>We can see that one query in particular is taking a long time:</p><div class="highlight wrap-code"><pre tabindex=0><code>select * from doorgamedb.users, doorgamedb.organizations</code></pre></div><p>(do you notice anything unusual about this query?)</p><p>Let&rsquo;s troubleshoot further by clicking on one of the spikes in the latency graph. This brings up a list of example traces that include this slow query:</p><p><a href=#R-image-1e49d34b9c0904121c0686f24dbe430d class=lightbox-link><img alt="Traces with Slow Query" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/traces_with_slow_query.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1e49d34b9c0904121c0686f24dbe430d><img alt="Traces with Slow Query" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/traces_with_slow_query.png></a></p><p>Click on one of the traces to see the details:</p><p><a href=#R-image-8f766bc7fc88093e3fe02eb948cf15d4 class=lightbox-link><img alt="Trace with Slow Query" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/trace_with_slow_query.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8f766bc7fc88093e3fe02eb948cf15d4><img alt="Trace with Slow Query" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/trace_with_slow_query.png></a></p><p>In the trace, we can see that the <code>DoorGame.startNew</code> operation took 25.8 seconds, and 17.6 seconds of this was associated with the slow SQL query we found earlier.</p><h2 id=what-did-we-accomplish>What did we accomplish?</h2><p>To recap what we&rsquo;ve done so far:</p><ul><li>We&rsquo;ve deployed our application and are able to access it successfully.</li><li>The application is sending traces to <strong>Splunk Observability Cloud</strong> successfully.</li><li>We started troubleshooting the slow application startup time, and found a slow SQL query that seems to be the root cause.</li></ul><p>To troubleshoot further, it would be helpful to get deeper diagnostic data that tells us what&rsquo;s happening inside our JVM, from both a memory (i.e. JVM heap) and CPU perspective. We&rsquo;ll tackle that in the next section of the workshop.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=enable-alwayson-profiling>Enable AlwaysOn Profiling</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<p>Let&rsquo;s learn how to enable the memory and CPU profilers, verify their operation,
and use the results in Splunk Observability Cloud to find out why our application startup is slow.</p><h3 id=update-the-application-configuration>Update the application configuration</h3><p>We will need to pass additional configuration arguments to the Splunk OpenTelemetry Java agent in order to
enable both profilers. The configuration is <a href=https://docs.splunk.com/observability/en/gdi/get-data-in/application/java/instrumentation/instrument-java-application.html#activate-alwayson-profiling rel=external target=_blank>documented here</a>
in detail, but for now we just need the following settings:</p><div class="highlight wrap-code"><pre tabindex=0><code>SPLUNK_PROFILER_ENABLED=&#34;true&#34;
SPLUNK_PROFILER_MEMORY_ENABLED=&#34;true&#34;</code></pre></div><p>Since our application is deployed in Kubernetes, we can update the Kubernetes manifest file to set these environment variables. Open the <code>doorgame/doorgame.yaml</code> file for editing, and ensure the values of the following environment variables are set to &ldquo;true&rdquo;:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SPLUNK_PROFILER_ENABLED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SPLUNK_PROFILER_MEMORY_ENABLED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span></span></span></code></pre></div><p>Next, let&rsquo;s redeploy the Door Game application by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> workshop/profiling
</span></span><span class=line><span class=cl>kubectl apply -f doorgame/doorgame.yaml</span></span></code></pre></div><p>After a few seconds, a new pod will be deployed with the updated application settings.</p><h3 id=confirm-operation>Confirm operation</h3><p>To ensure the profiler is enabled, let&rsquo;s review the application logs with the following commands:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>doorgame --tail<span class=o>=</span><span class=m>100</span> <span class=p>|</span> grep JfrActivator</span></span></code></pre></div><p>You should see a line in the application log output that shows the profiler is active:</p><div class="highlight wrap-code"><pre tabindex=0><code class=language-log data-lang=log>[otel.javaagent 2024-02-05 19:01:12:416 +0000] [main] INFO com.splunk.opentelemetry.profiler.JfrActivator - Profiler is active.```</code></pre></div><p>This confirms that the profiler is enabled and sending data to the OpenTelemetry collector deployed in our Kubernetes cluster, which in turn sends profiling data to Splunk Observability Cloud.</p><h3 id=profiling-in-apm>Profiling in APM</h3><p>Visit <code>http://&lt;your IP address>:81</code> and play a few more rounds of The Door Game.</p><p>Then head back to Splunk Observability Cloud, click on APM, and click on the <code>doorgame</code> service at the bottom of the screen.</p><p>Click on &ldquo;Traces&rdquo; on the right-hand side to load traces for this service. Filter on traces involving the <code>doorgame</code> service and the <code>GET new-game</code> operation (since we&rsquo;re troubleshooting the game startup sequence):</p><p><a href=#R-image-900d551a34fd7a669d207182a9a205db class=lightbox-link><img alt="New Game Traces" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/new_game_traces.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-900d551a34fd7a669d207182a9a205db><img alt="New Game Traces" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/new_game_traces.png></a></p><p>Selecting one of these traces brings up the following screen:</p><p><a href=#R-image-287679e748c2c8b534a146831b708b22 class=lightbox-link><img alt="Trace with Call Stacks" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/trace_with_call_stacks.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-287679e748c2c8b534a146831b708b22><img alt="Trace with Call Stacks" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/trace_with_call_stacks.png></a></p><p>You can see that the spans now include &ldquo;Call Stacks&rdquo;, which is a result of us enabling CPU and memory profiling earlier.</p><p>Click on the span named <code>doorgame: SELECT doorgamedb</code>, then click on CPU stack traces on the right-hand side:</p><p><a href=#R-image-cf0878d2c3db6c4a6acfc6473243bf4c class=lightbox-link><img alt="Trace with CPU Call Stacks" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/trace_with_cpu_call_stacks.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cf0878d2c3db6c4a6acfc6473243bf4c><img alt="Trace with CPU Call Stacks" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/trace_with_cpu_call_stacks.png></a></p><p>This brings up the CPU call stacks captured by the profiler.</p><p>Let&rsquo;s open the AlwaysOn Profiler to review the CPU stack trace in more detail. We can do this by clicking on the <code>Span</code> link beside <code>View in AlwaysOn Profiler</code>:</p><p><a href=#R-image-5ad10b0ce28a6f0f4488844dac1ca171 class=lightbox-link><img alt="Flamegraph and table" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/flamegraph_and_table.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5ad10b0ce28a6f0f4488844dac1ca171><img alt="Flamegraph and table" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/flamegraph_and_table.png></a></p><p>The AlwaysOn Profiler includes both a table and a <a href=https://www.brendangregg.com/flamegraphs.html rel=external target=_blank>flamegraph</a>. Take some time to explore this view by doing some of the following:</p><ul><li>click a table item and notice the change in flamegraph</li><li>navigate the flamegraph by clicking on a stack frame to zoom in, and a parent frame to zoom out</li><li>add a search term like <code>splunk</code> or <code>jetty</code> to highlight some matching stack frames</li></ul><p>Let&rsquo;s have a closer look at the stack trace, starting with the <code>DoorGame.startNew</code> method (since we already know that it&rsquo;s the slowest part of the request)</p><div class="highlight wrap-code"><pre tabindex=0><code>com.splunk.profiling.workshop.DoorGame.startNew(DoorGame.java:24)
com.splunk.profiling.workshop.UserData.loadUserData(UserData.java:33)
com.mysql.cj.jdbc.StatementImpl.executeQuery(StatementImpl.java:1168)
com.mysql.cj.NativeSession.execSQL(NativeSession.java:655)
com.mysql.cj.protocol.a.NativeProtocol.sendQueryString(NativeProtocol.java:998)
com.mysql.cj.protocol.a.NativeProtocol.sendQueryPacket(NativeProtocol.java:1065)
com.mysql.cj.protocol.a.NativeProtocol.readAllResults(NativeProtocol.java:1715)
com.mysql.cj.protocol.a.NativeProtocol.read(NativeProtocol.java:1661)
com.mysql.cj.protocol.a.TextResultsetReader.read(TextResultsetReader.java:48)
com.mysql.cj.protocol.a.TextResultsetReader.read(TextResultsetReader.java:87)
com.mysql.cj.protocol.a.NativeProtocol.read(NativeProtocol.java:1648)
com.mysql.cj.protocol.a.ResultsetRowReader.read(ResultsetRowReader.java:42)
com.mysql.cj.protocol.a.ResultsetRowReader.read(ResultsetRowReader.java:75)
com.mysql.cj.protocol.a.MultiPacketReader.readMessage(MultiPacketReader.java:44)
com.mysql.cj.protocol.a.MultiPacketReader.readMessage(MultiPacketReader.java:66)
com.mysql.cj.protocol.a.TimeTrackingPacketReader.readMessage(TimeTrackingPacketReader.java:41)
com.mysql.cj.protocol.a.TimeTrackingPacketReader.readMessage(TimeTrackingPacketReader.java:62)
com.mysql.cj.protocol.a.SimplePacketReader.readMessage(SimplePacketReader.java:45)
com.mysql.cj.protocol.a.SimplePacketReader.readMessage(SimplePacketReader.java:102)
com.mysql.cj.protocol.a.SimplePacketReader.readMessageLocal(SimplePacketReader.java:137)
com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:64)
java.io.FilterInputStream.read(Unknown Source:0)
sun.security.ssl.SSLSocketImpl$AppInputStream.read(Unknown Source:0)
sun.security.ssl.SSLSocketImpl.readApplicationRecord(Unknown Source:0)
sun.security.ssl.SSLSocketInputRecord.bytesInCompletePacket(Unknown Source:0)
sun.security.ssl.SSLSocketInputRecord.readHeader(Unknown Source:0)
sun.security.ssl.SSLSocketInputRecord.read(Unknown Source:0)
java.net.SocketInputStream.read(Unknown Source:0)
java.net.SocketInputStream.read(Unknown Source:0)
java.lang.ThreadLocal.get(Unknown Source:0)</code></pre></div><p>We can interpret the stack trace as follows:</p><ul><li>When starting a new Door Game, a call is made to load user data.</li><li>This results in executing a SQL query to load the user data (which is related to the slow SQL query we saw earlier).</li><li>We then see calls to read data in from the database.</li></ul><p>So, what does this all mean? It means that our application startup is slow since it&rsquo;s spending time loading user data. In fact, the profiler has told us the exact line of code where this happens:</p><div class="highlight wrap-code"><pre tabindex=0><code>com.splunk.profiling.workshop.UserData.loadUserData(UserData.java:33)</code></pre></div><p>Let&rsquo;s open the corresponding source file (<code>./doorgame/src/main/java/com/splunk/profiling/workshop/UserData.java</code>) and look at this code in more detail:</p><div class="highlight wrap-code"><pre tabindex=0><code>public class UserData {

    static final String DB_URL = &#34;jdbc:mysql://mysql/DoorGameDB&#34;;
    static final String USER = &#34;root&#34;;
    static final String PASS = System.getenv(&#34;MYSQL_ROOT_PASSWORD&#34;);
    static final String SELECT_QUERY = &#34;select * FROM DoorGameDB.Users, DoorGameDB.Organizations&#34;;

    HashMap&lt;String, User&gt; users;

    public UserData() {
        users = new HashMap&lt;String, User&gt;();
    }

    public void loadUserData() {

        // Load user data from the database and store it in a map
        Connection conn = null;
        Statement stmt = null;
        ResultSet rs = null;

        try{
            conn = DriverManager.getConnection(DB_URL, USER, PASS);
            stmt = conn.createStatement();
            rs = stmt.executeQuery(SELECT_QUERY);
            while (rs.next()) {
                User user = new User(rs.getString(&#34;UserId&#34;), rs.getString(&#34;FirstName&#34;), rs.getString(&#34;LastName&#34;));
                users.put(rs.getString(&#34;UserId&#34;), user);
            }</code></pre></div><p>Here we can see the application logic in action. It establishes a connection to the database, then executes the SQL query we saw earlier:</p><div class="highlight wrap-code"><pre tabindex=0><code>select * FROM DoorGameDB.Users, DoorGameDB.Organizations</code></pre></div><p>It then loops through each of the results, and loads each user into a <code>HashMap</code> object, which is a collection of <code>User</code> objects.</p><p>We have a good understanding of why the game startup sequence is so slow, but how do we fix it?</p><p>For more clues, let&rsquo;s have a look at the other part of AlwaysOn Profiling: memory profiling. To do this, click on the <code>Memory</code> tab in AlwaysOn profiling:</p><p><a href=#R-image-552ac4c39a7d99ac17a37c43fbbb12ba class=lightbox-link><img alt="Memory Profiling" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/memory_profiling.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-552ac4c39a7d99ac17a37c43fbbb12ba><img alt="Memory Profiling" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/memory_profiling.png></a></p><p>At the top of this view, we can see how much heap memory our application is using, the heap memory allocation rate, and garbage collection activity.</p><p>We can see that our application is using about 400 MB out of the max 1 GB heap size, which seems excessive for such a simple application. We can also see that some garbage collection occurred, which caused our application to pause (and probably annoyed those wanting to play the Game Door).</p><p>At the bottom of the screen, which can see which methods in our Java application code are associated with the most heap memory usage. Click on the first item in the list to show the Memory Allocation Stack Traces associated with the <code>java.util.Arrays.copyOf</code> method specifically:</p><p><a href=#R-image-bb35dbbdd73a32bc4b5d649422d3ae15 class=lightbox-link><img alt="Memory Allocation Stack Traces" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/memory_allocation_stack_traces.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bb35dbbdd73a32bc4b5d649422d3ae15><img alt="Memory Allocation Stack Traces" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/memory_allocation_stack_traces.png></a></p><p>With help from the profiler, we can see that the <code>loadUserData</code> method not only consumes excessive CPU time, but it also consumes excessive memory when storing the user data in the <code>HashMap</code> collection object.</p><h2 id=what-did-we-accomplish>What did we accomplish?</h2><p>We&rsquo;ve come a long way already!</p><ul><li>We learned how to enable the profiler in the Splunk OpenTelemetry Java instrumentation agent.</li><li>We learned how to verify in the agent output that the profiler is enabled.</li><li>We have explored several profiling related workflows in APM:<ul><li>How to navigate to AlwaysOn Profiling from the troubleshooting view</li><li>How to explore the flamegraph and method call duration table through navigation and filtering</li><li>How to identify when a span has sampled call stacks associated with it</li><li>How to explore heap utilization and garbage collection activity</li><li>How to view memory allocation stack traces for a particular method</li></ul></li></ul><p>In the next section, we&rsquo;ll apply a fix to our application to resolve the slow startup performance.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=fix-application-startup-slowness>Fix Application Startup Slowness</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>In this section, we&rsquo;ll use what we learned from the profiling data in <strong>Splunk Observability Cloud</strong> to resolve the slowness we saw when starting our application.</p><h3 id=examining-the-source-code>Examining the Source Code</h3><p>Open the corresponding source file once again (<code>./doorgame/src/main/java/com/splunk/profiling/workshop/UserData.java</code>) and focus on the following code:</p><div class="highlight wrap-code"><pre tabindex=0><code>public class UserData {

    static final String DB_URL = &#34;jdbc:mysql://mysql/DoorGameDB&#34;;
    static final String USER = &#34;root&#34;;
    static final String PASS = System.getenv(&#34;MYSQL_ROOT_PASSWORD&#34;);
    static final String SELECT_QUERY = &#34;select * FROM DoorGameDB.Users, DoorGameDB.Organizations&#34;;

    HashMap&lt;String, User&gt; users;

    public UserData() {
        users = new HashMap&lt;String, User&gt;();
    }

    public void loadUserData() {

        // Load user data from the database and store it in a map
        Connection conn = null;
        Statement stmt = null;
        ResultSet rs = null;

        try{
            conn = DriverManager.getConnection(DB_URL, USER, PASS);
            stmt = conn.createStatement();
            rs = stmt.executeQuery(SELECT_QUERY);
            while (rs.next()) {
                User user = new User(rs.getString(&#34;UserId&#34;), rs.getString(&#34;FirstName&#34;), rs.getString(&#34;LastName&#34;));
                users.put(rs.getString(&#34;UserId&#34;), user);
            }</code></pre></div><p>After speaking with a database engineer, you discover that the SQL query being executed includes a cartesian join:</p><div class="highlight wrap-code"><pre tabindex=0><code>select * FROM DoorGameDB.Users, DoorGameDB.Organizations</code></pre></div><p>Cartesian joins are notoriously slow, and shouldn&rsquo;t be used, in general.</p><p>Upon further investigation, you discover that there are 10,000 rows in the user table, and 1,000 rows in the organization table. When we execute a cartesian join using both of these tables, we end up with 10,000 x 1,000 rows being returned, which is 10,000,000 rows!</p><p>Furthermore, the query ends up returning duplicate user data, since each record in the user table is repeated for each organization.</p><p>So when our code executes this query, it tries to load 10,000,000 user objects into the HashMap, which explains why it takes so long to execute, and why it consumes so much heap memory.</p><h3 id=lets-fix-that-bug>Let&rsquo;s Fix That Bug</h3><p>After consulting the engineer that originally wrote this code, we determined that the join with the Organizations table was inadvertent.</p><p>So when loading the users into the HashMap, we simply need to remove this table from the query.</p><p>Open the corresponding source file once again (<code>./doorgame/src/main/java/com/splunk/profiling/workshop/UserData.java</code>) and change the following line of code:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>SELECT_QUERY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;select * FROM DoorGameDB.Users, DoorGameDB.Organizations&#34;</span><span class=p>;</span></span></span></code></pre></div><p>to:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>SELECT_QUERY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;select * FROM DoorGameDB.Users&#34;</span><span class=p>;</span></span></span></code></pre></div><p>Now the method should perform much more quickly, and less memory should be used, as it&rsquo;s loading the correct number of users into the HashMap (10,000 instead of 10,000,000).</p><h3 id=rebuild-and-redeploy-application>Rebuild and Redeploy Application</h3><p>Let&rsquo;s test our changes by using the following commands to re-build and re-deploy the Door Game application:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> workshop/profiling
</span></span><span class=line><span class=cl>./5-redeploy-doorgame.sh</span></span></code></pre></div><p>Once the application has been redeployed successfully, visit The Door Game again to confirm that your fix is in place:
<code>http://&lt;your IP address>:81</code></p><p>Clicking <code>Let's Play</code> should take us to the game more quickly now (though performance could still be improved):</p><p><a href=#R-image-3f466186e584d5cc565bbf9f7370f300 class=lightbox-link><img alt="Choose Door" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/door_game_choose_door.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f466186e584d5cc565bbf9f7370f300><img alt="Choose Door" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/door_game_choose_door.png></a></p><p>Start the game a few more times, then return to <strong>Splunk Observability Cloud</strong> to confirm that the latency of the <code>GET new-game</code> operation has decreased.</p><h2 id=what-did-we-accomplish>What did we accomplish?</h2><ul><li>We discovered why our SQL query was so slow.</li><li>We applied a fix, then rebuilt and redeployed our application.</li><li>We confirmed that the application starts a new game more quickly.</li></ul><p>In the next section, we&rsquo;ll explore continue playing the game and fix any remaining performance issues that we find.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=fix-in-game-slowness>Fix In Game Slowness</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Now that our game startup slowness has been resolved, let&rsquo;s play several rounds of the Door Game and ensure the rest of the game performs quickly.</p><p>As you play the game, do you notice any other slowness? Let&rsquo;s look at the data in <strong>Splunk Observability</strong> Cloud to put some numbers on what we&rsquo;re seeing.</p><h3 id=review-game-performance-in-splunk-observability-cloud>Review Game Performance in Splunk Observability Cloud</h3><p>Navigate to APM then click on Traces on the right-hand side of the screen. Sort the traces by Duration in descending order:</p><p><a href=#R-image-ec43e422a2f6886b15e417b4f08ca51e class=lightbox-link><img alt="Slow Traces" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/slow_trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ec43e422a2f6886b15e417b4f08ca51e><img alt="Slow Traces" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/slow_trace.png></a></p><p>We can see that a few of the traces with an operation of <code>GET /game/:uid/picked/:picked/outcome</code> have a duration of just over five seconds. This explains why we&rsquo;re still seeing some slowness when we play the app (note that the slowness is no longer on the game startup operation, <code>GET /new-game</code>, but rather a different operation used while actually playing the game).</p><p>Let&rsquo;s click on one of the slow traces and take a closer look. Since profiling is still enabled, call stacks have been captured as part of this trace. Click on the child span in the waterfall view, then click CPU Stack Traces:</p><p><a href=#R-image-973e1050a0c3664e1b7fed0bede7b08d class=lightbox-link><img alt="View Stack on Span" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/view_stack_on_span.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-973e1050a0c3664e1b7fed0bede7b08d><img alt="View Stack on Span" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/view_stack_on_span.png></a></p><p>At the bottom of the call stack, we can see that the thread was busy sleeping:</p><div class="highlight wrap-code"><pre tabindex=0><code class=language-log data-lang=log>com.splunk.profiling.workshop.ServiceMain$$Lambda$.handle(Unknown Source:0)
com.splunk.profiling.workshop.ServiceMain.lambda$main$(ServiceMain.java:34)
com.splunk.profiling.workshop.DoorGame.getOutcome(DoorGame.java:41)
com.splunk.profiling.workshop.DoorChecker.isWinner(DoorChecker.java:14)
com.splunk.profiling.workshop.DoorChecker.checkDoorTwo(DoorChecker.java:30)
com.splunk.profiling.workshop.DoorChecker.precheck(DoorChecker.java:36)
com.splunk.profiling.workshop.Util.sleep(Util.java:9)
java.util.concurrent.TimeUnit.sleep(Unknown Source:0)
java.lang.Thread.sleep(Unknown Source:0)
java.lang.Thread.sleep(Native Method:0)</code></pre></div><p>The call stack tells us a story &ndash; reading from the bottom up, it lets us describe
what is happening inside the service code. A developer, even one unfamiliar with the
source code, should be able to look at this call stack to craft a narrative like:</p><blockquote><p>We are getting the outcome of a game. We leverage the DoorChecker to
see if something is the winner, but the check for door two somehow issues
a precheck() that, for some reason, is deciding to sleep for a long time.</p></blockquote><p>Our workshop application is left intentionally simple &ndash; a real-world service might see the
thread being sampled during a database call or calling into an un-traced external service.
It is also possible that a slow span is executing a complicated business process,
in which case maybe none of the stack traces relate to each other at all.</p><p>The longer a method or process is, the greater chance we will have call stacks
sampled during its execution.</p><h3 id=lets-fix-that-bug>Let&rsquo;s Fix That Bug</h3><p>By using the profiling tool, we were able to determine that our application is slow
when issuing the <code>DoorChecker.precheck()</code> method from inside <code>DoorChecker.checkDoorTwo()</code>.
Let&rsquo;s open the <code>doorgame/src/main/java/com/splunk/profiling/workshop/DoorChecker.java</code> source file in our editor.</p><p>By quickly glancing through the file, we see that there are methods for checking
each door, and all of them call <code>precheck()</code>. In a real service, we might be uncomfortable
simply removing the <code>precheck()</code> call because there could be unseen/unaccounted side
effects.</p><p>Down on line 29 we see the following:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>checkDoorTwo</span><span class=p>(</span><span class=n>GameInfo</span><span class=w> </span><span class=n>gameInfo</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>precheck</span><span class=p>(</span><span class=n>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>gameInfo</span><span class=p>.</span><span class=na>isWinner</span><span class=p>(</span><span class=n>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>precheck</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>doorNum</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>long</span><span class=w> </span><span class=n>extra</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>Math</span><span class=p>.</span><span class=na>pow</span><span class=p>(</span><span class=n>70</span><span class=p>,</span><span class=w> </span><span class=n>doorNum</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sleep</span><span class=p>(</span><span class=n>300</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>extra</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span></span></span></code></pre></div><p>With our developer hat on, we notice that the door number is zero based, so
the first door is 0, the second is 1, and the 3rd is 2 (this is conventional).
The <code>extra</code> value is used as extra/additional sleep time, and it is computed by taking
<code>70^doorNum</code> (<code>Math.pow</code> performs an exponent calculation). That&rsquo;s odd, because this means:</p><ul><li>door 0 => 70^0 => 1ms</li><li>door 1 => 70^1 => 70ms</li><li>door 2 => 70^2 => 4900ms</li></ul><p>We&rsquo;ve found the root cause of our slow bug! This also explains why the first two doors
weren&rsquo;t ever very slow.</p><p>We have a quick chat with our product manager and team lead, and we agree that the <code>precheck()</code>
method must stay but that the extra padding isn&rsquo;t required. Let&rsquo;s remove the <code>extra</code> variable
and make <code>precheck</code> now read like this:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>precheck</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>doorNum</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>sleep</span><span class=p>(</span><span class=n>300</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span></span></span></code></pre></div><p>Now all doors will have a consistent behavior. Save your work and then rebuild and redeploy the application using the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> workshop/profiling
</span></span><span class=line><span class=cl>./5-redeploy-doorgame.sh</span></span></code></pre></div><p>Once the application has been redeployed successfully, visit The Door Game again to confirm that your fix is in place:
<code>http://&lt;your IP address>:81</code></p><h2 id=what-did-we-accomplish>What did we accomplish?</h2><ul><li>We found another performance issue with our application that impacts game play.</li><li>We used the CPU call stacks included in the trace to understand application behavior.</li><li>We learned how the call stack can tell us a story and point us to suspect lines of code.</li><li>We identified the slow code and fixed it to make it faster.</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=summary>Summary</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;<p>In this workshop, we accomplished the following:</p><ul><li>We deployed our application and captured traces with <strong>Splunk Observability Cloud</strong>.</li><li>We used <strong>Database Query Performance</strong> to find a slow-running query that impacted the game startup time.</li><li>We enabled <strong>AlwaysOn Profiling</strong> and used it to confirm which line of code was causing the increased startup time and memory usage.</li><li>We found another application performance issue and used <strong>AlwaysOn Profiling</strong> again to find the problematic line of code.</li><li>We applied fixes for both of these issues and verified the result using <strong>Splunk Observability Cloud</strong>.</li></ul><p>Enabling <strong>AlwaysOn Profiling</strong> and utilizing <strong>Database Query Performance</strong> for your applications will let you get even more value from the data you’re sending to <strong>Splunk Observability Cloud</strong>.</p><p>Now that you’ve completed this workshop, you have the knowledge you need to start collecting deeper diagnostic data from your own applications!</p><p>To get started with <strong>Database Query Performance</strong> today, check out <a href=https://docs.splunk.com/observability/en/apm/db-query-perf/db-query-performance.html rel=external target=_blank>Monitor Database Query Performance</a>.</p><p>And to get started with <strong>AlwaysOn Profiling</strong>, check out <a href=https://docs.splunk.com/observability/en/apm/profiling/intro-profiling.html rel=external target=_blank>Introduction to AlwaysOn Profiling for Splunk APM</a></p><p>For more help, feel free to <a href=https://www.splunk.com/en_us/about-splunk/contact-us.html rel=external target=_blank>ask a Splunk Expert</a>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 6, 2024</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=optimize-end-user-experiences>Optimize End User Experiences</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>90 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Sarah Ware</span></span><p>How can we use Splunk Observability to get insight into end user experience, and proactively test scenarios to improve that experience?</p><p>Sections:</p><ul><li>Set up basic <a href=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/1-synthetics/index.html>Synthetic tests</a> to understand availability and performance ASAP<ul><li>Uptime test</li><li>API test</li><li>Single page Browser test</li></ul></li><li>Explore <a href=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/2-rum/index.html>RUM</a> to understand our real users</li><li>Write <a href=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/3-advanced-synthetics/index.html>advanced Synthetics tests</a> based on what we&rsquo;ve learned about our users and what we need them to do</li><li>Customize <a href=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/4-dashboards/index.html>dashboard charts</a> to capture our KPIs, show trends, and show data in context of our events</li><li>Create <a href=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/5-detectors/index.html>Detectors</a> to alert on our KPIs</li></ul><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>Keep in mind throughout the workshop: how can I prioritize activities strategically to get the fastest time to value for my end users and for myself/ my developers?</div></details><h2 id=context>Context</h2><p>As a reminder, we need frontend performance monitoring to capture everything that goes into our end user experience. If we&rsquo;re just monitoring the backend, we&rsquo;re missing all of the other resources that are critical to our users&rsquo; success. Read <a href=https://www.splunk.com/en_us/blog/devops/what-the-fastly-outage-can-teach-us-about-observability.html rel=external target=_blank>What the Fastly Outage Can Teach Us About Observability</a> for a real world example. Click the image below to zoom in.
<a href=#R-image-cb30de3189a4652e3de88256315a2480 class=lightbox-link><img alt="What goes into the front end" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/images/frontend.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cb30de3189a4652e3de88256315a2480><img alt="What goes into the front end" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/images/frontend.png></a></p><h2 id=references>References</h2><p>Throughout this workshop, we will see references to resources to help further understand end user experience and how to optimize it. In addition to <a href=https://docs.splunk.com/observability/en/rum/intro-to-rum.html rel=external target=_blank>Splunk Docs</a> for supported features and <a href=https://lantern.splunk.com/Observability/UCE/Optimized_experiences rel=external target=_blank>Lantern</a> for tips and tricks, <a href=https://web.dev/ rel=external target=_blank>Google&rsquo;s web.dev</a> and <a href=https://developer.mozilla.org/en-US/docs/Learn/Performance rel=external target=_blank>Mozilla</a> are great resources.</p><p>Remember that the specific libraries, platforms, and CDNs you use often also have their own specific resources. For example <a href=https://react.dev/reference/react/useCallback#skipping-re-rendering-of-components rel=external target=_blank>React</a>, <a href=https://wpengine.com/support/troubleshooting-high-time-first-byte-ttfb/ rel=external target=_blank>Wordpress</a>, and <a href=https://community.cloudflare.com/t/improving-time-to-first-byte-ttfb-with-cloudflare/390367 rel=external target=_blank>Cloudflare</a> all have their own tips to improve performance.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 10, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Optimize End User Experiences</h1><article class=default><header class=headline></header><h1 id=synthetics>Synthetics</h1><p>Let&rsquo;s quickly set up some tests in Synthetics to immediately start understanding our end user experience, without waiting for real users to interact with our app.</p><p>We can capture not only the performance and availability of our own apps and endpoints, but also those third parties we rely on any time of the day or night.</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>If you find that your tests are being bot-blocked, see the docs for <strong><a href=https://docs.splunk.com/observability/en/synthetics/test-config/synth-configure-app.html rel=external target=_blank>tips on how to allow Synthetic testing</a></strong>. if you need to test something that is not accessible externally, see <strong><a href=https://docs.splunk.com/observability/en/synthetics/test-config/private-locations.html rel=external target=_blank>private location instructions</a></strong>.</div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Synthetics</h1><article class=default><header class=headline></header><h1 id=uptime-test>Uptime Test</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>The simplest way to keep an eye on endpoint availability is with an <a href=https://docs.splunk.com/observability/en/synthetics/uptime-test/uptime-test.html rel=external target=_blank>Uptime test</a>. This lightweight test can run internally or externally around the world, as frequently as every minute. Because this is the easiest (and cheapest!) test to set up, and because this is ideal for monitoring availability of your most critical enpoints and ports, let&rsquo;s start here.</p><h2 id=pre-requisites>Pre-requisites</h2><ul><li>Publicly accessible HTTP(S) endpoint(s) to test</li><li>Access to Splunk Observability Cloud</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Uptime Test</h1><article class=default><header class=headline></header><h1 id=creating-a-test>Creating a test</h1><ol><li><p>Open Synthetics
<a href=#R-image-91f124fe32459a176bae75cd6e981119 class=lightbox-link><img alt="Synthetics navigation item" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/nav-synthetics.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-91f124fe32459a176bae75cd6e981119><img alt="Synthetics navigation item" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/nav-synthetics.png></a></p></li><li><p>Click the <span class="btn cstyle blue"><span><span class=title>Add new test</span></span></span> button on the right side of the screen, then select Uptime and HTTP test.
<a href=#R-image-76e522a66976d0ff39de4dfbddec067a class=lightbox-link><img alt=image class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/create-uptime.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-76e522a66976d0ff39de4dfbddec067a><img alt=image class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/create-uptime.png></a></p></li><li><p>Name your test with your <strong>team name</strong> (provided by your workshop instructor), your initials, and any other details you&rsquo;d like to include, like geographic region.</p></li><li><p>For now let&rsquo;s test a <strong>GET</strong> request. Fill in the URL field. You can use one of your own, or one of ours like <a href=https://online-boutique-eu.splunko11y.com rel=external target=_blank>https://online-boutique-eu.splunko11y.com</a>, <a href=https://online-boutique-us.splunko11y.com rel=external target=_blank>https://online-boutique-us.splunko11y.com</a>, or <a href=https://www.splunk.com rel=external target=_blank>https://www.splunk.com</a>.</p></li><li><p>Click <span class="btn cstyle transparent"><span><span class=title>Try now</span></span></span> to validate that the endpoint is accessible before the selected location before saving the test. <span class="btn cstyle transparent"><span><span class=title>Try now</span></span></span> does not count against your subscription usage, so this is a good practice to make sure you&rsquo;re not wasting real test runs on a misconfigured test.
<a href=#R-image-b369512d3c9a10cd8f09db093a44da03 class=lightbox-link><img alt=image class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/try-now.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b369512d3c9a10cd8f09db093a44da03><img alt=image class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/try-now.png></a></p></li></ol><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>A common reason for <span class="btn cstyle transparent"><span><span class=title>Try now</span></span></span> to fail is that there is a non-2xx response code. If that is expected, add a Validation for the correct response code.</div></details><ol><li><p>Add any additional validations needed, for example: response code, response header, and response size.
<a href=#R-image-ac255a83e4034992db9c32af7c167a4e class=lightbox-link><img alt="Advanced settings for test configuration" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/uptime-security.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ac255a83e4034992db9c32af7c167a4e><img alt="Advanced settings for test configuration" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/uptime-security.png></a></p></li><li><p>Add and remove any locations you&rsquo;d like. Keep in mind where you expect your endpoint to be available.</p></li><li><p>Change the frequency to test your more critical endpoints more often, up to one minute.
<a href=#R-image-9dff65e6b79908111c7790135114e1a3 class=lightbox-link><img alt=image class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/uptime-config.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9dff65e6b79908111c7790135114e1a3><img alt=image class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/uptime-config.png></a></p></li><li><p>Make sure &ldquo;Round-robin&rdquo; is on so the test will run from one location at a time, rather than from all locations at once.</p><ul><li>If an endpoint is <strong>highly</strong> critical, think about if it is worth it to have all locations tested at the same time every single minute. If you have automations built in with a webhook from a detector, or if you have strict SLAs you need to track, this <em>could</em> be worth it to have as much coverage as possible. But if you are doing more manual investigation, or if this is a less critical endpoint, you could be wasting test runs that are executing while an issue is being investigated.</li><li>Remember that your license is based on the number of test runs per month. Turning Round-robin off will multiply the number of test runs by the number of locations you have selected.</li></ul></li><li><p>When you are ready for the test to start running, make sure &ldquo;Active&rdquo; is on, then scroll down and click <span class="btn cstyle blue"><span><span class=title>Submit</span></span></span> to save the test configuration.
<a href=#R-image-c5374b6ffd5c1869b760a0aef5bd86af class=lightbox-link><img alt="submit button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/submit.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c5374b6ffd5c1869b760a0aef5bd86af><img alt="submit button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/submit.png></a></p></li></ol><p>Now the test will start running with your saved configuration. Take a water break, then we&rsquo;ll look at the results!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=understanding-results>Understanding results</h1><ol><li><p>From the Synthetics landing page, click into a test to see its summary view and play with the <a href=https://docs.splunk.com/observability/en/synthetics/uptime-test/uptime-test-results.html#customize-the-performance-kpis-chart rel=external target=_blank>Performance KPIs chart</a> filters to see how you can slice and dice your data. This is a good place to get started understanding trends. Later, we will see what custom charts look like, so you can tailor dashboards to the KPIs you care about most.
<a href=#R-image-bcdd2663b42b3c3c47ffe3152b0eb945 class=lightbox-link><img alt="KPI chart filters" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-09/c040b5f6-a868-4977-8d3b-bc3e431ffcc8/user_cropped_screenshot.jpeg?tl_px=1160,0&br_px=2880,961&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=755,44" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bcdd2663b42b3c3c47ffe3152b0eb945><img alt="KPI chart filters" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-09/c040b5f6-a868-4977-8d3b-bc3e431ffcc8/user_cropped_screenshot.jpeg?tl_px=1160,0&br_px=2880,961&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=755,44"></a><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question: Using the Performance KPIs chart</summary><div class=box-content><p>What metrics are available? Is your data consistent across time and locations? Do certain locations run slower than others? Are there any spikes or failures?</p></div></details></p></li><li><p>Click into a recent run either in the chart or in the table below.
<a href=#R-image-caa8d1e7b80fcd0745a4a9335c1b57b7 class=lightbox-link><img alt="run results chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/run-results.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-caa8d1e7b80fcd0745a4a9335c1b57b7><img alt="run results chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/run-results.png></a></p></li><li><p>If there are failures, look at the response to see if you need to add a response code assertion (302 is a common one), if there is some authorization needed, or different request headers added. Here we have information about this particular test run including if it succeeded or failed, the location, timestamp, and duration in addition to the other Uptime test metrics. Click through to see the response, request, and connection info as well.
<a href=#R-image-84c8e15af68877ddb4d41647ff7aaa70 class=lightbox-link><img alt="uptime test result" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/uptime-test-result.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-84c8e15af68877ddb4d41647ff7aaa70><img alt="uptime test result" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/uptime-test-result.png></a>
If you need to edit the test for it to run successfully, click the test name in the top left breadcrumb on this run result page, then click <span class="btn cstyle transparent"><span><span class=title>Edit test</span></span></span> on the top right of the test overview page. Remember to scroll down and click <span class="btn cstyle blue"><span><span class=title>Submit</span></span></span> to save your changes after editing the test configuration.</p></li><li><p>In addition to the test running successfully, there are other metrics to measure the health of your endpoints. For example, <a href=https://web.dev/articles/ttfb rel=external target=_blank>Time to First Byte</a>(TTFB) is a great indicator of performance, and you can <a href=https://web.dev/articles/optimize-ttfb rel=external target=_blank>optimize TTFB</a> to improve end user experience.</p></li><li><p>Go back to the test overview page and change the Performance KPIs chart to display First Byte time. Once the test has run for a long enough time, expanding the time frame will draw the data points as lines to better see trends and anomalies, like in the example below.
<a href=#R-image-845d76279f58e88294061694043bddb4 class=lightbox-link><img alt="Performance KPIs for Uptime Tests" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/ttfb.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-845d76279f58e88294061694043bddb4><img alt="Performance KPIs for Uptime Tests" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/ttfb.png></a></p></li></ol><p>In the example above, we can see that TTFB varies consistently between locations. Knowing this, we can keep location in mind when reporting on metrics. We could also improve the experience, for example by serving users in those locations an endpoint hosted closer to them, which should reduce network latency. We can also see some slight variations in the results over time, but overall we already have a good idea of our baseline for this endpoint&rsquo;s KPIs. When we have a baseline, we can alert on worsening metrics as well as visualize improvements.<details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>We are not setting a detector on this test yet, to make sure it is running consistently and successfully. If you are testing a highly critical endpoint and want to be alerted on it ASAP (and have tolerance for potential alert noise), jump to <strong><a href=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/5-detectors/1-test-detector/index.html>Single Test Detectors</a></strong>.</p></div></details></p><p>Once you have your Uptime test running successfully, let&rsquo;s move on to the next test type.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=api-test>API Test</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>The <a href=https://docs.splunk.com/observability/en/synthetics/api-test/api-test.html rel=external target=_blank>API test</a> provides a flexible way to check the functionality and performance of API endpoints. The shift toward API-first development has magnified the necessity to monitor the back-end services that provide your core front-end functionality.</p><p>Whether you&rsquo;re interested in testing multi-step API interactions or you want to gain visibility into the performance of your endpoints, the API Test can help you accomplish your goals.</p><p>This excercise will walk through a multi-step test on the Spotify API. You can also use it as a reference to build tests on your own APIs or on those of your critical third parties.</p><p><a href=#R-image-1ca1e264f652726876ca528242aaad95 class=lightbox-link><img alt="API test result" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/api-test-result.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1ca1e264f652726876ca528242aaad95><img alt="API test result" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/api-test-result.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. API Test</h1><article class=default><header class=headline></header><h1 id=global-variables>Global Variables</h1><p><a href=https://docs.splunk.com/observability/en/synthetics/test-config/global-variables.html rel=external target=_blank>Global variables</a> allow us to use stored strings in multiple tests, so we only need to update them in one place.</p><p>View the global variable that we&rsquo;ll use to perform our API test. Click on <strong>Global Variables</strong> under the cog icon. The global variable named <code>env.encoded_auth</code> will be the one that we&rsquo;ll use to build the spotify API transaction.</p><p><a href=#R-image-c48cd6e5019107f105090bec6ff44b24 class=lightbox-link><img alt="global variables" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/global-variables.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c48cd6e5019107f105090bec6ff44b24><img alt="global variables" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/global-variables.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-new-api-test>Create new API test</h1><p>Create a new API test by clicking on the <span class="btn cstyle blue"><span><span class=title>Add new test</span></span></span> button and select <strong>API test</strong> from the dropdown. Name the test using your team name, your initials, and Spotify API e.g. <strong>[Daisy] RWC - Spotify API</strong></p><p><a href=#R-image-4d43b5f9a543d41183f66360004b0404 class=lightbox-link><img alt="new API test" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/create-api.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4d43b5f9a543d41183f66360004b0404><img alt="new API test" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/create-api.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=authentication-request>Authentication Request</h1><p>Click on <span class="btn cstyle transparent"><span><span class=title>+ Add requests</span></span></span> and enter the request step name e.g. <strong>Authenticate with Spotify API</strong>.</p><p><a href=#R-image-e1cd9e360275dfb7ece82e90e3703c3d class=lightbox-link><img alt=placeholder class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/add-request.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e1cd9e360275dfb7ece82e90e3703c3d><img alt=placeholder class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/add-request.png></a></p><p>Expand the Request section, from the drop-down change the request method to <strong>POST</strong> and enter the following URL:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://accounts.spotify.com/api/token</span></span></code></pre></div><p>In the <strong>Payload body</strong> section enter the following:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>grant_type=client_credentials</span></span></code></pre></div><p>Next, add two <span class="btn cstyle transparent"><span><span class=title>+ Request headers</span></span></span> with the following key/value pairings:</p><ul><li><strong>CONTENT-TYPE: application/x-www-form-urlencoded</strong></li><li><strong>AUTHORIZATION: Basic {{env.encoded_auth}}</strong></li></ul><p>Expand the <strong>Validation</strong> section and add the following extraction:</p><ul><li><strong>Extract</strong> from <strong>Response body</strong> <strong>JSON</strong> <strong>$.access_token</strong> as <strong>access_token</strong></li></ul><p>This will parse the JSON payload that is received from the Spotify API, extract the access token and store it as a custom variable.</p><p><a href=#R-image-91cd3a959c7cfc72bacbeeef5d7264aa class=lightbox-link><img alt="Add request payload token" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/api-payload-token.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-91cd3a959c7cfc72bacbeeef5d7264aa><img alt="Add request payload token" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/api-payload-token.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=search-request>Search Request</h1><p>Click on <span class="btn cstyle transparent"><span><span class=title>+ Add Request</span></span></span> to add the next step. Name the step <strong>Search for Tracks named &ldquo;Up around the bend&rdquo;</strong>.</p><p>Expand the <strong>Request</strong> section and change the request method to <strong>GET</strong> and enter the following URL:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://api.spotify.com/v1/search?q=Up%20around%20the%20bend&amp;type=track&amp;offset=0&amp;limit=5</span></span></code></pre></div><p>Next, add two request headers with the following key/value pairings:</p><ul><li><strong>CONTENT-TYPE: application/json</strong></li><li><strong>AUTHORIZATION: Bearer {{custom.access_token}}</strong><ul><li>This uses the custom variable we created in the previous step!</li></ul></li></ul><p><a href=#R-image-520da67a53c294da05d85353d2336e71 class=lightbox-link><img alt="Add search request" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/api-search-request.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-520da67a53c294da05d85353d2336e71><img alt="Add search request" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/api-search-request.png></a></p><p>Expand the <strong>Validation</strong> section and add the following extraction:</p><ul><li><strong>Extract</strong> from <strong>Response body</strong> <strong>JSON</strong> <strong>$.tracks.items[0].id</strong> as <strong>track.id</strong></li></ul><p><a href=#R-image-49a96319a47a02a0c5ffcf20e053e7f1 class=lightbox-link><img alt="Add search payload" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/api-search-payload.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-49a96319a47a02a0c5ffcf20e053e7f1><img alt="Add search payload" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/api-search-payload.png></a></p><p>To validate the test before saving, scroll to the top and change the location as needed. Click <span class="btn cstyle transparent"><span><span class=title>Try now</span></span></span>. See the docs for more information on the <a href=https://docs.splunk.com/observability/en/synthetics/test-config/try-now.html rel=external target=_blank>try now feature</a>.</p><p><a href=#R-image-df415bff572fcc11c1bfe7461a7d19b9 class=lightbox-link><img alt="try now" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/api-try-now.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-df415bff572fcc11c1bfe7461a7d19b9><img alt="try now" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/api-try-now.png></a></p><p>When the validation is successful, click on <span class="btn cstyle blue"><span><span class=title>< Return to test</span></span></span> to return to the test configuration page. And then click <span class="btn cstyle blue"><span><span class=title>Save</span></span></span> to save the API test.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Extra credit</summary><div class=box-content><p>Have more time to work on this test? Take a look at the Response Body in one of your run results. What additional steps would make this test more thorough? Edit the test, and use the <span class="btn cstyle transparent"><span><span class=title>Try now</span></span></span> feature to validate any changes you make before you save the test.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=view-results>View results</h1><p>Wait for a few minutes for the test to provision and run. Once you see the test has run successfully, click on the run to view the results:</p><p><a href=#R-image-d30cd62a3813dce24cf8669596084fd8 class=lightbox-link><img alt="API test result" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../_img/api-result.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d30cd62a3813dce24cf8669596084fd8><img alt="API test result" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../_img/api-result.png></a></p><h2 id=resources>Resources</h2><ul><li><a href=https://docs.splunk.com/Observability/synthetics/api-test/set-up-api-test.html rel=external target=_blank>How to Create an API Test</a></li><li><a href=https://docs.splunk.com/Observability/synthetics/api-test/api-test.html rel=external target=_blank>API Test Overview</a></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=single-page-browser-test>Single Page Browser Test</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>We have started testing our endpoints, now let&rsquo;s test the front end browser experience.</p><p>Starting with a single page <a href=https://docs.splunk.com/observability/en/synthetics/browser-test/browser-test.html rel=external target=_blank>browser test</a> will let us capture how first- and third-party resources impact how our end users experience our browser-based site. It also allows us to start to understand our user experience metrics before introducing the complexity of multiple steps in one test.</p><p>A page where your users commonly &ldquo;land&rdquo; is a good choice to start with a single page test. This could be your site homepage, a section main page, or any other high-traffic URL that is important to you and your end users.</p><ol><li><p>Click <span class="btn cstyle blue"><span><span class=title>Create new test</span></span></span> and select Browser test
<a href=#R-image-1221b3e36829fad299f9c4f993c17327 class=lightbox-link><img alt="Create new browser test" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/create-browser.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1221b3e36829fad299f9c4f993c17327><img alt="Create new browser test" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/create-browser.png></a></p></li><li><p>Include your <strong>team name</strong> and <strong>initials</strong> in the test name. Add to the Name and Custom properties to describe the scope of the test (like Desktop for device type). Then click <span class="btn cstyle transparent"><span><span class=title>+ Edit steps</span></span></span>
<a href=#R-image-60a64f6663dc4308a59af53e28c29863 class=lightbox-link><img alt="Browser test content fields" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-name.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-60a64f6663dc4308a59af53e28c29863><img alt="Browser test content fields" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-name.png></a></p></li><li><p>Change the transaction label (top left) and step name (on the right) to something readable that describes the step. Add the URL you&rsquo;d like to test. Your workshop instructor can provide you with a URL as well. In the below example, the transaction is &ldquo;Home&rdquo; and the step name is &ldquo;Go to homepage&rdquo;.
<a href=#R-image-edf24cc7057582eb21a0adecec6c8b2d class=lightbox-link><img alt="Transaction and step label" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/single-step.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-edf24cc7057582eb21a0adecec6c8b2d><img alt="Transaction and step label" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/single-step.png></a></p></li><li><p>To validate the test, change the location as needed and click <span class="btn cstyle transparent"><span><span class=title>Try now</span></span></span>. See the docs for more information on the <a href=https://docs.splunk.com/observability/en/synthetics/test-config/try-now.html rel=external target=_blank>try now feature</a>.
<a href=#R-image-09e2965279acb07092a9294d736cafa2 class=lightbox-link><img alt="browser test try now buttons" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-try-now.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-09e2965279acb07092a9294d736cafa2><img alt="browser test try now buttons" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-try-now.png></a></p></li><li><p>Wait for the test validation to complete. If the test validation failed, double check your URL and test location and try again. With <span class="btn cstyle transparent"><span><span class=title>Try now</span></span></span> you can see what the result of the test will be if it were saved and run as-is.
<a href=#R-image-620f9989411c121cf50e5d509980cfc0 class=lightbox-link><img alt="Try Now browser test results" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-try-now-result.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-620f9989411c121cf50e5d509980cfc0><img alt="Try Now browser test results" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-try-now-result.png></a></p></li><li><p>Click <span class="btn cstyle blue"><span><span class=title>&lt; Return to test</span></span></span> to continue the configuration.
<a href=#R-image-917f3764151598e99482b2563e43c092 class=lightbox-link><img alt="Return to test button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/return.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-917f3764151598e99482b2563e43c092><img alt="Return to test button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/return.png></a></p></li><li><p>Edit the locations you want to use, keeping in mind any regional rules you have for your site.<p></p><a href=#R-image-a48314fa8fe4cec52293ff5f62fb64a8 class=lightbox-link><img alt="Browser test details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-test-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a48314fa8fe4cec52293ff5f62fb64a8><img alt="Browser test details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-test-details.png></a></p></li><li><p>You can edit the Device and Frequency or leave them at their default values for now. Click <span class="btn cstyle blue"><span><span class=title>Submit</span></span></span> at the bottom of the form to save the test and start running it.<p></p><a href=#R-image-e603e2c469f31e50d84522af4bafa5db class=lightbox-link><img alt="browser test submit button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-submit.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e603e2c469f31e50d84522af4bafa5db><img alt="browser test submit button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-submit.png></a></p></li></ol><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Bonus Exercise</summary><div class=box-content><p>Have a few spare seconds? Copy this test and change just the title and device type, and save. Now you have visibility into the end user experience on another device and connection speed!</p></div></details><p>While our Synthetic tests are running, let&rsquo;s see how RUM is instrumented to start getting data from our real users.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=rum>RUM</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>With <a href=https://docs.splunk.com/observability/en/rum/intro-to-rum.html rel=external target=_blank>RUM</a> instrumented, we will be able to better understand our end users, what they are doing, and what issues they are encountering.</p><p>This workshop walks through how our demo site is instrumented and how to interpret the data. If you already have a RUM license, this will help you understand how RUM works and how you can use it to optimize your end user experience.</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>Our Docs also contain guidance such as <a href=https://docs.splunk.com/observability/en/rum/rum-scenario-library/scenario-landingpage.html rel=external target=_blank>scenarios using Splunk RUM</a> and demo applications to test out <a href=https://docs.splunk.com/observability/en/rum/sample-app.html rel=external target=_blank>RUM for mobile apps</a>.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of RUM</h1><article class=default><header class=headline></header><h1 id=overview>Overview</h1><p>The aim of this Splunk Real User Monitoring (RUM) workshop is to let you:</p><ul><li>Shop for items on the Online Boutique to create traffic, and create RUM User Sessions<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> that you can view in the Splunk Observability Suite.</li><li>See an overview of the performance of all your application(s) in the Application Summary Dashboard</li><li>Examine the performance of a specific website with RUM metrics.</li></ul><p>In order to reach this goal, we will use an online boutique to order various products. While shopping on the online boutique you will create what is called a User Session.</p><p>You may encounter some issues with this web site, and you will use Splunk RUM to identify the issues, so they can be resolved by the developers.</p><p>The workshop host will provide you with a URL for an online boutique store that has RUM enabled.</p><p>Each of these Online Boutiques are also being visited by a few synthetic users; this will allow us to generate more live data to be analyzed later.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>A RUM User session is a &ldquo;recording&rdquo; of a collection of user interactions on an application, basically collecting a website or app’s performance measured straight from the browser or Mobile App of the end user. To do this a small amount of JavaScript is embedded in each page. This script then collects data from each user as he or she explores the page, and transfers that data back for analysis.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=rum-instrumentation-in-a-browser-app>RUM instrumentation in a browser app</h1><ul><li>Check the HEAD section of the Online-boutique webpage in your browser</li><li>Find the code that instruments RUM</li></ul><hr><h2 id=1-browse-to-the-online-boutique>1. Browse to the Online Boutique</h2><p>Your workshop instructor will provide you with the Online Boutique URL that has RUM installed so that you can complete the next steps.</p><h2 id=2--inspecting-the-html-source>2. Inspecting the HTML source</h2><p>The changes needed for RUM are placed in the <code>&lt;head></code> section of the hosts Web page. Right click to view the page source or to inspect the code. Below is an example of the <code>&lt;head></code> section with RUM:</p><p><a href=#R-image-215bb595351361ca5ee5a6606c5366f3 class=lightbox-link><img alt="Online Boutique" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-inst.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-215bb595351361ca5ee5a6606c5366f3><img alt="Online Boutique" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-inst.png></a></p><p>This code enables RUM Tracing, <a href=https://docs.splunk.com/observability/en/rum/rum-session-replay.html rel=external target=_blank>Session Replay</a>, and <a href=https://docs.splunk.com/observability/en/rum/RUM-custom-events.html rel=external target=_blank>Custom Events</a> to better understand performance in the context of user workflows:</p><ul><li>The first part is to indicate where to download the Splunk Open Telemetry Javascript file from: <code>https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js</code> (this can also be hosted locally if so required).</li><li>The next section defines the location where to send the traces to in the beacon url: <code>{beaconUrl: "https://rum-ingest.eu0.signalfx.com/v1/rum"</code></li><li>The RUM Access Token: <code>rumAuth: "&lt;redacted>"</code>.</li><li>Identification tags <code>app</code> and <code>environment</code> to indentify in the SPLUNK RUM UI e.g. <code>app: "online-boutique-us-store", environment: "online-boutique-us"}</code> (these values will be different in your workshop)</li></ul><p>The above lines 21 and 23-30 are all that is required to enable RUM on your website!</p><p>Lines 22 and 31-34 are optional if you want Session Replay instrumented.</p><p>Line 36-39 <code>var tracer=Provider.getTracer('appModuleLoader');</code> will add a Custom Event for every page change, allowing you to better track your website conversions and usage. This may or may not be instrumented for this workshop.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>Time to shop! Take a minute to open the workshop store URL in as many browsers and devices as you&rsquo;d like, shop around, add items to cart, checkout, and feel free to close the shopping browsers when you&rsquo;re finished. Keep in mind this is a lightweight demo shop site, so don&rsquo;t be alarmed if the cart doesn&rsquo;t match the item you picked!</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>May 16, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=rum-landing-page>RUM Landing Page</h1><ul><li>Visit the RUM landing page and and check the overview of the performance of all your RUM enabled applications with the Application Summary Dashboard (Both Mobile and Web based)</li></ul><hr><h2 id=1-visit-the-rum-landing-page>1. Visit the RUM Landing Page</h2><p>Login into Splunk Observability. From the left side menu bar select <strong>RUM</strong> <a href=#R-image-6db8788891af8920e6a0233b8d84ca01 class=lightbox-link><img alt=RUM-ico class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/RUM_ico.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6db8788891af8920e6a0233b8d84ca01><img alt=RUM-ico class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/RUM_ico.png?classes=inline&height=25px"></a>. This will bring you to your the RUM Landing Page.</p><p>The goal of this page is to give you in a single page, a clear indication of the health, performance and potential errors found in your application(s) and allow you to dive deeper into the information about your User Sessions collected from your web page/App. You will have a pane for each of your active RUM applications. (The view below is the default expanded view)</p><p><a href=#R-image-8427f428c0cb5e764f147e40cd125848 class=lightbox-link><img alt=RUM-App-sum class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/Applicationsummarydashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8427f428c0cb5e764f147e40cd125848><img alt=RUM-App-sum class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/Applicationsummarydashboard.png></a></p><p>If you have multiple applications, (which will be the case when every attendee is using their own ec2 instance for the RUM workshop), the pane view may be automatically reduced by collapsing the panes as shown below:</p><p><a href=#R-image-7c40921d0a965278df7aedab416a069f class=lightbox-link><img alt=RUM-App-sum-collapsed class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/multiple_apps_collapsed.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7c40921d0a965278df7aedab416a069f><img alt=RUM-App-sum-collapsed class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/multiple_apps_collapsed.png></a></p><p>You can expanded a condensed RUM Application Summary View to the full dashboard by clicking on the small browser <a href=#R-image-fb45a9100a31ddf02f40741e6741ee81 class=lightbox-link><img alt=RUM-browser class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/browser.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fb45a9100a31ddf02f40741e6741ee81><img alt=RUM-browser class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/browser.png?classes=inline&height=25px"></a> or Mobile <a href=#R-image-9675c71cd2916ad79893052c12b114be class=lightbox-link><img alt=RUM-mobile class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/mobile.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9675c71cd2916ad79893052c12b114be><img alt=RUM-mobile class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/mobile.png?classes=inline&height=25px"></a>icon. (Depending on the type of application: <em>Mobile</em> or <em>Browser</em> based) on the left in front of the applications name, highlighted by the red arrow.</p><p>First find the right application to use for the workshop:</p><p>If you are participating in a stand alone RUM workshop, the workshop leader will tell you the name of the application to use, in the case of a combined workshop, it will follow the naming convention we used for IM and APM and use the ec2 node name as a unique id like <strong>jmcj-store</strong> as shown as the last app in the screenshot above.</p><h2 id=2-configure-the-rum-application-summary-dashboard-header-section>2. Configure the RUM Application Summary Dashboard Header Section</h2><p>RUM Application Summary Dashboard consists of 6 major sections. The first is the selection header, where you can set/filter a number of options:</p><ul><li>A drop down for the <strong>Time Window</strong> you&rsquo;re reviewing (You are looking at the past 15 minutes by default)</li><li>A drop down to select the <strong>Environment</strong><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> you want to look at. This allows you to focus on just the subset of applications belonging to that environment, or Select all to view all available.</li><li>A drop down list with the various <strong>Apps</strong> being monitored. You can use the one provided by the workshop host or select your own. This will focus you on just one application.</li><li>A drop down to select the <strong>Source</strong>, <em>Browser</em> or <em>Mobile</em> applications to view. For the Workshop leave <em>All</em> selected.</li><li>A hamburger menu located at the right of the header allowing you to configure some settings of your Splunk RUM application. (We will visit this in a later section).</li></ul><p><a href=#R-image-6cdf01f3e72fbe155ab519b9e14e49e0 class=lightbox-link><img alt=RUM-SummaryHeader class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM_SummaryHeader.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6cdf01f3e72fbe155ab519b9e14e49e0><img alt=RUM-SummaryHeader class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM_SummaryHeader.png></a></p><p>For the workshop lets do a deeper dive into the Application Summary screen in the next section: <a href=/observability-workshop/v5.76/en/scenarios/optimize_end_user_experiences/2-rum/4-browser-summary/index.html>Check Health Browser Application</a></p><hr><p>A common application deployment pattern is to have multiple, distinct application environments that don’t interact directly with each other but that are all being monitored by Splunk APM or RUM: for instance, quality assurance (QA) and production environments, or multiple distinct deployments in different datacenters, regions or cloud providers.
<a href=http://nebezb.com/ rel=external target=_blank></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>A deployment environment is a distinct deployment of your system or application that allows you to set up configurations that don’t overlap with configurations in other deployments of the same application. Separate deployment environments are often used for different stages of the development process, such as development, staging, and production.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=check-browser-applications-health-at-a-glance>Check Browser Applications health at a glance</h1><ul><li>Get familiar with the UI and options available from this landing page</li><li>Identify Page Views/JavaScript Errors and Request/Errors in a single view</br>Check the Web Vitals metrics and any Detector that has fired for in relation to your Browser Application</li></ul><hr><h2 id=application-summary-dashboard>Application Summary Dashboard</h2><h3 id=1header-bar>1.Header Bar</h3><p>As seen in the previous section the RUM Application Summary Dashboard consists of 5 major sections.</br>The first section is the selection header, where you can collapse the Pane via the <a href=#R-image-d68b4a4cf5f9939a4e09d616d6a87b7f class=lightbox-link><img alt=RUM-browser class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/browser.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d68b4a4cf5f9939a4e09d616d6a87b7f><img alt=RUM-browser class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/browser.png?classes=inline&height=25px"></a> Browser icon or the <strong>></strong> in front of the application name, which is <em>jmcj-store</em> in the example below. It also provides access to the <em>Application Overview</em> page if you click the link with your application name which is <em>jmcj-store</em> in the example below.</p><p>Further, you can also open the <em>Application Overview</em> or <em>App Health Dashboard</em> via the triple dot <a href=#R-image-3e033878fc2cdaf8dc4d117f6327b415 class=lightbox-link><img alt=trippleburger class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/trippleburger.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3e033878fc2cdaf8dc4d117f6327b415><img alt=trippleburger class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/trippleburger.png?classes=inline&height=25px"></a> menu on the right.</p><p><a href=#R-image-aad95d6dae1ccacd0e87c4dddc4eae82 class=lightbox-link><img alt=RUM-SummaryHeader class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/summaryHeader.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aad95d6dae1ccacd0e87c4dddc4eae82><img alt=RUM-SummaryHeader class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/summaryHeader.png></a></p><p>For now, let&rsquo;s look at the high level information we get on the application summary dashboard.</p><p>The RUM Application Summary Dashboard is focused on providing you with <em>at a glance</em> highlights of the status of your application.</p><h3 id=2-page-views--javascript-errors--network-requests--errors>2. Page Views / JavaScript Errors & Network Requests / Errors</h3><p>The first section shows <em>Page Views / JavaScript Errors</em>, & <em>Network Requests and Errors</em> charts show the quantity and trend of these issues in your application. This could be Javascript errors, or failed network calls to back end services.</p><p><a href=#R-image-bb5e8188dec9320951b83625def8dac3 class=lightbox-link><img alt=RUM-chart class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/Rum-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bb5e8188dec9320951b83625def8dac3><img alt=RUM-chart class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/Rum-chart.png></a></p><p>In the example above you can see that there are no failed network calls in the Network chart, but in the Page View chart you can see that a number of pages do experience some errors. These are often not visible for regular users, but can seriously impact the performance of your web site.</p><p>You can see the count of the Page Views / Network Requests / Errors by hovering over the charts.</p><p><a href=#R-image-97d4ef17299822b074f89f365faecef6 class=lightbox-link><img alt=RUM-chart-clicked class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-Chart-Clicked.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-97d4ef17299822b074f89f365faecef6><img alt=RUM-chart-clicked class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-Chart-Clicked.png></a></p><h3 id=3-javascript-errors>3. JavaScript Errors</h3><p>With the second section of the RUM Application Summary Dashboard we are showing you an overview of the JavaScript errors occurring in your application, along with a count of each error.</p><p><a href=#R-image-cf1eb66444d0bcc10fbbfd5d0ac3d102 class=lightbox-link><img alt=RUM-javascript class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-Javascripterrors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cf1eb66444d0bcc10fbbfd5d0ac3d102><img alt=RUM-javascript class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-Javascripterrors.png></a></p><p>In the example above you can see there are three JavaScript errors, one that appears 29 times in the selected time slot, and the other two each appear 12 times.</p><p>If you click on one of the errors a pop-out opens that will show a summary (below) of the errors over time, along with a Stack Trace of the JavaScript error, giving you an indication of where the problems occurred. (We will see this in more detail in one of the following sections)</p><p><a href=#R-image-8326ec3debd4ece9933d197b587093bd class=lightbox-link><img alt=RUM-javascript-chart class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/type-error-detail.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8326ec3debd4ece9933d197b587093bd><img alt=RUM-javascript-chart class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/type-error-detail.png></a></p><h3 id=4-web-vitals>4. Web Vitals</h3><p>The next section of the RUM Application Summary Dashboard is showing you <a href=https://web.dev/articles/vitals rel=external target=_blank>Google&rsquo;s Core Web Vitals</a>, three metrics that are not only used by Google in its search ranking system, but also quantify end user experience in terms of loading, interactivity, and visual stability.</p><p><a href=#R-image-81d14a28d66ed20edf05a00b082488a1 class=lightbox-link><img alt=WEB-vitals class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-QuickWebVitals.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-81d14a28d66ed20edf05a00b082488a1><img alt=WEB-vitals class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-QuickWebVitals.png></a></p><p>As you can see our site is well behaved and scores <em>Good</em> for all three Metrics. These metrics can be used to identify the effect changes to your application have, and help you improve the performance of your site.</p><p>If you click on any of the Metrics shown in the Web Vitals pane you will be taken to the corresponding Tag Spotlight Dashboard. e.g. clicking on the <strong>Largest Contentful Paint (LCP)</strong> chartlet, you will be taken to a dashboard similar to the screen shot below, that gives you timeline and table views for how this metric has performed. This should allow you to spot trends and identify where the problem may be more common, such as an operating system, geolocation, or browser version.</p><p><a href=#R-image-e9888ab6b54cba1f5947f0f7ef04cad4 class=lightbox-link><img alt=WEB-vitals-tag class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-Tag-Spotlight.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e9888ab6b54cba1f5947f0f7ef04cad4><img alt=WEB-vitals-tag class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-Tag-Spotlight.png></a></p><h3 id=5-most-recent-detectors>5. Most Recent Detectors</h3><p>The final section of the RUM Application Summary Dashboard is focused on providing you an overview of recent detectors that have triggered for your application. We have created a detector for this screen shot but your pane will be empty for now. We will add some detectors to your site and make sure they are triggered in one of the next sections.</p><p><a href=#R-image-5360a383b52fe78e668340c9ad154236 class=lightbox-link><img alt=detectors class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-detector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5360a383b52fe78e668340c9ad154236><img alt=detectors class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-detector.png></a></p><p>In the screen shot you can see we have a critical alert for the <em>RUM Aggregated View Detector</em>, and a Count, how often this alert has triggered in the selected time window. If you happen to have an alert listed, you can click on the name of the Alert (that is shown as a blue link) and you will be taken to the Alert Overview page showing the details of the alert (Note: this will move you away from the current page, Please use the <strong>Back</strong> option of your browser to return to the overview page).</p><p><a href=#R-image-39ea0175f50690676c1092f0d6cc2702 class=lightbox-link><img alt=alert class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/click-alert.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-39ea0175f50690676c1092f0d6cc2702><img alt=alert class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/click-alert.png></a></p><hr><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>Please take a few minutes to experiment with the RUM Application Summary Dashboard and the underlying chart and dashboards before going on to the next section.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=analyzing-rum-metrics>Analyzing RUM Metrics</h1><ul><li>See RUM Metrics and Session information in the RUM UI</li><li>See correlated APM traces in the RUM & APM UI</li></ul><hr><h2 id=1-rum-overview-pages>1. RUM Overview Pages</h2><p>From your RUM Application Summary Dashboard you can see detailed information by opening the Application Overview Page via the tripple dot <a href=#R-image-9710bb972dbef71543ccf13d547bd219 class=lightbox-link><img alt=trippleburger class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/trippleburger.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9710bb972dbef71543ccf13d547bd219><img alt=trippleburger class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/trippleburger.png?classes=inline&height=25px"></a> menu on the right by selecting <em>Open Application Overview</em> or by clicking the link with your application name which is <em>jmcj-rum-app</em> in the example below.</p><p><a href=#R-image-089efc5ac207eb632eb3dd29393f95c9 class=lightbox-link><img alt=RUM-SummaryHeader class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/summaryHeader.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-089efc5ac207eb632eb3dd29393f95c9><img alt=RUM-SummaryHeader class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/summaryHeader.png></a></p><p>This will take you to the RUM Application Overview Page screen as shown below.</p><p><a href=#R-image-611b91254034c590238058ad669e6599 class=lightbox-link><img alt="RUM app overview with UX metrics" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-ux-metrics.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-611b91254034c590238058ad669e6599><img alt="RUM app overview with UX metrics" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-ux-metrics.png></a></p><h2 id=2-rum-browser-overview>2. RUM Browser Overview</h2><h3 id=21-header>2.1. Header</h3><p>The RUM UI consists of five major sections. The first is the selection header, where you can set/filter a number of options:</p><ul><li>A drop down for the time window you&rsquo;re reviewing (You are looking at the past 15 minutes in this case)</li><li>A drop down to select the Comparison window (You are comparing current performance on a rolling window - in this case compared to 1 hour ago)</li><li>A drop down with the available Environments to view</li><li>A drop down list with the Various Web apps</li><li><em><strong>Optionally</strong></em> a drop down to select Browser or Mobile metrics (<em>Might not be available in your workshop</em>)</li></ul><p><a href=#R-image-ba55b06fdf4632c0b8f29d46dda5491b class=lightbox-link><img alt=RUM-Header class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-header.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ba55b06fdf4632c0b8f29d46dda5491b><img alt=RUM-Header class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-header.png></a></p><h3 id=22-ux-metrics>2.2. UX Metrics</h3><p>By default, RUM prioritizes the metrics that most directly reflect the experience of the end user.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Additional Tags</summary><div class=box-content><p>All of the dashboard charts allow us to compare trends over time, create detectors, and click through to further diagnose issues.</p></div></details><p>First, we see page load and route change information, which can help us understand if something unexpected is impacting user traffic trends.</p><p><a href=#R-image-d121c0cfd074048615348be5ae7ba273 class=lightbox-link><img alt="Page load and route change charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/page-load-route-change.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d121c0cfd074048615348be5ae7ba273><img alt="Page load and route change charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/page-load-route-change.png></a></p><p>Next, Google has defined Core Web Vitals to quantify the user experience as measured by loading, interactivity, and visual stability. Splunk RUM builds in Google&rsquo;s thresholds into the UI, so you can easily see if your metrics are in an acceptable range.</p><p><a href=#R-image-2d95bb01dee1d8da0b2b3d05c3521caa class=lightbox-link><img alt="Core Web Vitals charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/core-web-vitals-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2d95bb01dee1d8da0b2b3d05c3521caa><img alt="Core Web Vitals charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/core-web-vitals-overview.png></a></p><ul><li><strong>Largest Contentful Paint (LCP)</strong>, measures loading performance. How long does it take for the largest block of content in the viewport to load? To provide a good user experience, LCP should occur within 2.5 seconds of when the page first starts loading.</li><li><strong>First Input Delay (FID)</strong>, measures interactivity. How long does it take to be able to interact with the app? To provide a good user experience, pages should have a FID of 100 milliseconds or less.</li><li><strong>Cumulative Layout Shift (CLS)</strong>, measures visual stability. How much does the content move around after the initial load? To provide a good user experience, pages should maintain a CLS of 0.1. or less.</li></ul><p>Improving Web Vitals is a key component to optimizing your end user experience, so being able to quickly understand them and create detectors if they exceed a threshold is critical.</p><p>Google has some great resources if you want to learn more, for example <a href=https://web.dev/case-studies/vitals-business-impact rel=external target=_blank>the business impact of Core Web Vitals</a>.</p><h3 id=23-front-end-health>2.3. Front-end health</h3><p>Common causes of frontend issues are javascript errors and long tasks, which can especially affect interactivity. Creating detectors on these indicators helps us investigate interactivity issues sooner than our users report it, allowing us to build workarounds or roll back related releases faster if needed. Learn more about <a href=https://web.dev/articles/optimize-long-tasks rel=external target=_blank>optimizing long tasks</a> for better end user experience!</p><p><a href=#R-image-1aeaf8956eb5c75537c79e07015f7af6 class=lightbox-link><img alt="JS error charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-js-errors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1aeaf8956eb5c75537c79e07015f7af6><img alt="JS error charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-js-errors.png></a>
<a href=#R-image-5758641fd60bda742c1384b4c33c949c class=lightbox-link><img alt="Long task charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-long-tasks.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5758641fd60bda742c1384b4c33c949c><img alt="Long task charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-long-tasks.png></a></p><h3 id=24-back-end-health>2.4. Back-end health</h3><p>Common back-end issues affecting user experience are network issues and resource requests. In this example, we clearly see a spike in Time To First Byte that lines up with a resource request spike, so we already have a good starting place to investigate.</p><p><a href=#R-image-4475858d095d779669ef8e462db671b6 class=lightbox-link><img alt="Back-end health charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-be-health.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4475858d095d779669ef8e462db671b6><img alt="Back-end health charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-be-health.png></a></p><ul><li><strong>Time To First Byte (TTFB)</strong>, measures how long it takes for a client&rsquo;s browser to receive the first byte of the response from the server. The longer it takes for the server to process the request and send a response, the slower your visitors&rsquo; browser is at displaying your page.</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=analyzing-rum-tags-in-the-tag-spotlight-view>Analyzing RUM Tags in the Tag Spotlight view</h1><ul><li>Look into the Metrics views for the various endpoints and use the Tags sent via the Tag spotlight for deeper analysis</li></ul><hr><h2 id=1-find-an-url-for-the-cart-endpoint>1. Find an url for the Cart endpoint</h2><p>From the RUM Overview page, please select the url for the <strong>Cart</strong> endpoint to dive deeper into the information available for this endpoint.</p><p><a href=#R-image-4e86c79c9bead35d0eda9f710cb0b1a5 class=lightbox-link><img alt=RUM-Cart2 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-url-cart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4e86c79c9bead35d0eda9f710cb0b1a5><img alt=RUM-Cart2 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-url-cart.png></a></p><p>Once you have selected and clicked on the blue url, you will find yourself in the <strong>Tag Spotlight</strong> overview</p><p><a href=#R-image-0d3d0112127ef7daa87190563c57f7d2 class=lightbox-link><img alt=RUM-Tag class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-tag-spotlight.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0d3d0112127ef7daa87190563c57f7d2><img alt=RUM-Tag class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-tag-spotlight.png></a></p><p>Here you will see all of the tags that have been sent to Splunk RUM as part of the RUM traces. The tags displayed will be relevant to the overview that you have selected. These are generic Tags created automatically when the Trace was sent, and additional Tags you have added to the trace as part of the configuration of your website.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Additional Tags</summary><div class=box-content><p>We are already sending two additional tags, you have seen them defined in the <em>Beacon url</em> that was added to your website: <code>app: "[nodename]-store", environment: "[nodename]-workshop"</code> in the first section of this workshop! You can add additional tags in a similar way.</p></div></details><p>In our example we have selected the <strong>Page Load</strong> view as shown here:</p><p><a href=#R-image-f7f1b44acbcf5613c6b012cda1917a0c class=lightbox-link><img alt=RUM-Header class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-Selection.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f7f1b44acbcf5613c6b012cda1917a0c><img alt=RUM-Header class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-Selection.png></a></p><p>You can select any of the following Tag views, each focused on a specific metric.</p><p><a href=#R-image-0ad3fec969c022282e0fd64ef5df1c98 class=lightbox-link><img alt=RUM-views class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-Tag-views.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0ad3fec969c022282e0fd64ef5df1c98><img alt=RUM-views class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-Tag-views.png></a></p><hr><h2 id=2-explore-the-information-in-the-tag-spotlight-view>2. Explore the information in the Tag Spotlight view</h2><p>The Tag spotlight is designed to help you identify problems, either through the chart view,, where you may quickly identify outliers or via the TAGs.</p><p>In the <strong>Page Load</strong> view, if you look at the <strong>Browser</strong>, <strong>Browser Version</strong> & <strong>OS Name</strong> Tag views,you can see the various browser types and versions, as well as for the underlying OS.</p><p>This makes it easy to identify problems related to specific browser or OS versions, as they would be highlighted.</p><p><a href=#R-image-b079bcd43127a0160919a6a09e500aad class=lightbox-link><img alt=RUM-Tag2 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUMBrowserTags.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b079bcd43127a0160919a6a09e500aad><img alt=RUM-Tag2 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUMBrowserTags.png></a></p><p>In the above example you can see that Firefox had the slowest response, various Browser versions ( Chrome) that have different response times and the slow response of the Android devices.</p><p>A further example are the regional Tags that you can use to identify problems related to ISP or locations etc. Here you should be able to find the location you have been using to access the Online Boutique. Drill down by selecting the town or country you are accessing the Online Boutique from by clicking on the name as shown below (City of Amsterdam):</p><p><a href=#R-image-0a6dded2741c7c9e28dc0ce882d9cc71 class=lightbox-link><img alt=RUM-click class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-Region.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a6dded2741c7c9e28dc0ce882d9cc71><img alt=RUM-click class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-Region.png></a></p><p>This will select only the sessions relevant to the city selected as shown below:</p><p><a href=#R-image-38c27073bd1d0726b8922674cafba815 class=lightbox-link><img alt=RUM-Adam class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-Adam.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-38c27073bd1d0726b8922674cafba815><img alt=RUM-Adam class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-Adam.png></a></p><p>By selecting the various Tag you build up a filter, you can see the current selection below</p><p><a href=#R-image-1a3f4524ef136abb8b06ef608f345376 class=lightbox-link><img alt=RUM-Adam class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-Filter.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1a3f4524ef136abb8b06ef608f345376><img alt=RUM-Adam class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-Filter.png></a></p><p>To clear the filter and see every trace click on <strong>Clear All</strong> at the top right of the page.</p><p>If the overview page is empty or shows <a href=#R-image-05860e423e0842d3bf94b30e6d45705a class=lightbox-link><img alt=RUM-Adam class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/RUM-NoTime.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-05860e423e0842d3bf94b30e6d45705a><img alt=RUM-Adam class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/RUM-NoTime.png?classes=inline&height=25px"></a>, no traces have been received in the selected timeslot.
You need to increase the time window at the top left. You can start with the <em>Last 12 hours</em> for example.</p><p>You can then use your mouse to select the time slot you want like show in the view below and activate that time filter by clicking on the little spyglass icon.</p><p><a href=#R-image-2609f4323c0b7bb13d08349e93ad1454 class=lightbox-link><img alt=RUM-time class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/RUM-TimeSelect.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2609f4323c0b7bb13d08349e93ad1454><img alt=RUM-time class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/RUM-TimeSelect.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=analyzing-rum-sessions>Analyzing RUM Sessions</h1><ul><li>Dive into RUM Session information in the RUM UI</li><li>Identify Javascript errors in the Span of an user interaction</li></ul><hr><h2 id=1-drill-down-in-the-sessions>1. Drill down in the Sessions</h2><p>After you have analyzed the information and drilled down via the Tag Spotlight to a subset of the traces, you can view the actual session as it was run by the end-user&rsquo;s browser.</p><p>You do this by clicking on the link <strong>User Sessions</strong> as shown below:</p><p><a href=#R-image-5963f8ff1381f01ac1ef77e127bea273 class=lightbox-link><img alt=RUM-Header class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-sessions-link.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5963f8ff1381f01ac1ef77e127bea273><img alt=RUM-Header class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-sessions-link.png></a></p><p>This will give you a list of sessions that matched both the time filter and the subset selected in the Tag Profile.</p><p>Select one by clicking on the session ID, It is a good idea to select one that has the longest duration (preferably over 700 ms).</p><p><a href=#R-image-d6697379e0e4baa0e8d51a98d49cb4c5 class=lightbox-link><img alt=RUM-Header class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-session-list.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d6697379e0e4baa0e8d51a98d49cb4c5><img alt=RUM-Header class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-session-list.png></a></p><p>Once you have selected the session, you will be taken to the session details page. As you are selecting a specific action that is part of the session, you will likely arrive somewhere in the middle of the session, at the moment of the interaction.</p><p>You can see the URL that you selected earlier is where we are focusing on in the waterfall.</p><p><a href=#R-image-e3afbb81bf5fcfe85bbfa8ccc9b9d796 class=lightbox-link><img alt=RUM-Session-Tag class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/rum-session.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e3afbb81bf5fcfe85bbfa8ccc9b9d796><img alt=RUM-Session-Tag class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/rum-session.png></a></p><p>Scroll down a little bit on the page, so you see the end of the operation as shown below.</p><p><a href=#R-image-267ed28ab54408176acf5fcecaa9bd8d class=lightbox-link><img alt=RUM-Session-info class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/Session-Tag-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-267ed28ab54408176acf5fcecaa9bd8d><img alt=RUM-Session-info class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/Session-Tag-2.png></a></p><p>You can see that we have received a few Javascript Console errors that may not have been detected or visible to the end users. To examine these in more detail click on the middle one that says: *<strong>Cannot read properties of undefined (reading &lsquo;Prcie&rsquo;)</strong></p><p><a href=#R-image-af842417f9d17c8d005c2b54cb2627c8 class=lightbox-link><img alt=RUM-Session-info class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/Session-Tag-3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af842417f9d17c8d005c2b54cb2627c8><img alt=RUM-Session-info class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/Session-Tag-3.png></a></p><p>This will cause the page to expand and show the Span detail for this interaction, It will contain a detailed <em>error.stack</em> you can pass on the developer to solve the issue. You may have noticed when buying in the Online Boutique that the final total always was $0.00.</p><p><a href=#R-image-587fbcbeb5a6b4982f957fe5c87139bb class=lightbox-link><img alt=RUM-Session-info class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/Session-Tag-4.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-587fbcbeb5a6b4982f957fe5c87139bb><img alt=RUM-Session-info class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/Session-Tag-4.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=advanced-synthetics>Advanced Synthetics</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>30 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>This workshop walks you through using the <a href=https://developer.chrome.com/docs/devtools/recorder/ rel=external target=_blank>Chrome DevTools Recorder</a> to create a synthetic test on a Splunk demonstration environment or on your own public website.</p><p>The exported JSON from the Chrome DevTools Recorder will then be used to create a Splunk Synthetic Monitoring Real Browser Test.</p><h2 id=pre-requisites>Pre-requisites</h2><ul><li>Google Chrome Browser installed</li><li>Publicly browser-accessible URL</li><li>Access to Splunk Observability Cloud</li></ul><h2 id=supporting-resources>Supporting resources</h2><ol><li>Lantern: <a href=https://lantern.splunk.com/Observability/UCE/Proactive_response/Optimize_End-User_Experiences/Running_Synthetics_browser_tests/Selectors_for_multi-step_browser_tests rel=external target=_blank>advanced Selectors for multi-step browser tests</a></li><li>Chrome for Developers <a href=https://developer.chrome.com/blog/devtools-tips-4 rel=external target=_blank>DevTools Tips</a></li><li>web.dev <a href=https://web.dev/explore/learn-core-web-vitals rel=external target=_blank>Core Web Vitals</a> reference</li></ol><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Advanced Synthetics</h1><article class=default><header class=headline></header><h1 id=record-a-test>Record a test</h1><p>Write down a short user journey you want to test. Remember: smaller bites are easier to chew! In other words, get started with just a few steps. This is easier not only to create and maintain the test, but also to understand and act on the results. Test the essential features to your users, like a support contact form, login widget, or date picker.</p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>Record the test in the same type of viewport that you want to run it. For example, if you want to run a test on a mobile viewport, narrow your browser width to mobile and refresh before starting the recording. This way you are capturing the correct elements that could change depending on responsive style rules.</p></div></details><p>Open your starting URL in Chrome Incognito. This is important so you&rsquo;re not carrying cookies into the recording, which we won&rsquo;t set up in the Synthetic test by default. If you workshop instructor does not have a custom URL, feel free to use <a href=https://online-boutique-eu.splunko11y.com rel=external target=_blank>https://online-boutique-eu.splunko11y.com</a> or <a href=https://online-boutique-us.splunko11y.com rel=external target=_blank>https://online-boutique-us.splunko11y.com</a>, which are in the examples below.</p><h2 id=open-the-chrome-devtools-recorder>Open the Chrome DevTools Recorder</h2><p>Next, open the Developer Tools (in the new tab that was opened above) by pressing <code>Ctrl + Shift + I</code> on Windows or <code>Cmd + Option + I</code> on a Mac, then select <strong>Recorder</strong> from the top-level menu or the <strong>More tools</strong> flyout menu.</p><p><a href=#R-image-3aa384791c1018b10cd05afe8446137b class=lightbox-link><img alt="Open Recorder" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/open-recorder.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3aa384791c1018b10cd05afe8446137b><img alt="Open Recorder" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/open-recorder.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>Site elements might change depending on viewport width. Before recording, set your browser window to the correct width for the test you want to create (Desktop, Tablet, or Mobile). Change the DevTools &ldquo;dock side&rdquo; to pop out as a separate window if it helps.</p></div></details><h2 id=create-a-new-recording>Create a new recording</h2><p>With the Recorder panel open in the DevTools window. Click on the <span class="btn cstyle blue"><span><span class=title>Create a new recording</span></span></span> button to start.</p><p><a href=#R-image-4537002d68425baea8183a02a67a36ac class=lightbox-link><img alt=Recorder class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/recorder.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4537002d68425baea8183a02a67a36ac><img alt=Recorder class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/recorder.png></a></p><p>For the <strong>Recording Name</strong> use your initials to prefix the name of the recording e.g. <strong><code>&lt;your initials></code> - <code>&lt;website name></code></strong>. Click on <strong>Start Recording</strong> to start recording your actions.</p><p><a href=#R-image-5d62e9f8ea307f664dd9e0aec231ba12 class=lightbox-link><img alt="Recording Name" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/recording-name.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d62e9f8ea307f664dd9e0aec231ba12><img alt="Recording Name" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/recording-name.png></a></p><p>Now that we are recording, complete a few actions on the site. An example for our demo site is:</p><ul><li>Click on <strong>Vintage Camera Lens</strong></li><li>Click on <strong>Add to Cart</strong></li><li>Click on <strong>Place Order</strong></li><li>Click on <strong>End recording</strong> in the Recorder panel.</li></ul><p><a href=#R-image-f6b39354e32359959086a1568a8a983c class=lightbox-link><img alt="End Recording" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/end-recording.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f6b39354e32359959086a1568a8a983c><img alt="End Recording" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/end-recording.png></a></p><h2 id=export-the-recording>Export the recording</h2><p>Click on the <strong>Export</strong> button:</p><p><a href=#R-image-f2a4383f0f3968b024fc2cd99dbe3aba class=lightbox-link><img alt="Export button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/export-button.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f2a4383f0f3968b024fc2cd99dbe3aba><img alt="Export button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/export-button.png></a></p><p>Select <strong>JSON</strong> as the format, then click on <strong>Save</strong></p><p><a href=#R-image-c7c4fa6a4495ccaa7c2bdad608351afb class=lightbox-link><img alt="Export JSON" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/export-json.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c7c4fa6a4495ccaa7c2bdad608351afb><img alt="Export JSON" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/export-json.png></a></p><p><a href=#R-image-d0055a07b6555bb451a3661743c648e8 class=lightbox-link><img alt="Save JSON" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/save-json.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d0055a07b6555bb451a3661743c648e8><img alt="Save JSON" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/save-json.png></a></p><p><strong>Congratulations!</strong> You have successfully created a recording using the Chrome DevTools Recorder. Next, we will use this recording to create a Real Browser Test in Splunk Synthetic Monitoring.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
View the example JSON file for this browser test recording</summary><div class=box-content><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;RWC - Online Boutique&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;setViewport&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;width&#34;</span><span class=p>:</span> <span class=mi>1430</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;height&#34;</span><span class=p>:</span> <span class=mi>1016</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;deviceScaleFactor&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;isMobile&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;hasTouch&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;isLandscape&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;Online Boutique&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;div:nth-of-type(2) &gt; div:nth-of-type(2) a &gt; div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div/div/div[2]/div[2]/div/a/div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/div:nth-of-type(2) &gt; div:nth-of-type(2) a &gt; div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mi>170</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mi>180</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/product/66VCHSJNUP&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;aria/ADD TO CART&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div[1]/div/div[2]/div/form/div/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;text/Add to Cart&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mf>35.0078125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mf>46.4140625</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/cart&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;aria/PLACE ORDER&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;div &gt; div &gt; div.py-3 button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div/div/div[4]/div/form/div[4]/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/div &gt; div &gt; div.py-3 button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;text/Place order&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mf>29.8125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mf>66.8203125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/cart/checkout&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 10, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-a-browser-test>Create a Browser Test</h1><p>In Splunk Observability Cloud, navigate to <strong>Synthetics</strong> and click on <span class="btn cstyle blue"><span><span class=title>Add new test</span></span></span>.</p><p>From the dropdown select <strong>Browser test</strong>.</p><p><a href=#R-image-5f808314791a973f539c4346add586f8 class=lightbox-link><img alt="Add new test" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/create-browser.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5f808314791a973f539c4346add586f8><img alt="Add new test" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/create-browser.png></a></p><p>You will then be presented with the <strong>Browser test content</strong> configuration page.</p><p><a href=#R-image-f1977efb3c9e9c46e0302bf0381401aa class=lightbox-link><img alt="New Test" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/new-browser.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f1977efb3c9e9c46e0302bf0381401aa><img alt="New Test" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/new-browser.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=import-json>Import JSON</h1><p>To begin configuring our test, we need to import the JSON that we exported from the Chrome DevTools Recorder. To enable the <span class="btn cstyle transparent"><span><span class=title><strong>Import</strong></span></span></span> button, we must first give our test a name e.g. <strong>[<code>&lt;your team name></code>] <code>&lt;your initials></code> - Online Boutique</strong>.</p><p><a href=#R-image-15d87aafcdd89668743b7c2a43dc489e class=lightbox-link><img alt="Browser edit form" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-form.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-15d87aafcdd89668743b7c2a43dc489e><img alt="Browser edit form" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-form.png></a></p><p>Once the <span class="btn cstyle transparent"><span><span class=title><strong>Import</strong></span></span></span> button is enabled, click on it and either drop the JSON file that you exported from the Chrome DevTools Recorder or upload the file.</p><p><a href=#R-image-75544006434383be0dc90903b9740a32 class=lightbox-link><img alt="Import JSON" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-import.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-75544006434383be0dc90903b9740a32><img alt="Import JSON" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-import.png></a></p><p>Once the JSON file has been uploaded, click on <span class="btn cstyle blue"><span><span class=title>Continue to edit steps</span></span></span></p><p><a href=#R-image-1be1f1f8271178b3a087d43552dce196 class=lightbox-link><img alt="Import complete message" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-import-complete.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1be1f1f8271178b3a087d43552dce196><img alt="Import complete message" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-import-complete.png></a></p><p>Before we make any edits to the test, let&rsquo;s first configure the settings, click on <span class="btn cstyle blue"><span><span class=title>&lt; Return to test</span></span></span></p><p><a href=#R-image-3d7fea0b0b2b1f223c0e330039fcbee3 class=lightbox-link><img alt="Return to test button in the browser test editor" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-return.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3d7fea0b0b2b1f223c0e330039fcbee3><img alt="Return to test button in the browser test editor" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-return.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=test-settings>Test settings</h1><p>The simple settings allow you to configure the basics of the test:</p><ul><li><strong>Name</strong>: The name of the test (e.g. RWC - Online Boutique).</li><li><strong>Details</strong>:<ul><li><strong>Locations</strong>: The locations where the test will run from.</li><li><strong>Device</strong>: Emulate different devices and connection speeds. Also, the viewport will be adjusted to match the chosen device.</li><li><strong>Frequency</strong>: How often the test will run.</li><li><strong>Round-robin</strong>: If multiple locations are selected, the test will run from one location at a time, rather than all locations at once.</li><li><strong>Active</strong>: Set the test to active or inactive.</li></ul></li></ul><p>For this workshop, we will configure the locations that we wish to monitor from. Click in the <strong>Locations</strong> field and you will be presented with a list of global locations (over 50 in total).</p><p><a href=#R-image-f9f69e5f549a31d9db34b40a6ed40ea4 class=lightbox-link><img alt="Global Locations" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-loc-field.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f9f69e5f549a31d9db34b40a6ed40ea4><img alt="Global Locations" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-loc-field.png></a></p><p>Select the following locations:</p><ul><li><strong>AWS - N. Virginia</strong></li><li><strong>AWS - London</strong></li><li><strong>AWS - Melbourne</strong></li></ul><p>Once complete, scroll down and click on Click on <span class="btn cstyle blue"><span><span class=title>Submit</span></span></span> to save the test.</p><p>The test will now be scheduled to run every 5 minutes from the 3 locations that we have selected. This does take a few minutes for the schedule to be created.</p><p>So while we wait for the test to be scheduled, click on <span class="btn cstyle transparent"><span><span class=title>Edit test</span></span></span> so we can go through the Advanced settings.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=advanced-test-settings>Advanced Test Settings</h1><p>Click on <strong>Advanced</strong>, these settings are optional and can be used to further configure the test.</p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>In the case of this workshop, we will <strong>not</strong> be using any of these settings; this is for informational purposes only.</p></div></details><p><a href=#R-image-cdb45f67d8b5e1b7c45bbfd16fff2047 class=lightbox-link><img alt="Advanced Settings" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-advanced.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cdb45f67d8b5e1b7c45bbfd16fff2047><img alt="Advanced Settings" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-advanced.png></a></p><ul><li><strong>Security</strong>:<ul><li><strong>TLS/SSL validation</strong>: When activated, this feature is used to enforce the validation of expired, invalid hostname, or untrusted issuer on SSL/TLS certificates.</li><li><strong>Authentication</strong>: Add credentials to authenticate with sites that require additional security protocols, for example from within a corporate network. By using <a href=https://docs.splunk.com/Observability/synthetics/test-config/global-variables.html rel=external target=_blank>concealed global variables</a> in the Authentication field, you create an additional layer of security for your credentials and simplify the ability to share credentials across checks.</li></ul></li><li><strong>Custom Content</strong>:<ul><li><strong>Custom headers</strong>: Specify custom headers to send with each request. For example, you can add a header in your request to filter out requests from analytics on the back end by sending a specific header in the requests. You can also use custom headers to set cookies.</li><li><strong>Cookies</strong>: Set cookies in the browser before the test starts. For example, to prevent a popup modal from randomly appearing and interfering with your test, you can set cookies. Any cookies that are set will apply to the domain of the starting URL of the check. Splunk Synthetics Monitoring uses the public suffix list to determine the domain.</li><li><strong>Host overrides</strong>: Add host override rules to reroute requests from one host to another. For example, you can create a host override to test an existing production site against page resources loaded from a development site or a specific CDN edge node.</li></ul></li></ul><p>See the <a href=https://docs.splunk.com/observability/en/synthetics/browser-test/set-up-browser-test.html#advanced-settings-for-browser-tests rel=external target=_blank>Advanced Settings for Browser Tests</a> section of the Docs for more information.</p><p>Next, we will edit the test steps to provide more meaningful names for each step.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=edit-test-steps>Edit test steps</h1><p>To edit the steps click on the <span class="btn cstyle transparent"><span><span class=title>+ Edit steps or synthetic transactions</span></span></span> button. From here, we are going to give meaningful names to each step.</p><p>For each step, we are going to give them a meaningful, readable name. That could look like:</p><ul><li><strong>Step 1</strong> replace the text <strong>Go to URL</strong> with <strong>Go to Homepage</strong></li><li><strong>Step 2</strong> enter the text <strong>Select Typewriter</strong>.</li><li><strong>Step 3</strong> enter <strong>Add to Cart</strong>.</li><li><strong>Step 4</strong> enter <strong>Place Order</strong>.</li></ul><p><a href=#R-image-6867f745f6d2465b1a346264d492ca11 class=lightbox-link><img alt="Editing browser test step names" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-edit.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6867f745f6d2465b1a346264d492ca11><img alt="Editing browser test step names" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-edit.png></a></p><details open class="box cstyle notices note"><summary class=box-label><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>If you&rsquo;d like, group the test steps into <a href=https://docs.splunk.com/observability/en/synthetics/browser-test/set-up-transactional-browser-test.html#add-transactions rel=external target=_blank>Transactions</a> and edit the transaction names as seen above. This is especially useful for Single Page Apps (SPAs), where the resource waterfall is not split by URL. We can also create charts and alerts based on transactions.</p></div></details><p>Click <span class="btn cstyle blue"><span><span class=title>&lt; Return to test</span></span></span> to return to the test configuration page and click <span class="btn cstyle blue"><span><span class=title>Save</span></span></span> to save the test.</p><p>You will be returned to the test dashboard where you will see test results start to appear.</p><p><a href=#R-image-d2b88d99dcaa778d0c50d296b0335b10 class=lightbox-link><img alt="Browser KPIs chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-kpis.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d2b88d99dcaa778d0c50d296b0335b10><img alt="Browser KPIs chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-kpis.png></a></p><p><strong>Congratulations!</strong> You have successfully created a Real Browser Test in Splunk Synthetic Monitoring. Next, we will look into a test result in more detail.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=view-test-results>View test results</h1><p>1. Click into a spike or failure in your test run results.</p><p><a href=#R-image-7189afc2639af78cc24dedb6a2f007c0 class=lightbox-link><img alt="Spike in the browser test performance KPIs chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-spike.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7189afc2639af78cc24dedb6a2f007c0><img alt="Spike in the browser test performance KPIs chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-spike.png></a></p><p>2. What can you learn about this test run? If it failed, use the error message, filmstrip, video replay, and waterfall to understand what happened.</p><p><a href=#R-image-47c63906ca43617b8457026edb614a0f class=lightbox-link><img alt="Single test run result, with an error message and screenshots" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-fail-result.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-47c63906ca43617b8457026edb614a0f><img alt="Single test run result, with an error message and screenshots" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-fail-result.png></a></p><p>3. What do you see in the resources? Make sure to click through all of the page (or transaction) tabs.</p><p><a href=#R-image-8ac08ac2610140c7d9c3f2ca487345c8 class=lightbox-link><img alt="resources in the browser test waterfall, with a long request highlighted" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/browser-resources.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8ac08ac2610140c7d9c3f2ca487345c8><img alt="resources in the browser test waterfall, with a long request highlighted" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/browser-resources.png></a></p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Do you see anything interesting? Common issues to find and fix include: unexpected response codes, duplicate requests, forgotten third parties, large or slow files, and long gaps between requests.</p></div></details><p>Want to learn more about specific performance improvements? <a href=https://web.dev/learn/performance/welcome rel=external target=_blank>Google</a> and <a href=https://developer.mozilla.org/en-US/docs/Web/Performance/How_browsers_work rel=external target=_blank>Mozilla</a> have great resources to help understand what goes into frontend performance as well as in-depth details of how to optimize it.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=frontend-dashboards>Frontend Dashboards</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>Go to Dashboards and find the End User Experiences dashboard group.</p><p>Click the three dots on the top right to open the dashboard menu, and select Save As, and include your <strong>team name</strong> and <strong>initials</strong> in the dashboard name.</p><p>Save to the dashboard group that matches your email address. Now you have your own copy of this dashboard to customize!</p><p><a href=#R-image-a46f7d371a7b969e7e2fcdb52da3fd8d class=lightbox-link><img alt="Dashboard save as" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/dashboard-save-as.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a46f7d371a7b969e7e2fcdb52da3fd8d><img alt="Dashboard save as" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/dashboard-save-as.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 10, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Frontend Dashboards</h1><article class=default><header class=headline></header><h1 id=copying-and-editing-charts>Copying and editing charts</h1><p>We have some good charts in our dashboard, but let&rsquo;s add a few more.</p><ol><li><p>Go to Dashboards by clicking the dasboard icon on the left side of the screen. Find the <strong>Browser app health dashboard</strong> and scroll to the Largest Contentful Paint (LCP) chart. Click the chart actions icon to open the flyout menu, and click &ldquo;Copy&rdquo; to add this chart to your clipboard.
<a href=#R-image-f652b059e637c92b6354f59b1067ef84 class=lightbox-link><img alt="copy chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/60ea6b19-e024-415f-b3da-4f942f343ec3/user_cropped_screenshot.jpeg?tl_px=179,36&br_px=1899,998&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,311" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f652b059e637c92b6354f59b1067ef84><img alt="copy chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/60ea6b19-e024-415f-b3da-4f942f343ec3/user_cropped_screenshot.jpeg?tl_px=179,36&br_px=1899,998&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,311"></a></p></li><li><p>Now you can continue to add any other charts to your clipboard by clicking the &ldquo;add to clipboard&rdquo; icon.
<a href=#R-image-98061ee20b46c123f94c09521a8992e7 class=lightbox-link><img alt="copy chart inline icon" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/c05c55b9-0c3e-47fe-ac83-b945839c513c/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1540,764&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=723,126" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-98061ee20b46c123f94c09521a8992e7><img alt="copy chart inline icon" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/c05c55b9-0c3e-47fe-ac83-b945839c513c/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1540,764&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=723,126"></a></p></li><li><p>When you have collected the charts you want on your dashboard, click the &ldquo;create&rdquo; icon on the top right. You might need to reload the page if you were looking at charts in another browser tab.
<a href=#R-image-123a31093a1ca52f08ecd8884ea0bff6 class=lightbox-link><img alt="create icon" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/9cd17fba-a199-4e2c-9f2a-c692a611630d/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1388,750&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=969,17" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-123a31093a1ca52f08ecd8884ea0bff6><img alt="create icon" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/9cd17fba-a199-4e2c-9f2a-c692a611630d/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1388,750&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=969,17"></a></p></li><li><p>Click the &ldquo;Paste charts&rdquo; menu option.
<a href=#R-image-bcc85b098e66d7c5899f784bcd18e005 class=lightbox-link><img alt="paste charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/1abb0536-3a91-42e5-ae35-4db1311c7c71/ascreenshot.jpeg?tl_px=1160,476&br_px=2880,1437&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=842,276" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bcc85b098e66d7c5899f784bcd18e005><img alt="paste charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/1abb0536-3a91-42e5-ae35-4db1311c7c71/ascreenshot.jpeg?tl_px=1160,476&br_px=2880,1437&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=842,276"></a></p></li></ol><p>Now you are able to resize and edit the charts as you&rsquo;d like!</p><h2 id=bonus-edit-chart-data>Bonus: edit chart data</h2><ol><li><p>Click the chart actions icon and select Open to edit the chart.
<a href=#R-image-62be24dd728557d9e09a2d8101a66b39 class=lightbox-link><img alt="chart actions menu" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/653607e9-5a00-42b3-9fd8-37fe3f9ec6ad/ascreenshot.jpeg?tl_px=792,581&br_px=2512,1542&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,276" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-62be24dd728557d9e09a2d8101a66b39><img alt="chart actions menu" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/653607e9-5a00-42b3-9fd8-37fe3f9ec6ad/ascreenshot.jpeg?tl_px=792,581&br_px=2512,1542&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,276"></a></p></li><li><p>Remove the existing Test signal.
<a href=#R-image-19739d21408fd5b54d0aaabf3242ca7b class=lightbox-link><img alt="edit the test signal" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/df0ca0c4-bb5a-4348-a6d3-d0d29c5a2ec5/ascreenshot.jpeg?tl_px=0,775&br_px=1719,1736&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=454,277" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-19739d21408fd5b54d0aaabf3242ca7b><img alt="edit the test signal" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/df0ca0c4-bb5a-4348-a6d3-d0d29c5a2ec5/ascreenshot.jpeg?tl_px=0,775&br_px=1719,1736&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=454,277"></a></p></li><li><p>Click <span class="btn cstyle blue"><span><span class=title>Add filter</span></span></span> and type <code>test: *yourInitials*</code>. This will use a wildcard match so that all of the tests you have created that contain your initials (or any string you decide) will be pulled into the chart.
<a href=#R-image-8e917c37ac8c59c4cedccc40d7161a3b class=lightbox-link><img alt="add filter button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/14a6b9be-2e79-4c30-8a98-7e5f29570560/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1152,518&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=654,229" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8e917c37ac8c59c4cedccc40d7161a3b><img alt="add filter button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/14a6b9be-2e79-4c30-8a98-7e5f29570560/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1152,518&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=654,229"></a></p></li><li><p>Click into the functions to see how adding and removing dimensions changes how the data is displayed. For example, if you want all of your test location data rolled up, remove that dimension from the function.
<a href=#R-image-4966cf6eeffbf47d5b4962ec15c6aa5b class=lightbox-link><img alt="test signal functions" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/0e402434-a302-4df3-9c2d-9a9c16a01524/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1557,725&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=881,212" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4966cf6eeffbf47d5b4962ec15c6aa5b><img alt="test signal functions" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/0e402434-a302-4df3-9c2d-9a9c16a01524/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1557,725&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=881,212"></a></p></li><li><p>Change the chart name and description as appropriate, and click &ldquo;Save and close&rdquo; to commit your changes or just &ldquo;Close&rdquo; to cancel your changes.
<a href=#R-image-202f11e77845cf6cc50f748b09694bd3 class=lightbox-link><img alt="chart close buttons" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/02bc81af-cd81-4ac4-b1d1-f73cf7e62b99/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=999,644&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=682,162" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-202f11e77845cf6cc50f748b09694bd3><img alt="chart close buttons" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/02bc81af-cd81-4ac4-b1d1-f73cf7e62b99/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=999,644&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=682,162"></a></p></li></ol><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=events-in-context-with-chart-data>Events in context with chart data</h1><p>Seeing the visualization of our KPIs is great. What&rsquo;s better? KPIs in context with events! <a href=https://docs.splunk.com/observability/en/data-visualization/dashboards/dashboards-add.html#overlay-event-markers-on-charts-in-a-dashboard rel=external target=_blank>Overlaying events on a dashboard</a> can help us more quickly understand if an event like a deployment caused a change in metrics, for better or worse.</p><ol><li><p>Your instructor will push a condition change to the workshop application. Click the event marker on any of your dashboard charts to see more details.
<a href=#R-image-ac67ec22f05a322f13f1c79cbe60a88d class=lightbox-link><img alt="condition change event" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/d2dac271-0a85-46b9-b46d-e13e4e759f60/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1385,827&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=921,460" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ac67ec22f05a322f13f1c79cbe60a88d><img alt="condition change event" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/d2dac271-0a85-46b9-b46d-e13e4e759f60/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1385,827&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=921,460"></a></p></li><li><p>In the dimensions, we can see more details about this specific event. If we click the event record, we can mark for deletion if needed.
<a href=#R-image-0a21e547e5360e8a0547fa5c7b737933 class=lightbox-link><img alt="event record" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/55a9d0dc-5a44-496d-b44f-60f681b5576b/ascreenshot.jpeg?tl_px=692,626&br_px=2412,1587&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,277" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a21e547e5360e8a0547fa5c7b737933><img alt="event record" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/55a9d0dc-5a44-496d-b44f-60f681b5576b/ascreenshot.jpeg?tl_px=692,626&br_px=2412,1587&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,277"></a>
<a href=#R-image-c9e44c0f59878fc347a1282fb3b6e433 class=lightbox-link><img alt="event details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/ee20c9d9-9ea4-4302-af4a-73c8c24df029/user_cropped_screenshot.jpeg?tl_px=13,12&br_px=1733,974&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=832,324" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c9e44c0f59878fc347a1282fb3b6e433><img alt="event details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/ee20c9d9-9ea4-4302-af4a-73c8c24df029/user_cropped_screenshot.jpeg?tl_px=13,12&br_px=1733,974&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=832,324"></a></p></li><li><p>We can also see a history of events in the event feed by clicking the icon on the top right of the screen, and selecting Event feed.
<a href=#R-image-c14a265051da9d5aa7cb3ed41cc72b0e class=lightbox-link><img alt="event feed" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/7e7317f6-04b4-404e-8e17-78cf3e319ef9/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1471,785&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=1056,84" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c14a265051da9d5aa7cb3ed41cc72b0e><img alt="event feed" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/7e7317f6-04b4-404e-8e17-78cf3e319ef9/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1471,785&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=1056,84"></a></p></li><li><p>Again, we can see details about recent events in this feed.
<a href=#R-image-dec5d4b1b5a1a819ba48996c7b6336f9 class=lightbox-link><img alt="event details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/66c575d0-da25-4e4d-bd3b-78b6ce777ef4/user_cropped_screenshot.jpeg?tl_px=41,0&br_px=1760,877&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=815,346" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dec5d4b1b5a1a819ba48996c7b6336f9><img alt="event details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/66c575d0-da25-4e4d-bd3b-78b6ce777ef4/user_cropped_screenshot.jpeg?tl_px=41,0&br_px=1760,877&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=815,346"></a></p></li><li><p>We can also add new events in the GUI or <a href=https://dev.splunk.com/observability/reference/api/ingest_data/latest#endpoint-send-events rel=external target=_blank>via API</a>. To add a new event in the GUI, click the New event button.
<a href=#R-image-345a406233b7297868c69c7c027685a9 class=lightbox-link><img alt="GUI add event button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/f6707f30-af0e-4aa0-aa60-8272a601c0f7/user_cropped_screenshot.jpeg?tl_px=50,0&br_px=1770,852&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=895,179" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-345a406233b7297868c69c7c027685a9><img alt="GUI add event button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/f6707f30-af0e-4aa0-aa60-8272a601c0f7/user_cropped_screenshot.jpeg?tl_px=50,0&br_px=1770,852&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=895,179"></a></p></li><li><p>Name your event with your team name, initials, and what kind of event it is (deployment, campaign start, etc). Choose a timestamp, or leave as-is to use the current time, and click &ldquo;Create&rdquo;.
<a href=#R-image-fed65d32722ec6d361c7e837baab41eb class=lightbox-link><img alt="create event form" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/1280542f-4446-4b9d-8a46-d524e0319572/user_cropped_screenshot.jpeg?tl_px=0,125&br_px=1567,1087&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=858,513" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fed65d32722ec6d361c7e837baab41eb><img alt="create event form" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/1280542f-4446-4b9d-8a46-d524e0319572/user_cropped_screenshot.jpeg?tl_px=0,125&br_px=1567,1087&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=858,513"></a></p></li><li><p>Now, we need to make sure our new event is overlaid in this dashboard. Wait a minute or so (refresh the page if needed) and then search for the event in the Event overlay field.
<a href=#R-image-73a1cbd54ab346578857a928698a4291 class=lightbox-link><img alt="overlay event" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/ca2b0b08-a369-473d-ad32-3926bfca934c/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1601,810&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=408,229" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-73a1cbd54ab346578857a928698a4291><img alt="overlay event" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/ca2b0b08-a369-473d-ad32-3926bfca934c/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1601,810&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=408,229"></a></p></li><li><p>If your event is within the dashboard time window, you should now see it overlaid in your charts. Click &ldquo;Save&rdquo; to make sure your event overlay is saved to your dashboard!
<a href=#R-image-90cf4b55c65ed3e489b1b59aaeb93cb9 class=lightbox-link><img alt="save dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/21dc9ffa-4b33-46b1-81e2-6204924b7ec5/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1432,732&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=868,67" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-90cf4b55c65ed3e489b1b59aaeb93cb9><img alt="save dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-04-02/21dc9ffa-4b33-46b1-81e2-6204924b7ec5/user_cropped_screenshot.jpeg?tl_px=0,0&br_px=1432,732&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=868,67"></a></p></li></ol><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Keep in mind</summary><div class=box-content><p>Want to add context to that bug ticket, or show your manager how your change improved app performance? Seeing observability data in context with events not only helps with troubleshooting, but also helps us communicate with other teams.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=detectors>Detectors</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<p>After we have a good understanding of our performance baseline, we can start to create Detectors so that we receive alerts when our KPIs are unexpected. If we create detectors before understanding our baseline, we run the risk of generating unnecessary alert noise.</p><p>For RUM and Synthetics, we will explore how to create detectors:</p><ol><li>on a single Synthetic test</li><li>on a single KPI in RUM</li><li>on a dashboard chart</li></ol><p>For more Detector resources, please see our <a href=https://docs.splunk.com/observability/en/alerts-detectors-notifications/alerts-detectors-notifications.html rel=external target=_blank>Observability docs</a>, <a href="https://lantern.splunk.com/Special:Search?query=detector&type=wiki" rel=external target=_blank>Lantern</a>, and consider an <a href="https://education.splunk.com/Saba/Web_spf/NA10P2PRD105/guestapp/catalog/search?searchText=detector&selectedTab=LEARNINGEVENT" rel=external target=_blank>Education course</a> if you&rsquo;d like to go more in depth with instructor guidance.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Detectors</h1><article class=default><header class=headline></header><h1 id=test-detectors>Test Detectors</h1><p>Why would we want a <a href=https://docs.splunk.com/observability/en/synthetics/test-config/synth-alerts.html rel=external target=_blank>detector on a single Synthetic test</a>? Some examples:</p><ul><li>The endpoint, API transaction, or browser journey is highly critical</li><li>We have deployed code changes and want to know if the resulting KPI is or is not as we expect</li><li>We need to temporarily keep a close eye on a specific change we are testing and don&rsquo;t want to create a lot of noise, and will disable the detector later</li><li>We want to know about unexpected issues before a real user encounters them</li></ul><ol><li><p>On the test overview page, click <span class="btn cstyle transparent"><span><span class=title>Create Detector</span></span></span> on the top right.
<a href=#R-image-130a5c71fcf146a35719ad18fc39b791 class=lightbox-link><img alt="create detector on a single synthetic test" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-16/5ff84106-52ac-4519-8835-999446227709/user_cropped_screenshot.jpeg?tl_px=1144,0&br_px=2864,961&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=902,79" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-130a5c71fcf146a35719ad18fc39b791><img alt="create detector on a single synthetic test" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-16/5ff84106-52ac-4519-8835-999446227709/user_cropped_screenshot.jpeg?tl_px=1144,0&br_px=2864,961&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=902,79"></a></p></li><li><p>Name the detector with your <strong>team name</strong> and your <strong>initials</strong> and <strong>LCP</strong> (the signal we will eventually use), so that the instructor can better keep track of everyone&rsquo;s progress.</p></li><li><p>Change the signal to First byte time.
<a href=#R-image-f9ee5aa76410179f3b782088f2e9897a class=lightbox-link><img alt="change the signal" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-16/e443d816-7608-4073-905f-45f36d189665/ascreenshot.jpeg?tl_px=440,240&br_px=2160,1201&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,276" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f9ee5aa76410179f3b782088f2e9897a><img alt="change the signal" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-16/e443d816-7608-4073-905f-45f36d189665/ascreenshot.jpeg?tl_px=440,240&br_px=2160,1201&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,276"></a></p></li><li><p>Change the alert details, and see how the chart to the right shows the amount of alert events under those conditions. This is where you can decide how much alert noise you want to generate, based on how much your team tolerates. Play with the settings to see how they affect estimated alert noise.
<a href=#R-image-5d97361299fd600a8e4ac1f62d2f1d6f class=lightbox-link><img alt="alert noise preview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-16/35b475b5-4e66-498d-971a-06c5368bc0ce/ascreenshot.jpeg?tl_px=0,233&br_px=1719,1194&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=404,277" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d97361299fd600a8e4ac1f62d2f1d6f><img alt="alert noise preview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-16/35b475b5-4e66-498d-971a-06c5368bc0ce/ascreenshot.jpeg?tl_px=0,233&br_px=1719,1194&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=404,277"></a></p></li><li><p>Now, <strong>change the signal to Largest contentful paint</strong>. This is a key web vital related to the user experience as it relates to loading time. Change the threshold to <strong>2500ms</strong>. It&rsquo;s okay if there is no sample alert event in the detector preview.</p></li><li><p>Scroll down in this window to see the notification options, including severity and recipients.
<a href=#R-image-1877156a18ac3392d4f998ca7f7a14c2 class=lightbox-link><img alt="notification options" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/detector-notifications.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1877156a18ac3392d4f998ca7f7a14c2><img alt="notification options" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/detector-notifications.png></a></p></li><li><p>Click the notifications link to customize the alert subject, message, tip, and runbook link.
<a href=#R-image-1a3bea71836b9ed32d9c92fa25fd2ba8 class=lightbox-link><img alt="notification customization dialog" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/notification-custom.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1a3bea71836b9ed32d9c92fa25fd2ba8><img alt="notification customization dialog" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/notification-custom.png></a></p></li><li><p>When you are happy with the amount of alert noise this detector would generate, click Activate.
<a href=#R-image-cfecd4893de3c43582ee2e7a362e41bc class=lightbox-link><img alt="activate the detector" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-16/6a80893a-fffc-475b-a22c-98c89c239095/ascreenshot.jpeg?tl_px=0,838&br_px=1719,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=168,451" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cfecd4893de3c43582ee2e7a362e41bc><img alt="activate the detector" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-16/6a80893a-fffc-475b-a22c-98c89c239095/ascreenshot.jpeg?tl_px=0,838&br_px=1719,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=168,451"></a></p></li></ol><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=rum-detectors>RUM Detectors</h1><p>Let&rsquo;s say we want to know about an issue in production without waiting for a ticket from our support center. This is where <a href=https://docs.splunk.com/observability/en/rum/rum-alerts.html rel=external target=_blank>creating detectors in RUM</a> will be helpful for us.</p><ol><li><p>Go to the RUM overview of our App. Scroll to the LCP chart, click the chart menu icon, and click Create Detector.
<a href=#R-image-7592f3b3a196f74ee123a7b33086a6eb class=lightbox-link><img alt="RUM LCP chart with action menu flyout" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/rum-lcp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7592f3b3a196f74ee123a7b33086a6eb><img alt="RUM LCP chart with action menu flyout" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/rum-lcp.png></a></p></li><li><p>Rename the detector to include your <strong>team name</strong> and <strong>initials</strong>, and change the scope of the detector to App so we are not limited to a single URL or page. Change the threshold and sensitivity until there is at least one alert event in the time frame.
<a href=#R-image-2609e5ab99ae097ffaef3ee94c2bbd68 class=lightbox-link><img alt="RUM alert details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../_img/rum-detector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2609e5ab99ae097ffaef3ee94c2bbd68><img alt="RUM alert details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../_img/rum-detector.png></a></p></li><li><p>Change the alert severity and add a recipient if you&rsquo;d like, and click <span class="btn cstyle blue"><span><span class=title>Activate</span></span></span> to save the Detector.</p></li></ol><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>Now, your workshop instructor will change something on the website. How do you find out about the issue, and how do you investigate it?</p></div></details><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>Wait a few minutes, and take a look at the online store homepage in your browser. How is the experience in an incognito browser window? How is it different when you refresh the page?</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 8, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=chart-detectors>Chart Detectors</h1><p>With our custom dashboard charts, we can create detectors focussed directly on the data and conditions we care about. In building our charts, we also built signals that can trigger alerts.</p><h2 id=static-detectors>Static detectors</h2><p>For many KPIs, we have a static value in mind as a threshold.</p><ol><li><p>In your custom End User Experience dashboard, go to the &ldquo;LCP - all tests&rdquo; chart.</p></li><li><p>Click the bell icon on the top right of the chart, and select &ldquo;New detector from chart&rdquo;
<a href=#R-image-a16bdc65846b3828a48cd7f6ba52fed9 class=lightbox-link><img alt="new detector from chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/2e7a0adf-f4f7-4183-b7e9-08bbe7350232/ascreenshot.jpeg?tl_px=1160,297&br_px=2880,1258&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=886,277" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a16bdc65846b3828a48cd7f6ba52fed9><img alt="new detector from chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/2e7a0adf-f4f7-4183-b7e9-08bbe7350232/ascreenshot.jpeg?tl_px=1160,297&br_px=2880,1258&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=886,277"></a></p></li><li><p>Change the detector name to include your <strong>team name</strong> and <strong>initials</strong>, and adjust the alert details. Change the threshold to 2500 or 4000 and see how the alert noise preview changes.
<a href=#R-image-17380764c6d759563d4128385d208c89 class=lightbox-link><img alt="alert details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/4a6f44da-2559-49bf-8c5a-a58220c6e64d/ascreenshot.jpeg?tl_px=0,152&br_px=1719,1113&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=444,277" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-17380764c6d759563d4128385d208c89><img alt="alert details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/4a6f44da-2559-49bf-8c5a-a58220c6e64d/ascreenshot.jpeg?tl_px=0,152&br_px=1719,1113&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=444,277"></a></p></li><li><p>Change the severity, and add yourself as a recipient before you save this detector. Click <span class="btn cstyle blue"><span><span class=title>Activate</span></span></span>.
<a href=#R-image-8d2319c8e61b8be15df735dbfae45867 class=lightbox-link><img alt="activate the detector" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/1c2a7f23-c076-45e8-80b0-3a99e3989048/user_cropped_screenshot.jpeg?tl_px=0,652&br_px=1719,1614&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=216,453" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8d2319c8e61b8be15df735dbfae45867><img alt="activate the detector" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/1c2a7f23-c076-45e8-80b0-3a99e3989048/user_cropped_screenshot.jpeg?tl_px=0,652&br_px=1719,1614&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=216,453"></a></p></li></ol><h2 id=advanced-dynamic-detectors>Advanced: Dynamic detectors</h2><p>Sometimes we have metrics that vary naturally, so we want to create a more dynamic detector that isn&rsquo;t limited by the static threshold we decide in the moment.</p><ol><li><p>To create dynamic detectors on your chart, click the link to the &ldquo;old&rdquo; detector wizard.
<a href=#R-image-b719de3bbd3202e8b474184a3abbda2a class=lightbox-link><img alt="click the link to open this detector in the old editor" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/877e9402-3634-4b44-8585-fe27331674c6/user_cropped_screenshot.jpeg?tl_px=901,0&br_px=2621,961&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,109" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b719de3bbd3202e8b474184a3abbda2a><img alt="click the link to open this detector in the old editor" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/877e9402-3634-4b44-8585-fe27331674c6/user_cropped_screenshot.jpeg?tl_px=901,0&br_px=2621,961&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,109"></a></p></li><li><p>Change the detector name to include your <strong>team name</strong> and <strong>initials</strong>, and Click <span class="btn cstyle blue"><span><span class=title>Create alert rule</span></span></span>
<a href=#R-image-3a7dc691d290c1bbc18fce75533263d0 class=lightbox-link><img alt="name and create alert rule" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/fa9714b1-1fa0-47c4-9361-5753c0c5d4b4/ascreenshot.jpeg?tl_px=978,191&br_px=2698,1152&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,277" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3a7dc691d290c1bbc18fce75533263d0><img alt="name and create alert rule" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/fa9714b1-1fa0-47c4-9361-5753c0c5d4b4/ascreenshot.jpeg?tl_px=978,191&br_px=2698,1152&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,277"></a></p></li><li><p>Confirm the signal looks correct and proceed to Alert condition.
<a href=#R-image-6aa51814aae57e82f2d9633d7773cad0 class=lightbox-link><img alt="alert signal details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/d8dc6a69-f559-4399-b71d-583555266e35/ascreenshot.jpeg?tl_px=0,630&br_px=1719,1591&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=246,277" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6aa51814aae57e82f2d9633d7773cad0><img alt="alert signal details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/d8dc6a69-f559-4399-b71d-583555266e35/ascreenshot.jpeg?tl_px=0,630&br_px=1719,1591&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=246,277"></a></p></li><li><p>Select the &ldquo;Sudden Change&rdquo; condition and proceed to Alert settings
<a href=#R-image-68e0e0c5026930c38049dc55867ae0f2 class=lightbox-link><img alt="list of dynamic conditions" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/3a4e5b88-befc-4af8-8736-5f4a5529d0aa/ascreenshot.jpeg?tl_px=0,838&br_px=1719,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=486,340" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-68e0e0c5026930c38049dc55867ae0f2><img alt="list of dynamic conditions" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/3a4e5b88-befc-4af8-8736-5f4a5529d0aa/ascreenshot.jpeg?tl_px=0,838&br_px=1719,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=486,340"></a></p></li><li><p>Play with the settings and see how the estimated alert noise is previewed in the chart above. Tune the settings, and change the advanced settings if you&rsquo;d like, before proceeding to the Alert message.
<a href=#R-image-70e4734d5062d65b21c75dda1f1d378e class=lightbox-link><img alt="alert noise marked on chart based on settings" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/8a01627f-2287-494e-a2a3-20ff1592b641/ascreenshot.jpeg?tl_px=381,782&br_px=2101,1743&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,277" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-70e4734d5062d65b21c75dda1f1d378e><img alt="alert noise marked on chart based on settings" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/8a01627f-2287-494e-a2a3-20ff1592b641/ascreenshot.jpeg?tl_px=381,782&br_px=2101,1743&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,277"></a></p></li><li><p>Customize the severity, runbook URL, any tips, and message payload before proceeding to add recipients.
<a href=#R-image-7654da5d50b5bca503b49424a3a99c75 class=lightbox-link><img alt="alert message options" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/0af4f210-2202-4daf-9754-c8719867b388/ascreenshot.jpeg?tl_px=94,838&br_px=1813,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,485" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7654da5d50b5bca503b49424a3a99c75><img alt="alert message options" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/0af4f210-2202-4daf-9754-c8719867b388/ascreenshot.jpeg?tl_px=94,838&br_px=1813,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,485"></a></p></li><li><p>For the sake of this workshop, only add your own email address as recipient. This is where you would add other options like webhooks, ticketing systems, and Slack channels if it&rsquo;s in your real environment.
<a href=#R-image-22ce1f01e19417476c9c43aadf781b95 class=lightbox-link><img alt="recipient options" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/006bf87f-d5cb-4b17-9658-4f381aff9c9e/ascreenshot.jpeg?tl_px=87,838&br_px=1807,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,457" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-22ce1f01e19417476c9c43aadf781b95><img alt="recipient options" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/006bf87f-d5cb-4b17-9658-4f381aff9c9e/ascreenshot.jpeg?tl_px=87,838&br_px=1807,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=524,457"></a></p></li><li><p>Finally, confirm the detector name before clicking <span class="btn cstyle blue"><span><span class=title>Activate Alert Rule</span></span></span>
<a href=#R-image-ab7c6e3a493ec014020469aea53cd745 class=lightbox-link><img alt="activate alert rule button" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/146b3a5c-3c08-4fe8-a3fb-af44176963ca/ascreenshot.jpeg?tl_px=1160,838&br_px=2880,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=890,468" style=height:auto;width:1120></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ab7c6e3a493ec014020469aea53cd745><img alt="activate alert rule button" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="https://ajeuwbhvhr.cloudimg.io/colony-recorder.s3.amazonaws.com/files/2024-02-17/146b3a5c-3c08-4fe8-a3fb-af44176963ca/ascreenshot.jpeg?tl_px=1160,838&br_px=2880,1799&force_format=png&width=1120.0&wat=1&wat_opacity=0.7&wat_gravity=northwest&wat_url=https://colony-recorder.s3.us-west-1.amazonaws.com/images/watermarks/FB923C_standard.png&wat_pad=890,468"></a></p></li></ol><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=summary>Summary</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>In this workshop, we learned the following:</p><ul><li>How to create simple synthetic tests so that we can quickly begin to understand the availability and performance of our application</li><li>How to understand what RUM shows us about the end user experience, including specific user sessions</li><li>How to write advanced synthetic browser tests to proactively test our most important user actions</li><li>How to visualize our frontend performance data in context with events on dashboards</li><li>How to set up detectors so we don&rsquo;t have to wait to hear about issues from our end users</li><li>How all of the above, plus Splunk and Google&rsquo;s resources, helps us optimize end user experience</li></ul><p>There is a lot more we can do with front end performance monitoring. If you have extra time, be sure to play with the charts, detectors, and do some more synthetic testing. Remember our resources such as <a href=https://lantern.splunk.com/Observability/UCE/Optimized_experiences rel=external target=_blank>Lantern</a>, <a href=https://docs.splunk.com/observability/en/rum/intro-to-rum.html rel=external target=_blank>Splunk Docs</a>, and <a href=https://docs.splunk.com/observability/en/rum/sample-app.html rel=external target=_blank>experiment with apps for Mobile RUM</a>.</p><p>This is just the beginning! If you need more time to trial Splunk Observability, or have any other questions, <a href=https://www.splunk.com/en_us/about-splunk/contact-us.html rel=external target=_blank>reach out to a Splunk Expert</a>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 10, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=self-service-observability>Self-Service Observability</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>1 minute</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Bill Grant</span></span><p><strong>Splunk Observability Cloud</strong> includes powerful features that help central platform teams that are responsible for creating consistency, standards and best practices in an organization.</p><p>This workshop will go through some of the ways to apply standardization in your Observability practice.</p><p>We will cover:</p><ul><li>Collecting data with standards, and applying metadata at various points in the process</li><li>Managing costs, by reviewing metrics and applying metrics pipeline management to it</li><li>Configuring Observability-as-code, using terraform and api&rsquo;s</li></ul><p>We will use a variety of scripts to demonstrate these examples. Be sure to pick a unique name, so your data won&rsquo;t cross over with anyone else taking the workshop at the same time.</p><p>Let&rsquo;s get started!</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (◀️) and right (▶️) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 25, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Self-Service Observability</h1><article class=default><header class=headline></header><h1 id=background>Background</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;<h2 id=background>Background</h2><p>Let&rsquo;s review a few background concepts on <strong>Open Telemetry</strong> before jumping into the details.</p><p>First we have the <strong>Open Telemetry Collector</strong>, which lives on hosts or kubernetes nodes. These collectors can collect local information (like cpu, disk, memory, etc.). They can also collect metrics from other sources like prometheus (push or pull) or databases and other middleware.</p><p><a href=#R-image-6dfbfcf41a9f4a86a7165efa60a12b95 class=lightbox-link><img alt="OTel Diagram" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../images/otel-diagram.svg?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6dfbfcf41a9f4a86a7165efa60a12b95><img alt="OTel Diagram" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../images/otel-diagram.svg?width=60vw"></a>
Source: <a href=https://opentelemetry.io/docs/ rel=external target=_blank>OTel Documentation</a></p><p>The way the <strong>OTel Collector</strong> collects and sends data is using <strong>pipelines</strong>. Pipelines are made up of:</p><ul><li><strong>Receivers</strong>: Collect telemetry from one or more sources; they are pull- or push-based.</li><li><strong>Processors</strong>: Take data from receivers and modify or transform them. Unlike receivers and exporters, processors process data in a specific order.</li><li><strong>Exporters</strong>: Send data to one or more observability backends or other destinations.</li></ul><p><a href=#R-image-c373d8021c86c39541c2bc172d71676a class=lightbox-link><img alt="OTel Diagram" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../images/otel-collector-details.svg?width=60vw" style=height:auto;width:60vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c373d8021c86c39541c2bc172d71676a><img alt="OTel Diagram" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../images/otel-collector-details.svg?width=60vw"></a>
Source: <a href=https://opentelemetry.io/docs/collector/ rel=external target=_blank>OTel Documentation</a></p><p>The final piece is applications which are instrumented; they will send traces (spans), metrics, and logs.</p><p>By default the instrumentation is designed to send data to the local collector (on the host or kubernetes node). This is desirable because we can then add metadata on it &ndash; like which pod or which node/host the application is running on.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 10, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=collect-data-with-standards>Collect Data with Standards</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>For this workshop, we&rsquo;ll be doing things that only a central tools or administration would do.</p><p>The workshop uses scripts to help with steps that aren&rsquo;t part of the focus of this workshop &ndash; like how to change a kubernetes app, or start an application from a host.</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>It can be useful to review what the scripts are doing.</p><p>So along the way it is advised to run <code>cat &lt;filename></code> from time to time to see what that step just did.</p><p>The workshop won&rsquo;t call this out, so do it when you are curious.</p></div></details><p>We&rsquo;ll also be running some scripts to simulate data that we want to deal with.</p><p>A simplified version of the architecture (leaving aside the specifics of kubernetes) will look something like the following:</p><p><a href=#R-image-b82149f98bcac16e038de28fb05a8fa6 class=lightbox-link><img alt=Architecture class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/scenarios/self_service_observability/2-collect_with_standards/images/arch.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b82149f98bcac16e038de28fb05a8fa6><img alt=Architecture class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/scenarios/self_service_observability/2-collect_with_standards/images/arch.png></a></p><ul><li>The <strong>App</strong> sends metrics and traces to the <strong>Otel Collector</strong></li><li>The <strong>Otel Collector</strong> also collects metrics of its own</li><li>The <strong>Otel Collector</strong> adds metadata to its own metrics and data that passes through it</li><li>The <strong>OTel Gateway</strong> offers another opportunity to add metadata</li></ul><p>Let&rsquo;s start by deploying the gateway.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 12, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2 Collect Data with Standards</h1><article class=default><header class=headline></header><h1 id=deploy-gateway>Deploy Gateway</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=gateway>Gateway</h2><p>First we will deploy the <strong>OTel Gateway</strong>. The workshop instructor will deploy the gateway, but we will walk through the steps here if you wish to try this yourself on a second instance.</p><p>The steps:</p><ul><li>Click the <strong>Data Management</strong> icon in the toolbar</li><li>Click the <strong>+ Add integration</strong> button</li><li>Click <strong>Deploy the Splunk OpenTelemetry Collector</strong> button</li><li>Click <strong>Next</strong></li><li>Select <strong>Linux</strong></li><li>Change mode to <strong>Data forwarding (gateway)</strong></li><li>Set the environment to <strong>prod</strong></li><li>Choose the access token for this workshop</li><li>Click <strong>Next</strong></li><li>Copy the installer script and run it in the provided linux environment.</li></ul><p>Once our gateway is started we will notice&mldr; <strong>Nothing</strong>. The gateway, by default, doesn&rsquo;t send any data. It can be configured to send data, but it doesn&rsquo;t by default.</p><p>We can review the config file with:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo cat /etc/otel/collector/splunk-otel-collector.conf</span></span></code></pre></div><p>And see that the config being used is <code>gateway_config.yaml</code>.</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>Diagrams created with <strong><a href=https://www.otelbin.io/ rel=external target=_blank>otelbin.io</a></strong>. Click on them to see them in detail.</p></div></details><table><thead><tr><th style=text-align:left>Diagram</th><th style=text-align:left>What it Tells Us</th></tr></thead><tbody><tr><td style=text-align:left><a href=#R-image-5d356305bf37afac582364a93ef24e6b class=lightbox-link><img alt="metrics Config" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/metrics.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d356305bf37afac582364a93ef24e6b><img alt="metrics Config" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/metrics.png></a></td><td style=text-align:left><strong>Metrics</strong>:<br>The gateway will receive metrics over <strong>otlp</strong> or <strong>signalfx</strong> protocols, and then send these metrics to <strong>Splunk Observability Cloud</strong> with the <strong>signalfx</strong> protocol.<br><br>There is also a pipeline for <strong>prometheus metrics</strong> to be sent to Splunk. That pipeline is labeled <strong>internal</strong> and is meant to be for the collector. (In other words if we want to receive prometheus directly we should add it to the main pipeline.)</td></tr><tr><td style=text-align:left><a href=#R-image-3afb0529cec1c114081ca2f57250fd85 class=lightbox-link><img alt="traces Config" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/traces.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3afb0529cec1c114081ca2f57250fd85><img alt="traces Config" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/traces.png></a></td><td style=text-align:left><strong>Traces</strong>:<br>The gateway will receive traces over <strong>jaeger</strong>, <strong>otlp</strong>, <strong>sapm</strong>, or <strong>zipkin</strong> and then send these traces to <strong>Splunk Observability Cloud</strong> with the <strong>sapm</strong> protocol.</td></tr><tr><td style=text-align:left><a href=#R-image-d63f6ff90c7ac3b698fc103c2e687dc8 class=lightbox-link><img alt="logs Config" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d63f6ff90c7ac3b698fc103c2e687dc8><img alt="logs Config" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/logs.png></a></td><td style=text-align:left><strong>Logs</strong>:<br>The gateway will receive logs over <strong>otlp</strong> and then send these logs to 2 places: <strong>Splunk Enterprise (Cloud)</strong> (for logs) and <strong>Splunk Observability Cloud</strong> (for profiling data).<br><br>There is also a pipeline labeled <strong>signalfx</strong> that is sending <strong>signalfx</strong> to <strong>Splunk Observability Cloud</strong>; these are events that can be used to add events to charts, as well as the process list.</td></tr></tbody></table><p>We&rsquo;re not going to see any host metrics, and we aren&rsquo;t send any other data through the gateway yet. But we do have the <strong>internal</strong> metrics being sent in.</p><p>You can find it by creating a new chart and adding a metric:</p><ul><li>Click the <strong>+</strong> in the top-right</li><li>Click <strong>Chart</strong></li><li>For the signal of Plot A, type <code>otelcol_process_uptime</code></li><li>Add a filter with the + to the right, and type: <code>host.id:&lt;name of instance></code></li></ul><p>You should get a chart like the following:
<a href=#R-image-750401a9347154fbad49c0376e8271c4 class=lightbox-link><img alt="Chart of gateway" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/gateway_metric_chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-750401a9347154fbad49c0376e8271c4><img alt="Chart of gateway" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/gateway_metric_chart.png></a></p><p>You can look at the <strong>Metric Finder</strong> to find other internal metrics to explore.</p><h2 id=add-metadata>Add Metadata</h2><p>Before we deploy a collector (agent) let&rsquo;s add some metada onto metrics and traces with the gateway. That&rsquo;s how we will know data is passing through it.</p><p>The <a href=https://docs.splunk.com/observability/en/gdi/opentelemetry/components/attributes-processor.html rel=external target=_blank>attributes processor</a> let&rsquo;s us add some metadata.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otel/collector/agent_config.yaml</span></span></code></pre></div><p>Here&rsquo;s what we want to add to the processors section:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/gateway_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>gateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>oac</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span></span></span></code></pre></div><p>And then to the pipelines (adding <code>attributes/gateway_config</code> to each):</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>jaeger, otlp, smartagent/signalfx-forwarder, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>attributes/gateway_config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- resource/add_environment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>sapm, signalfx]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Use instead when sending to gateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#exporters: [otlp, signalfx]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, signalfx, smartagent/signalfx-forwarder]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>memory_limiter, batch, resourcedetection, attributes/gateway_config]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>signalfx]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Use instead when sending to gateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#exporters: [otlp]</span></span></span></code></pre></div><p>And finally we need to restart the gateway:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart splunk-otel-collector.service</span></span></code></pre></div><p>We can make sure it is still running fine by checking the status:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl status splunk-otel-collector.service </span></span></code></pre></div><h2 id=next>Next</h2><p>Next, let&rsquo;s deploy a collector and then configure it to this gateway.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-collector-agent>Deploy Collector (Agent)</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=collector-agent>Collector (Agent)</h2><p>Now we will deploy a collector. At first this will be configured to go directly to the back-end, but we will change the configuration and restart the collector to use the gateway.</p><p>The steps:</p><ul><li>Click the <strong>Data Management</strong> icon in the toolbar</li><li>Click the <strong>+ Add integration</strong> button</li><li>Click <strong>Deploy the Splunk OpenTelemetry Collector</strong> button</li><li>Click <strong>Next</strong></li><li>Select <strong>Linux</strong></li><li>Leave the mode as <strong>Host monitoring (agent)</strong></li><li>Set the environment to <strong>prod</strong></li><li>Leave the rest as defaults</li><li>Choose the access token for this workshop</li><li>Click <strong>Next</strong></li><li>Copy the installer script and run it in the provided linux environment.</li></ul><p>This collector is sending host metrics, so you can find it in common navigators:</p><ul><li>Click the <strong>Infrastructure</strong> icon in the toolbar</li><li>Click the <strong>EC2</strong> panel under <strong>Amazon Web Services</strong></li><li>The <code>AWSUniqueId</code> is the easiest thing to find; add a filter and look for it with a wildcard (i.e. <code>i-0ba6575181cb05226*</code>)</li></ul><p><a href=#R-image-e4966947ecef3514fe80f5b2fe49ba79 class=lightbox-link><img alt="Chart of agent" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/collector_agent_chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e4966947ecef3514fe80f5b2fe49ba79><img alt="Chart of agent" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/collector_agent_chart.png></a></p><p>We can also simply look at the <code>cpu.utilization</code> metric. Create a new chart to display it, filtered on the AWSUniqueId:</p><p><a href=#R-image-f9e79705461fd5cfa9a2f089da0cc200 class=lightbox-link><img alt="Chart 2 of agent" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/collector_agent_chart_2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f9e79705461fd5cfa9a2f089da0cc200><img alt="Chart 2 of agent" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/collector_agent_chart_2.png></a></p><p>The reason we wanted to do that is so we can easily see the new dimension added on once we send the collector through the gateway. You can click on the <strong>Data table</strong> to see the dimensions currently being sent:</p><p><a href=#R-image-f64d7a47ce4bde2877f1e7e9574cb083 class=lightbox-link><img alt="Data Table" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/collector_agent_data_table.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f64d7a47ce4bde2877f1e7e9574cb083><img alt="Data Table" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/collector_agent_data_table.png></a></p><h2 id=next>Next</h2><p>Next we&rsquo;ll reconfigure the collector to send to the gateway.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 10, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=reconfigure-collector>Reconfigure Collector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=reconfigure-collector>Reconfigure Collector</h2><p>To reconfigure the collector we need to make these changes:</p><ul><li>In <code>agent_config.yaml</code><ul><li>We need to adjust the <strong>signalfx</strong> exporter to use the gateway</li><li>The <strong>otlp</strong> exporter is already there, so we leave it alone</li><li>We need to change the pipelines to use <strong>otlp</strong></li></ul></li><li>In <code>splunk-otel-collector.conf</code><ul><li>We need to set the <code>SPLUNK_GATEWAY_URL</code> to the url provided by the instructor</li></ul></li></ul><p>See this <a href=https://docs.splunk.com/observability/en/gdi/opentelemetry/deployment-modes.html#agent-configuration rel=external target=_blank>docs page</a> for more details.</p><p>The exporters will be the following:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Metrics + Events</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>signalfx</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>access_token</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;${SPLUNK_ACCESS_TOKEN}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#api_url: &#34;${SPLUNK_API_URL}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#ingest_url: &#34;${SPLUNK_INGEST_URL}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># Use instead when sending to gateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>api_url</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://${SPLUNK_GATEWAY_URL}:6060&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ingest_url</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://${SPLUNK_GATEWAY_URL}:9943&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>sync_host_metadata</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>correlation</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Send to gateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;${SPLUNK_GATEWAY_URL}:4317&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>tls</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>insecure</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div><p>The others you can leave as they are but they won&rsquo;t be used, as you will see in the pipelines.</p><p>The pipeline changes (you can see the items commented out and uncommented out):</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>jaeger, otlp, smartagent/signalfx-forwarder, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- resource/add_environment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#exporters: [sapm, signalfx]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Use instead when sending to gateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, signalfx]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, signalfx, smartagent/signalfx-forwarder]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>memory_limiter, batch, resourcedetection]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#exporters: [signalfx]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Use instead when sending to gateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>memory_limiter, batch, resourcedetection]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># When sending to gateway, at least one metrics pipeline needs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># to use signalfx exporter so host metadata gets emitted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>signalfx]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs/signalfx</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>signalfx, smartagent/processlist]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>memory_limiter, batch, resourcedetection]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>signalfx]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>fluentforward, otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- resource/add_environment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#exporters: [splunk_hec, splunk_hec/profiling]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Use instead when sending to gateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span></span></span></code></pre></div><p>And finally we can add the <code>SPLUNK_GATEWAY_URL</code> in <code>splunk-otel-collector.conf</code>, for example:</p><div class="highlight wrap-code"><pre tabindex=0><code class=language-conf data-lang=conf>SPLUNK_GATEWAY_URL=gateway.splunk011y.com</code></pre></div><p>Then we can restart the collector:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart splunk-otel-collector.service</span></span></code></pre></div><p>And check the status:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl status splunk-otel-collector.service</span></span></code></pre></div><p>And finally see the new dimension on the metrics:
<a href=#R-image-c35db511e2eab541a0f3cd71b1175368 class=lightbox-link><img alt="New Dimension" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/gateway_dimension.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c35db511e2eab541a0f3cd71b1175368><img alt="New Dimension" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/gateway_dimension.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 10, 2024</span></span></footer></article></section></section></section><article class=default><header class=headline></header><h1 id=resources>Resources</h1><div class="children children-h3 children-sort-"><h3><a href=/observability-workshop/v5.76/en/resources/dimensions_properties_tags/index.html>Dimension, Properties and Tags</a></h3><p>One conversation that frequently comes up is Dimensions vs Properties and when you should use one verus the other.</p><h3><a href=/observability-workshop/v5.76/en/resources/otel_tagging/index.html>OpenTelemetry Tagging</a></h3><p>When deploying OpenTelemetry in a large organization, it’s critical to define a standardized naming convention for tagging, and a governance process to ensure the convention is adhered to.</p><h3><a href=/observability-workshop/v5.76/en/resources/local-hosting/index.html>Local Hosting</a></h3><p>Resources for setting up a locally hosted workshop environment.</p></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Resources</h1><article class=default><header class=headline></header><h1 id=dimension-properties-and-tags>Dimension, Properties and Tags</h1><h2 id=applying-context-to-your-metrics>Applying context to your metrics</h2><p>One conversation that frequently comes up is Dimensions vs Properties and when you should use one verus the other. Instead of starting off with their descriptions it makes sense to understand how we use them and how they are similar, before diving into their differences and examples of why you would use one or the other.</p><h2 id=how-are-dimensions-and-properties-similar>How are Dimensions and Properties similar?</h2><p>The simplest answer is that they are both metadata <code>key:value</code> pairs that add context to our metrics. Metrics themselves are what we actually want to measure, whether it’s a standard infrastructure metric like​ ​<code>cpu.utilization</code> or a custom metric like number of API calls received.</p><p>If we receive a value of 50% for th​e ​<code>cpu.utilization</code> metric without knowing where it came from or any other context it is just a number and not useful to us. We would need at least to know what host it comes from.</p><p>These days it is likely we care more about the performance or utilization of a cluster or data center as a whole then that of an individual host and therefore more interested in things like the average <code>cpu.utilization</code> across a cluster of hosts, when a​ host’s <code>​cpu.utilization</code> is a outlier when compared to other hosts running the same service or maybe compare the ​average ​<code>cpu.utilization</code> of one environment to another.</p><p>To be able to slice, aggregate or g​roup our ​<code>cpu.utilization</code> metrics in this way we will need additional metad​ata for the <code>​cpu.utilization</code> metrics we receive to include what cluster a host belongs to, what service is running on the host and what environment it is a part of. This metadata can be in the form of either dimension or property <code>key:value</code> pairs.</p><p>For example, if I go to apply a filter to a dashboard or use the Group by function when running analytics, I can use a property or a dimension.</p><h2 id=so-how-are-dimensions-and-properties-different>So how are Dimensions and Properties different?</h2><p>Dimensions are sent in with metrics at the time of ingest while properties are applied to metrics or dimensions after ingest. This means that any metadata you need to make a datapoint (​a single reported value of a metric) ​unique, like what host a value of <code>cpu.utilization</code> is coming from needs to be a dimension. Metric names + dimensions uniquely define an MTS (metric time series).</p><p>Example: the <code>​cpu.utilization</code> metric sent by a particular host (​server1) with a dimension <code>​host:server1</code> would be considered a unique time series. If you have 10 servers, each sending that metric, then you would have 10 time series, with each time series sharing the metric name <code>​cpu.utilization</code> and uniquely identified by the dimension key-value pair (​host:server1, host:server2&mldr;host:server10).</p><p>However, if your server names are only unique within a datacenter vs your whole environment you would need to add a 2n​d​ dimension <code>dc</code> for the datacenter location. You could now have double the number of possible MTSs. cpu.utilization metrics received would now be uniquely identified by 2 sets of dimension key-value pairs.</p><p>cpu.utilization plus ​dc:east &​ host:server1 would create a different time series then ​cpu.utilization plus dc:west & ​host:server1.</p><h2 id=dimensions-are-immutable-while-properties-are-mutable>Dimensions are immutable while properties are mutable</h2><p>As we mentioned above, Metric name + dimensions make a unique MTS. Therefore, if the dimension value changes we will have a new unique combination of metric name + dimension value and create a new MTS.</p><p>Properties on the other hand are applied to metrics (or dimensions) after they are ingested. If you apply a property to a metric, it propagates and applies to all MTS that the metric is a part of. Or if you apply a property to a dimension, say ​host:server1 then all metrics from that host will have those properties attached. If you change the value of a property it will propagate and update the value of the property to all MTSs with that property attached. Why is this important? It means that if you care about the historical value of a property you need to make it a dimension.</p><p>Example: We are collecting custom metrics on our application. One metric is ​latency which counts the latency of requests made to our application. We have a dimension ​customer, so we can sort and compare latency by customer. We decide we want to track the ​application version as well so we can sort and compare our application ​latency by the version customers are using. We create a property ​version that we attach to the customer dimension. Initially all customers are using application version 1, so ​version:1.</p><p>We now have some customers using version 2 of our application, for those customers we update the property to ​version:2. When we update the value of the ​version property for those customers it will propagate down to all MTS for that customer. We lose the history that those customers at some point used ​version 1, so if we wanted to compare ​latency of ​version 1 and ​version 2 over a historical period we would not get accurate data. In this case even though we don’t need application ​version to make out metric time series unique we need to make ​version a dimension, because we care about the historical value.</p><h2 id=so-when-should-something-be-a-property-instead-of-a-dimension>So when should something be a Property instead of a dimension?</h2><p>The first reason would be if there is any metadata you want attached to metrics, but you don’t know it at the time of ingest.
The second reason is best practice is if it doesn’t need to be a dimension, make it a property. Why?
One reason is that today there is a limit of 5K MTSs per analytics job or chart rendering and the more dimensions you have the more MTS you will create. Properties are completely free-form and let you add as much information as you want or need to metrics or dimensions without adding to MTS counts.</p><p>As dimensions are sent in with every datapoint, the more dimensions you have the more data you send to us, which could mean higher costs to you if your cloud provider charges for data transfer.</p><p>A good example of some things that should be properties would be additional host information. You want to be able to see things like machine_type, processor, or os, but instead of making these things dimensions and sending them with every metric from a host you could make them properties and attach the properties to the host dimension.</p><p>Example where ​host:server1 you would set properties ​machine_type:ucs, processor:xeon-5560, os:rhel71. Anytime a metric comes in with the dimension ​host:server1 all the above properties will be applied to it automatically.</p><p>Some other examples of use cases for properties would be if you want to know who is the escalation contact for each service or SLA level for every customer. You do not need these items to make metrics uniquely identifiable and you don’t care about the historical values, so they can be properties. The properties could be added to the service dimension and customer dimensions and would then apply to all metrics and MTSs with those dimensions.</p><h2 id=what-about-tags>What about Tags?</h2><p>Tags are the 3r​d​ type of metadata that can be used to give context to or help organize your metrics. Unlike dimensions and properties, tags are NOT key:value pairs. ​Tags can be thought of as labels or keywords. Similar to Properties, Tags are applied to your data after ingest via the Catalog in the UI or programmatically via the API.​ Tags can be applied to Metrics, Dimensions or other objects such as Detectors.</p><h2 id=where-would-i-use-tags>Where would I use Tags?</h2><p>Tags are used when there is a need for a many-to-one relationship of tags to an object or a one-to-many relationship between the tag and the objects you are applying them to. They are useful for grouping together metrics that may not be intrinsically associated.</p><p>One example is you have hosts that run multiple applications. You can create tags (labels) for each application and then apply multiple tags to each host to label the applications that are running on it.</p><p>Example: Server1 runs 3 applications. You create tags ​app1, app2 and app3 and apply all 3 tags to the dimension ​host:server1</p><p>To expand on the example above let us say you also collect metrics from your applications.​ You could apply the tags you created to any metrics coming in from the applications themselves. You can filter based on a tag allowing you to filter based on an application, but get the full picture including both application and the relevant host metrics.</p><p>Example: App1 sends in metrics with the dimension ​service:application1. You would apply tag ​app1 to the dimension ​service:application1. You can then filter on the tag ​app1 in charts and dashboards.</p><p>Another use case for tags for binary states where there is just one possible value. An example is you do canary testing and when you do a canary deployment you want to be able to mark the hosts that received the new code, so you can easily identify their metrics and compare their performance to those hosts that did not receive the new code. There is no need for a key:value pair as there is just a single value “canary”.</p><p>Be aware that while you can filter on tags you cannot use the groupBy function on them. The groupBy function is run by supplying the key part of a key:value pair and the results are then grouped by values of that key pair.</p><h2 id=additional-information>Additional information</h2><p>For information on sending dimensions for custom metrics please review the ​Client Libraries documentation for your library of choice.</p><p>For information on how to apply properties & tags to metrics or dimensions via the API please see the API documentation for ​/metric/:name​ ​/dimension/:key/:value</p><p>For information on how to add or edit properties and tags via the Metadata Catalog in the UI please reference the section <strong>​Add or edit metadata</strong> in <a href=https://docs.splunk.com/Observability/metrics-and-metadata/metrics-finder-metadata-catalog.html#use-the-metadata-catalog rel=external target=_blank>Search the Metric Finder and Metadata catalog</a>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=naming-conventions-for-tagging-with-opentelemetry-and-splunk>Naming Conventions for Tagging with OpenTelemetry and Splunk</h1><h2 id=introduction>Introduction</h2><p>When deploying OpenTelemetry in a large organization, it’s critical to define a standardized naming convention for tagging, and a governance process to ensure the convention is adhered to.</p><p>This ensures that MELT data collected via OpenTelemetry can be efficiently utilized for alerting, dashboarding, and troubleshooting purposes. It also ensures that users of Splunk Observability Cloud can quickly find the data they’re looking for.</p><p>Naming conventions also ensure that data can be aggregated effectively. For example, if we wanted to count the number of unique hosts by environment, then we must use a standardized convention for capturing the host and environment names.</p><h2 id=attributes-vs-tags>Attributes vs. Tags</h2><p>Before we go further, let’s make a note regarding terminology. Tags in OpenTelemetry are called “attributes”. Attributes can be attached to metrics, logs, and traces, either via manual instrumentation or automated instrumentation.</p><p>Attributes can also be attached to metrics, logs, and traces at the OpenTelemetry collector level, using various processors such as the <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/resourcedetectionprocessor rel=external target=_blank>Resource Detection processor</a>.</p><p>Once traces with attributes are ingested into Splunk Observability Cloud, they are available as “tags”. Optionally, attributes collected as part of traces can be used to create <a href=https://docs.splunk.com/Observability/apm/span-tags/metricsets.html#troubleshooting-metricsets rel=external target=_blank>Troubleshooting Metric Sets</a>, which can in turn be used with various features such as <a href=https://docs.splunk.com/Observability/apm/span-tags/tag-spotlight.html rel=external target=_blank>Tag Spotlight</a>.</p><p>Alternatively, attributes can be used to create <a href=https://docs.splunk.com/Observability/apm/span-tags/metricsets.html#monitoring-metricsets rel=external target=_blank>Monitoring Metric Sets</a>, which can be used to drive alerting.</p><h2 id=resource-semantic-conventions>Resource Semantic Conventions</h2><p><a href=https://github.com/open-telemetry/semantic-conventions/tree/main rel=external target=_blank>OpenTelemetry resource semantic conventions</a> should be used as a starting point when determining which attributes an organization should standardize on. In the following sections, we’ll review some of the more commonly used attributes.</p><h3 id=service-attributes>Service Attributes</h3><p>A number of attributes are used to describe the service being monitored.</p><p><code>service.name</code> is a required attribute that defines the logical name of the service. It’s added automatically by the OpenTelemetry SDK but can be customized. It’s best to keep this simple (i.e. <code>inventoryservice</code> would be better than <code>inventoryservice-prod-hostxyz</code>, as other attributes can be utilized to capture other aspects of the service instead).</p><p>The following service attributes are recommended:</p><ul><li><code>service.namespace</code> this attribute could be utilized to identify the team that owns the service</li><li><code>service.instance.id</code> is used to identify a unique instance of the service</li><li><code>service.version</code> is used to identify the version of the service</li></ul><h3 id=telemetry-sdk>Telemetry SDK</h3><p>These attributes are set automatically by the SDK, to record information about the instrumentation libraries being used:</p><ul><li><code>telemetry.sdk.name</code> is typically set to <code>opentelemetry</code></li><li><code>telemetry.sdk.language</code> is the language of the SDK, such as <code>java</code></li><li><code>telemetry.sdk.version</code> identifies which version of the SDK is utilized</li></ul><h3 id=containers>Containers</h3><p>For services running in containers, there are numerous attributes used to describe the container runtime, such as <code>container.id</code>, <code>container.name</code>, and <code>container.image.name</code>. The full list can be found <a href=https://github.com/open-telemetry/semantic-conventions/blob/main/docs/resource/container.md rel=external target=_blank>here</a>.</p><h3 id=hosts>Hosts</h3><p>These attributes describe the host where the service is running, and include attributes such as <code>host.id</code>, <code>host.name</code>, and <code>host.arch</code>. The full list can be found <a href=https://github.com/open-telemetry/semantic-conventions/blob/main/docs/resource/host.md rel=external target=_blank>here</a>.</p><h3 id=deployment-environment>Deployment Environment</h3><p>The <code>deployment.environment</code> attribute is used to identify the environment where the service is deployed, such as <strong>staging</strong> or <strong>production</strong>.</p><p>Splunk Observability Cloud uses this attribute to enable related content (as described <a href=https://docs.splunk.com/observability/metrics-and-metadata/enablerelatedcontent.html rel=external target=_blank>here</a>), so it’s important to include it.</p><h3 id=cloud>Cloud</h3><p>There are also attributes to capture information for services running in public cloud environments, such as AWS. Attributes include cloud.provider, <code>cloud.account.id</code>, and <code>cloud.region</code>.</p><p>The full list of attributes can be found <a href=https://github.com/open-telemetry/semantic-conventions/blob/main/docs/resource/cloud.md rel=external target=_blank>here</a>.</p><p>Some cloud providers, such as <a href=https://github.com/open-telemetry/semantic-conventions/tree/main/docs/resource/cloud-provider/gcp rel=external target=_blank>GCP</a>, define semantic conventions specific to their offering.</p><h3 id=kubernetes>Kubernetes</h3><p>There are a number of standardized attributes for applications running in Kubernetes as well. Many of these are added automatically by Splunk’s distribution of the OpenTelemetry collector, as described <a href=https://docs.splunk.com/observability/metrics-and-metadata/enablerelatedcontent.html#splunk-infrastructure-monitoring rel=external target=_blank>here</a>.</p><p>These attributes include <code>k8s.cluster.name</code>, <code>k8s.node.name</code>, <code>k8s.pod.name</code>, <code>k8s.namespace.name</code>, and <code>kubernetes.workload.name</code>.</p><h2 id=best-practices-for-creating-custom-attributes>Best Practices for Creating Custom Attributes</h2><p>Many organizations require attributes that go beyond what’s defined in OpenTelemetry’s resource semantic conventions.</p><p>In this case, it’s important to avoid naming conflicts with attribute names already included in the semantic conventions. So it’s a good idea to check the semantic conventions before deciding on a particular attribute name for your naming convention.</p><p>In addition to a naming convention for attribute names, you also need to consider attribute values. For example, if you’d like to capture the particular business unit with which an application belongs, then you’ll also want to have a standardized list of business unit values to choose from, to facilitate effective filtering.</p><p>The OpenTelemetry community provides guidelines that should be followed when naming attributes as well, which can be found <a href=https://opentelemetry.io/docs/specs/otel/common/attribute-naming/ rel=external target=_blank>here</a>.</p><p>The <a href=https://opentelemetry.io/docs/specs/otel/common/attribute-naming/#recommendations-for-application-developers rel=external target=_blank>Recommendations for Application Developers</a> section is most relevant to our discussion.</p><p>They recommend:</p><ul><li>Prefixing the attribute name with your company’s domain name, e.g. <code>com.acme.shopname</code> (if the attribute may be used outside your company as well as inside).</li><li>Prefixing the attribute name with the application name, if the attribute is unique to a particular application and is only used within your organization.</li><li>Not using existing OpenTelemetry semantic convention names as a prefix for your attribute name.</li><li>Consider submitting a proposal to add your attribute name to the OpenTelemetry specification, if there’s a general need for it across different organizations and industries.</li><li>Avoid having attribute names start with <code>otel.*</code>, as this is reserved for OpenTelemetry specification usage.</li></ul><h2 id=metric-cardinality-considerations>Metric Cardinality Considerations</h2><p>One final thing to keep in mind when deciding on naming standards for attribute names and values is related to metric cardinality.</p><p>Metric cardinality is defined as **the number of unique metric time series (MTS) produced by a combination of metric <strong>names and their associated dimensions</strong>.</p><p>A metric has high cardinality when it has a high number of dimension keys and a high number of possible unique values for those dimension keys.</p><p>For example, suppose your application sends in data for a metric named <code>custom.metric</code>. In the absence of any attributes, <code>custom.metric</code> would generate a single metric time series (MTS).</p><p>On the other hand, if <code>custom.metric</code> includes an attribute named <code>customer.id</code>, and there are thousands of customer ID values, this would generate thousands of metric time series, which may impact costs and query performance.</p><p>Splunk Observability Cloud provides a <a href=https://docs.splunk.com/Observability/infrastructure/metrics-pipeline/metrics-usage-report.html rel=external target=_blank>report</a> that allows for the management of metrics usage. And <a href=https://docs.splunk.com/Observability/infrastructure/metrics-pipeline/use-metrics-pipeline.html rel=external target=_blank>rules</a> can be created to drop undesirable dimensions. However, the first line of defence is understanding how attribute name and value combinations can drive increased metric cardinality.</p><h2 id=summary>Summary</h2><p>In this document, we highlighted the importance of defining naming conventions for OpenTelemetry tags, preferably before starting a large rollout of OpenTelemetry instrumentation.</p><p>We discussed how OpenTelemetry’s resource semantic conventions define the naming conventions for several attributes, many of which are automatically collected via the OpenTelemetry SDKs, as well as processors that run within the OpenTelemetry collector.</p><p>Finally, we shared some best practices for creating your attribute names, for situations where the resource semantic conventions are not sufficient for your organization’s needs.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 2, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=local-hosting>Local Hosting</h1><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>Please disable any VPNs or proxies before setting up an instance e.g:</p><ul><li>ZScaler</li><li>Cisco AnyConnect</li></ul><p>These tools <strong>will</strong> prevent the instance from being created properly.</p></div></details><ul class="children children-li children-sort-"><li><a href=/observability-workshop/v5.76/en/resources/local-hosting/multipass/index.html>Local Hosting with Multipass</a><p>Learn how to create a local hosting environment with Multipass - Windows/Linux/Mac(Intel)</p><ul></ul></li><li><a href=/observability-workshop/v5.76/en/resources/local-hosting/orbstack/index.html>Local Hosting with OrbStack</a><p>Learn how to create a local hosting environment with OrbStack - Mac (Apple Silicon)</p><ul></ul></li><li><a href=/observability-workshop/v5.76/en/resources/local-hosting/diab/index.html>Running Demo-in-a-Box</a><p>Learn how to use Demo-in-a-Box to manage demos and otel collectors in an easy-to-use web interface.</p><ul></ul></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Aug 13, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Local Hosting</h1><article class=default><header class=headline></header><h1 id=local-hosting-with-multipass>Local Hosting with Multipass</h1><p>Install <a href=https://multipass.run/ rel=external target=_blank>Multipass</a> and Terraform for your operating system. On a Mac (Intel), you can also install via <a href=https://brew.sh/ rel=external target=_blank>Homebrew</a> e.g.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>brew install multipass
</span></span><span class=line><span class=cl>brew install terraform</span></span></code></pre></div><p>Clone workshop repository:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/splunk/observability-workshop</span></span></code></pre></div><p>Change into multipass directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> observability-workshop/local-hosting/multipass</span></span></code></pre></div><p>Log Observer Connect:</p><p>If you plan to use your own Splunk Observability Cloud Suite Org and or Splunk instance, you may need to create a new <strong>Log Observer Connect</strong> connection:
Follow the instructions found in the <a href=https://docs.splunk.com/observability/en/logs/lo-connect-landing.html rel=external target=_blank>documentation</a> for <a href=https://docs.splunk.com/observability/en/logs/scp.html#logs-scp rel=external target=_blank>Splunk Cloud</a> or <a href=https://docs.splunk.com/observability/en/logs/set-up-logconnect.html rel=external target=_blank>Splunk Enterprize</a>.</p><p>Additional requirements for running your own <strong>Log Observer Connect</strong> connection are:</p><ul><li>Create an index called <strong>splunk4rookies-workshop</strong></li><li>Make sure the Service account user used in the <strong>Log observer Connect</strong> connection has access to the <strong>splunk4rookies-workshop</strong> index (you can remove all other indexes, as all workshop log data should go to this index).</li></ul><p>Initialise Terraform:</p><div class=tab-panel data-tab-group=e5df4a72987493d67a3b5f5bab640914><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("e5df4a72987493d67a3b5f5bab640914","command")'>
<span class=tab-nav-text>Command</span>
</button>
<button data-tab-item=example-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("e5df4a72987493d67a3b5f5bab640914","example-output")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform init -upgrade</span></span></code></pre></div></div></div><div data-tab-item=example-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>```text
Initializing the backend...
Initializing provider plugins...
- Finding latest version of hashicorp/random...
- Finding latest version of hashicorp/local...
- Finding larstobi/multipass versions matching "~> 1.4.1"...
- Installing hashicorp/random v3.5.1...
- Installed hashicorp/random v3.5.1 (signed by HashiCorp)
- Installing hashicorp/local v2.4.0...
- Installed hashicorp/local v2.4.0 (signed by HashiCorp)
- Installing larstobi/multipass v1.4.2...
- Installed larstobi/multipass v1.4.2 (self-signed, key ID 797707331BF3549C)
```</div></div></div></div><p>Create Terraform variables file. Variables are kept in file <code>terrform.tfvars</code> and a template is provided, <code>terraform.tfvars.template</code>, to copy and edit:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp terraform.tfvars.template terraform.tfvars</span></span></code></pre></div><p>The following Terraform variables are required:</p><ul><li><code>splunk_access_token</code>: Observability Cloud Access Token</li><li><code>splunk_api_token</code>: Observability Cloud API Token</li><li><code>splunk_rum_token</code>: Observability Cloud RUM Token</li><li><code>splunk_realm</code>: Observability Cloud Realm e.g. <code>eu0</code></li><li><code>splunk_hec_url</code>: Splunk HEC URL. Do not use a <code>raw</code> endpoint, use the <code>event</code> endpoint so logs process correctly.</li><li><code>splunk_hec_token</code>: Splunk HEC Token</li><li><code>splunk_index</code>: Splunk Index to send logs to. Defaults to <code>splunk4rookies-workshop</code>.</li></ul><p>Instance type variables:</p><ul><li><code>splunk_presetup</code>: Provide a preconfigured instance (OTel Collector and Online Boutique deployed with RUM enabled). The default is <code>false</code>.</li><li><code>splunk_diab</code>: Install and run Demo-in-a-Box. The default is <code>false</code>.</li><li><code>tagging_workshop</code>: Install and configure the Tagging Workshop. The default is <code>false</code>.</li><li><code>otel_demo</code> : Install and configure the OpenTelemetry Astronomy Shop Demo. This requires that <code>splunk_presetup</code> is set to <code>false</code>. The default is <code>false</code>.</li></ul><p>Optional advanced variables:</p><ul><li><code>wsversion</code>: Set this to <code>main</code> if working on the development of the workshop, otherwise this can be omitted.</li><li><code>architecture</code>: Set this to <code>arm64</code> if you are running on Apple Silicon. Defaults to <code>amd64</code>.</li></ul><p>Run <code>terraform plan</code> to check that all configuration is OK. Once happy run <code>terraform apply</code> to create the instance.</p><div class=tab-panel data-tab-group=c84fe8110572e3656fce615699c2fdb9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c84fe8110572e3656fce615699c2fdb9","command")'>
<span class=tab-nav-text>Command</span>
</button>
<button data-tab-item=example-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("c84fe8110572e3656fce615699c2fdb9","example-output")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform apply</span></span></code></pre></div></div></div><div data-tab-item=example-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>random_string.hostname: Creating...
</span></span><span class=line><span class=cl>random_string.hostname: Creation complete after 0s [id=cynu]
</span></span><span class=line><span class=cl>local_file.user_data: Creating...
</span></span><span class=line><span class=cl>local_file.user_data: Creation complete after 0s [id=46a5c50e396a1a7820c3999c131a09214db903dd]
</span></span><span class=line><span class=cl>multipass_instance.ubuntu: Creating...
</span></span><span class=line><span class=cl>multipass_instance.ubuntu: Still creating... [10s elapsed]
</span></span><span class=line><span class=cl>multipass_instance.ubuntu: Still creating... [20s elapsed]
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>multipass_instance.ubuntu: Still creating... [1m30s elapsed]
</span></span><span class=line><span class=cl>multipass_instance.ubuntu: Creation complete after 1m38s [name=cynu]
</span></span><span class=line><span class=cl>data.multipass_instance.ubuntu: Reading...
</span></span><span class=line><span class=cl>data.multipass_instance.ubuntu: Read complete after 1s [name=cynu]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Apply complete! Resources: 3 added, 0 changed, 0 destroyed.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Outputs:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>instance_details = [
</span></span><span class=line><span class=cl>  {
</span></span><span class=line><span class=cl>    &#34;image&#34; = &#34;Ubuntu 22.04.2 LTS&#34;
</span></span><span class=line><span class=cl>    &#34;image_hash&#34; = &#34;345fbbb6ec82 (Ubuntu 22.04 LTS)&#34;
</span></span><span class=line><span class=cl>    &#34;ipv4&#34; = &#34;192.168.205.185&#34;
</span></span><span class=line><span class=cl>    &#34;name&#34; = &#34;cynu&#34;
</span></span><span class=line><span class=cl>    &#34;state&#34; = &#34;Running&#34;
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>]</span></span></code></pre></div></div></div></div></div><p>Once the instance has been successfully created (this can take several minutes), <code>exec</code> into it using the <code>name</code> from the output above. The password for Multipass instance is <code>Splunk123!</code>.</p><div class=tab-panel data-tab-group=93f83e6d90df442a780fb77b191c25a4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("93f83e6d90df442a780fb77b191c25a4","command")'>
<span class=tab-nav-text>Command</span>
</button>
<button data-tab-item=example-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("93f83e6d90df442a780fb77b191c25a4","example-output")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>multipass <span class=nb>exec</span> cynu -- su -l splunk</span></span></code></pre></div></div></div><div data-tab-item=example-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ multipass exec kdhl -- su -l splunk
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl>Waiting for cloud-init status...
</span></span><span class=line><span class=cl>Your instance is ready!</span></span></code></pre></div></div></div></div></div><p>Validate the instance:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl version --output<span class=o>=</span>yaml</span></span></code></pre></div><p>To delete the instance, first make sure you have exited from instance and then run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform destroy</span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 25, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=local-hosting-with-orbstack>Local Hosting with OrbStack</h1><p>Install Orbstack:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>brew install orbstack</span></span></code></pre></div><p>Log Observer Connect:</p><p>If you plan to use your own Splunk Observability Cloud Suite Org and or Splunk instance, you may need to create a new <strong>Log Observer Connect</strong> connection:
Follow the instructions found in the <a href=https://docs.splunk.com/observability/en/logs/lo-connect-landing.html rel=external target=_blank>documentation</a> for <a href=https://docs.splunk.com/observability/en/logs/scp.html#logs-scp rel=external target=_blank>Splunk Cloud</a> or <a href=https://docs.splunk.com/observability/en/logs/set-up-logconnect.html rel=external target=_blank>Splunk Enterprize</a>.</p><p>Additional requirements for running your own <strong>Log Observer Connect</strong> connection are:
Create an index called <strong>splunk4rookies-workshop</strong>
Make sure the Service account user used in the <strong>Log observer Connect</strong> Connection has access to the <strong>splunk4rookies-workshop</strong> index. (You can remove all other indexes, as all workshop log data should go to this index)</p><p>Clone workshop repository:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/splunk/observability-workshop</span></span></code></pre></div><p>Change into Orbstack directory:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> observability-workshop/local-hosting/orbstack</span></span></code></pre></div><p>Copy the <code>start.sh.example</code> to <code>start.sh</code> and edit the file to set the following required variables
Make sure that you do not use a Raw Endpoint, but use an Event Endpoint instead as this will process the logs correctly</p><ul><li><code>ACCESS_TOKEN</code></li><li><code>REALM</code></li><li><code>API_TOKEN</code></li><li><code>RUM_TOKEN</code></li><li><code>HEC_TOKEN</code></li><li><code>HEC_URL</code></li></ul><p>Run the script and provide and instance name e.g.:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./start.sh my-instance</span></span></code></pre></div><p>Once the instance has been successfully created (this can take several minutes), you will automatically be logged into the instance. If you exit you can SSH back in using the following command (replace <code>&lt;my_instance></code> with the name of your instance):</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh splunk@&lt;my_instance&gt;@orb</span></span></code></pre></div><p>Once in the shell, you can validate that the instance is ready by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl version --output<span class=o>=</span>yaml</span></span></code></pre></div><p>To get the IP address of the instance, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ifconfig eth0</span></span></code></pre></div><p>To delete the instance, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>orb delete my-instance</span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Aug 20, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=running-demo-in-a-box>Running Demo-in-a-Box</h1><p><strong>Demo-in-a-box</strong> is a method for running demo apps easily using a web interface.</p><p>It provides:</p><ul><li>A quick way to deploy demo apps and states</li><li>A way to easily change configuration of your otel collector and see logs</li><li>Get pod status, pod logs, etc.</li></ul><p>To leverage this locally using multipass:</p><ul><li>Follow the <a href=../multipass>local hosting for multipass</a> instructions<ul><li>In the <code>terraform.tfvars</code> file, set <code>splunk_diab</code> to <code>true</code> and make sure <strong>all</strong> other options are set to <code>false</code></li><li>Then set the other required and important tokens/url</li><li>Then run the terraform steps</li></ul></li><li>Once the instance is up, navigate in your browser to: <code>http://&lt;IP>:8083</code><ul><li>In the <code>terraform.tfvars</code> file the <code>wsversion</code> defaults to the current version of the workshop e.g <code>4.64</code>:<ul><li>To use the latest developments change <code>wsversion</code> to use <code>main</code></li><li>There are only three versions of the workshop maintained, development (<code>main</code>) current (e.g. <code>4.64</code> and the previous (e.g. <code>4.63</code>)</li><li>After making the change, run <code>terraform apply</code> to make the changes</li></ul></li></ul></li><li>Now you can deploy any of the demos; this will also deploy the collector as part of the deployment</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Aug 14, 2024</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=unsupported-field-workshops>Unsupported Field Workshops</h1><ul class="children children-li children-sort-"><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/1-imt/index.html>Splunk IM</a><p>Splunk delivers real-time monitoring and troubleshooting to help you maximize infrastructure performance with complete visibility.</p></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/3-nodejs-kubernetes/index.html>NodeJS Zero-Config Workshop</a><p>A workshop using Zero Configuration Auto-Instrumentation for NodeJS.</p></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/8-gdi/index.html>GDI (OTel & UF)</a><p>Learn how to get data into Splunk Observability Cloud with OpenTelemetry and the Splunk Universal Forwarder.</p></li><li><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/index.html>Splunk OnCall</a><p>Make expensive service outages a thing of the past. Remediate issues faster, reduce on-call burnout and keep your services up and running.</p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Unsupported Field Workshops</h1><article class=default><header class=headline></header><h1 id=splunk-im>Splunk IM</h1><p>During this <em><strong>technical</strong></em> Splunk Observability Cloud Infrastructure Monitoring and APM Workshop, you will build out an environment based on a <a href=https://k3s.io/ rel=external target=_blank>lightweight</a> Kubernetes<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> cluster.</p><p>To simplify the workshop modules, a pre-configured AWS/EC2 instance is provided.</p><p>The instance is pre-configured with all the software required to deploy the Splunk OpenTelemetry Connector<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> in Kubernetes, deploy an NGINX^3 ReplicaSet^4 and finally deploy a microservices-based application which has been instrumented using OpenTelemetry to send metrics, traces, spans and logs<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</p><p>The workshops also introduce you to dashboards, editing and creating charts, creating detectors to fire alerts, Monitoring as Code and the Service Bureau<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></p><p>By the end of these technical workshops, you will have a good understanding of some of the key features and capabilities of the Splunk Observability Cloud.</p><p>Here are the instructions on how to access your pre-configured <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/1-imt/initial-setup/index.html>AWS</a>/<a href=/observability-workshop/v5.76/en/unsupported-field-workshops/1-imt/initial-setup/index.html>EC2 instance</a></p><p><a href=#R-image-88efb75393aebb623008d6f3b418d6ab class=lightbox-link><img alt="Splunk Architecture" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/1-imt/images/architecture.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-88efb75393aebb623008d6f3b418d6ab><img alt="Splunk Architecture" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/1-imt/images/architecture.png></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/ rel=external target=_blank><strong>Kubernetes</strong></a> is a portable, extensible, open-source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://opentelemetry.io/ rel=external target=_blank><strong>OpenTelemetry Collector</strong></a> offers a vendor-agnostic implementation on how to receive, process and export telemetry data. In addition, it removes the need to run, operate and maintain multiple agents/collectors to support open-source telemetry data formats (e.g. Jaeger, Prometheus, etc.) sending to multiple open-source or commercial back-ends.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://www.jaegertracing.io/ rel=external target=_blank><strong>Jaeger</strong></a>, inspired by Dapper and OpenZipkin, is a distributed tracing system released as open source by Uber Technologies. It is used for monitoring and troubleshooting microservices-based distributed systems&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://www.splunk.com/en_us/blog/it/monitoring-observability-enterprise-service.html rel=external target=_blank><strong>Monitoring as Code and Service Bureau</strong></a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Splunk IM</h1><article class=default><header class=headline></header><h1 id=how-to-connect-to-your-workshop-environment>How to connect to your workshop environment</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<ol><li>How to retrieve the IP address of the AWS/EC2 instance assigned to you.</li><li>Connect to your instance using SSH, Putty<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> or your web browser.</li><li>Verify your connection to your AWS/EC2 cloud instance.</li><li>Using Putty (Optional)</li><li>Using Multipass (Optional)</li></ol><hr><h2 id=1-awsec2-ip-address>1. AWS/EC2 IP Address</h2><p>In preparation for the workshop, Splunk has prepared an Ubuntu Linux instance in AWS/EC2.</p><p>To get access to the instance that you will be using in the workshop please visit the URL to access the Google Sheet provided by the workshop leader.</p><p>Search for your AWS/EC2 instance by looking for your first and last name, as provided during registration for this workshop.</p><p><a href=#R-image-465d411597acd3366d2275967fb7818d class=lightbox-link><img alt="attendee spreadsheet" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/spreadsheet-info.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-465d411597acd3366d2275967fb7818d><img alt="attendee spreadsheet" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/spreadsheet-info.png></a></p><p>Find your allocated IP address, SSH command (for Mac OS, Linux and the latest Windows versions) and password to enable you to connect to your workshop instance.</p><p>It also has the Browser Access URL that you can use in case you cannot connect via ssh or Putty - see <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/1-imt/initial-setup/index.html#4-web-browser-all>EC2 access via Web browser</a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Important</summary><div class=box-content><p>Please use SSH or Putty to gain access to your EC2 instance if possible and
make a note of the IP address as you will need this during the workshop.</p></div></details><h2 id=2-ssh-mac-oslinux>2. SSH (Mac OS/Linux)</h2><p>Most attendees will be able to connect to the workshop by using SSH from their Mac or Linux device, or on Windows 10 and above.</p><p>To use SSH, open a terminal on your system and type <code>ssh splunk@x.x.x.x</code> (replacing x.x.x.x with the IP address found in Step #1).</p><p><a href=#R-image-ac1a269ee863728565935170bdd417f2 class=lightbox-link><img alt="ssh login" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/ssh-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ac1a269ee863728565935170bdd417f2><img alt="ssh login" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/ssh-1.png></a></p><p>When prompted <strong><code>Are you sure you want to continue connecting (yes/no/[fingerprint])?</code></strong> please type <strong><code>yes</code></strong>.</p><p><a href=#R-image-4334777d23c273ee941ba857db8ac3b6 class=lightbox-link><img alt="ssh password" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/ssh-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4334777d23c273ee941ba857db8ac3b6><img alt="ssh password" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/ssh-2.png></a></p><p>Enter the password provided in the Google Sheet from Step #1.</p><p>Upon successful login, you will be presented with the Splunk logo and the Linux prompt.</p><p><a href=#R-image-3f83935a5652ce78ddf282e9e30e3df6 class=lightbox-link><img alt="ssh connected" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/ssh-3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f83935a5652ce78ddf282e9e30e3df6><img alt="ssh connected" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/ssh-3.png></a></p><h2 id=3-ssh-windows-10-and-above>3. SSH (Windows 10 and above)</h2><p>The procedure described above is the same on Windows 10, and the commands can be executed either in the Windows Command Prompt or PowerShell.
However, Windows regards its SSH Client as an &ldquo;optional feature&rdquo;, which might need to be enabled.</p><p>You can verify if SSH is enabled by simply executing <code>ssh</code></p><p>If you are shown a help text on how to use the ssh-command (like shown on the screenshot below), you are all set.</p><p><a href=#R-image-9794d34bd33cd811b56169c39610128c class=lightbox-link><img alt="Windows SSH enabled" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/windows-ssh-enabled-feedback.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9794d34bd33cd811b56169c39610128c><img alt="Windows SSH enabled" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/windows-ssh-enabled-feedback.png></a></p><p>If the result of executing the command looks something like the screenshot below, you want to enable the &ldquo;OpenSSH Client&rdquo; feature manually.</p><p><a href=#R-image-dfbdeb144b70d8e6f209a9a4cc11938e class=lightbox-link><img alt="Windows SSH disabled" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/windows-ssh-disabled-feedback.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dfbdeb144b70d8e6f209a9a4cc11938e><img alt="Windows SSH disabled" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/windows-ssh-disabled-feedback.png></a></p><p>To do that, open the &ldquo;Settings&rdquo; menu, and click on &ldquo;Apps&rdquo;. While in the &ldquo;Apps & features&rdquo; section, click on &ldquo;Optional features&rdquo;.</p><p><a href=#R-image-1dc3e0042ceecabec179d14269c4b32e class=lightbox-link><img alt="Windows Apps Settings" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/windows-gui-optionalfeatures.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1dc3e0042ceecabec179d14269c4b32e><img alt="Windows Apps Settings" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/windows-gui-optionalfeatures.png></a></p><p>Here, you are presented with a list of installed features. On the top, you see a button with a plus icon to &ldquo;Add a feature&rdquo;. Click it.
In the search input field, type &ldquo;OpenSSH&rdquo;, and find a feature called &ldquo;OpenSSH Client&rdquo;, or respectively, &ldquo;OpenSSH Client (Beta)&rdquo;, click on it, and click the &ldquo;Install&rdquo;-button.</p><p><a href=#R-image-5969f412acec05fad05b884180d8e471 class=lightbox-link><img alt="Windows Enable OpenSSH Client" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/windows-enable-openssh-client.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5969f412acec05fad05b884180d8e471><img alt="Windows Enable OpenSSH Client" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/windows-enable-openssh-client.png></a></p><p>Now you are set! In case you are not able to access the provided instance despite enabling the OpenSSH feature, please do not shy away from reaching
out to the course instructor, either via chat or directly.</p><p>At this point you are ready to continue and <a href=../gdi/index.html>start the workshop</a></p><hr><h2 id=4-putty-for-windows-versions-prior-to-windows-10>4. Putty (For Windows Versions prior to Windows 10)</h2><p>If you do not have SSH pre-installed or if you are on a Windows system, the best option is to install putty, you can find <a href=https://www.putty.org/ rel=external target=_blank>here.</a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Important</summary><div class=box-content><p>If you <strong>cannot</strong> install Putty, please go to <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/1-imt/initial-setup/index.html#4-web-browser-all>Web Browser (All)</a>.</p></div></details><p>Open Putty and enter in the <strong>Host Name (or IP address)</strong> field the IP address provided in the Google Sheet.</p><p>You can optionally save your settings by providing a name and pressing <strong>Save</strong>.</p><p><a href=#R-image-e470ce5f05305305c3e22a48831ceee0 class=lightbox-link><img alt=putty-2 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images//putty-settings.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e470ce5f05305305c3e22a48831ceee0><img alt=putty-2 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images//putty-settings.png></a></p><p>To then login to your instance click on the <strong>Open</strong> button as shown above.</p><p>If this is the first time connecting to your AWS/EC2 workshop instance, you will be presented with a security dialogue, please click <strong>Yes</strong>.</p><p><a href=#R-image-1c636dc1f420f8dc529f621351f454a0 class=lightbox-link><img alt=putty-3 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images//putty-security.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1c636dc1f420f8dc529f621351f454a0><img alt=putty-3 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images//putty-security.png></a></p><p>Once connected, login in as <strong>splunk</strong> and the password is the one provided in the Google Sheet.</p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-c60fe4c146ccc779f92893d74450716d class=lightbox-link><img alt=putty-4 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images//putty-loggedin.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c60fe4c146ccc779f92893d74450716d><img alt=putty-4 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images//putty-loggedin.png></a></p><p>At this point, you are ready to continue and <a href=../gdi/index.html>start the workshop</a></p><hr><h2 id=5-web-browser-all>5. Web Browser (All)</h2><p>If you are blocked from using SSH (Port 22) or unable to install Putty you may be able to connect to the workshop instance by using a web browser.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>This assumes that access to port 6501 is not restricted by your company&rsquo;s firewall.</p></div></details><p>Open your web browser and type <strong><a href=http://x.x.x.x:6501 rel=external target=_blank>http://x.x.x.x:6501</a></strong> (where X.X.X.X is the IP address from the Google Sheet).</p><p><a href=#R-image-fd1c2fc5ed9300aec4b1d5219441bcac class=lightbox-link><img alt=http-6501 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images//shellinabox-url.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fd1c2fc5ed9300aec4b1d5219441bcac><img alt=http-6501 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images//shellinabox-url.png></a></p><p>Once connected, login in as <strong>splunk</strong> and the password is the one provided in the Google Sheet.</p><p><a href=#R-image-379fe008007f067b6c26d1bd89625f71 class=lightbox-link><img alt=http-connect class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images//shellinabox-connect.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-379fe008007f067b6c26d1bd89625f71><img alt=http-connect class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images//shellinabox-connect.png></a></p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-129bb37be62f728195af5233df8150d7 class=lightbox-link><img alt="web login" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images//shellinabox-login.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-129bb37be62f728195af5233df8150d7><img alt="web login" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images//shellinabox-login.png></a></p><p>Unlike when you are using regular SSH, <em>copy and paste</em> does require a few extra steps to complete when using a browser session. This is due to cross browser restrictions.</p><p>When the workshop asks you to copy instructions into your terminal, please do the following:</p><p><em>Copy the instruction as normal, but when ready to paste it in the web terminal, choose <strong>Paste from browser</strong> as show below:</em></p><p><a href=#R-image-2f761bae777b0b4e4204bb64a90bd144 class=lightbox-link><img alt="web paste 1" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images//shellinabox-paste-browser.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2f761bae777b0b4e4204bb64a90bd144><img alt="web paste 1" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images//shellinabox-paste-browser.png></a></p><p>This will open a dialogue box asking for the text to be pasted into the web terminal:</p><p><a href=#R-image-93cc8364351ff6280b92987534b7679d class=lightbox-link><img alt="web paste 3" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images//shellinabox-example-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-93cc8364351ff6280b92987534b7679d><img alt="web paste 3" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images//shellinabox-example-1.png></a></p><p>Paste the text in the text box as shown, then press <strong>OK</strong> to complete the copy and paste process.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>Unlike regular SSH connection, the web browser has a 60-second time out, and you will be disconnected, and a <strong>Connect</strong> button will be shown in the center of the web terminal.</p><p>Simply click the <strong>Connect</strong> button and you will be reconnected and will be able to continue.</p></div></details><p><a href=#R-image-994cc7085bcfb42f49462dead1f4a578 class=lightbox-link><img alt="web reconnect" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images//shellinabox-reconnect.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-994cc7085bcfb42f49462dead1f4a578><img alt="web reconnect" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images//shellinabox-reconnect.png></a></p><p>At this point you are ready to continue and <a href=../gdi/index.html>start the workshop</a>.</p><hr><h2 id=6-multipass-all>6. Multipass (All)</h2><p>If you are unable to access AWS, but want to install software locally, follow the instructions for <a href=https://github.com/splunk/observability-workshop/blob/main/multipass/README.md rel=external target=_blank>using Multipass</a>.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.chiark.greenend.org.uk/~sgtatham/putty/ rel=external target=_blank>Download Putty</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploying-the-opentelemetry-collector-in-kubernetes>Deploying the OpenTelemetry Collector in Kubernetes</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<ul><li>Use the Splunk Helm chart to install the OpenTelemetry Collector in K3s</li><li>Explore your cluster in the Kubernetes Navigator</li></ul><hr><h2 id=1-installation-using-helm>1. Installation using Helm</h2><p>Install the OpenTelemetry Collector using the Splunk Helm chart. First, add the Splunk Helm chart repository to Helm and update:</p><div class=tab-panel data-tab-group=c1c48e91425b46c4dd83f88fc2c7caba><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-repo-add class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c1c48e91425b46c4dd83f88fc2c7caba","helm-repo-add")'>
<span class=tab-nav-text>Helm Repo Add</span>
</button>
<button data-tab-item=helm-repo-add-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("c1c48e91425b46c4dd83f88fc2c7caba","helm-repo-add-output")'>
<span class=tab-nav-text>Helm Repo Add Output</span></button></div><div class=tab-content-container><div data-tab-item=helm-repo-add class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span class=o>&amp;&amp;</span> helm repo update</span></span></code></pre></div></div></div><div data-tab-item=helm-repo-add-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>Using ACCESS_TOKEN={REDACTED}
Using REALM=eu0
&ldquo;splunk-otel-collector-chart&rdquo; has been added to your repositories
Using ACCESS_TOKEN={REDACTED}
Using REALM=eu0
Hang tight while we grab the latest from your chart repositories&mldr;
&mldr;Successfully got an update from the &ldquo;splunk-otel-collector-chart&rdquo; chart repository
Update Complete. ⎈Happy Helming!⎈</p></div></div></div></div><p>Install the OpenTelemetry Collector Helm chart with the following commands, do <strong>NOT</strong> edit this:</p><div class=tab-panel data-tab-group=b15c7d102327438cdd9aeed4359bf1ad><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-install class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b15c7d102327438cdd9aeed4359bf1ad","helm-install")'>
<span class=tab-nav-text>Helm Install</span>
</button>
<button data-tab-item=helm-install-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("b15c7d102327438cdd9aeed4359bf1ad","helm-install-output")'>
<span class=tab-nav-text>Helm Install Output</span></button></div><div class=tab-content-container><div data-tab-item=helm-install class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector --version 0.111.0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;logsEngine=otel&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.profilingEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;environment=</span><span class=nv>$INSTANCE</span><span class=s2>-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml</span></span></code></pre></div></div></div><div data-tab-item=helm-install-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Using ACCESS_TOKEN={REDACTED}
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Fri May  7 11:19:01 2021
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: 1
</span></span><span class=line><span class=cl>TEST SUITE: None</span></span></code></pre></div></div></div></div></div><p>You can monitor the progress of the deployment by running <code>kubectl get pods</code> which should typically report a new pod is up and running after about 30 seconds.</p><p>Ensure the status is reported as Running before continuing.</p><div class=tab-panel data-tab-group=02937846b2290a70836ce7445cff74fe><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("02937846b2290a70836ce7445cff74fe","kubectl-get-pods")'>
<span class=tab-nav-text>Kubectl Get Pods</span>
</button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("02937846b2290a70836ce7445cff74fe","kubectl-get-pods-output")'>
<span class=tab-nav-text>Kubectl Get Pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                          READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-2sk6k                             0/1     Running   0          10s
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-6956d4446f-gwnd7   0/1     Running   0          10s</span></span></code></pre></div></div></div></div></div><p>Ensure there are no errors by tailing the logs from the OpenTelemetry Collector pod. The output should look similar to the log output shown in the Output tab below.</p><p>Use the label set by the <code>helm</code> install to tail logs (You will need to press <code>ctrl+c</code> to exit). Or use the installed <code>k9s</code> terminal UI for bonus points!</p><div class=tab-panel data-tab-group=15fec483c7253096617940d936f39f37><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-logs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("15fec483c7253096617940d936f39f37","kubectl-logs")'>
<span class=tab-nav-text>Kubectl Logs</span>
</button>
<button data-tab-item=kubectl-logs-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("15fec483c7253096617940d936f39f37","kubectl-logs-output")'>
<span class=tab-nav-text>Kubectl Logs Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector -f --container otel-collector</span></span></code></pre></div></div></div><div data-tab-item=kubectl-logs-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>2021-03-21T16:11:10.900Z INFO service/service.go:364 Starting receivers&mldr;
2021-03-21T16:11:10.900Z INFO builder/receivers_builder.go:70 Receiver is starting&mldr; {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;prometheus&rdquo;, &ldquo;component_name&rdquo;: &ldquo;prometheus&rdquo;}
2021-03-21T16:11:11.009Z INFO builder/receivers_builder.go:75 Receiver started. {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;prometheus&rdquo;, &ldquo;component_name&rdquo;: &ldquo;prometheus&rdquo;}
2021-03-21T16:11:11.009Z INFO builder/receivers_builder.go:70 Receiver is starting&mldr; {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;}
2021-03-21T16:11:11.009Z INFO <a href=mailto:k8sclusterreceiver@v0.21.0 rel=external target=_blank>k8sclusterreceiver@v0.21.0</a>/watcher.go:195 Configured Kubernetes MetadataExporter {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;exporter_name&rdquo;: &ldquo;signalfx&rdquo;}
2021-03-21T16:11:11.009Z INFO builder/receivers_builder.go:75 Receiver started. {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;}
2021-03-21T16:11:11.009Z INFO healthcheck/handler.go:128 Health Check state change {&ldquo;component_kind&rdquo;: &ldquo;extension&rdquo;, &ldquo;component_type&rdquo;: &ldquo;health_check&rdquo;, &ldquo;component_name&rdquo;: &ldquo;health_check&rdquo;, &ldquo;status&rdquo;: &ldquo;ready&rdquo;}
2021-03-21T16:11:11.009Z INFO service/service.go:267 Everything is ready. Begin running and processing data.
2021-03-21T16:11:11.009Z INFO <a href=mailto:k8sclusterreceiver@v0.21.0 rel=external target=_blank>k8sclusterreceiver@v0.21.0</a>/receiver.go:59 Starting shared informers and wait for initial cache sync. {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;}
2021-03-21T16:11:11.281Z INFO <a href=mailto:k8sclusterreceiver@v0.21.0 rel=external target=_blank>k8sclusterreceiver@v0.21.0</a>/receiver.go:75 Completed syncing shared informer caches. {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;}</p></div></div></div></div><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Deleting a failed installation</summary><div class=box-content><p>If you make an error installing the OpenTelemetry Collector you can start over by deleting the installation using:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></details><hr><h2 id=2-validate-metrics-in-the-ui>2. Validate metrics in the UI</h2><p>In the Splunk UI, click the <strong>&#187;</strong> bottom left and click on <strong>Infrastructure</strong>.</p><p><a href=#R-image-f4f1c37810c877a272346d23a69b2f75 class=lightbox-link><img alt="Selecting the Kubernetes Navigator Map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/clustermap-nav.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f4f1c37810c877a272346d23a69b2f75><img alt="Selecting the Kubernetes Navigator Map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/clustermap-nav.png></a></p><p>Under <strong>Containers</strong> click on <strong>Kubernetes</strong> to open the Kubernetes Navigator Cluster Map to ensure metrics are being sent in.</p><p>Validate that your cluster is discovered and reported by finding your cluster (in the workshop you will see many other clusters). To find your cluster name run the following command and copy the output to your clipboard:</p><div class=tab-panel data-tab-group=458612f568ea628b480284d980be6300><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=echo-cluster-name class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("458612f568ea628b480284d980be6300","echo-cluster-name")'>
<span class=tab-nav-text>Echo Cluster Name</span></button></div><div class=tab-content-container><div data-tab-item=echo-cluster-name class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$INSTANCE</span>-k3s-cluster</span></span></code></pre></div></div></div></div></div><p>Then in the UI, click on the &ldquo;Cluster: - " menu just below the Splunk Logo, paste the Cluster name you just copied into the search box, click the box to select your cluster, and finally click off the menu into white space to apply the filter.</p><p><a href=#R-image-8827724d8d4668cc03e0c9f1f720587d class=lightbox-link><img alt="K8S Clusters Filter" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/search-k3s-cluster.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8827724d8d4668cc03e0c9f1f720587d><img alt="K8S Clusters Filter" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/search-k3s-cluster.png></a></p><p><a href=#R-image-60ec8fdf26afa3b71edaf0919eca76a8 class=lightbox-link><img alt="Select K8S Cluster" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/selecting-k3s-cluster.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-60ec8fdf26afa3b71edaf0919eca76a8><img alt="Select K8S Cluster" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/selecting-k3s-cluster.png></a></p><p><a href=#R-image-fdaf2cedfabb493c9e4a45dfa571c80a class=lightbox-link><img alt="Filtered K8S Cluster" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/filtered-k3s-cluster.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fdaf2cedfabb493c9e4a45dfa571c80a><img alt="Filtered K8S Cluster" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/filtered-k3s-cluster.png></a></p><p>To examine the health of your node, hover over the pale blue background of your cluster, then click on the blue magnifying glass <a href=#R-image-bf0b951ede3641bd5ec3fdbddbe3efba class=lightbox-link><img alt="Magnifying Glass" class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/blue-cross.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bf0b951ede3641bd5ec3fdbddbe3efba><img alt="Magnifying Glass" class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/blue-cross.png?classes=inline&height=25px"></a> that appears in the top left-hand corner.</p><p>This will drill down to the node level. Next, open the Metrics sidebar by clicking on the sidebar button.</p><p>Once it is open, you can use the slider on the side to explore the various charts relevant to your cluster/node: CPU, Memory, Network, Events etc.</p><p><a href=#R-image-e35d63b096f0ac19e80514ca3dcd8089 class=lightbox-link><img alt="Sidebar metrics" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/explore-metrics.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e35d63b096f0ac19e80514ca3dcd8089><img alt="Sidebar metrics" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/explore-metrics.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 13, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. Get Data In</h1><article class=default><header class=headline></header><h1 id=deploying-nginx-in-k3s>Deploying NGINX in K3s</h1><ul><li>Deploy a NGINX ReplicaSet into your K3s cluster and confirm the discovery of your NGINX deployment.</li><li>Run a load test to create metrics and confirm them streaming into Splunk Observability Cloud!</li></ul><hr><h2 id=1-start-your-nginx>1. Start your NGINX</h2><p>Verify the number of pods running in the Splunk UI by selecting the <strong>WORKLOADS</strong> tab. This should give you an overview of the workloads on your cluster.</p><p><a href=#R-image-84967a65328d5616c08c79bc353c3287 class=lightbox-link><img alt="Workload Agent" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/k8s-workloads.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-84967a65328d5616c08c79bc353c3287><img alt="Workload Agent" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/k8s-workloads.png></a></p><p>Note the single agent container running per node among the default Kubernetes pods. This single container will monitor all the pods and services being deployed on this node!</p><p>Now switch back to the default cluster node view by selecting the <strong>MAP</strong> tab and selecting your cluster again.</p><p>In your AWS/EC2 or Multipass shell session change into the <code>nginx</code> directory:</p><div class=tab-panel data-tab-group=7a6db706909c028499680af0c5814f38><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=change-directory class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7a6db706909c028499680af0c5814f38","change-directory")'>
<span class=tab-nav-text>Change Directory</span></button></div><div class=tab-content-container><div data-tab-item=change-directory class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/k3s/nginx</span></span></code></pre></div></div></div></div></div><hr><h2 id=2-create-nginx-deployment>2. Create NGINX deployment</h2><p>Create the NGINX ConfigMap<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> using the <code>nginx.conf</code> file:</p><div class=tab-panel data-tab-group=e6551d83c30b3f86ae6b5a515cd389d9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-configmap-create class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("e6551d83c30b3f86ae6b5a515cd389d9","kubectl-configmap-create")'>
<span class=tab-nav-text>Kubectl Configmap Create</span>
</button>
<button data-tab-item=kubectl-create-configmap-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("e6551d83c30b3f86ae6b5a515cd389d9","kubectl-create-configmap-output")'>
<span class=tab-nav-text>Kubectl Create Configmap Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-configmap-create class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create configmap nginxconfig --from-file<span class=o>=</span>nginx.conf</span></span></code></pre></div></div></div><div data-tab-item=kubectl-create-configmap-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>configmap/nginxconfig created</p></div></div></div></div><p>Then create the deployment:</p><div class=tab-panel data-tab-group=13ea24a1f30ba9db525765aba027e448><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-create-deployment class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("13ea24a1f30ba9db525765aba027e448","kubectl-create-deployment")'>
<span class=tab-nav-text>Kubectl Create Deployment</span>
</button>
<button data-tab-item=kubectl-create-deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("13ea24a1f30ba9db525765aba027e448","kubectl-create-deployment-output")'>
<span class=tab-nav-text>Kubectl Create Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-create-deployment class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create -f nginx-deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=kubectl-create-deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>deployment.apps/nginx created
service/nginx created</p></div></div></div></div><p>Next, we will deploy Locust<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> which is an open-source tool used for creating a load test against NGINX:</p><div class=tab-panel data-tab-group=e5fa7a8d36fe2834ef355326e8eb81d4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-create-deployment class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("e5fa7a8d36fe2834ef355326e8eb81d4","kubectl-create-deployment")'>
<span class=tab-nav-text>Kubectl Create Deployment</span>
</button>
<button data-tab-item=kubectl-create-deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("e5fa7a8d36fe2834ef355326e8eb81d4","kubectl-create-deployment-output")'>
<span class=tab-nav-text>Kubectl Create Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-create-deployment class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create -f locust-deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=kubectl-create-deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>deployment.apps/nginx-loadgenerator created
service/nginx-loadgenerator created</p></div></div></div></div><p>Validate the deployment has been successful and that the Locust and NGINX pods are running.</p><p>If you have the Splunk UI open you should see new Pods being started and containers being deployed.</p><p>It should only take around 20 seconds for the pods to transition into a Running state. In the Splunk UI you will have a cluster that looks like the screenshot below:</p><p><a href=#R-image-146ee161f05d4c7cea6bf7c02964431c class=lightbox-link><img alt="back to Cluster" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/cluster.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-146ee161f05d4c7cea6bf7c02964431c><img alt="back to Cluster" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/cluster.png></a></p><p>If you select the <strong>WORKLOADS</strong> tab again you will now see that there is a new ReplicaSet and a deployment added for NGINX:</p><p><a href=#R-image-dc7fa39aa65f6ed7dc7bf9402a4b8a6f class=lightbox-link><img alt="NGINX loaded" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/k8s-workloads-nginx.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dc7fa39aa65f6ed7dc7bf9402a4b8a6f><img alt="NGINX loaded" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/k8s-workloads-nginx.png></a></p><hr><p>Let&rsquo;s validate this in your shell as well:</p><div class=tab-panel data-tab-group=c16094bc85fbe9e180548b988d78b4b7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c16094bc85fbe9e180548b988d78b4b7","kubectl-get-pods")'>
<span class=tab-nav-text>Kubectl Get Pods</span>
</button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("c16094bc85fbe9e180548b988d78b4b7","kubectl-get-pods-output")'>
<span class=tab-nav-text>Kubectl Get Pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>NAME READY STATUS RESTARTS AGE
splunk-otel-collector-k8s-cluster-receiver-77784c659c-ttmpk 1/1 Running 0 9m19s
splunk-otel-collector-agent-249rd 1/1 Running 0 9m19s
svclb-nginx-vtnzg 1/1 Running 0 5m57s
nginx-7b95fb6b6b-7sb9x 1/1 Running 0 5m57s
nginx-7b95fb6b6b-lnzsq 1/1 Running 0 5m57s
nginx-7b95fb6b6b-hlx27 1/1 Running 0 5m57s
nginx-7b95fb6b6b-zwns9 1/1 Running 0 5m57s
svclb-nginx-loadgenerator-nscx4 1/1 Running 0 2m20s
nginx-loadgenerator-755c8f7ff6-x957q 1/1 Running 0 2m20s</p></div></div></div></div><hr><h2 id=3-run-locust-load-test>3. Run Locust load test</h2><p>Locust, an open-source load generator, is available on port 8083 of the EC2 instance&rsquo;s IP address. Open a new tab in your web browser and go to <code>http://{==EC2-IP==}:8083/</code>, you will then be able to see the Locust running.</p><p><a href=#R-image-f0ee4d0b11ee59bac0fa2cf80543a9d8 class=lightbox-link><img alt=Locust class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/nginx-locust.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f0ee4d0b11ee59bac0fa2cf80543a9d8><img alt=Locust class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/nginx-locust.png></a></p><p>Set the <strong>Spawn rate</strong> to 2 and click <strong>Start Swarming</strong>.</p><p><a href=#R-image-5d177e93ad3c396ee8fc2c293ccba5ab class=lightbox-link><img alt="Locust Spawn Rate" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/nginx-locust-spawn-rate.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d177e93ad3c396ee8fc2c293ccba5ab><img alt="Locust Spawn Rate" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/nginx-locust-spawn-rate.png></a></p><p>This will start a gentle continuous load on the application.</p><p><a href=#R-image-eecdddc391ae752978e2a39c888cb4af class=lightbox-link><img alt="Locust Statistics" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/nginx-locust-statistics.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eecdddc391ae752978e2a39c888cb4af><img alt="Locust Statistics" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/nginx-locust-statistics.png></a></p><p>As you can see from the above screenshot, most of the calls will report a fail, this is expected, as we have not yet deployed the application behind it, however, NGINX is reporting on your attempts and you should be able to see those metrics.</p><p>Validate you are seeing those metrics in the UI by selecting <strong>Dashboards → Built-in Dashboard Groups → NGINX → NGINX Servers</strong>. Using the <strong>Overrides</strong> filter on <code>k8s.cluster.name:</code>, find the name of your cluster as returned by <code>echo $INSTANCE-k3s-cluster</code> in the terminal.</p><p><a href=#R-image-f80c59c3bddb5febd9643c441df2f500 class=lightbox-link><img alt="NGINX Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/nginx-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f80c59c3bddb5febd9643c441df2f500><img alt="NGINX Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/nginx-dashboard.png></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>A ConfigMap is an API object used to store non-confidential data in key-value pairs. Pods can consume ConfigMaps as environment variables, command-line arguments, or configuration files in a volume. A ConfigMap allows you to decouple environment-specific configuration from your container images so that your applications are easily portable.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://locust.io/ rel=external target=_blank>What is Locust?</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=working-with-dashboards>Working with Dashboards</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<ul><li>Introduction to the Dashboards and Charts</li><li>Editing and creating charts</li><li>Filtering and analytical functions</li><li>Using formulas</li><li>Saving charts in a dashboard</li><li>Introduction to SignalFlow</li></ul><hr><h2 id=1-dashboards>1. Dashboards</h2><p>Dashboards are groupings of charts and visualizations of metrics. Well-designed dashboards can provide useful and actionable insight into your system at a glance. Dashboards can be complex or contain just a few charts that drill down only into the data you want to see.</p><p>During this module, we are going to create the following charts and dashboard and connect them to your Team page.</p><p><a href=#R-image-e8c8517ee0c00833a1f36531dc550e30 class=lightbox-link><img alt="Example Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/example-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e8c8517ee0c00833a1f36531dc550e30><img alt="Example Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/example-dashboard.png></a></p><hr><h2 id=2-your-teams-page>2. Your Teams&rsquo; Page</h2><p>Click on the <a href=#R-image-c45ee4bf347b415ce4675feee5dce9cc class=lightbox-link><img alt="Dashboards button" class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/dashboards.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c45ee4bf347b415ce4675feee5dce9cc><img alt="Dashboards button" class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/dashboards.png?classes=inline&height=25px"></a> from the navbar. As you have already been assigned to a team, you will land on the team dashboard. We use the <em><strong>Example Team</strong></em> as an example here. The one in your workshop will be different!</p><p><a href=#R-image-a9fe960fa1bca068ddeb82f6352e50e7 class=lightbox-link><img alt="Team Dashboard1" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/team-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a9fe960fa1bca068ddeb82f6352e50e7><img alt="Team Dashboard1" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/team-dashboard.png></a></p><p>This page shows the total number of team members, how many active alerts for your team and all dashboards that are assigned to your team. Right now there are no dashboards assigned but as stated before, we will add the new dashboard that you will create to your Teams page later.</p><hr><h2 id=3-sample-charts>3. Sample Charts</h2><p>To continue, click on <strong>All Dashboards</strong> in the top right corner of the screen. This brings you to the view that shows all the available dashboards, including the pre-built ones.</p><p><a href=#R-image-8461d01b986b10b3f99a5321fe0d9456 class=lightbox-link><img alt="Sample Data" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/sample-data.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8461d01b986b10b3f99a5321fe0d9456><img alt="Sample Data" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/sample-data.png></a></p><p>If you are already receiving metrics from a Cloud API integration or another service through the Splunk Agent you will see relevant dashboards for these services.</p><hr><h2 id=4-inspecting-the-sample-data>4. Inspecting the Sample Data</h2><p>Among the dashboards, you will see a Dashboard group called <strong>Sample Data</strong>. Expand the <strong>Sample Data</strong> dashboard group by clicking on it, and then click on the <strong>Sample Charts</strong> dashboard.</p><p>In the Sample Charts dashboard, you can see a selection of charts that show a sample of the various styles, colors and formats you can apply to your charts in the dashboards.</p><p>Have a look through all the dashboards in this dashboard group (<strong>PART 1</strong>, <strong>PART 2</strong>, <strong>PART 3</strong> and <strong>INTRO TO SPLUNK OBSERVABILITY CLOUD</strong>)</p><p><a href=#R-image-235825f904c3ef3b20e82aa910476411 class=lightbox-link><img alt="Sample Charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/sample-charts.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-235825f904c3ef3b20e82aa910476411><img alt="Sample Charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/sample-charts.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. Dashboards</h1><article class=default><header class=headline></header><h1 id=editing-charts>Editing charts</h1><h2 id=1-editing-a-chart>1. Editing a chart</h2><p>Select the <strong>SAMPLE CHARTS</strong> dashboard and then click on the three dots <strong><code>...</code></strong> on the <strong>Latency histogram</strong> chart, then on <strong>Open</strong> (or you can click on the name of the chart which here is <strong>Latency histogram</strong>).</p><p><a href=#R-image-144b49e0cd068c5e4951bb3053b3bc99 class=lightbox-link><img alt="Sample Charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/latency-histogram-open.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-144b49e0cd068c5e4951bb3053b3bc99><img alt="Sample Charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/latency-histogram-open.png></a></p><p>You will see the plot options, current plot and signal (metric) for the <strong>Latency histogram</strong> chart in the chart editor UI.</p><p><a href=#R-image-cca6d793bf2f900ed02a33cb080b160c class=lightbox-link><img alt="Latency Histogram" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/latency-histogram.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cca6d793bf2f900ed02a33cb080b160c><img alt="Latency Histogram" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/latency-histogram.png></a></p><p>In the <strong>Plot Editor</strong> tab under <strong>Signal</strong> you see the metric <strong><code>demo.trans.latency</code></strong> we are currently plotting.</p><p><a href=#R-image-b4400f0f5824eec87fb5bcba7af932f7 class=lightbox-link><img alt="Plot Editor" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/plot-editor.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b4400f0f5824eec87fb5bcba7af932f7><img alt="Plot Editor" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/plot-editor.png></a></p><p>You will see a number of <strong>Line</strong> plots. The number <strong><code>18 ts</code></strong> indicates that we are plotting 18 metric time series in the chart.</p><p>Click on the different chart type icons to explore each of the visualizations. Notice their name while you swipe over them. For example, click on the Heat Map icon:</p><p><a href=#R-image-3c39021fd02ec6e8f7456b8c8f42a514 class=lightbox-link><img alt="Chart Types" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Editing-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3c39021fd02ec6e8f7456b8c8f42a514><img alt="Chart Types" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Editing-2.png></a></p><p>See how the chart changes to a heat map.</p><p><a href=#R-image-b23fed2979eff0b8791264961720ed3d class=lightbox-link><img alt="Change to Heatmap" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/change-to-heatmap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b23fed2979eff0b8791264961720ed3d><img alt="Change to Heatmap" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/change-to-heatmap.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>You can use different charts to visualize your metrics - you choose which chart type fits best for the visualization you want to have.</p><p>For more info on the different chart types see <a href=https://docs.splunk.com/Observability/data-visualization/charts/chart-types.html#chart-types rel=external target=_blank>Choosing a chart type.</a></p></div></details><p>Click on the <strong>Line</strong> chart type and you will see the line plot.</p><p><a href=#R-image-b09a27061c5fe3c73f449991f65ede55 class=lightbox-link><img alt="Line Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Editing-3b.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b09a27061c5fe3c73f449991f65ede55><img alt="Line Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Editing-3b.png></a></p><h2 id=2-changing-the-time-window>2. Changing the time window</h2><p>You can also increase the time window of the chart by changing the time to <strong>Past 15 minutes</strong> by selecting from the <strong>Time</strong> dropdown.</p><p><a href=#R-image-a03d697578683db905b45104d8de5ca4 class=lightbox-link><img alt="Line Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/line-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a03d697578683db905b45104d8de5ca4><img alt="Line Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/line-chart.png></a></p><h2 id=3-viewing-the-data-table>3. Viewing the Data Table</h2><p>Click on the <strong>Data Table</strong> tab.</p><p><a href=#R-image-cc67eaa73b39df2e7da6cd7750a16b87 class=lightbox-link><img alt="Data Table" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/data-table.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cc67eaa73b39df2e7da6cd7750a16b87><img alt="Data Table" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/data-table.png></a></p><p>You now see 18 rows, each representing a metric time series with a number of columns. These columns represent the dimensions of the metric. The dimensions for <code>demo.trans.latency</code> are:</p><ul><li><code>demo_datacenter</code></li><li><code>demo_customer</code></li><li><code>demo_host</code></li></ul><p>In the <strong><code>demo_datacenter</code></strong> column you see that there are two data centers, <strong>Paris</strong> and <strong>Tokyo</strong>, for which we are getting metrics.</p><p>If you move your cursor over the lines in the chart horizontally you will see the data table update accordingly. If you click on one of the lines in the chart you will see a pinned value appear in the data table.</p><hr><p>Now click on <strong>Plot editor</strong> again to close the Data Table and let&rsquo;s save this chart into a dashboard for later use!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=saving-charts>Saving charts</h1><h2 id=1-saving-a-chart>1. Saving a chart</h2><p>To start saving your chart, lets give it a name and description. Click the name of the chart <strong>Copy of Latency Histogram</strong> and rename it to <strong>&ldquo;Active Latency&rdquo;</strong>.</p><p>To change the description click on <strong>Spread of latency values across time.</strong> and change this to <strong>Overview of latency values in real-time.</strong></p><p><a href=#R-image-c9ffeda33438481f33525365f86b7056 class=lightbox-link><img alt="Save Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/save-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c9ffeda33438481f33525365f86b7056><img alt="Save Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/save-chart.png></a></p><p>Click the <span class="btn cstyle blue"><span><span class=title>Save As</span></span></span> button. Make sure your chart has a name, it will use the name <strong>Active Latency</strong> the you defined in the previous step, but you can edit it here if needed.</p><p>Press the <span class="btn cstyle blue"><span><span class=title>Ok</span></span></span>
button to continue.</p><p><a href=#R-image-25e75a2dcead45d61e6e51004341f0a6 class=lightbox-link><img alt="Name Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/name-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-25e75a2dcead45d61e6e51004341f0a6><img alt="Name Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/name-chart.png></a></p><h2 id=2-creating-a-dashboard>2. Creating a dashboard</h2><p>In the <strong>Choose dashboard</strong> dialog, we need to create a new dashboard, click on the <span class="btn cstyle blue"><span><span class=title>New Dashboard</span></span></span>
button.</p><p><a href=#R-image-0a1774f429f06faa1be4860555b33401 class=lightbox-link><img alt="Create Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/create-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a1774f429f06faa1be4860555b33401><img alt="Create Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/create-dashboard.png></a></p><p>You will now see the <strong>New Dashboard</strong> Dialog. In here you can give you dashboard a name and description, and set <strong>Read and Write Permissions</strong>.</p><p>Please use your own name in the following format to give your dashboard a name e.g. <strong>YOUR_NAME-Dashboard</strong>.</p><p>Please replace <strong>YOUR_NAME</strong> with your own name, change the dashboard permissions to <em>Restricted Read and Write access</em>, and verify your user can read/write.</p><p><a href=#R-image-34646b23b98f063644a5d7c8757698f2 class=lightbox-link><img alt="Name Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/name-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-34646b23b98f063644a5d7c8757698f2><img alt="Name Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/name-dashboard.png></a></p><p>You should see you own login information displayed, meaning you are now the only one who can edit this dashboard. Of course you have the option to add other users or teams from the drop box below that may edit your dashboard and charts, but for now make sure you change it back to <em>Everyone can Read or Write</em> to remove any restrictions and press the <span class="btn cstyle blue"><span><span class=title>Save</span></span></span>
Button to continue.</p><p>Your new dashboard is now available and selected so you can save your chart in your new dashboard.</p><p><a href=#R-image-898e09e02f7b2d20b1a949947c96d1ce class=lightbox-link><img alt="Choose Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/choose-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-898e09e02f7b2d20b1a949947c96d1ce><img alt="Choose Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/choose-dashboard.png></a></p><p>Make sure you have your dashboard selected and press the <span class="btn cstyle blue"><span><span class=title>Ok</span></span></span> button.</p><p>You will now be taken to your dashboard like below. You can see at the top left that your <strong>YOUR_NAME-DASHBOARD</strong> is part of a Dashboard Group <strong>YOUR_NAME-Dashboard</strong>. You can add other dashboards to this dashboard group.</p><p><a href=#R-image-0df96a9f824b8ec683fa566a3c298975 class=lightbox-link><img alt="New Dashboard Group" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/new-dashboard-group.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0df96a9f824b8ec683fa566a3c298975><img alt="New Dashboard Group" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/new-dashboard-group.png></a></p><hr><h2 id=3-add-to-team-page>3. Add to Team page</h2><p>It is common practice to link dashboards that are relevant to a Team to a teams page. So let&rsquo;s add your dashboard to the team page for easy access later. Use the <a href=#R-image-14b17059c1624663aff3c0135af7298b class=lightbox-link><img alt="dashboards button" class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../images/dashboards.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-14b17059c1624663aff3c0135af7298b><img alt="dashboards button" class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/dashboards.png?classes=inline&height=25px"></a> from the navbar again.</p><p>This will bring you to your teams dashboard, We use the team <em><strong>Example Team</strong></em> as an example here, the workshop one will be different.</p><p><a href=#R-image-f6fe1c81a431ab69ab02af1640d29f23 class=lightbox-link><img alt="Team Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/team-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f6fe1c81a431ab69ab02af1640d29f23><img alt="Team Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/team-dashboard.png></a></p><p>Press the <span class="btn cstyle white"><span><span class=title>+</span></span></span> <em>Add Dashboard Group</em> button to add you dashboard to the team page.</p><p>This will bring you to the <strong>Select a dashboard group to link to this team</strong> dialog.
Type your name (that you used above) in the search box to find your Dashboard. Select it so its highlighted and click the <strong>Ok</strong> button to add your dashboard.</p><p><a href=#R-image-72cfc6c7c0cbe3b4835dcc1987987ced class=lightbox-link><img alt="Select Dashboard Group" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/select-dashboard-group.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-72cfc6c7c0cbe3b4835dcc1987987ced><img alt="Select Dashboard Group" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/select-dashboard-group.png></a></p><p>Your dashboard group will appear as part of the team page. Please note during the course of the workshop many more will appear here.</p><p><a href=#R-image-da1119adf060042785f255d9187cbb16 class=lightbox-link><img alt="New Team Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/new-team-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-da1119adf060042785f255d9187cbb16><img alt="New Team Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/new-team-dashboard.png></a></p><hr><p>Now click on the link for your Dashboard to add more charts!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=33-using-filters--formulas>3.3 Using Filters & Formulas</h1><h2 id=1-creating-a-new-chart>1 Creating a new chart</h2><p>Let&rsquo;s now create a new chart and save it in our dashboard!</p><p>Select the plus icon (top right of the UI) and from the drop down, choose the option <strong>Chart</strong>.
Or click on the <span class="btn cstyle blue"><span><span class=title>+ New Chart</span></span></span> Button to create a new chart.</p><p><a href=#R-image-58be380c963f5e30c7d8be4b2c63f921 class=lightbox-link><img alt="Create new chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-0.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-58be380c963f5e30c7d8be4b2c63f921><img alt="Create new chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-0.png></a></p><p>You will now see a chart template like the following.</p><p><a href=#R-image-59099387edc836ab214ec5aee175fc89 class=lightbox-link><img alt="Empty Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Editing-6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-59099387edc836ab214ec5aee175fc89><img alt="Empty Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Editing-6.png></a></p><p>Let&rsquo;s enter a metric to plot. We are still going to use the metric <strong><code>demo.trans.latency</code></strong>.</p><p>In the <strong>Plot Editor</strong> tab under <strong>Signal</strong> enter <strong><code>demo.trans.latency</code></strong>.</p><p><a href=#R-image-b698e7d58c7e14f88abcdd2e80046609 class=lightbox-link><img alt=Signal class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/plot-editor.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b698e7d58c7e14f88abcdd2e80046609><img alt=Signal class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/plot-editor.png></a></p><p>You should now have a familiar line chart. Please switch the time to 15 mins.</p><p><a href=#R-image-e4141c045cdc2deb31820c251cbf4b33 class=lightbox-link><img alt=Signal class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-10.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e4141c045cdc2deb31820c251cbf4b33><img alt=Signal class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-10.png></a></p><h2 id=2-filtering-and-analytics>2. Filtering and Analytics</h2><p>Let&rsquo;s now select the <strong>Paris</strong> datacenter to do some analytics - for that we will use a filter.</p><p>Let&rsquo;s go back to the <strong>Plot Editor</strong> tab and click on <span class="btn cstyle blue"><span><span class=title>Add Filter</span></span></span>
, wait until it automatically populates, choose <strong><code>demo_datacenter</code></strong>, and then <strong><code>Paris</code></strong>.</p><p><a href=#R-image-6b7c1dc1bc16730017d143a2f6d09e6b class=lightbox-link><img alt=Filter class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6b7c1dc1bc16730017d143a2f6d09e6b><img alt=Filter class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-1.png></a></p><p>In the <strong>F(x)</strong> column, add the analytic function <strong><code>Percentile:Aggregation</code></strong>, and leave the value to <strong><code>95</code></strong> (click outside to confirm).</p><p><a href=#R-image-8a0eabc95335e4306a91fc932309e4ec class=lightbox-link><img alt=Analytics class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8a0eabc95335e4306a91fc932309e4ec><img alt=Analytics class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-2.png></a></p><p>For info on the <strong>Percentile</strong> function and the other functions see <a href=https://docs.splunk.com/Observability/data-visualization/charts/gain-insights-through-chart-analytics.html#gain-insights-through-chart-analytics rel=external target=_blank>Chart Analytics</a>.</p><hr><h2 id=3-using-timeshift-analytical-function>3. Using Timeshift analytical function</h2><p>Let&rsquo;s now compare with older metrics. Click on <strong><code>...</code></strong> and then on <strong>Clone</strong> in the dropdown to clone Signal <strong>A</strong>.</p><p><a href=#R-image-d45857fd9db021df8c1f0686599fa932 class=lightbox-link><img alt="Clone Signal" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d45857fd9db021df8c1f0686599fa932><img alt="Clone Signal" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-3.png></a></p><p>You will see a new row identical to <strong>A</strong>, called <strong>B</strong>, both visible and plotted.</p><p><a href=#R-image-4cf4c9d978da3fab2b1090151e5b6beb class=lightbox-link><img alt="Plot Editor" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-4.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4cf4c9d978da3fab2b1090151e5b6beb><img alt="Plot Editor" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-4.png></a></p><p>For Signal <strong>B</strong>, in the <strong>F(x)</strong> column add the analytic function <strong>Timeshift</strong> and enter <strong><code>1w</code></strong> (or 7d for 7 days), and click outside to confirm.</p><p><a href=#R-image-4e228d11ef6c395a66cc2b2ddd8165ac class=lightbox-link><img alt=Timeshift class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-5.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4e228d11ef6c395a66cc2b2ddd8165ac><img alt=Timeshift class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-5.png></a></p><p>Click on the cog on the far right, and choose a <strong>Plot Color</strong> e.g. pink, to change color for the plot of <strong>B</strong>.</p><p><a href=#R-image-bd51489e4144e49593168ef10bea74a9 class=lightbox-link><img alt="Change Plot Colour" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bd51489e4144e49593168ef10bea74a9><img alt="Change Plot Colour" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-6.png></a></p><p>Click on <strong>Close</strong>.</p><p>We now see plots for Signal <strong>A</strong> (the past 15 minutes) as a blue plot, and the plots from a week ago in pink.</p><p>In order to make this clearer we can click on the <strong>Area chart</strong> icon to change the visualization.</p><p><a href=#R-image-2ae8b08cfc008bffe38e326b13fccdbc class=lightbox-link><img alt="Area Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-8.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2ae8b08cfc008bffe38e326b13fccdbc><img alt="Area Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-8.png></a></p><p>We now can see when last weeks latency was higher!</p><p>Next, click into the field next to <strong>Time</strong> on the Override bar and choose <strong><code>Past Hour</code></strong> from the dropdown.</p><p><a href=#R-image-251c9b0cdb69dacd65e5a1670f094bf0 class=lightbox-link><img alt=Timeframe class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-9.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-251c9b0cdb69dacd65e5a1670f094bf0><img alt=Timeframe class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-9.png></a></p><hr><h2 id=4-using-formulas>4. Using Formulas</h2><p>Let&rsquo;s now plot the difference of all metric values for a day with 7 days in between.</p><p>Click on <span class="btn cstyle blue"><span><span class=title>Enter Formula</span></span></span>
then enter <strong><code>A-B</code></strong> (A minus B) and hide (deselect) all Signals using the eye, except <strong>C</strong>.</p><p><a href=#R-image-8206f272657d8ecdd185ba43f43e873a class=lightbox-link><img alt=Formulas class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Filter-11.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8206f272657d8ecdd185ba43f43e873a><img alt=Formulas class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Filter-11.png></a></p><p>We now see only the difference of all metric values of <strong>A</strong> and <strong>B</strong> being plotted. We see that we have some negative values on the plot because a metric value of <strong>B</strong> has some times larger value than the metric value of <strong>A</strong> at that time.</p><p>Lets look at the Signalflow that drives our Charts and Detectors!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=34-signalflow>3.4 SignalFlow</h1><h2 id=1-introduction>1. Introduction</h2><p>Let&rsquo;s take a look at SignalFlow - the analytics language of Observability Cloud that can be used to setup monitoring as code.</p><p>The heart of Splunk Infrastructure Monitoring is the SignalFlow analytics engine that runs computations written in a Python-like language. SignalFlow programs accept streaming input and produce output in real time. SignalFlow provides built-in analytical functions that take metric time series (MTS) as input, perform computations, and output a resulting MTS.</p><ul><li>Comparisons with historical norms, e.g. on a week-over-week basis</li><li>Population overviews using a distributed percentile chart</li><li>Detecting if the rate of change (or other metric expressed as a ratio, such as a service level objective) has exceeded a critical threshold</li><li>Finding correlated dimensions, e.g. to determine which service is most correlated with alerts for low disk space</li></ul><p>Infrastructure Monitoring creates these computations in the Chart Builder user interface, which lets you specify the input MTS to use and the analytical functions you want to apply to them. You can also run SignalFlow programs directly by using the <a href=https://dev.splunk.com/observability/docs/ rel=external target=_blank>SignalFlow API</a>.</p><p>SignalFlow includes a large library of built-in analytical functions that take a metric time series as an input, performs computations on its datapoints, and outputs time series that are the result of the computation.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>For more information on SignalFlow see <a href=https://docs.splunk.com/Observability/infrastructure/analytics/signalflow.html rel=external target=_blank>Analyze incoming data using SignalFlow</a>.</p></div></details><h2 id=2-view-signalflow>2. View SignalFlow</h2><p>In the chart builder, click on <strong>View SignalFlow</strong>.</p><p><a href=#R-image-f2d2beb80db7594923161f0ab4bd7f15 class=lightbox-link><img alt=SignalFlow class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/view-signalflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f2d2beb80db7594923161f0ab4bd7f15><img alt=SignalFlow class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/view-signalflow.png></a></p><p>You will see the SignalFlow code that composes the chart we were working on. You can now edit the SignalFlow directly within the UI. Our documentation has the <a href=https://dev.splunk.com/observability/docs/signalflow/function_method_list rel=external target=_blank>full list</a> of SignalFlow functions and methods.</p><p>Also, you can copy the SignalFlow and use it when interacting with the API or with Terraform to enable Monitoring as Code.</p><p><a href=#R-image-55523936c064f2d33da7f183fffb9033 class=lightbox-link><img alt=Code class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/show-signalflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-55523936c064f2d33da7f183fffb9033><img alt=Code class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/show-signalflow.png></a></p><div class=tab-panel data-tab-group=f1e3664e99fc722cd158b278c325a2ab><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=signalflow class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("f1e3664e99fc722cd158b278c325a2ab","signalflow")'>
<span class=tab-nav-text>SignalFlow</span></button></div><div class=tab-content-container><div data-tab-item=signalflow class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>data</span><span class=p>(</span><span class=s1>&#39;demo.trans.latency&#39;</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=nb>filter</span><span class=p>(</span><span class=s1>&#39;demo_datacenter&#39;</span><span class=p>,</span> <span class=s1>&#39;Paris&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=mi>95</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=n>enable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>B</span> <span class=o>=</span> <span class=n>data</span><span class=p>(</span><span class=s1>&#39;demo.trans.latency&#39;</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=nb>filter</span><span class=p>(</span><span class=s1>&#39;demo_datacenter&#39;</span><span class=p>,</span> <span class=s1>&#39;Paris&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=mi>95</span><span class=p>)</span><span class=o>.</span><span class=n>timeshift</span><span class=p>(</span><span class=s1>&#39;1w&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=n>enable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>C</span> <span class=o>=</span> <span class=p>(</span><span class=n>A</span><span class=o>-</span><span class=n>B</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;C&#39;</span><span class=p>)</span></span></span></code></pre></div></div></div></div></div><p>Click on <strong>View Builder</strong> to go back to the Chart <strong>Builder</strong> UI.</p><p><a href=#R-image-3b51cd2cff31890ffc81e569a6becc68 class=lightbox-link><img alt="View Builder" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/view-builder.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3b51cd2cff31890ffc81e569a6becc68><img alt="View Builder" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/view-builder.png></a></p><p>Let&rsquo;s save this new chart to our Dashboard!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=adding-charts-to-dashboards>Adding charts to dashboards</h1><h2 id=1-save-to-existing-dashboard>1. Save to existing dashboard</h2><p>Check that you have <strong>YOUR_NAME-Dashboard: YOUR_NAME-Dashboard</strong> in the top left corner. This means you chart will be saved in this Dashboard.</p><p>Name the Chart <strong>Latency History</strong> and add a Chart Description if you wish.</p><p><a href=#R-image-878a6ac2c095334ee408fa86cd4221d8 class=lightbox-link><img alt="Save Chart 1" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-MoreCharts-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-878a6ac2c095334ee408fa86cd4221d8><img alt="Save Chart 1" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-MoreCharts-1.png></a></p><p>Click on <span class="btn cstyle transparent"><span><span class=title>Save And Close</span></span></span>. This returns you to your dashboard that now has two charts!</p><p><a href=#R-image-638c2b49235878a8bdaa61e7f690350c class=lightbox-link><img alt="Save Chart 2" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-MoreCharts-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-638c2b49235878a8bdaa61e7f690350c><img alt="Save Chart 2" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-MoreCharts-2.png></a>
Now let&rsquo;s quickly add another Chart based on the previous one.</p><h2 id=2-copy-and-paste-a-chart>2. Copy and Paste a chart</h2><p>Click on the three dots <strong><code>...</code></strong> on the <strong>Latency History</strong> chart in your dashboard and then on <strong>Copy</strong>.</p><p><a href=#R-image-ab5147583f050e956d5a059ec7d0c0ee class=lightbox-link><img alt="Copy chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-MoreCharts-3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ab5147583f050e956d5a059ec7d0c0ee><img alt="Copy chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-MoreCharts-3.png></a></p><p>You see the chart being copied, and you should now have a red circle with a white 1 next to the <strong>+</strong> on the top left of the page.</p><p>Click on the plus icon the top of the page, and then in the menu on <em>Paste Charts</em> (There should also be a red dot with a 1 visible at the end of the line).</p><p><a href=#R-image-f13c5c4778680401320f935806223cfc class=lightbox-link><img alt="Past charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-MoreCharts-5.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f13c5c4778680401320f935806223cfc><img alt="Past charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-MoreCharts-5.png></a></p><p>This will place a copy of the previous chart in your dashboard.</p><p><a href=#R-image-541996fc678255dcec7286de5008f7fd class=lightbox-link><img alt="Three Dashboard" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-MoreCharts-6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-541996fc678255dcec7286de5008f7fd><img alt="Three Dashboard" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-MoreCharts-6.png></a></p><h2 id=3-edit-the-pasted-chart>3. Edit the pasted chart</h2><p>Click on the three dots <strong><code>...</code></strong> on one of the <strong>Latency History</strong> charts in your dashboard and then on <strong>Open</strong> (or you can click on the name of the chart which here is <strong>Latency History</strong>).</p><p>This will bring you to the editor environment again.</p><p>First set the time for the chart to -1 hour in the Time box at the top right of the chart. Then to make this a different chart, click on the eye icon in front of signal &ldquo;<em>A</em>&rdquo; to make it visible again, and then hide signal &ldquo;<em>C</em>&rdquo; via the eye icon and change the name for <em>Latency history</em> to <strong>Latency vs Load</strong>.</p><p><a href=#R-image-6f34881a382bbd6ff555125fc40fe5bf class=lightbox-link><img alt="Set Visibility" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-MoreCharts-7.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6f34881a382bbd6ff555125fc40fe5bf><img alt="Set Visibility" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-MoreCharts-7.png></a></p><p>Click on the <span class="btn cstyle blue"><span><span class=title>Add Metric Or Event</span></span></span> button. This will bring up the box for a new signal. Type and select <code>demo.trans.count</code> for Signal <strong>D</strong>.</p><p><a href=#R-image-fd6f234e16cd2bd6ccce3bff222baedc class=lightbox-link><img alt="Dashboard Info" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-MoreCharts-8.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fd6f234e16cd2bd6ccce3bff222baedc><img alt="Dashboard Info" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-MoreCharts-8.png></a></p><p>This will add a new Signal <strong>D</strong> to your chart, It shows the number of active requests. Add the filter for the <em>demo_datacenter:Paris</em>, then change the Rollup type by clicking on the <strong>Configure Plot</strong> button and changing the roll-up from <strong>Auto (Delta)</strong> to <strong>Rate/sec</strong>. Change the name from <strong>demo.trans.count</strong> to <strong>Latency vs Load</strong>.</p><p><a href=#R-image-03d8fea2bed11f4e2d642a72deb08863 class=lightbox-link><img alt="rollup change" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-MoreCharts-9.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-03d8fea2bed11f4e2d642a72deb08863><img alt="rollup change" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-MoreCharts-9.png></a></p><p>Finally press the <span class="btn cstyle transparent"><span><span class=title>Save And Close</span></span></span> button. This returns you to your dashboard that now has three different charts!</p><p><a href=#R-image-a33de8a0dc18b7c7ddc9ef26373ef477 class=lightbox-link><img alt="three charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-MoreCharts-10.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a33de8a0dc18b7c7ddc9ef26373ef477><img alt="three charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-MoreCharts-10.png></a></p><p>Let&rsquo;s add an &ldquo;instruction&rdquo; note and arrange the charts!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=adding-notes-and-dashboard-layout>Adding Notes and Dashboard Layout</h1><h2 id=1-adding-notes>1. Adding Notes</h2><p>Often on dashboards it makes sense to place a short &ldquo;instruction&rdquo; pane that helps users of a dashboard. Lets add one now by clicking on the <span class="btn cstyle white"><span><span class=title>New Text Note</span></span></span>
Button.</p><p><a href=#R-image-8200ffe7681130d78b581350319b9361 class=lightbox-link><img alt="three charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Notes-0.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8200ffe7681130d78b581350319b9361><img alt="three charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Notes-0.png></a></p><p>This will open the notes editor.</p><p><a href=#R-image-adb556e5d4fe9fddce428721997ed3cb class=lightbox-link><img alt="Notes 1" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Notes-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-adb556e5d4fe9fddce428721997ed3cb><img alt="Notes 1" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Notes-1.png></a></p><p>To allow you to add more then just text to you notes, Splunk is allowing you to use Markdown in these notes/panes.
Markdown is a lightweight markup language for creating formatted text using plain-text often used in Webpages.</p><p>This includes (but not limited to):</p><ul><li>Headers. (in various sizes)</li><li>Emphasis styles.</li><li>Lists and Tables.</li><li>Links. These can be external webpages (for documentation for example) or directly to other Splunk IM Dashboards</li></ul><p>Below is an example of above Markdown options you can use in your note.</p><div class=tab-panel data-tab-group=3f0ea7591ed14004f2ea0c8f9a1573d9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=sample-markdown-text class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("3f0ea7591ed14004f2ea0c8f9a1573d9","sample-markdown-text")'>
<span class=tab-nav-text>Sample Markdown text</span></button></div><div class=tab-content-container><div data-tab-item=sample-markdown-text class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># h1 Big headings
</span></span></span><span class=line><span class=cl><span class=gh></span>
</span></span><span class=line><span class=cl><span class=gu>###### h6 To small headings
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl><span class=gu>##### Emphasis
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl><span class=gs>**This is bold text**</span>, <span class=ge>*This is italic text*</span> , <span class=gd>~~Strikethrough~~</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>##### Lists
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>Unordered
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>+ Create a list by starting a line with <span class=sb>`+`</span>, <span class=sb>`-`</span>, or <span class=sb>`*`</span>
</span></span><span class=line><span class=cl><span class=k>-</span> Sub-lists are made by indenting 2 spaces:
</span></span><span class=line><span class=cl><span class=k>-</span> Marker character change forces new list start:
</span></span><span class=line><span class=cl>    <span class=k>*</span> Ac tristique libero volutpat at
</span></span><span class=line><span class=cl>    + Facilisis in pretium nisl aliquet
</span></span><span class=line><span class=cl><span class=k>*</span> Very easy!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ordered
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>1.</span> Lorem ipsum dolor sit amet
</span></span><span class=line><span class=cl><span class=k>2.</span> Consectetur adipiscing elit
</span></span><span class=line><span class=cl><span class=k>3.</span> Integer molestie lorem at massa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>##### Tables
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>| Option | Description |
</span></span><span class=line><span class=cl>| ------ | ----------- |
</span></span><span class=line><span class=cl>| chart  | path to data files to supply the data that will be passed into templates. |
</span></span><span class=line><span class=cl>| engine | engine to be used for processing templates. Handlebars is the default. |
</span></span><span class=line><span class=cl>| ext    | extension to be used for dest files. |
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>#### Links
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>[<span class=nt>link to webpage</span>](<span class=na>https://www.splunk.com</span>)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[<span class=nt>link to dashboard with title</span>](<span class=na>https://app.eu0.signalfx.com/#/dashboard/EaJHrbPAEAA?groupId=EaJHgrsAIAA&amp;configId=EaJHsHzAEAA &#34;Link to the Sample chart Dashboard!&#34;</span>)</span></span></code></pre></div></div></div></div></div><p>Copy the above by using the copy button and paste it in the <em>Edit</em> box.
the preview will show you how it will look.</p><hr><h2 id=2-saving-our-chart>2. Saving our chart</h2><p>Give the Note chart a name, in our example we used <em>Example text chart</em>, then press the <span class="btn cstyle transparent"><span><span class=title>Save And Close</span></span></span> Button.</p><p><a href=#R-image-8cd64ba519a37e3f714aab07021c05b1 class=lightbox-link><img alt="saving note" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Notes-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8cd64ba519a37e3f714aab07021c05b1><img alt="saving note" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Notes-2.png></a></p><p>This will bring you back to you Dashboard, that now includes the note.</p><p><a href=#R-image-5d0b5579398f24ee69efd37fe3c79698 class=lightbox-link><img alt="three charts and note" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Notes-3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d0b5579398f24ee69efd37fe3c79698><img alt="three charts and note" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Notes-3.png></a></p><hr><h2 id=3-ordering--sizing-of-charts>3. Ordering & sizing of charts</h2><p>If you do not like the default order and sizes of your charts you can simply use window dragging technique to move and size them to the desired location.</p><p>Grab the <strong>top</strong> border of a chart and you should see the mouse pointer change to a drag icon (see picture below).</p><p><a href=#R-image-33f7300a64d4afa2d60cdf189af289ce class=lightbox-link><img alt="dragging charts" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Notes-4.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-33f7300a64d4afa2d60cdf189af289ce><img alt="dragging charts" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Notes-4.png></a></p><p>Now drag the <strong>Latency vs Load</strong> chart to sit between the <strong>Latency History</strong> Chart and the <strong>Example text chart</strong>.</p><p><a href=#R-image-119bd9ecdda2adb31e3e9b36187300ab class=lightbox-link><img alt=sizing class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Notes-5.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-119bd9ecdda2adb31e3e9b36187300ab><img alt=sizing class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Notes-5.png></a></p><p>You can also resize windows by dragging from the left, right and bottom edges.</p><p>As a last exercise reduce the width of the note chart to about a third of the other charts. The chart will automatically snap to one of the sizes it supports. Widen the 3 other charts to about a third of the Dashboard. Drag the notes to the right of the others and resize it to match it to the 3 others. Set the <strong>Time</strong> to <strong>-1h</strong> and you should have the following dashboard!</p><p><a href=#R-image-982dfc66c25608d35495bbd0a99dc8b3 class=lightbox-link><img alt=TaDA! class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/M-Notes-6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-982dfc66c25608d35495bbd0a99dc8b3><img alt=TaDA! class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/M-Notes-6.png></a></p><p>On to Detectors!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=working-with-detectors>Working with Detectors</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<ul><li>Create a Detector from one of your charts</li><li>Setting Alert conditions</li><li>Running a pre-flight check</li><li>Working with muting rules</li></ul><hr><h2 id=1-introduction>1. Introduction</h2><p>Splunk Observability Cloud uses detectors, events, alerts, and notifications to keep you informed when certain criteria are met. For example, you might want a message sent to a Slack channel or an email address for the Ops team when CPU Utilization has reached 95%, or when the number of concurrent users is approaching a limit that might require you to spin up an additional AWS instance.</p><p>These conditions are expressed as one or more rules that trigger an alert when the conditions in the rules are met. Individual rules in a detector are labeled according to criticality: Info, Warning, Minor, Major, and Critical.</p><h2 id=2-creating-a-detector>2. Creating a Detector</h2><p>In <strong>Dashboards</strong> click on your <strong>Custom Dashboard Group</strong> (that you created in the previous module) and then click on the dashboard name.</p><p><a href=#R-image-d65d3d36ba83d559694ad64ccced4481 class=lightbox-link><img alt="Custom Dashboard Group" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/custom-dashboard-group.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d65d3d36ba83d559694ad64ccced4481><img alt="Custom Dashboard Group" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/custom-dashboard-group.png></a></p><p>We are now going to create a new detector from a chart on this dashboard. Click on the bell icon on the <strong>Latency vs Load</strong> chart, and then click <strong>New Detector From Chart</strong>.</p><p><a href=#R-image-04a44675cd26111c13bc0158ef58c24b class=lightbox-link><img alt="New Detector" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/new-detector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-04a44675cd26111c13bc0158ef58c24b><img alt="New Detector" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/new-detector.png></a></p><p>In the text field next to <strong>Detector Name</strong>, <strong>ADD YOUR INITIALS</strong> before the proposed detector name.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Naming the detector</summary><div class=box-content><p>It&rsquo;s important that you add your initials in front of the proposed detector name.</p><p>It should be something like this: <strong>XYZ&rsquo;s Latency Chart Detector</strong>.</p></div></details><p>Click on <span class="btn cstyle blue"><span><span class=title>Create Alert Rule</span></span></span></p><p><a href=#R-image-b83bd6cbb1bb1abe828861a10d1fbeac class=lightbox-link><img alt="Create Alert Rule" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/create-alert-rule.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b83bd6cbb1bb1abe828861a10d1fbeac><img alt="Create Alert Rule" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/create-alert-rule.png></a></p><p>In the Detector window, inside <strong>Alert signal</strong>, the Signal we will alert on is marked with a (blue) bell in the <strong>Alert on</strong> column. The bell indicates which Signal is being used to generate the alert.</p><p>Click on <span class="btn cstyle blue"><span><span class=title>Proceed to Alert Condition</span></span></span></p><p><a href=#R-image-5369e7207bdadd5a46b530ce2655a808 class=lightbox-link><img alt="Alert Signal" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/alert-signal.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5369e7207bdadd5a46b530ce2655a808><img alt="Alert Signal" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/alert-signal.png></a></p><h2 id=3-setting-alert-condition>3. Setting Alert condition</h2><p>In <strong>Alert condition</strong>, click on <strong>Static Threshold</strong> and then on <span class="btn cstyle blue"><span><span class=title>Proceed to Alert Settings</span></span></span></p><p><a href=#R-image-9de83bf3e3406d2d1b91dffdc68a3ca0 class=lightbox-link><img alt="Alert Condition" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/alert-condition.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9de83bf3e3406d2d1b91dffdc68a3ca0><img alt="Alert Condition" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/alert-condition.png></a></p><p>In <strong>Alert Settings</strong>, enter the value <strong><code>290</code></strong> in the <strong>Threshold</strong> field. In the same window change <strong>Time</strong> on top right to past day (<strong>-1d</strong>).</p><hr><h2 id=4-alert-pre-flight-check>4. Alert pre-flight check</h2><p>A pre-flight check will take place after 5 seconds. See the <strong>Estimated alert count</strong>. Based on the current alert settings, the amount of alerts we would have received in 1 day would have been <strong>3</strong>.</p><p><a href=#R-image-c04135d67182747bd1f9f6ca13501bde class=lightbox-link><img alt="Alert Threshold" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/alert-threshold.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c04135d67182747bd1f9f6ca13501bde><img alt="Alert Threshold" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/alert-threshold.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
About pre-flight checks</summary><div class=box-content><p>Once you set an alert condition, the UI estimates how many alerts you might get based on the current settings, and in the timeframe set on the upper right corner - in this case, the past day.</p><p>Immediately, the platform will start analyzing the signals with the current settings, and perform something we call a Pre-flight Check. This enables you to test the alert conditions using the historical data in the platform, to ensure the settings are logical and will not inadvertently generate an alert storm, removing the guesswork from configuring alerts in a simple but very powerful way, only available using the Splunk Observability Cloud.</p><p>To read more about detector previewing, please visit this link
<a href=https://docs.splunk.com/Observability/alerts-detectors-notifications/preview-detector-alerts.html#nav-Preview-detector-alerts rel=external target=_blank>Preview detector alerts.</a></p></div></details><p>Click on <span class="btn cstyle blue"><span><span class=title>Proceed to Alert Message</span></span></span></p><hr><h2 id=5-alert-message>5. Alert message</h2><p>In <strong>Alert message</strong>, under <strong>Severity</strong> choose <strong>Major</strong>.</p><p><a href=#R-image-2e49a45f3bdc7ea5cfe6dc676cf44a34 class=lightbox-link><img alt="Alert Message" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/alert-message.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2e49a45f3bdc7ea5cfe6dc676cf44a34><img alt="Alert Message" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/alert-message.png></a></p><p>Click on <span class="btn cstyle blue"><span><span class=title>Proceed to Alert Recipients</span></span></span></p><p>Click on <strong>Add Recipient</strong> and then on your email address displayed as the first option.</p><p><a href=#R-image-d1300abe802c41abfee33022b1364ab2 class=lightbox-link><img alt="Add Recipient" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/add-recipient.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d1300abe802c41abfee33022b1364ab2><img alt="Add Recipient" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/add-recipient.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Notification Services</summary><div class=box-content><p>That&rsquo;s the same as entering that email address OR you can enter another email address by clicking on <strong>E-mail&mldr;</strong>.</p><p>This is just one example of the many <strong>Notification Services</strong> the platform has available. You can check this out by going to the <strong>Integrations</strong> tab of the top menu, and see <strong>Notification Services</strong>.</p></div></details><hr><h2 id=6-alert-activation>6. Alert Activation</h2><p>Click on <span class="btn cstyle blue"><span><span class=title>Proceed to Alert Activation</span></span></span></p><p>In <strong>Activate&mldr;</strong> click on <span class="btn cstyle blue"><span><span class=title>Activate Alert Rule</span></span></span></p><p><a href=#R-image-c903e250f52582bd48c39d0d8d72f2e3 class=lightbox-link><img alt="Activate Alert" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/activate-alert.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c903e250f52582bd48c39d0d8d72f2e3><img alt="Activate Alert" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/activate-alert.png></a></p><p>If you want to get alerts quicker you edit the rule and lower the value from <strong><code>290</code></strong> to say <strong><code>280</code></strong>.</p><p>If you change the <strong>Time</strong> to <strong>-1h</strong> you can see how many alerts you might get with the threshold you have chosen based on the metrics from the last 1 hour.</p><p>Click on the <a href=#R-image-d0669bc60f3813e6a7de27a42ef102f9 class=lightbox-link><img alt="alerts and detectors button" class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../images/alerts-and-detectors.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d0669bc60f3813e6a7de27a42ef102f9><img alt="alerts and detectors button" class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../images/alerts-and-detectors.png?classes=inline&height=25px"></a> in the navbar and then click on <strong>Detectors</strong>. You can optionally filter for your initials. You will see you detector listed here. If you don&rsquo;t then please refresh your browser.</p><p><a href=#R-image-0e0a3d6fd8e7282c6923c0c4440594a1 class=lightbox-link><img alt="Detector List" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/detectors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0e0a3d6fd8e7282c6923c0c4440594a1><img alt="Detector List" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/detectors.png></a></p><p><strong>Congratulations</strong>! You have created your first detector and activated it!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 4. Detectors</h1><article class=default><header class=headline></header><h1 id=working-with-muting-rules>Working with Muting Rules</h1><ul><li>Learn how to configure Muting Rules</li><li>Learn how to resume notifications</li></ul><hr><h2 id=1-configuring-muting-rules>1. Configuring Muting Rules</h2><p>There will be times when you might want to mute certain notifications. For example, if you want to schedule downtime for maintenance on a server or set of servers, or if you are testing new code or settings etc. For that you can use muting rules in Splunk Observability Cloud. Let&rsquo;s create one!</p><p>Click on <strong>Alerts & Detectors</strong> in the sidebar and then click <strong>Detectors</strong> to see the list of active detectors.</p><p><a href=#R-image-714c5f63ffb0e06a6e5e1d60d2b44c92 class=lightbox-link><img alt="detectors list" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/detectors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-714c5f63ffb0e06a6e5e1d60d2b44c92><img alt="detectors list" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/detectors.png></a></p><p>If you created a detector in <strong>Creating a Detector</strong> you can click on the three dots <strong><code>...</code></strong> on the far right for that detector; if not, do that for another detector.</p><p>From the drop-down click on <strong>Create Muting Rule&mldr;</strong></p><p><a href=#R-image-ccbd434686ffaed027d51e216494743b class=lightbox-link><img alt="Create Muting Rule" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/create-muting-rule.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ccbd434686ffaed027d51e216494743b><img alt="Create Muting Rule" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/create-muting-rule.png></a></p><p>In the <strong>Muting Rule</strong> window check <strong>Mute Indefinitely</strong> and enter a reason.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Important</summary><div class=box-content><p>This will mute the notifications permanently until you come back here and un-check this box or resume notifications for this detector.</p></div></details><p><a href=#R-image-443bc2e917ccd276277ee51c298ba2fb class=lightbox-link><img alt="Mute Indefinitely" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/mute-indefinitely.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-443bc2e917ccd276277ee51c298ba2fb><img alt="Mute Indefinitely" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/mute-indefinitely.png></a></p><p>Click <strong>Next</strong> and in the new modal window confirm the muting rule setup.</p><p><a href=#R-image-5700ac451322b1de4081d2189f43b93a class=lightbox-link><img alt="Confirm Rule" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/confirm-rule.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5700ac451322b1de4081d2189f43b93a><img alt="Confirm Rule" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/confirm-rule.png></a></p><p>Click on <span class="btn cstyle blue"><span><span class=title>Mute Indefinitely</span></span></span> to confirm.</p><p><a href=#R-image-f5b4b28e612b6d9d69f705b705551f11 class=lightbox-link><img alt="List muted rule" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/alert-muted.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f5b4b28e612b6d9d69f705b705551f11><img alt="List muted rule" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/alert-muted.png></a></p><p>You won&rsquo;t be receiving any email notifications from your detector until you resume notifications again. Let&rsquo;s now see how to do that!</p><hr><h2 id=2-resuming-notifications>2. Resuming notifications</h2><p>To Resume notifications, click on <strong>Muting Rules</strong>, you will see the name of the detector you muted notifications for under <strong>Detector</strong> heading.</p><p>Click on the thee dots <strong><code>...</code></strong> on the far right, and click on <strong>Resume Notifications</strong>.</p><p><a href=#R-image-c2749ab567a87ec5615815527a4a0bc7 class=lightbox-link><img alt=Resume class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/muting-list.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c2749ab567a87ec5615815527a4a0bc7><img alt=Resume class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/muting-list.png></a></p><p>Click on <span class="btn cstyle blue"><span><span class=title>Resume</span></span></span> to confirm and resume notifications for this detector.</p><p><a href=#R-image-975225a1f74fa6f9719b79e19c600be3 class=lightbox-link><img alt=Resume class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/resume.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-975225a1f74fa6f9719b79e19c600be3><img alt=Resume class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/resume.png></a></p><p><strong>Congratulations!</strong> You have now resumed your alert notifications!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=monitoring-as-code>Monitoring as Code</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<ul><li>Use Terraform<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> to manage Observability Cloud Dashboards and Detectors</li><li>Initialize the Terraform Splunk Provider<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</li><li>Run Terraform to create detectors and dashboards from code using the Splunk Terraform Provider.</li><li>See how Terraform can also delete detectors and dashboards.</li></ul><hr><h2 id=1-initial-setup>1. Initial setup</h2><p>Monitoring as code adopts the same approach as infrastructure as code. You can manage monitoring the same way you do applications, servers, or other infrastructure components.</p><p>You can use monitoring as code to build out your visualizations, what to monitor, and when to alert, among other things. This means your monitoring setup, processes, and rules can be versioned, shared, and reused.</p><p>Full documentation for the Splunk Terraform Provider is available <a href=https://registry.terraform.io/providers/splunk-terraform/signalfx/latest/docs rel=external target=_blank><strong>here</strong></a>.</p><p>Remaining in your AWS/EC2 instance, change into the <code>o11y-cloud-jumpstart</code> directory</p><div class=tab-panel data-tab-group=d622c2736e1b1f83aa55b9b101f8758e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=change-directory class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("d622c2736e1b1f83aa55b9b101f8758e","change-directory")'>
<span class=tab-nav-text>Change directory</span></button></div><div class=tab-content-container><div data-tab-item=change-directory class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/observability-content-contrib/integration-examples/terraform-jumpstart</span></span></code></pre></div></div></div></div></div><p>Initialize Terraform and upgrade to the latest version of the Splunk Terraform Provider.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note: Upgrading the SignalFx Terraform Provider</summary><div class=box-content><p>You will need to run the command below each time a new version of the Splunk Terraform Provider is released. You can track the releases on <a href=https://github.com/splunk-terraform/terraform-provider-signalfx/releases rel=external target=_blank>GitHub.</a></p></div></details><div class=tab-panel data-tab-group=2a61b753228f6b4f6e452ea5879f0c3c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=initialise-terraform class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2a61b753228f6b4f6e452ea5879f0c3c","initialise-terraform")'>
<span class=tab-nav-text>Initialise Terraform</span>
</button>
<button data-tab-item=initialise-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2a61b753228f6b4f6e452ea5879f0c3c","initialise-output")'>
<span class=tab-nav-text>Initialise Output</span></button></div><div class=tab-content-container><div data-tab-item=initialise-terraform class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform init -upgrade</span></span></code></pre></div></div></div><div data-tab-item=initialise-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>    Upgrading modules...
</span></span><span class=line><span class=cl>    - aws in modules/aws
</span></span><span class=line><span class=cl>    - azure in modules/azure
</span></span><span class=line><span class=cl>    - docker in modules/docker
</span></span><span class=line><span class=cl>    - gcp in modules/gcp
</span></span><span class=line><span class=cl>    - host in modules/host
</span></span><span class=line><span class=cl>    - kafka in modules/kafka
</span></span><span class=line><span class=cl>    - kubernetes in modules/kubernetes
</span></span><span class=line><span class=cl>    - parent_child_dashboard in modules/dashboards/parent
</span></span><span class=line><span class=cl>    - pivotal in modules/pivotal
</span></span><span class=line><span class=cl>    - rum_and_synthetics_dashboard in modules/dashboards/rum_and_synthetics
</span></span><span class=line><span class=cl>    - usage_dashboard in modules/dashboards/usage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Initializing the backend...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Initializing provider plugins...
</span></span><span class=line><span class=cl>    - Finding latest version of splunk-terraform/signalfx...
</span></span><span class=line><span class=cl>    - Installing splunk-terraform/signalfx v6.20.0...
</span></span><span class=line><span class=cl>    - Installed splunk-terraform/signalfx v6.20.0 (self-signed, key ID CE97B6074989F138)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Partner and community providers are signed by their developers.
</span></span><span class=line><span class=cl>    If you&#39;d like to know more about provider signing, you can read about it here:
</span></span><span class=line><span class=cl>    https://www.terraform.io/docs/cli/plugins/signing.html
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Terraform has created a lock file .terraform.lock.hcl to record the provider
</span></span><span class=line><span class=cl>    selections it made above. Include this file in your version control repository
</span></span><span class=line><span class=cl>    so that Terraform can guarantee to make the same selections by default when
</span></span><span class=line><span class=cl>    you run &#34;terraform init&#34; in the future.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Terraform has been successfully initialized!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    You may now begin working with Terraform. Try running &#34;terraform plan&#34; to see
</span></span><span class=line><span class=cl>    any changes that are required for your infrastructure. All Terraform commands
</span></span><span class=line><span class=cl>    should now work.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    If you ever set or change modules or backend configuration for Terraform,
</span></span><span class=line><span class=cl>    rerun this command to reinitialize your working directory. If you forget, other
</span></span><span class=line><span class=cl>    commands will detect it and remind you to do so if necessary.</span></span></code></pre></div></div></div></div></div><h2 id=2-create-execution-plan>2. Create execution plan</h2><p>The <code>terraform plan</code> command creates an execution plan. By default, creating a plan consists of:</p><ul><li>Reading the current state of any already-existing remote objects to make sure that the Terraform state is up-to-date.</li><li>Comparing the current configuration to the prior state and noting any differences.</li><li>Proposing a set of change actions that should, if applied, make the remote objects match the configuration.</li></ul><p>The plan command alone will not actually carry out the proposed changes, and so you can use this command to check whether the proposed changes match what you expected before you apply the changes</p><div class=tab-panel data-tab-group=f2506f1b8f6a8cceeb277449c93f47e7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=execution-plan class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("f2506f1b8f6a8cceeb277449c93f47e7","execution-plan")'>
<span class=tab-nav-text>Execution Plan</span>
</button>
<button data-tab-item=execution-plan-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("f2506f1b8f6a8cceeb277449c93f47e7","execution-plan-output")'>
<span class=tab-nav-text>Execution Plan Output</span></button></div><div class=tab-content-container><div data-tab-item=execution-plan class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform plan -var<span class=o>=</span><span class=s2>&#34;api_token=</span><span class=nv>$API_TOKEN</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;o11y_prefix=[</span><span class=nv>$INSTANCE</span><span class=s2>]&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=execution-plan-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Plan: 146 to add, 0 to change, 0 to destroy.</span></span></code></pre></div></div></div></div></div><p>If the plan executes successfully, we can go ahead and apply:</p><hr><h2 id=3-apply-execution-plan>3. Apply execution plan</h2><p>The <code>terraform apply</code> command executes the actions proposed in the Terraform plan above.</p><p>The most straightforward way to use <code>terraform apply</code> is to run it without any arguments at all, in which case it will automatically create a new execution plan (as if you had run terraform plan) and then prompt you to provide the API Token, Realm (the prefix defaults to <code>Splunk</code>) and approve the plan, before taking the indicated actions.</p><p>Due to this being a workshop it is required that the prefix is to be unique so you need to run the <code>terraform apply</code> below.</p><div class=tab-panel data-tab-group=4e2f167616c3112bdf59ea7cd97640fb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=apply-plan class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("4e2f167616c3112bdf59ea7cd97640fb","apply-plan")'>
<span class=tab-nav-text>Apply Plan</span>
</button>
<button data-tab-item=apply-plan-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("4e2f167616c3112bdf59ea7cd97640fb","apply-plan-output")'>
<span class=tab-nav-text>Apply Plan Output</span></button></div><div class=tab-content-container><div data-tab-item=apply-plan class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform apply -var<span class=o>=</span><span class=s2>&#34;api_token=</span><span class=nv>$API_TOKEN</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;o11y_prefix=[</span><span class=nv>$INSTANCE</span><span class=s2>]&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=apply-plan-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Apply complete! Resources: 146 added, 0 changed, 0 destroyed.</span></span></code></pre></div></div></div></div></div><p>Once the apply has been completed, validate that the detectors were created, under the <strong>Alerts & Detectors</strong> and click on the <strong>Detectors</strong> tab. They will be prefixed by the instance name. To check the prefix value run:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$INSTANCE</span></span></span></code></pre></div><p>You will see a list of the new detectors and you can search for the prefix that was output from above.</p><p><a href=#R-image-53ae6839bc13229e440feaa0a7f7bb6d class=lightbox-link><img alt=Detectors class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/detectors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-53ae6839bc13229e440feaa0a7f7bb6d><img alt=Detectors class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/detectors.png></a></p><h2 id=3-destroy-all-your-hard-work>3. Destroy all your hard work</h2><p>The <code>terraform destroy</code> command is a convenient way to destroy all remote objects managed by your Terraform configuration.</p><p>While you will typically not want to destroy long-lived objects in a production environment, Terraform is sometimes used to manage ephemeral infrastructure for development purposes, in which case you can use <code>terraform destroy</code> to conveniently clean up all of those temporary objects once you are finished with your work.</p><p>Now go and destroy all the Detectors and Dashboards that were previously applied!</p><div class=tab-panel data-tab-group=4eb54ae11bc59d1db9e954de728f3cac><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=destroy class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("4eb54ae11bc59d1db9e954de728f3cac","destroy")'>
<span class=tab-nav-text>Destroy</span>
</button>
<button data-tab-item=destroy-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("4eb54ae11bc59d1db9e954de728f3cac","destroy-output")'>
<span class=tab-nav-text>Destroy Output</span></button></div><div class=tab-content-container><div data-tab-item=destroy class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform destroy -var<span class=o>=</span><span class=s2>&#34;api_token=</span><span class=nv>$API_TOKEN</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=destroy-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Destroy complete! Resources: 146 destroyed.</span></span></code></pre></div></div></div></div></div><p>Validate all the detectors have been removed by navigating to <em><strong>Alerts → Detectors</strong></em></p><p><a href=#R-image-4f3f30e74d8cfbd7c6e713e9783a591a class=lightbox-link><img alt=Destroyed class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/destroy.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4f3f30e74d8cfbd7c6e713e9783a591a><img alt=Destroyed class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/destroy.png></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Terraform is a tool for building, changing, and versioning infrastructure safely and efficiently. Terraform can manage existing and popular service providers as well as custom in-house solutions.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>A provider is responsible for understanding API interactions and exposing resources. Providers generally are an IaaS (e.g. Alibaba Cloud, AWS, GCP, Microsoft Azure, OpenStack), PaaS (e.g. Heroku), or SaaS services (e.g. Splunk, Terraform Cloud, DNSimple, Cloudflare).&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=service-bureau>Service Bureau</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<ul><li>How to keep track of the usage of Observability Cloud in your organization</li><li>Learn how to keep track of spend by exploring the Subscription Usage interface</li><li>Creating Teams</li><li>Adding notification rules to Teams</li><li>Controlling usage</li></ul><hr><h2 id=1-understanding-engagement>1. Understanding engagement</h2><p>To fully understand Observability Cloud engagement inside your organization, click on the <strong>&#187;</strong> bottom left and select the <strong>Settings → Organization Overview</strong>, this will provide you with the following dashboards that show you how your Observability Cloud organization is being used:</p><p><a href=#R-image-d507293a98350664011693cf88b28fb4 class=lightbox-link><img alt="Organization Overview" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/engagement.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d507293a98350664011693cf88b28fb4><img alt="Organization Overview" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/engagement.png></a></p><p>You will see various dashboards such as Throttling, System Limits, Entitlements & Engagement. The workshop organization you&rsquo;re using now may have less data to work with as this is cleared down after each workshop.</p><p>Take a minute to explore the various dashboards and charts in the Organization Overview of this workshop instance.</p><h2 id=2-subscription-usage>2. Subscription Usage</h2><p>If you want to see what your usage is against your subscription you can select <strong>Subscription Usage</strong>.</p><p><a href=#R-image-411d75a60dffe8a67966f658171908f9 class=lightbox-link><img alt="Left pane" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/billing-and-usage-menu.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-411d75a60dffe8a67966f658171908f9><img alt="Left pane" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/billing-and-usage-menu.png></a></p><p>This screen may take a few seconds to load whilst it calculates and pulls in the usage.</p><h2 id=3-understanding-usage>3. Understanding usage</h2><p>You will see a screen similar to the one below that will give you an overview of the current usage, the average usage and your entitlement per category: Hosts, Containers, Custom Metrics and High Resolution Metrics.</p><p>For more information about these categories please refer to <a href=https://docs.splunk.com/Observability/admin/monitor-imm-billing-usage.html rel=external target=_blank>Monitor Splunk Infrastructure Monitoring subscription usage</a>.</p><p><a href=#R-image-000c1da528b659a32dad04e7e2d322b6 class=lightbox-link><img alt="Billing and Usage" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/usage-charts.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-000c1da528b659a32dad04e7e2d322b6><img alt="Billing and Usage" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/usage-charts.png></a></p><hr><h2 id=4-examine-usage-in-detail>4. Examine usage in detail</h2><p>The top chart shows you the current subscription levels per category (shown by the red arrows at the top in the screenshot below).</p><p>Also, your current usage of the four categories is displayed (shown in the red lines at the bottom of the chart).</p><p>In this example, you can see that there are 25 Hosts, 0 Containers, 100 Custom Metrics and 0 High Resolution Metrics.</p><p><a href=#R-image-14a83769d71b81f63e94db43a3ca03de class=lightbox-link><img alt="Billing and Usage-top" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/usage-detail.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-14a83769d71b81f63e94db43a3ca03de><img alt="Billing and Usage-top" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/usage-detail.png></a></p><p>In the bottom chart, you can see the usage per category for the current period (shown in the drop-down box on the top right of the chart).</p><p>The blue line marked <strong>Average Usage</strong> indicates what Observability Cloud will use to calculate your average usage for the current Subscription Usage Period.</p><p><a href=#R-image-c7c3fedcaaced185d0d4a1acfc3a89ad class=lightbox-link><img alt="Billing and Usage-Bottom" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/usage-trends.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c7c3fedcaaced185d0d4a1acfc3a89ad><img alt="Billing and Usage-Bottom" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/usage-trends.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>As you can see from the screenshot, Observability Cloud does not use High Watermark or P95% for cost calculation but the actual average hourly usage, allowing you to do performance testing or Blue/Green style deployments etc. without the risk of overage charges.</p></div></details><p>To get a feel for the options you can change the metric displayed by selecting the different options from the <strong>Usage Metric</strong> drop-down on the left, or change the <strong>Subscription Usage Period</strong> with the drop-down on the right.</p><p>Please take a minute to explore the different time periods & categories and their views.</p><p>Finally, the pane on the right shows you information about your Subscription.</p><p><a href=#R-image-978f1a3feadd71a4958c80fe033d9ce0 class=lightbox-link><img alt="Billing and Usage-Pane" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/subscription.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-978f1a3feadd71a4958c80fe033d9ce0><img alt="Billing and Usage-Pane" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/subscription.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 6. Service Bureau</h1><article class=default><header class=headline></header><h1 id=teams>Teams</h1><ul><li>Introduction to Teams</li><li>Create a Team and add members to the Team</li></ul><hr><h2 id=1-introduction-to-teams>1. Introduction to Teams</h2><p>To make sure that users see the dashboards and alerts that are relevant to them when using Observability Cloud, most organizations will use Observability Cloud&rsquo;s Teams feature to assign a member to one or more Teams.</p><p>Ideally, this matches work-related roles, for example, members of a Dev-Ops or Product Management group would be assigned to the corresponding Teams in Observability Cloud.</p><p>When a user logs into Observability Cloud, they can choose which Team Dashboard will be their home page and they will typically select the page for their primary role.</p><p>In the example below, the user is a member of the Development, Operations and Product Management Teams, and is currently viewing the Dashboard for the Operations Team.</p><p>This Dashboard has specific Dashboard Groups for Usage, SaaS and APM Business Workflows assigned but any Dashboard Group can be linked to a Teams Dashboard.</p><p>They can use the menu along the top left to quickly navigate between their allocated teams, or they can use the <strong>ALL TEAMS</strong> dropdown on the right to select specific Team Dashboards, as well as quickly access <strong>ALL Dashboards</strong>** using the adjacent link.</p><p><a href=#R-image-e9dd276f6ad49c1418a96faa81dc7056 class=lightbox-link><img alt=Teams class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/teams-homepage.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e9dd276f6ad49c1418a96faa81dc7056><img alt=Teams class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/teams-homepage.png></a></p><p>Alerts can be linked to specific Teams so the Team can monitor only the Alerts they are interested in, and in the above example, they currently have 1 active Critical Alert.</p><p>The Description for the Team Dashboard can be customized and can include links to team-specific resources (using Markdown).</p><hr><h2 id=2-creating-a-new-team>2. Creating a new Team</h2><p>To work with Splunk&rsquo;s Team UI click on the hamburger icon top left and select the <strong>Organizations Settings → Teams</strong>.</p><p>When the <strong>Team</strong> UI is selected you will be presented with the list of current Teams.</p><p>To add a new <strong>Team</strong> click on the <span class="btn cstyle blue"><span><span class=title>Create New Team</span></span></span> button. This will present you with the <strong>Create New Team</strong> dialog.</p><p><a href=#R-image-aceddeb53133584fc62f49af0e2cdf24 class=lightbox-link><img alt="Add Team" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/create-new-team.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aceddeb53133584fc62f49af0e2cdf24><img alt="Add Team" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/create-new-team.png></a></p><p>Create your own team by naming it <code>[YOUR-INITIALS]-Team and</code> add yourself by searching for your name and selecting the <strong>Add</strong> link next to your name. This should result in a dialog similar to the one below:</p><p><a href=#R-image-ef1bb609374b27e411429b20b6907e37 class=lightbox-link><img alt="Add Team complete" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/add-to-team.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ef1bb609374b27e411429b20b6907e37><img alt="Add Team complete" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/add-to-team.png></a></p><p>You can remove selected users by pressing <strong>Remove</strong> or the small <strong>x</strong>.</p><p>Make sure you have your group created with your initials and with yourself added as a member, then click <span class="btn cstyle blue"><span><span class=title>Done</span></span></span></p><p>This will bring you back to the <strong>Teams</strong> list that will now show your Team and the ones created by others.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>The Teams(s) you are a member of have a grey <strong>Member</strong> icon in front of it.</p></div></details><p>If no members are assigned to your Team, you should see a blue <strong>Add Members</strong> link instead of the member count, clicking on that link will get you to the <strong>Edit Team</strong> dialog where you can add yourself.</p><p>This is the same dialog you get when pressing the 3 dots <strong>&mldr;</strong> at the end of the line with your Team and selecting <strong>Edit Team</strong></p><p>The <strong>&mldr;</strong> menu gives you the option to Edit, Join, Leave or Delete a Team (leave and join will depend on if you are currently a member).</p><hr><h2 id=3-adding-notification-rules>3. Adding Notification Rules</h2><p>You can set up specific Notification rules per team, by clicking on the <strong>Notification Policy</strong> tab, this will open the notification edit menu.</p><p><a href=#R-image-f464039f6462449707a515be2a296b30 class=lightbox-link><img alt="Base notification menu" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/notification-policy.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f464039f6462449707a515be2a296b30><img alt="Base notification menu" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/notification-policy.png></a></p><p>By default, the system offers you the ability to set up a general notification rule for your team.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>The <strong>Email all team members</strong> option means all members of this Team will receive an email with the Alert information, regardless of the alert type.</p></div></details><h3 id=31-adding-recipients>3.1 Adding recipients</h3><p>You can add other recipients, by clicking <span class="btn cstyle blue"><span><span class=title>Add Recipient</span></span></span>. These recipients do not need to be Observability Cloud users.</p><p>However, if you click on the link <strong>Configure separate notification tiers for different severity alerts</strong> you can configure every alert level independently.</p><p><a href=#R-image-deb4061d3c4522cf07fadc7e2276585d class=lightbox-link><img alt="Multiple Notifications" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/single-policy.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-deb4061d3c4522cf07fadc7e2276585d><img alt="Multiple Notifications" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/single-policy.png></a></p><p>Different alert rules for the different alert levels can be configured, as shown in the above image.</p><p>Critical and Major are using <a href=https://www.splunk.com/en_us/observability/on-call.html rel=external target=_blank>Splunk's On-Call</a> Incident Management solution. For the Minor alerts, we send it to the Teams Slack channel and for Warning and Info we send an email.</p><h3 id=32-notification-integrations>3.2 Notification Integrations</h3><p>In addition to sending alert notifications via email, you can configure Observability Cloud to send alert notifications to the services shown below.</p><p><a href=#R-image-99ddad34ffa8a4bfba60d0eadc77e874 class=lightbox-link><img alt="Notifications options" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/integrations.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-99ddad34ffa8a4bfba60d0eadc77e874><img alt="Notifications options" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/integrations.png></a></p><p>Take a moment to create some notification rules for your Team.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=controlling-usage>Controlling Usage</h1><ul><li>Discover how you can restrict usage by creating separate Access Tokens and setting limits.</li></ul><h2 id=1-access-tokens>1. Access Tokens</h2><p>If you wish to control the consumption of Hosts, Containers, Custom Metrics and High Resolution Metrics, you can create multiple Access Tokens and allocate them to different parts of your organization.</p><p>In the UI click on the <strong>&#187;</strong> bottom left and select the <strong>Settings → Access Tokens</strong> under <strong>General Settings</strong>.</p><p>The <strong>Access Tokens</strong> Interface provides an overview of your allotments in the form of a list of Access Tokens that have been generated. Every Organization will have a <strong>Default</strong> token generated when they are first set up, but there will typically be multiple Tokens configured.</p><p>Each Token is unique and can be assigned limits for the number of Hosts, Containers, Custom Metrics and High Resolution Metrics it can consume.</p><p>The <strong>Usage Status</strong> Column quickly shows if a token is above or below its assigned limits.</p><p><a href=#R-image-56d6a223bd2b7577ad212814044d9f12 class=lightbox-link><img alt="New token" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/access-tokens.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-56d6a223bd2b7577ad212814044d9f12><img alt="New token" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/access-tokens.png></a></p><h2 id=2-creating-a-new-token>2. Creating a new token</h2><p>Let create a new token by clicking on the <span class="btn cstyle blue"><span><span class=title>New Token</span></span></span> button. This will provide you with the <strong>Name Your Access Token</strong> dialog.</p><p>Enter the new name of the new Token by using your Initials e.g. RWC-Token and make sure to tick both <strong>Ingest Token</strong> and <strong>API Token</strong> checkboxes!</p><p><a href=#R-image-d9a16787c58d0142ee936635597b1021 class=lightbox-link><img alt="Name Your token" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/new-access-token.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d9a16787c58d0142ee936635597b1021><img alt="Name Your token" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/new-access-token.png></a></p><p>After you press <span class="btn cstyle blue"><span><span class=title>OK</span></span></span> you will be taken back to the <strong>Access Token</strong> UI. Here your new token should be present, among the ones created by others.</p><p><a href=#R-image-8748d38314f7159437328e7bdd64c3da class=lightbox-link><img alt="full tokenlist" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/access-token-created.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8748d38314f7159437328e7bdd64c3da><img alt="full tokenlist" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/access-token-created.png></a></p><p>If you have made an error in your naming, want to disable/enable a token or set a Token limit, click on the ellipsis (<strong>&mldr;</strong>) menu button behind a token limit to open the manage token menu.</p><p><a href=#R-image-c61983b73721410ef703303962d4b333 class=lightbox-link><img alt="Show Menu" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/manage-access-token.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c61983b73721410ef703303962d4b333><img alt="Show Menu" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/manage-access-token.png></a></p><p>If you made a typo you can use the <strong>Rename Token</strong> option to correct the name of your token.</p><h2 id=3-disabling-a-token>3. Disabling a token</h2><p>If you need to make sure a token cannot be used to send Metrics in you can disable a token.</p><p>Click on <strong>Disable</strong> to disable the token, this means the token cannot be used for sending in data to Splunk Observability Cloud.</p><p>The line with your token should have become greyed out to indicate that it has been disabled as you can see in the screenshot below.</p><p><a href=#R-image-fb8a3d59b02a989cbc6fa9d904148ec4 class=lightbox-link><img alt="Token disabled" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/disable-access-token.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fb8a3d59b02a989cbc6fa9d904148ec4><img alt="Token disabled" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/disable-access-token.png></a></p><p>Go ahead and click on the ellipsis (<strong>&mldr;</strong>) menu button to Disable and Enable your token.</p><h2 id=4-manage-token-usage-limits>4. Manage token usage limits</h2><p>Now, let&rsquo;s start limiting usage by clicking on Manage Token Limit in the 3 <strong>&mldr;</strong> menu.</p><p>This will show the Manage Token Limit Dialog:</p><p><a href=#R-image-0de80f0afd40ba85168056353182882f class=lightbox-link><img alt="Set Limits on token" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/manage-token-limit.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0de80f0afd40ba85168056353182882f><img alt="Set Limits on token" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/manage-token-limit.png></a></p><p>In this dialog, you can set the limits per category.</p><p>Please go ahead and specify the limits as follows for each usage metric:</p><table><thead><tr><th style=text-align:left>Limit</th><th style=text-align:left>Value</th></tr></thead><tbody><tr><td style=text-align:left>Host Limit</td><td style=text-align:left>5</td></tr><tr><td style=text-align:left>Container Limit</td><td style=text-align:left>15</td></tr><tr><td style=text-align:left>Custom Metric Limit</td><td style=text-align:left>20</td></tr><tr><td style=text-align:left>High Resolution Metric Limit</td><td style=text-align:left>0</td></tr></tbody></table><p>For our lab use your email address, and double check that you have the correct numbers in your dialog box as shown in the table above.</p><p>Token limits are used to trigger an alert that notifies one or more recipients when the usage has been above 90% of the limit for 5 minutes.</p><p>To specify the recipients, click <span class="btn cstyle blue"><span><span class=title>Add Recipient</span></span></span>, then select the recipient or notification method you want to use (specifying recipients is optional but highly recommended).</p><p>The severity of token alerts is always Critical.</p><p>Click on <span class="btn cstyle blue"><span><span class=title>Update</span></span></span> to save your Access Tokens limits and The Alert Settings.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note: Going above token limit</summary><div class=box-content><p>When a token is at or above its limit in a usage category, new metrics for that usage category will not be stored and processed by Observability Cloud. This will make sure there will be no unexpected cost due to a team sending in data without restriction.</p></div></details><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note: Advanced alerting</summary><div class=box-content><p>If you wish to get alerts before you hit 90%, you can create additional detectors using whatever values you want. These detectors could target the Teams consuming the specific Access Tokens so they can take action before the admins need to get involved.</p></div></details><p>In your company you would distribute these new Access Tokens to various teams, controlling how much information/data they can send to Observability Cloud.</p><p>This will allow you to fine-tune the way you consume your Observability Cloud allotment and prevent overages from happening.</p><p><strong>Congratulations!</strong> You have now completed the Service Bureau module.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=nodejs-zero-config-workshop>NodeJS Zero-Config Workshop</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>30 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Robert Castley</span></span><p>The goal is to walk through the basic steps to configure the following components of the <strong>Splunk Observability Cloud</strong> platform:</p><ul><li>Splunk Infrastructure Monitoring (IM)</li><li>Splunk Zero Configuration Auto Instrumentation for NodeJS (APM)<ul><li>AlwaysOn Profiling</li></ul></li><li>Splunk Log Observer (LO)</li></ul><p>We will deploy the OpenTelemetry Astronomy Shop application in Kubernetes, which contains two NodeJS services (<strong>Frontend</strong> & <strong>Payment Service</strong>). Once the application and the OpenTelemetry Connector are up and running, we will start seeing metrics, traces and logs via the <strong>Zero Configuration Auto Instrumentation</strong> for NodeJS that will be used by the <strong>Splunk Observability Cloud</strong> platform to provide insights into the application.</p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-info"></i>
Prerequisites</summary><div class=box-content><ul><li>Outbound SSH access to port <code>2222</code>.</li><li>Outbound HTTP access to port <code>8083</code>.</li><li>Familiarity with the <code>bash</code> shell and <code>vi/vim</code> editor.</li></ul></div></details><p>Next, we will deploy the <strong>OpenTelemetry Demo</strong>.</p><pre class="mermaid align-center">
graph TD
subgraph Service Diagram
accountingservice(Accounting Service):::golang
adservice(Ad Service):::java
cache[(Cache)]
cartservice(Cart Service):::dotnet
checkoutservice(Checkout Service):::golang
currencyservice(Currency Service):::cpp
emailservice(Email Service):::ruby
frauddetectionservice(Fraud Detection Service):::kotlin
frontend(Frontend):::typescript
frontendproxy(Frontend Proxy):::cpp
loadgenerator([Load Generator]):::python
paymentservice(Payment Service):::javascript
productcatalogservice(Product Catalog Service):::golang
quoteservice(Quote Service):::php
recommendationservice(Recommendation Service):::python
shippingservice(Shipping Service):::rust
featureflagservice(Feature Flag Service):::erlang
featureflagstore[(Feature Flag Store)]
queue[(queue)]
Internet --&gt;|HTTP| frontendproxy
frontendproxy --&gt;|HTTP| frontend
frontendproxy --&gt;|HTTP| featureflagservice
loadgenerator --&gt;|HTTP| frontendproxy
accountingservice --&gt;|TCP| queue
cartservice ---&gt;|gRPC| featureflagservice
checkoutservice ---&gt;|gRPC| cartservice --&gt; cache
checkoutservice ---&gt;|gRPC| productcatalogservice
checkoutservice ---&gt;|gRPC| currencyservice
checkoutservice ---&gt;|HTTP| emailservice
checkoutservice ---&gt;|gRPC| paymentservice
checkoutservice --&gt;|gRPC| shippingservice
checkoutservice ---&gt;|TCP| queue
frontend --&gt;|gRPC| adservice
frontend --&gt;|gRPC| cartservice
frontend --&gt;|gRPC| productcatalogservice
frontend --&gt;|gRPC| checkoutservice
frontend --&gt;|gRPC| currencyservice
frontend --&gt;|gRPC| recommendationservice --&gt;|gRPC| productcatalogservice
frontend --&gt;|gRPC| shippingservice --&gt;|HTTP| quoteservice
frauddetectionservice --&gt;|TCP| queue
adservice ---&gt;|gRPC| featureflagservice
productcatalogservice --&gt;|gRPC| featureflagservice
recommendationservice --&gt;|gRPC| featureflagservice
shippingservice --&gt;|gRPC| featureflagservice
featureflagservice --&gt; featureflagstore
end

classDef dotnet fill:#178600,color:white;
classDef cpp fill:#f34b7d,color:white;
classDef erlang fill:#b83998,color:white;
classDef golang fill:#00add8,color:black;
classDef java fill:#b07219,color:white;
classDef javascript fill:#f1e05a,color:black;
classDef kotlin fill:#560ba1,color:white;
classDef php fill:#4f5d95,color:white;
classDef python fill:#3572A5,color:white;
classDef ruby fill:#701516,color:white;
classDef rust fill:#dea584,color:black;
classDef typescript fill:#e98516,color:black;
</pre><pre class="mermaid align-center">
graph TD
subgraph Service Legend
  dotnetsvc(.NET):::dotnet
  cppsvc(C++):::cpp
  erlangsvc(Erlang/Elixir):::erlang
  golangsvc(Go):::golang
  javasvc(Java):::java
  javascriptsvc(JavaScript):::javascript
  kotlinsvc(Kotlin):::kotlin
  phpsvc(PHP):::php
  pythonsvc(Python):::python
  rubysvc(Ruby):::ruby
  rustsvc(Rust):::rust
  typescriptsvc(TypeScript):::typescript
end

classDef dotnet fill:#178600,color:white;
classDef cpp fill:#f34b7d,color:white;
classDef erlang fill:#b83998,color:white;
classDef golang fill:#00add8,color:black;
classDef java fill:#b07219,color:white;
classDef javascript fill:#f1e05a,color:black;
classDef kotlin fill:#560ba1,color:white;
classDef php fill:#4f5d95,color:white;
classDef python fill:#3572A5,color:white;
classDef ruby fill:#701516,color:white;
classDef rust fill:#dea584,color:black;
classDef typescript fill:#e98516,color:black;
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of NodeJS Zero-Config Workshop</h1><article class=default><header class=headline></header><h1 id=deploying-the-opentelemetry-demo>Deploying the OpenTelemetry Demo</h1><h2 id=1-create-a-namespace>1. Create a namespace</h2><p>To not conflict with other workshops, we will deploy the OpenTelemetry Demo in a separate namespace called <code>otel-demo</code>. To create the namespace, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create namespace otel-demo</span></span></code></pre></div><h2 id=2-deploy-the-opentelemetry-demo>2. Deploy the OpenTelemetry Demo</h2><p>Next, change to the directory containing the OpenTelemetry Demo application:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/apm</span></span></code></pre></div><p>Deploy the OpenTelemetry Demo application:</p><div class=tab-panel data-tab-group=e3c07733d8ae9043ef50486698e7cb61><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("e3c07733d8ae9043ef50486698e7cb61","command")'>
<span class=tab-nav-text>Command</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("e3c07733d8ae9043ef50486698e7cb61","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -n otel-demo -f otel-demo.yaml</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>serviceaccount/opentelemetry-demo created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-adservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-cartservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-checkoutservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-currencyservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-emailservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-featureflagservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-ffspostgres created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-frontend created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-kafka created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-loadgenerator created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-paymentservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-productcatalogservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-quoteservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-recommendationservice created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-redis created
</span></span><span class=line><span class=cl>service/opentelemetry-demo-shippingservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-accountingservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-adservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-cartservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-checkoutservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-currencyservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-emailservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-featureflagservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-ffspostgres created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-frauddetectionservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-frontend created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-kafka created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-loadgenerator created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-paymentservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-productcatalogservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-quoteservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-recommendationservice created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-redis created
</span></span><span class=line><span class=cl>deployment.apps/opentelemetry-demo-shippingservice created</span></span></code></pre></div></div></div></div></div><p>Once the application is deployed, we need to wait for the pods to be in a <code>Running</code> state. To check the status of the pods, run the following command:</p><div class=tab-panel data-tab-group=2ef712c19e4c0e20369bc02a1116307d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2ef712c19e4c0e20369bc02a1116307d","command")'>
<span class=tab-nav-text>Command</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2ef712c19e4c0e20369bc02a1116307d","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -n otel-demo</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                        READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>opentelemetry-demo-emailservice-847d6fb577-bxll6            1/1     Running   0          40s
</span></span><span class=line><span class=cl>opentelemetry-demo-ffspostgres-55f65465dd-2gsj4             1/1     Running   0          40s
</span></span><span class=line><span class=cl>opentelemetry-demo-adservice-5b7c68859d-5hx5f               1/1     Running   0          40s
</span></span><span class=line><span class=cl>opentelemetry-demo-currencyservice-c4cb78446-qsd68          1/1     Running   0          40s
</span></span><span class=line><span class=cl>opentelemetry-demo-frontend-5d7cdb8786-5dl76                1/1     Running   0          39s
</span></span><span class=line><span class=cl>opentelemetry-demo-kafka-79868d56d8-62wsd                   1/1     Running   0          39s
</span></span><span class=line><span class=cl>opentelemetry-demo-paymentservice-5cb4ccc47c-65hxl          1/1     Running   0          39s
</span></span><span class=line><span class=cl>opentelemetry-demo-productcatalogservice-59d955f9d6-xtnjr   1/1     Running   0          38s
</span></span><span class=line><span class=cl>opentelemetry-demo-loadgenerator-755d6cd5b-r5lqs            1/1     Running   0          39s
</span></span><span class=line><span class=cl>opentelemetry-demo-quoteservice-5fbfb97778-vm62m            1/1     Running   0          38s
</span></span><span class=line><span class=cl>opentelemetry-demo-redis-57c49b7b5b-b2klr                   1/1     Running   0          37s
</span></span><span class=line><span class=cl>opentelemetry-demo-shippingservice-6667f69f78-cwj8q         1/1     Running   0          37s
</span></span><span class=line><span class=cl>opentelemetry-demo-recommendationservice-749f55f9b6-5k4lc   1/1     Running   0          37s
</span></span><span class=line><span class=cl>opentelemetry-demo-featureflagservice-67677647c-85xtm       1/1     Running   0          40s
</span></span><span class=line><span class=cl>opentelemetry-demo-checkoutservice-5474bf74b8-2nmns         1/1     Running   0          40s
</span></span><span class=line><span class=cl>opentelemetry-demo-frauddetectionservice-77fd69d967-lnjcg   1/1     Running   0          39s
</span></span><span class=line><span class=cl>opentelemetry-demo-accountingservice-96d44cfbc-vmtzb        1/1     Running   0          40s
</span></span><span class=line><span class=cl>opentelemetry-demo-cartservice-7c4f59bdd5-rfkf4             1/1     Running   0          40s</span></span></code></pre></div></div></div></div></div><h2 id=3-validate-the-application-is-running>3. Validate the application is running</h2><p>To validate the application is running, we will port-forward the frontend service. To do this, run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl port-forward svc/opentelemetry-demo-frontend 8083:8080 -n otel-demo --address<span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span></span></span></code></pre></div><p>Obtain the <strong>public IP address</strong> of the instance you are running on. You can do this by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl ifconfig.me</span></span></code></pre></div><p>Once the port-forward is running, you can access the application by opening a browser and navigating to <code>http://&lt;public IP address>:8083</code>. You should see the following:</p><p><a href=#R-image-6fb441de61c7329d66b36cfc875313e2 class=lightbox-link><img alt="OpenTelemetry Demo" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/otel-demo.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6fb441de61c7329d66b36cfc875313e2><img alt="OpenTelemetry Demo" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/otel-demo.png></a></p><p>Once you have confirmed the application is running, you can close the port-forward by pressing <code>ctrl + c</code>.</p><p>Next, we will deploy the <strong>OpenTelemetry Collector</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=installing-the-opentelemetry-collector>Installing the OpenTelemetry Collector</h1><h2 id=1-introduction>1. Introduction</h2><details open class="box cstyle notices warning"><summary class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i>
Delete any existing OpenTelemetry Collectors</summary><div class=box-content><p>If you have completed any other Observability workshops, please ensure you delete the collector running in Kubernetes before continuing. This can be done by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></details><h2 id=2-confirm-environment-variables>2. Confirm environment variables</h2><p>To ensure your instance is configured correctly, we need to confirm that the required environment variables for this workshop are set correctly. In your terminal run the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>env</span></span></code></pre></div><p>In the output check the following environment variables are present and have values set:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>ACCESS_TOKEN
</span></span><span class=line><span class=cl>REALM
</span></span><span class=line><span class=cl>RUM_TOKEN
</span></span><span class=line><span class=cl>HEC_TOKEN
</span></span><span class=line><span class=cl>HEC_URL</span></span></code></pre></div><p>For this workshop, <strong>all</strong> of the above are required. If any are missing, please contact your instructor.</p><h2 id=3-install-the-opentelemetry-collector>3. Install the OpenTelemetry Collector</h2><p>We can then go ahead and install the Collector. Some additional parameters are passed to the <code>helm install</code> command, they are:</p><ul><li><code>--set="operator.enabled=true"</code> - Enabled the Splunk OpenTelemetry Collector Operator for Kubernetes.</li><li><code>--set="certmanager.enabled=true"</code> - The cert-manager adds certificates and certificate issuers as resource types in Kubernetes clusters and simplifies the process of obtaining, renewing and using those certificates.</li><li><code>--set="splunkObservability.profilingEnabled=true"</code> - Enables CPU/Memory profiling for supported languages.</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span class=o>&amp;&amp;</span> helm repo update</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector --version 0.111.0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;operator.enabled=true&#34;</span>, <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;certmanager.enabled=true&#34;</span>, <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;logsEngine=otel&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.profilingEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;environment=</span><span class=nv>$INSTANCE</span><span class=s2>-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml</span></span></code></pre></div><p>Once the installation is completed, you can navigate to the <strong>Kubernetes Navigator</strong> to see the data from your host.</p><p>Click on <strong>Add filters</strong> select <code>k8s.cluster.name</code> and select the cluster of your workshop instance.
You can determine your instance name from the command prompt in your terminal session:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$INSTANCE</span></span></span></code></pre></div><p>Once you see data flowing for your host, we are then ready to get started with the APM component.</p><p><a href=#R-image-af84270b07205dfb53fcc60179afbe1c class=lightbox-link><img alt="Kubernetes Navigator" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/k8s-navigator.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af84270b07205dfb53fcc60179afbe1c><img alt="Kubernetes Navigator" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/k8s-navigator.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 13, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=zero-configuration---frontend-service>Zero Configuration - Frontend Service</h1><h2 id=1-patching-the-frontend-service>1. Patching the Frontend service</h2><p>First, confirm that you can see your environment in <strong>APM</strong>. There should be a service called <code>loadgenerator</code> displayed in the Service map.</p><p><a href=#R-image-257988312abcea58cdd3c44d4557eca3 class=lightbox-link><img alt="APM Service Map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-servicemap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-257988312abcea58cdd3c44d4557eca3><img alt="APM Service Map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-servicemap.png></a></p><p>Next, we will patch the <code>frontend</code> deployment with an annotation to inject the NodeJS auto instrumentation. This will allow us to see the <code>frontend</code> service in <strong>APM</strong>. Note, that at this point we have not edited any code.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl patch deployment opentelemetry-demo-frontend -n otel-demo -p <span class=s1>&#39;{&#34;spec&#34;: {&#34;template&#34;:{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;instrumentation.opentelemetry.io/inject-nodejs&#34;:&#34;default/splunk-otel-collector&#34;}}}} }&#39;</span></span></span></code></pre></div><ul><li>This will cause the <code>opentelemetry-demo-frontend</code> pod to restart.</li><li>The annotation value <code>default/splunk-otel-collector</code> refers to the instrumentation configuration named <code>splunk-otel-collector</code> in the <code>default</code> namespace.</li><li>If the chart is not installed in the <code>default</code> namespace, modify the annotation value to be <code>{chart_namespace}/splunk-otel-collector</code>.</li></ul><p>After a few minutes, you should see the <code>frontend</code> service in <strong>APM</strong>.</p><p><a href=#R-image-386d0a16e3d878d26b4d752de1b58587 class=lightbox-link><img alt=Frontend class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-frontend.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-386d0a16e3d878d26b4d752de1b58587><img alt=Frontend class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-frontend.png></a></p><p>With the <code>frontend</code> service highlighted, click on the <strong>Traces</strong> tab to see the traces for the service. Select one of the traces and confirm that the trace contains metadata confirming that the Splunk Zero-Configuration Auto-Instrumentation for NodeJS is being used.</p><p><a href=#R-image-a0115c2009e5ba00fff24cac5e92f780 class=lightbox-link><img alt="Zero Configuration" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-frontend-trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a0115c2009e5ba00fff24cac5e92f780><img alt="Zero Configuration" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-frontend-trace.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=zero-configuration---payment-service>Zero Configuration - Payment Service</h1><h2 id=1-patching-the-payment-service>1. Patching the Payment Service</h2><p>Finally, we will patch the <code>paymentservice</code> deployment with an annotation to inject the NodeJS auto instrumentation. This will allow us to see the <code>paymentservice</code> service in <strong>APM</strong>.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl patch deployment opentelemetry-demo-paymentservice -n otel-demo -p <span class=s1>&#39;{&#34;spec&#34;: {&#34;template&#34;:{&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;instrumentation.opentelemetry.io/inject-nodejs&#34;:&#34;default/splunk-otel-collector&#34;}}}} }&#39;</span></span></span></code></pre></div><p>This will cause the <code>opentelemetry-demo-paymentservice</code> pod to restart and after a few minutes, you should see the <code>paymentservice</code> service in <strong>APM</strong>.</p><p><a href=#R-image-459673a5c78a35675d62d4629e1df44a class=lightbox-link><img alt=Paymentservice class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/apm-paymentservice.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-459673a5c78a35675d62d4629e1df44a><img alt=Paymentservice class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/apm-paymentservice.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=code-profiling---payment-service>Code Profiling - Payment Service</h1><h2 id=1-alwayson-profiling-for-the-payment-service>1. AlwaysOn Profiling for the Payment Service</h2><p><strong>AlwaysOn Profiling</strong> is a feature of the Splunk Distribution of OpenTelemetry Collector that allows you to collect CPU and Memory profiling data for your services without having to modify your code. This is useful for troubleshooting performance issues in your services. Here are some of the benefits of AlwaysOn Profiling:</p><ul><li>Perform continuous profiling of your applications. The profiler is always on once you activate it.</li><li>Collect code performance context and link it to trace data.</li><li>Explore memory usage and garbage collection of your application.</li><li>Analyze code bottlenecks that impact service performance.</li><li>Identify inefficiencies that increase the need for scaling up cloud resources.</li></ul><p>With the <code>opentelemetry-demo-paymentservice</code> selected, click on <strong>AlwaysOn Profiling</strong> to view the code profiling data for the service.</p><p><a href=#R-image-73b2b71560b4b15f1f1929e68c4e8363 class=lightbox-link><img alt="AlwaysOn Profiling" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/alwayson-profiling.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-73b2b71560b4b15f1f1929e68c4e8363><img alt="AlwaysOn Profiling" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/alwayson-profiling.png></a></p><p>Here you can see the CPU and Memory profiling data for the <code>paymentservice</code> service. You can also see the CPU and Memory profiling data for the <code>frontend</code> service by selecting the <code>opentelemetry-demofrontend</code> service from the <strong>Service</strong> dropdown.</p><p><a href=#R-image-e173c01fd89eb57432b2716afbb3dcf5 class=lightbox-link><img alt="Profiling Service" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/profiling-service.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e173c01fd89eb57432b2716afbb3dcf5><img alt="Profiling Service" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/profiling-service.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=logs---payment-service>Logs - Payment Service</h1><h2 id=1-viewing-the-logs-for-the-payment-service>1. Viewing the logs for the Payment Service</h2><p>Navigate back to APM from the main menu and under <strong>Services</strong> click on <code>opentelemetry-demo-paymentservice</code>. This will open up the Service map for the <code>paymentservice</code> service only.</p><p>At the bottom of the page, click on the <strong>Logs(1)</strong> tab to view the logs for the <code>paymentservice</code> service.</p><p><a href=#R-image-9b271bc415af2305838c2db3cc96bc5a class=lightbox-link><img alt="Related Logs" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/related-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9b271bc415af2305838c2db3cc96bc5a><img alt="Related Logs" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/related-logs.png></a></p><p>Once in <strong>Log Observer</strong> select one of the log entries to view the metadata for the log entry.</p><p><a href=#R-image-44f482b526ab53c482e9258413722487 class=lightbox-link><img alt="Log Entry" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/log-entry.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-44f482b526ab53c482e9258413722487><img alt="Log Entry" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/log-entry.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=getting-data-in-gdi-with-otel-and-uf>Getting Data In (GDI) with OTel and UF</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>45 minutes</span>
</span>&nbsp;<p>During this technical workshop, you will learn how to:</p><ul><li>Efficiently deploy complex environments</li><li>Capture metrics from these environments to Splunk Observability Cloud</li><li>Auto-instrument a Python application</li><li>Enable OS logging to Splunk Enterprise via Universal Forwarder</li></ul><p>To simplify the workshop modules, a pre-configured AWS EC2 instance is provided.</p><p>By the end of this technical workshop, you will have an approach to demonstrating metrics collection for complex environments and services.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of GDI (OTel & UF)</h1><article class=default><header class=headline></header><h1 id=getting-started-with-o11y-gdi---real-time-enrichment-workshop>Getting Started with O11y GDI - Real Time Enrichment Workshop</h1><p>Please note to begin the following lab, you must have completed the prework:</p><ul><li>Obtain a Splunk Observability Cloud access key</li><li>Understand cli commands</li></ul><p>Follow these steps if using O11y Workshop EC2 instances</p><h2 id=1-verify-yelp-data-files-are-present>1. Verify yelp data files are present</h2><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ll /var/appdata/yelp*</span></span></code></pre></div><h2 id=2-export-the-following-variables>2. Export the following variables</h2><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span>&lt;your-access-token&gt;
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span>&lt;your-o11y-cloud-realm&gt;
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>clusterName</span><span class=o>=</span>&lt;your-k8s-cluster&gt;</span></span></code></pre></div><h2 id=3-clone-the-following-repo>3. Clone the following repo</h2><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk 
</span></span><span class=line><span class=cl>git clone https://github.com/leungsteve/realtime_enrichment.git 
</span></span><span class=line><span class=cl><span class=nb>cd</span> realtime_enrichment/workshop 
</span></span><span class=line><span class=cl>python3 -m venv rtapp-workshop 
</span></span><span class=line><span class=cl><span class=nb>source</span> rtapp-workshop/bin/activate</span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-complex-environments-and-capture-metrics>Deploy Complex Environments and Capture Metrics</h1><p><strong>Objective:</strong> Learn how to efficiently deploy complex infrastructure components such as Kafka and MongoDB to demonstrate metrics collection with Splunk O11y IM integrations</p><p><strong>Duration</strong>: 15 Minutes</p><h2 id=scenario>Scenario</h2><p>A prospect uses Kafka and MongoDB in their environment. Since there are integrations for these services, you’d like to demonstrate this to the prospect. What is a quick and efficient way to set up a live environment with these services and have metrics collected?</p><h3 id=1-where-can-i-find-helm-charts>1. Where can I find helm charts?</h3><ul><li>Google “myservice helm chart”</li><li><code>https://artifacthub.io/</code> (<strong>Note:</strong> Look for charts from trusted organizations, with high star count and frequent updates)</li></ul><h3 id=2-review-apache-kafka-packaged-by-bitnamihttpsgithubcombitnamichartstreemainbitnamikafkainstalling-the-chart>2. Review <a href=https://github.com/bitnami/charts/tree/main/bitnami/kafka/#installing-the-chart rel=external target=_blank>Apache Kafka packaged by Bitnami</a></h3><p>We will deploy the helm chart with these options enabled:</p><ul><li><code>replicaCount=3</code></li><li><code>metrics.jmx.enabled=true</code></li><li><code>metrics.kafka.enabled=true</code></li><li><code>deleteTopicEnable=true</code></li></ul><h3 id=3-review-mongodbr-packaged-by-bitnamihttpsgithubcombitnamichartstreemasterbitnamimongodbinstalling-the-chart>3. Review <a href=https://github.com/bitnami/charts/tree/master/bitnami/mongodb/#installing-the-chart rel=external target=_blank>MongoDB(R) packaged by Bitnami</a></h3><p>We will deploy the helm chart with these options enabled:</p><ul><li><code>version 12.1.31</code></li><li><code>metrics.enabled=true</code></li><li><code>global.namespaceOverride=default</code></li><li><code>auth.rootUser=root</code></li><li><code>auth.rootPassword=splunk</code></li><li><code>auth.enabled=false</code></li></ul><h3 id=4-install-kafka-and-mongodb-with-helm-charts>4. Install Kafka and MongoDB with helm charts</h3><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add bitnami https://charts.bitnami.com/bitnami</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install kafka --set <span class=nv>replicaCount</span><span class=o>=</span><span class=m>3</span> --set metrics.jmx.enabled<span class=o>=</span><span class=nb>true</span> --set metrics.kafka.enabled<span class=o>=</span><span class=nb>true</span>  --set <span class=nv>deleteTopicEnable</span><span class=o>=</span><span class=nb>true</span> bitnami/kafka</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install mongodb --set metrics.enabled<span class=o>=</span><span class=nb>true</span> bitnami/mongodb --set global.namespaceOverride<span class=o>=</span>default --set auth.rootUser<span class=o>=</span>root --set auth.rootPassword<span class=o>=</span>splunk --set auth.enabled<span class=o>=</span><span class=nb>false</span> --version 12.1.31</span></span></code></pre></div><p>Verify the helm chart installation</p><div class=tab-panel data-tab-group=6a7ca58493b1ffebae1411623874af02><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-list class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("6a7ca58493b1ffebae1411623874af02","helm-list")'>
<span class=tab-nav-text>helm list</span>
</button>
<button data-tab-item=helm-list-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("6a7ca58493b1ffebae1411623874af02","helm-list-output")'>
<span class=tab-nav-text>helm list output</span></button></div><div class=tab-content-container><div data-tab-item=helm-list class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm list</span></span></code></pre></div></div></div><div data-tab-item=helm-list-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME    NAMESPACE   REVISION    UPDATED                                 STATUS      CHART           APP VERSION
</span></span><span class=line><span class=cl>kafka   default     1           2022-11-14 11:21:36.328956822 -0800 PST deployed    kafka-19.1.3    3.3.1
</span></span><span class=line><span class=cl>mongodb default     1           2022-11-14 11:19:36.507690487 -0800 PST deployed    mongodb-12.1.31 5.0.10</span></span></code></pre></div></div></div></div></div><p>Verify the helm chart installation</p><div class=tab-panel data-tab-group=2539be5d362b2c122aa5ac030e80ab4a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2539be5d362b2c122aa5ac030e80ab4a","kubectl-get-pods")'>
<span class=tab-nav-text>kubectl get pods</span>
</button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2539be5d362b2c122aa5ac030e80ab4a","kubectl-get-pods-output")'>
<span class=tab-nav-text>kubectl get pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                              READY   STATUS              RESTARTS   AGE
</span></span><span class=line><span class=cl>kafka-exporter-595778d7b4-99ztt   0/1     ContainerCreating   0          17s
</span></span><span class=line><span class=cl>mongodb-b7c968dbd-jxvsj           0/2     Pending             0          6s
</span></span><span class=line><span class=cl>kafka-1                           0/2     ContainerCreating   0          16s
</span></span><span class=line><span class=cl>kafka-2                           0/2     ContainerCreating   0          16s
</span></span><span class=line><span class=cl>kafka-zookeeper-0                 0/1     Pending             0          17s
</span></span><span class=line><span class=cl>kafka-0                           0/2     Pending             0          17s</span></span></code></pre></div></div></div></div></div><p>Use information for each Helm chart and Splunk O11y Data Setup to generate values.yaml for capturing metrics from Kafka and MongoDB.</p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p><code>values.yaml</code> for the different services will be passed to the Splunk Helm Chart at installation time. These will configure the OTEL collector to capture metrics from these services.</p></div></details><ul><li>References:<ul><li><a href=https://github.com/bitnami/charts/tree/master/bitnami/spark/#installing-the-chart rel=external target=_blank>Apache Kafka packaged by Bitnami</a></li><li><a href=https://docs.splunk.com/Observability/gdi/kafka/kafka.html rel=external target=_blank>Configure application receivers for databases » Apache Kafka</a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/kafkametricsreceiver rel=external target=_blank>Kafkametricsreceiver</a></li></ul></li></ul><h4 id=41-example-kafkavaluesyaml>4.1 Example kafka.values.yaml</h4><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>otelAgent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>smartagent/kafka</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;pod&#34; &amp;&amp; name matches &#34;kafka&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=c>#endpoint: &#39;`endpoint`:5555&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>5555</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>collectd/kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>clusterName</span><span class=p>:</span><span class=w> </span><span class=l>sl-kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>otelK8sClusterReceiver</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>k8sEventsEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>kafkametrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>brokers</span><span class=p>:</span><span class=w> </span><span class=l>kafka:9092</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>protocol_version</span><span class=p>:</span><span class=w> </span><span class=m>2.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>brokers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>topics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>consumers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c>#- prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>k8s_cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>kafkametrics</span></span></span></code></pre></div><h4 id=42-example-mongodbvaluesyaml>4.2 Example mongodb.values.yaml</h4><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>otelAgent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>smartagent/mongodb</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;pod&#34; &amp;&amp; name matches &#34;mongo&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>collectd/mongodb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>mongodb.default.svc.cluster.local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>27017</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>databases</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;admin&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;O11y&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;local&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;config&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>sendCollectionMetrics</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>sendCollectionTopMetrics</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div><h4 id=43-example-zookeepervaluesyaml>4.3 Example zookeeper.values.yaml</h4><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>otelAgent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>smartagent/zookeeper</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;pod&#34; &amp;&amp; name matches &#34;kafka-zookeeper&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>collectd/zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>kafka-zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>2181</span></span></span></code></pre></div><h3 id=5-install-the-splunk-otel-helm-chart>5. Install the Splunk OTEL helm chart</h3><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk/realtime_enrichment/otel_yamls/ 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>helm repo update</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install --set <span class=nv>provider</span><span class=o>=</span><span class=s1>&#39; &#39;</span> --set <span class=nv>distro</span><span class=o>=</span><span class=s1>&#39; &#39;</span> --set splunkObservability.accessToken<span class=o>=</span><span class=nv>$ACCESS_TOKEN</span> --set <span class=nv>clusterName</span><span class=o>=</span><span class=nv>$clusterName</span> --set splunkObservability.realm<span class=o>=</span><span class=nv>$REALM</span> --set otelCollector.enabled<span class=o>=</span><span class=s1>&#39;false&#39;</span> --set splunkObservability.logsEnabled<span class=o>=</span><span class=s1>&#39;true&#39;</span> --set gateway.enabled<span class=o>=</span><span class=s1>&#39;false&#39;</span> --values kafka.values.yaml --values mongodb.values.yaml --values zookeeper.values.yaml --values alwayson.values.yaml --values k3slogs.yaml --generate-name splunk-otel-collector-chart/splunk-otel-collector</span></span></code></pre></div><h3 id=6-verify-installation>6. Verify installation</h3><p>Verify that the Kafka, MongoDB and Splunk OTEL Collector helm charts are installed, note that names may differ.</p><div class=tab-panel data-tab-group=1b5364214844eb666348c0a7f2ba3fea><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-list class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("1b5364214844eb666348c0a7f2ba3fea","helm-list")'>
<span class=tab-nav-text>helm list</span>
</button>
<button data-tab-item=helm-list-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("1b5364214844eb666348c0a7f2ba3fea","helm-list-output")'>
<span class=tab-nav-text>helm list Output</span></button></div><div class=tab-content-container><div data-tab-item=helm-list class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm list</span></span></code></pre></div></div></div><div data-tab-item=helm-list-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                NAMESPACE   REVISION    UPDATED                                 STATUS      CHART                           APP VERSION
</span></span><span class=line><span class=cl>kafka                               default     1           2021-12-07 12:48:47.066421971 -0800 PST deployed    kafka-14.4.1                    2.8.1
</span></span><span class=line><span class=cl>mongodb                             default     1           2021-12-07 12:49:06.132771625 -0800 PST deployed    mongodb-10.29.2                 4.4.10
</span></span><span class=line><span class=cl>splunk-otel-collector-1638910184    default     1           2021-12-07 12:49:45.694013749 -0800 PST deployed    splunk-otel-collector-0.37.1    0.37.1</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=c51b8ab21dcbc53b7c5232c088f7388b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c51b8ab21dcbc53b7c5232c088f7388b","kubectl-get-pods")'>
<span class=tab-nav-text>kubectl get pods</span>
</button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("c51b8ab21dcbc53b7c5232c088f7388b","kubectl-get-pods-output")'>
<span class=tab-nav-text>kubectl get pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                              READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>kafka-zookeeper-0                                                 1/1     Running   0          18m
</span></span><span class=line><span class=cl>kafka-2                                                           2/2     Running   1          18m
</span></span><span class=line><span class=cl>mongodb-79cf87987f-gsms8                                          2/2     Running   0          18m
</span></span><span class=line><span class=cl>kafka-1                                                           2/2     Running   1          18m
</span></span><span class=line><span class=cl>kafka-exporter-7c65fcd646-dvmtv                                   1/1     Running   3          18m
</span></span><span class=line><span class=cl>kafka-0                                                           2/2     Running   1          18m
</span></span><span class=line><span class=cl>splunk-otel-collector-1638910184-agent-27s5c                      2/2     Running   0          17m
</span></span><span class=line><span class=cl>splunk-otel-collector-1638910184-k8s-cluster-receiver-8587qmh9l   1/1     Running   0          17m</span></span></code></pre></div></div></div></div></div><h3 id=7-verify-dashboards>7. Verify dashboards</h3><p>Verify that out of the box dashboards for Kafka, MongoDB and Zookeeper are populated in the Infrastructure Monitor landing page. Drill down into each component to view granular details for each service.</p><p>Tip: You can use the filter <code>k8s.cluster.name</code> with your cluster name to find your instance.</p><ul><li>Infrastructure Monitoring Landing page:</li></ul><p><a href=#R-image-1481038c81cb273c6b36ecf2b56c4a59 class=lightbox-link><img alt=IM-landing-page class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/inframon.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1481038c81cb273c6b36ecf2b56c4a59><img alt=IM-landing-page class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/inframon.jpg></a></p><ul><li>K8 Navigator:</li></ul><p><a href=#R-image-ffa1dea490d5835bb30fb1c2178dd211 class=lightbox-link><img alt=k8-navigator class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/k8navigator.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ffa1dea490d5835bb30fb1c2178dd211><img alt=k8-navigator class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/k8navigator.jpg></a></p><ul><li>MongoDB Dashboard:</li></ul><p><a href=#R-image-472ff81f3ac10c237000136418f31090 class=lightbox-link><img alt=mongodb-dash class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/mongoDB.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-472ff81f3ac10c237000136418f31090><img alt=mongodb-dash class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/mongoDB.jpg></a></p><ul><li>Kafka Dashboard:</li></ul><p><a href=#R-image-976fc7ce799614e0146add05952ba1fb class=lightbox-link><img alt=kafka-dash class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/kafka.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-976fc7ce799614e0146add05952ba1fb><img alt=kafka-dash class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/kafka.jpg></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=code-to-kubernetes---python>Code to Kubernetes - Python</h1><h2 id=code-to-kubernetes---python>Code to Kubernetes - Python</h2><p><strong>Objective:</strong> Understand activities to instrument a python application and run it on Kubernetes.</p><ul><li>Verify the code</li><li>Containerize the app</li><li>Deploy the container in Kubernetes</li></ul><p><strong>Note:</strong> these steps do not involve Splunk</p><p><strong>Duration:</strong> 15 Minutes</p><h2 id=1-verify-the-code---review-service>1. Verify the code - Review service</h2><p>Navigate to the review directory</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk/realtime_enrichment/flask_apps/review/</span></span></code></pre></div><p>Inspect review.py (realtime_enrichment/flask_apps/review)</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat review.py</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>review</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>num_reviews</span> <span class=o>=</span> <span class=mi>8635403</span>
</span></span><span class=line><span class=cl><span class=n>num_reviews</span> <span class=o>=</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl><span class=n>reviews_file</span> <span class=o>=</span> <span class=s1>&#39;/var/appdata/yelp_academic_dataset_review.json&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@review.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hello_world</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>message</span><span class=o>=</span><span class=s1>&#39;Hello, you want to hit /get_review. We have &#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>num_reviews</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39; reviews!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@review.route</span><span class=p>(</span><span class=s1>&#39;/get_review&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_review</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>random_review_int</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>num_reviews</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>line_num</span> <span class=o>=</span> <span class=n>random_review_int</span> <span class=o>+</span> <span class=s1>&#39;q;d&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>command</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;sed&#34;</span><span class=p>,</span> <span class=n>line_num</span><span class=p>,</span> <span class=n>reviews_file</span><span class=p>]</span> <span class=c1># sed &#34;7997242q;d&#34; &lt;file&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>random_review</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>command</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>text</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>random_review</span><span class=o>.</span><span class=n>stdout</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>review</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span> <span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span> <span class=o>=</span> <span class=mi>5000</span><span class=p>,</span> <span class=n>debug</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span></span></span></code></pre></div><p>Inspect requirements.txt</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Flask==2.0.2</span></span></code></pre></div><p>Create a virtual environment and Install the necessary python packages</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk/realtime_enrichment/workshop/flask_apps_start/review/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>pip freeze <span class=c1>#note output</span>
</span></span><span class=line><span class=cl>pip install -r requirements.txt
</span></span><span class=line><span class=cl>pip freeze <span class=c1>#note output</span></span></span></code></pre></div><p>Start the REVIEW service. <strong>Note:</strong> You can stop the app with control+C</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 review.py
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Serving Flask app <span class=s1>&#39;review&#39;</span> <span class=o>(</span>lazy loading<span class=o>)</span>
</span></span><span class=line><span class=cl> * Environment: production
</span></span><span class=line><span class=cl>         ...snip...
</span></span><span class=line><span class=cl> * Running on http://10.160.145.246:5000/ <span class=o>(</span>Press CTRL+C to quit<span class=o>)</span>
</span></span><span class=line><span class=cl> * Restarting with stat
</span></span><span class=line><span class=cl>127.0.0.1 - - <span class=o>[</span>17/May/2022 22:46:38<span class=o>]</span> <span class=s2>&#34;GET / HTTP/1.1&#34;</span> <span class=m>200</span> -
</span></span><span class=line><span class=cl>127.0.0.1 - - <span class=o>[</span>17/May/2022 22:47:02<span class=o>]</span> <span class=s2>&#34;GET /get_review HTTP/1.1&#34;</span> <span class=m>200</span> -
</span></span><span class=line><span class=cl>127.0.0.1 - - <span class=o>[</span>17/May/2022 22:47:58<span class=o>]</span> <span class=s2>&#34;GET /get_review HTTP/1.1&#34;</span> <span class=m>200</span> -</span></span></code></pre></div><p>Verify that the service is working</p><ul><li>Open a new terminal and ssh into your ec2 instance. Then use the curl command in your terminal.</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:5000</span></span></code></pre></div><ul><li>Or hit the URL <code>http://{Your_EC2_IP_address}:5000</code> and <code>http://{Your_EC2_IP_address}:5000/get_review</code> with a browser</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl localhost:5000
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Hello, you want to hit /get_review. We have 100000 reviews!&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl localhost:5000/get_review
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;review_id&#34;</span>:<span class=s2>&#34;NjbiESXotcEdsyTc4EM3fg&#34;</span>,<span class=s2>&#34;user_id&#34;</span>:<span class=s2>&#34;PR9LAM19rCM_HQiEm5OP5w&#34;</span>,<span class=s2>&#34;business_id&#34;</span>:<span class=s2>&#34;UAtX7xmIfdd1W2Pebf6NWg&#34;</span>,<span class=s2>&#34;stars&#34;</span>:3.0,<span class=s2>&#34;useful&#34;</span>:0,<span class=s2>&#34;funny&#34;</span>:0,<span class=s2>&#34;cool&#34;</span>:0,<span class=s2>&#34;text&#34;</span>:<span class=s2>&#34;-If you&#39;re into cheap beer (pitcher of bud-light for </span><span class=nv>$7</span><span class=s2>) decent wings and a good time, this is the place for you. Its generally very packed after work hours and weekends. Don&#39;t expect cocktails. \n\n-You run into a lot of sketchy characters here sometimes but for the most part if you&#39;re chilling with friends its not that bad. \n\n-Friendly bouncer and bartenders.&#34;</span>,<span class=s2>&#34;date&#34;</span>:<span class=s2>&#34;2016-04-12 20:23:24&#34;</span><span class=o>}</span></span></span></code></pre></div><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><ul><li>What does this application do?</li><li>Do you see the yelp dataset being used?</li><li>Why did the output of pip freeze differ each time you ran it?</li><li>Which port is the REVIEW app listening on? Can other python apps use this same port?</li></ul></div></details><h2 id=2-create-a-review-container>2. Create a REVIEW container</h2><p>To create a container image, you need to create a Dockerfile, run docker build to build the image referencing the Docker file and push it up to a remote repository so it can be pulled by other sources.</p><ul><li><a href=https://docs.docker.com/get-started/02_our_app/ rel=external target=_blank>Create a Dockerfile</a></li><li>Creating a Dockerfile typically requires you to consider the following:<ul><li>Identify an appropriate container image<ul><li>ubuntu vs. python vs. alpine/slim</li><li>ubuntu - overkill, large image size, wasted resources when running in K8</li><li>this is a python app, so pick an image that is optimized for it</li><li><a href=https://lih-verma.medium.com/alpine-makes-python-docker-builds-way-too-50-slower-and-images-double-2-larger-61d1d43cbc79 rel=external target=_blank>avoid alpine for python</a></li></ul></li><li>Order matters<ul><li>you&rsquo;re building layers.</li><li>re-use the layers as much as possible</li><li>have items that change often towards the end</li></ul></li><li><a href=https://docs.docker.com/develop/develop-images/dockerfile_best-practices/ rel=external target=_blank>Other Best practices for writing Dockerfiles</a></li></ul></li></ul><p>Dockerfile for review</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:3.10-slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> requirements.txt /app<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install -r requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./review.py /app<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 5000</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span> <span class=s2>&#34;python&#34;</span><span class=p>,</span> <span class=s2>&#34;review.py&#34;</span> <span class=p>]</span></span></span></code></pre></div><p>Create a container image (locally)
Run ‘docker build’ to build a local container image referencing the Dockerfile</p><div class=tab-panel data-tab-group=1d7051d6ec5454171e2fa472f396f230><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=docker-build class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("1d7051d6ec5454171e2fa472f396f230","docker-build")'>
<span class=tab-nav-text>docker build</span>
</button>
<button data-tab-item=docker-build-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("1d7051d6ec5454171e2fa472f396f230","docker-build-output")'>
<span class=tab-nav-text>docker build Output</span></button></div><div class=tab-content-container><div data-tab-item=docker-build class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build -f Dockerfile -t localhost:8000/review:0.01 .</span></span></code></pre></div></div></div><div data-tab-item=docker-build-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[+] Building 35.5s (11/11) FINISHED
</span></span><span class=line><span class=cl> =&gt; [internal] load build definition from Dockerfile                              0.0s
</span></span><span class=line><span class=cl>         ...snip...
</span></span><span class=line><span class=cl> =&gt; [3/5] COPY requirements.txt /app                                              0.0s
</span></span><span class=line><span class=cl> =&gt; [4/5] RUN pip install -r requirements.txt                                     4.6s
</span></span><span class=line><span class=cl> =&gt; [5/5] COPY ./review.py /app                                                   0.0s
</span></span><span class=line><span class=cl> =&gt; exporting to image                                                            0.2s
</span></span><span class=line><span class=cl> =&gt; =&gt; exporting layers                                                           0.2s
</span></span><span class=line><span class=cl> =&gt; =&gt; writing image sha256:61da27081372723363d0425e0ceb34bbad6e483e698c6fe439c5  0.0s
</span></span><span class=line><span class=cl> =&gt; =&gt; naming to docker.io/localhost:8000/review:0.1                                   0.0</span></span></code></pre></div></div></div></div></div><p>Push the container image into a container repository
Run ‘docker push’ to place a copy of the REVIEW container to a remote location</p><div class=tab-panel data-tab-group=347f59a8bc6a89d727ea8db12390909a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=docker-push class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("347f59a8bc6a89d727ea8db12390909a","docker-push")'>
<span class=tab-nav-text>docker push</span>
</button>
<button data-tab-item=docker-push-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("347f59a8bc6a89d727ea8db12390909a","docker-push-output")'>
<span class=tab-nav-text>docker push Output</span></button></div><div class=tab-content-container><div data-tab-item=docker-push class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker push localhost:8000/review:0.01</span></span></code></pre></div></div></div><div data-tab-item=docker-push-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>The push refers to repository [docker.io/localhost:8000/review]
</span></span><span class=line><span class=cl>02c36dfb4867: Pushed
</span></span><span class=line><span class=cl>         ...snip...
</span></span><span class=line><span class=cl>fd95118eade9: Pushed
</span></span><span class=line><span class=cl>0.1: digest: sha256:3651f740abe5635af95d07acd6bcf814e4d025fcc1d9e4af9dee023a9b286f38 size: 2202</span></span></code></pre></div></div></div></div></div><p>Verify that the image is in Docker Hub. The same info can be found in Docker Desktop</p><div class=tab-panel data-tab-group=ec46739b2246cf40f0f7c4377175ce19><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=get-catalog class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ec46739b2246cf40f0f7c4377175ce19","get-catalog")'>
<span class=tab-nav-text>get catalog</span>
</button>
<button data-tab-item=get-catalog-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("ec46739b2246cf40f0f7c4377175ce19","get-catalog-output")'>
<span class=tab-nav-text>get catalog Output</span></button></div><div class=tab-content-container><div data-tab-item=get-catalog class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -s http://localhost:8000/v2/_catalog</span></span></code></pre></div></div></div><div data-tab-item=get-catalog-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{&#34;repositories&#34;:[&#34;review&#34;]}</span></span></code></pre></div></div></div></div></div><h2 id=3-run-review-in-kubernetes>3. Run REVIEW in Kubernetes</h2><p>Create K8 deployment yaml file for the REVIEW app</p><p>Reference: <a href=https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#creating-a-deployment rel=external target=_blank>Creating a Deployment</a></p><p>review.deployment.yaml</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>imagePullSecrets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>regcred</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>localhost:8000/review:0.01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/var/appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hostPath</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/var/appdata</span></span></span></code></pre></div><p>Notes regarding review.deployment.yaml:</p><ul><li>labels - K8 uses labels and selectors to tag and identify resources<ul><li>In the next step, we&rsquo;ll create a service and associate it to this deployment using the label</li></ul></li><li>replicas = 1<ul><li>K8 allows you to scale your deployments horizontally</li><li>We&rsquo;ll leverage this later to add load and increase our ingestion rate</li></ul></li><li>regcred provides this deployment with the ability to access your dockerhub credentials which is necessary to pull the container image.</li><li>The volume definition and volumemount make the yelp dataset visible to the container</li></ul><p>Create a K8 service yaml file for the review app.</p><p>Reference: <a href=https://kubernetes.io/docs/concepts/services-networking/service/#defining-a-service rel=external target=_blank>Creating a service:</a></p><p>review.service.yaml</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>NodePort</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>5000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>5000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>nodePort</span><span class=p>:</span><span class=w> </span><span class=m>30000</span></span></span></code></pre></div><p>Notes about review.service.yaml:</p><ul><li>the selector associates this service to pods with the label app with the value being review</li><li>the review service exposes the review pods as a network service<ul><li>other pods can now ping &lsquo;review&rsquo; and they will hit a review pod.</li><li>a pod would get a review if it ran <code>curl http://review:5000</code></li></ul></li><li>NodePort service<ul><li>the service is accessible to the K8 host by the nodePort, 30000</li><li>Another machine that has this can get a review if it ran <code>curl http://&lt;k8 host ip>:30000</code></li></ul></li></ul><p>Apply the review deployment and service</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f review.service.yaml -f review.deployment.yaml</span></span></code></pre></div><p>Verify that the deployment and services are running:</p><div class=tab-panel data-tab-group=488b18e0ea8c774125ba9576fe83b9c1><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-deployments class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("488b18e0ea8c774125ba9576fe83b9c1","kubectl-get-deployments")'>
<span class=tab-nav-text>kubectl get deployments</span>
</button>
<button data-tab-item=kubectl-get-deployments-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("488b18e0ea8c774125ba9576fe83b9c1","kubectl-get-deployments-output")'>
<span class=tab-nav-text>kubectl get deployments output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-deployments class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get deployments</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-deployments-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span class=line><span class=cl>review                                                  1/1     1            1           19h</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=26cb9aba99e16a7f98d5fb61b690f01b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-services class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("26cb9aba99e16a7f98d5fb61b690f01b","kubectl-get-services")'>
<span class=tab-nav-text>kubectl get services</span>
</button>
<button data-tab-item=kubectl-get-services-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("26cb9aba99e16a7f98d5fb61b690f01b","kubectl-get-services-output")'>
<span class=tab-nav-text>kubectl get services output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-services class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get services</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-services-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                       TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)                         AGE
</span></span><span class=line><span class=cl>review                     NodePort    10.43.175.21    &lt;none&gt;        5000:30000/TCP                  154d</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=43bf175e9861360a413ac4faa8696b70><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=curl-localhost class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("43bf175e9861360a413ac4faa8696b70","curl-localhost")'>
<span class=tab-nav-text>curl localhost</span>
</button>
<button data-tab-item=curl-localhost-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("43bf175e9861360a413ac4faa8696b70","curl-localhost-output")'>
<span class=tab-nav-text>curl localhost Output</span></button></div><div class=tab-content-container><div data-tab-item=curl-localhost class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl localhost:30000</span></span></code></pre></div></div></div><div data-tab-item=curl-localhost-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;message&#34;: &#34;Hello, you want to hit /get_review. We have 100000 reviews!&#34;
</span></span><span class=line><span class=cl>}</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=a857c5e84d381a1239f5d92585a96722><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=get-review class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("a857c5e84d381a1239f5d92585a96722","get-review")'>
<span class=tab-nav-text>get review</span>
</button>
<button data-tab-item=get-review-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a857c5e84d381a1239f5d92585a96722","get-review-output")'>
<span class=tab-nav-text>get review Output</span></button></div><div class=tab-content-container><div data-tab-item=get-review class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl localhost:30000/get_review</span></span></code></pre></div></div></div><div data-tab-item=get-review-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{&#34;review_id&#34;:&#34;Vv9rHtfBrFc-1M1DHRKN9Q&#34;,&#34;user_id&#34;:&#34;EaNqIwKkM7p1bkraKotqrg&#34;,&#34;business_id&#34;:&#34;TA1KUSCu8GkWP9w0rmElxw&#34;,&#34;stars&#34;:3.0,&#34;useful&#34;:1,&#34;funny&#34;:0,&#34;cool&#34;:0,&#34;text&#34;:&#34;This is the first time I&#39;ve actually written a review for Flip, but I&#39;ve probably been here about 10 times.  \n\nThis used to be where I would take out of town guests who wanted a good, casual, and relatively inexpensive meal.  \n\nI hadn&#39;t been for a while, so after a long day in midtown, we decided to head to Flip.  \n\nWe had the fried pickles, onion rings, the gyro burger, their special burger, and split a nutella milkshake.  I have tasted all of the items we ordered previously (with the exception of the special) and have been blown away with how good they were.  My guy had the special which was definitely good, so no complaints there.  The onion rings and the fried pickles were greasier than expected.  Though I&#39;ve thought they were delicious in the past, I probably wouldn&#39;t order either again.  The gyro burger was good, but I could have used a little more sauce.  It almost tasted like all of the ingredients didn&#39;t entirely fit together.  Something was definitely off. It was a friday night and they weren&#39;t insanely busy, so I&#39;m not sure I would attribute it to the staff not being on their A game...\n\nDon&#39;t get me wrong.  Flip is still good.  The wait staff is still amazingly good looking.  They still make delicious milk shakes.  It&#39;s just not as amazing as it once was, which really is a little sad.&#34;,&#34;date&#34;:&#34;2010-10-11 18:18:35&#34;}</span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What changes are required if you need to make an update to your Dockerfile now?</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=instrument-reviews-for-tracing>Instrument REVIEWS for Tracing</h1><h2 id=1-use-data-setup-to-instrument-a-python-application>1. Use Data Setup to instrument a Python application</h2><p>Within the O11y Cloud UI:</p><p>Data Management -> Add Integration -> Monitor Applications -> Python (traces) -> Add Integration</p><p>Provide the following to the Configure Integration Wizard:</p><ul><li><p>Service: review</p></li><li><p>Django: no</p></li><li><p>collector endpoint: <code>http://localhost:4317</code></p></li><li><p>Environment: rtapp-workshop-[YOURNAME]</p></li><li><p>Kubernetes: yes</p></li><li><p>Legacy Agent: no</p></li></ul><p><a href=#R-image-3c61ddddeaed31cea1cb82ff5a908f85 class=lightbox-link><img alt=o11y_cloud_ui class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/configureintegration.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3c61ddddeaed31cea1cb82ff5a908f85><img alt=o11y_cloud_ui class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/configureintegration.png></a></p><p>We are instructed to:</p><ul><li>Install the instrumentation packages for your Python environment.</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>pip install splunk-opentelemetry[all]
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>splunk-py-trace-bootstrap</span></span></code></pre></div><ul><li><p>Configure the Downward API to expose environment variables to Kubernetes resources.</p><p>For example, update a Deployment to inject environment variables by adding <code>.spec.template.spec.containers.env</code> like:</p></li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>your-application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>myapp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SPLUNK_OTEL_AGENT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>status.hostIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(SPLUNK_OTEL_AGENT):4317&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_SERVICE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;review&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_RESOURCE_ATTRIBUTES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;deployment.environment=rtapp-workshop-stevel&#34;</span></span></span></code></pre></div><ul><li><p>Enable the Splunk OTel Python agent by editing your Python service command.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>splunk-py-trace python3 main.py --port=8000</span></span></code></pre></div></li><li><p>The actions we must perform include:</p><ul><li>Update the Dockerfile to install the splunk-opentelemetry packages</li><li>Update the deployment.yaml for each service to include these environment variables which will be used by the pod and container.</li><li>Update our Dockerfile for REVIEW so that our program is bootstrapped with splunk-py-trace</li></ul></li></ul><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>We will accomplish this by:</p><ol><li>generating a new requirements.txt file</li><li>generating a new container image with an updated Dockerfile for REVIEW and then</li><li>update the review.deployment.yaml to capture all of these changes.</li></ol></div></details><h2 id=2-update-the-review-container>2. Update the REVIEW container</h2><ul><li><p>Generate a new container image</p></li><li><p>Update the Dockerfile for REVIEW (<code>/workshop/flask_apps_finish/review</code>)</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:3.10-slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> requirements.txt /app<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install -r requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install splunk-opentelemetry<span class=o>[</span>all<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> splk-py-trace-bootstrap<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./review.py /app<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 5000</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span> <span class=s2>&#34;splunk-py-trace&#34;</span> <span class=p>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span> <span class=s2>&#34;python&#34;</span><span class=p>,</span> <span class=s2>&#34;review.py&#34;</span> <span class=p>]</span></span></span></code></pre></div></li></ul><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>Note that the only lines, in bold, added to the Dockerfile</p></div></details><ul><li>Generate a new container image with docker build in the ‘finished’ directory</li><li>Notice that I have changed the repository name from <code>localhost:8000/review:0.01</code> to <code>localhost:8000/review-splkotel:0.01</code></li></ul><p>Ensure you are in the correct directory.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>pwd</span>
</span></span><span class=line><span class=cl>./workshop/flask_apps_finish/review</span></span></code></pre></div><div class=tab-panel data-tab-group=3608caaacc9f92f7dd6cbd8af11ae735><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=docker-build class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("3608caaacc9f92f7dd6cbd8af11ae735","docker-build")'>
<span class=tab-nav-text>docker build</span>
</button>
<button data-tab-item=docker-build-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("3608caaacc9f92f7dd6cbd8af11ae735","docker-build-output")'>
<span class=tab-nav-text>docker build Output</span></button></div><div class=tab-content-container><div data-tab-item=docker-build class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build -f Dockerfile.review -t localhost:8000/review-splkotel:0.01 .</span></span></code></pre></div></div></div><div data-tab-item=docker-build-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[+] Building 27.1s (12/12) FINISHED
</span></span><span class=line><span class=cl>=&gt; [internal] load build definition from Dockerfile                                                        0.0s
</span></span><span class=line><span class=cl>=&gt; =&gt; transferring dockerfile: 364B                                                                        0.0s
</span></span><span class=line><span class=cl>=&gt; [internal] load .dockerignore                                                                           0.0s
</span></span><span class=line><span class=cl>=&gt; =&gt; transferring context: 2B                                                                             0.0s
</span></span><span class=line><span class=cl>=&gt; [internal] load metadata for docker.io/library/python:3.10-slim                                         1.6s
</span></span><span class=line><span class=cl>=&gt; [auth] library/python:pull token for registry-1.docker.io                                               0.0s
</span></span><span class=line><span class=cl>=&gt; [1/6] FROM docker.io/library/python:3.10-slim@sha256:54956d6c929405ff651516d5ebbc204203a6415c9d2757aad  0.0s
</span></span><span class=line><span class=cl>=&gt; [internal] load build context                                                                           0.3s
</span></span><span class=line><span class=cl>=&gt; =&gt; transferring context: 1.91kB                                                                         0.3s
</span></span><span class=line><span class=cl>=&gt; CACHED [2/6] WORKDIR /app                                                                               0.0s
</span></span><span class=line><span class=cl>=&gt; [3/6] COPY requirements.txt /app                                                                        0.0s
</span></span><span class=line><span class=cl>=&gt; [4/6] RUN pip install -r requirements.txt                                                              15.3s
</span></span><span class=line><span class=cl>=&gt; [5/6] RUN splk-py-trace-bootstrap                                                                       9.0s
</span></span><span class=line><span class=cl>=&gt; [6/6] COPY ./review.py /app                                                                             0.0s
</span></span><span class=line><span class=cl>=&gt; exporting to image                                                                                      0.6s
</span></span><span class=line><span class=cl>=&gt; =&gt; exporting layers                                                                                     0.6s
</span></span><span class=line><span class=cl>=&gt; =&gt; writing image sha256:164977dd860a17743b8d68bcc50c691082bd3bfb352d1025dc3a54b15d5f4c4d                0.0s
</span></span><span class=line><span class=cl>=&gt; =&gt; naming to docker.io/localhost:8000/review-splkotel:0.01                                              0.0s</span></span></code></pre></div></div></div></div></div><ul><li>Push the image to Docker Hub with docker push command</li></ul><div class=tab-panel data-tab-group=d4534debf523b211a02a1f1410492cef><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=docker-push class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("d4534debf523b211a02a1f1410492cef","docker-push")'>
<span class=tab-nav-text>docker push</span>
</button>
<button data-tab-item=docker-push-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d4534debf523b211a02a1f1410492cef","docker-push-output")'>
<span class=tab-nav-text>docker push Output</span></button></div><div class=tab-content-container><div data-tab-item=docker-push class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker push localhost:8000/review-splkotel:0.01</span></span></code></pre></div></div></div><div data-tab-item=docker-push-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>The push refers to repository [docker.io/localhost:8000/review-splkotel]
</span></span><span class=line><span class=cl>682f0e550f2c: Pushed
</span></span><span class=line><span class=cl>dd7dfa312442: Pushed
</span></span><span class=line><span class=cl>917fd8334695: Pushed
</span></span><span class=line><span class=cl>e6782d51030d: Pushed
</span></span><span class=line><span class=cl>c6b19a64e528: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>8f52e3bfc0ab: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>f90b85785215: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>d5c0beb90ce6: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>3759be374189: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>fd95118eade9: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>0.01: digest: sha256:3b251059724dbb510ea81424fc25ed03554221e09e90ef965438da33af718a45 size: 2412</span></span></code></pre></div></div></div></div></div><h2 id=3-update-the-review-deployment-in-kubernetes>3. Update the REVIEW deployment in Kubernetes</h2><ul><li><p>review.deployment.yaml must be updated with the following changes:</p><ul><li>Load the new container image on Docker Hub</li><li>Add environment variables so traces can be emitted to the OTEL collector</li></ul></li><li><p>The deployment must be replaced using the updated review.deployment.yaml</p><ul><li><p>Update review.deployment.yaml (updates highlighted in bold)</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>imagePullSecrets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>regcred</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>localhost:8000/review-splkotel:0.01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/var/appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SPLUNK_OTEL_AGENT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>status.hostIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_SERVICE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;review&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SPLUNK_METRICS_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(SPLUNK_OTEL_AGENT):9943&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(SPLUNK_OTEL_AGENT):4317&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_RESOURCE_ATTRIBUTES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;deployment.environment=rtapp-workshop-stevel&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hostPath</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/var/appdata</span></span></span></code></pre></div></li></ul></li><li><p>Apply review.deployment.yaml. Kubernetes will automatically pick up the changes to the deployment and redeploy new pods with these updates</p><ul><li>Notice that the review-* pod has been restarted</li></ul></li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f review.deployment.yaml</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                              READY   STATUS        RESTARTS   AGE
</span></span><span class=line><span class=cl>kafka-client                                                      0/1     Unknown       0          155d
</span></span><span class=line><span class=cl>curl                                                              0/1     Unknown       0          155d
</span></span><span class=line><span class=cl>kafka-zookeeper-0                                                 1/1     Running       0          26h
</span></span><span class=line><span class=cl>kafka-2                                                           2/2     Running       0          26h
</span></span><span class=line><span class=cl>kafka-exporter-647bddcbfc-h9gp5                                   1/1     Running       2          26h
</span></span><span class=line><span class=cl>mongodb-6f6c78c76-kl4vv                                           2/2     Running       0          26h
</span></span><span class=line><span class=cl>kafka-1                                                           2/2     Running       1          26h
</span></span><span class=line><span class=cl>kafka-0                                                           2/2     Running       1          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-agent-n4dfn                      2/2     Running       0          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-k8s-cluster-receiver-5f48v296j   1/1     Running       0          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-agent-jqxhh                      2/2     Running       0          26h
</span></span><span class=line><span class=cl>review-6686859bd7-4pf5d                                           1/1     Running       0          11s
</span></span><span class=line><span class=cl>review-5dd8cfd77b-52jbd                                           0/1     Terminating   0          2d10h
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>kubectl get pods
</span></span><span class=line><span class=cl>NAME                                                              READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>kafka-client                                                      0/1     Unknown   0          155d
</span></span><span class=line><span class=cl>curl                                                              0/1     Unknown   0          155d
</span></span><span class=line><span class=cl>kafka-zookeeper-0                                                 1/1     Running   0          26h
</span></span><span class=line><span class=cl>kafka-2                                                           2/2     Running   0          26h
</span></span><span class=line><span class=cl>kafka-exporter-647bddcbfc-h9gp5                                   1/1     Running   2          26h
</span></span><span class=line><span class=cl>mongodb-6f6c78c76-kl4vv                                           2/2     Running   0          26h
</span></span><span class=line><span class=cl>kafka-1                                                           2/2     Running   1          26h
</span></span><span class=line><span class=cl>kafka-0                                                           2/2     Running   1          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-agent-n4dfn                      2/2     Running   0          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-k8s-cluster-receiver-5f48v296j   1/1     Running   0          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-agent-jqxhh                      2/2     Running   0          26h
</span></span><span class=line><span class=cl>review-6686859bd7-4pf5d                                           1/1     Running   0          15s</span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=monitor-system-logs-with-splunk-universal-forwarder>Monitor System Logs with Splunk Universal Forwarder</h1><p><strong>Objective:</strong> Learn how to monitor Linux system logs with the Universal Forwarder sending logs to Splunk Enterprise</p><p><strong>Duration</strong>: 10 Minutes</p><h2 id=scenario>Scenario</h2><p>You&rsquo;ve been tasked with monitoring the OS logs of the host running your Kubernetes cluster. We are going to utilize a script that will autodeploy the Splunk Universal Forwarder. You will then configure the Universal Forwarder to send logs to the Splunk Enterprise instance assigned to you.</p><h3 id=1-ensure-youre-in-the-correct-directory>1. Ensure You&rsquo;re in the Correct Directory</h3><ul><li>we will need to be in /home/splunk/session-2</li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk/session-2</span></span></code></pre></div><h3 id=2-review-the-universal-forwarder-install-script>2. Review the Universal Forwarder Install Script</h3><ul><li>Let&rsquo;s take a look at the script that will install the Universal Forwarder and Linux TA automatically for you.<ul><li>This script is primarily used for remote instances.</li><li>Note we are not using a deployment server in this lab, however it is recommended in production we do that.</li><li>What user are we installing Splunk as?</li></ul></li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/sh  
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># This EXAMPLE script shows how to deploy the Splunk universal forwarder</span>
</span></span><span class=line><span class=cl><span class=c1># to many remote hosts via ssh and common Unix commands.</span>
</span></span><span class=line><span class=cl><span class=c1># For &#34;real&#34; use, this script needs ERROR DETECTION AND LOGGING!!</span>
</span></span><span class=line><span class=cl><span class=c1># --Variables that you must set -----</span>
</span></span><span class=line><span class=cl><span class=c1># Set username using by splunkd to run.</span>
</span></span><span class=line><span class=cl>  <span class=nv>SPLUNK_RUN_USER</span><span class=o>=</span><span class=s2>&#34;ubuntu&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Populate this file with a list of hosts that this script should install to,</span>
</span></span><span class=line><span class=cl><span class=c1># with one host per line. This must be specified in the form that should</span>
</span></span><span class=line><span class=cl><span class=c1># be used for the ssh login, ie. username@host</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Example file contents:</span>
</span></span><span class=line><span class=cl><span class=c1># splunkuser@10.20.13.4</span>
</span></span><span class=line><span class=cl><span class=c1># splunkker@10.20.13.5</span>
</span></span><span class=line><span class=cl>  <span class=nv>HOSTS_FILE</span><span class=o>=</span><span class=s2>&#34;myhost.txt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># This should be a WGET command that was *carefully* copied from splunk.com!!</span>
</span></span><span class=line><span class=cl><span class=c1># Sign into splunk.com and go to the download page, then look for the wget</span>
</span></span><span class=line><span class=cl><span class=c1># link near the top of the page (once you have selected your platform)</span>
</span></span><span class=line><span class=cl><span class=c1># copy and paste your wget command between the &#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>WGET_CMD</span><span class=o>=</span><span class=s2>&#34;wget -O splunkforwarder-9.0.3-dd0128b1f8cd-Linux-x86_64.tgz &#39;https://download.splunk.com/products/universalforwarder/releases/9.0.3/linux/splunkforwarder-9.0.3-dd0128b1f8cd-Linux-x86_64.tgz&#39;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Set the install file name to the name of the file that wget downloads</span>
</span></span><span class=line><span class=cl><span class=c1># (the second argument to wget)</span>
</span></span><span class=line><span class=cl>  <span class=nv>INSTALL_FILE</span><span class=o>=</span><span class=s2>&#34;splunkforwarder-9.0.3-dd0128b1f8cd-Linux-x86_64.tgz&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># After installation, the forwarder will become a deployment client of this</span>
</span></span><span class=line><span class=cl><span class=c1># host.  Specify the host and management (not web) port of the deployment server</span>
</span></span><span class=line><span class=cl><span class=c1># that will be managing these forwarder instances.</span>
</span></span><span class=line><span class=cl><span class=c1># Example 1.2.3.4:8089</span>
</span></span><span class=line><span class=cl><span class=c1>#  DEPLOY_SERVER=&#34;x.x.x.x:8089&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># After installation, the forwarder can have additional TA&#39;s added to the </span>
</span></span><span class=line><span class=cl><span class=c1># /app directory please provide the local where TA&#39;s will be. </span>
</span></span><span class=line><span class=cl>  <span class=nv>TA_INSTALL_DIRECTORY</span><span class=o>=</span><span class=s2>&#34;/home/splunk/session-2&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the seed app folder name for deploymentclien.conf</span>
</span></span><span class=line><span class=cl><span class=c1>#  DEPLOY_APP_FOLDER_NAME=&#34;seed_all_deploymentclient&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Set the new Splunk admin password</span>
</span></span><span class=line><span class=cl>  <span class=nv>PASSWORD</span><span class=o>=</span><span class=s2>&#34;buttercup&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>REMOTE_SCRIPT_DEPLOY</span><span class=o>=</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>  cd /opt
</span></span></span><span class=line><span class=cl><span class=s2>  sudo </span><span class=nv>$WGET_CMD</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  sudo tar xvzf </span><span class=nv>$INSTALL_FILE</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  sudo rm </span><span class=nv>$INSTALL_FILE</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo useradd </span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  sudo find </span><span class=nv>$TA_INSTALL_DIRECTORY</span><span class=s2> -name &#39;*.tgz&#39; -exec tar xzvf {} --directory /opt/splunkforwarder/etc/apps \;
</span></span></span><span class=line><span class=cl><span class=s2>  sudo chown -R </span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2>:</span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2> /opt/splunkforwarder
</span></span></span><span class=line><span class=cl><span class=s2>  echo \&#34;[user_info] 
</span></span></span><span class=line><span class=cl><span class=s2>  USERNAME = admin
</span></span></span><span class=line><span class=cl><span class=s2>  PASSWORD = </span><span class=nv>$PASSWORD</span><span class=s2>\&#34; &gt; /opt/splunkforwarder/etc/system/local/user-seed.conf   
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo cp </span><span class=nv>$TA_INSTALL_DIRECTORY</span><span class=s2>/*.tgz /opt/splunkforwader/etc/apps/
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo find /opt/splunkforwarder/etc/apps/ -name &#39;*.tgz&#39; -exec tar xzvf {} \;
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo -u splunk /opt/splunkforwarder/bin/splunk start --accept-license --answer-yes --auto-ports --no-prompt
</span></span></span><span class=line><span class=cl><span class=s2>  /opt/splunkforwarder/bin/splunk start --accept-license --answer-yes --auto-ports --no-prompt
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo /opt/splunkforwarder/bin/splunk enable boot-start -user </span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  /opt/splunkforwarder/bin/splunk enable boot-start -user </span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo cp </span><span class=nv>$TA_INSTALL_DIRECTORY</span><span class=s2>/*.tgz /opt/splunkforwarder/etc/apps/
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  exit
</span></span></span><span class=line><span class=cl><span class=s2> &#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>DIR</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span> <span class=nb>cd</span> <span class=s2>&#34;</span><span class=k>$(</span> dirname <span class=s2>&#34;</span><span class=si>${</span><span class=nv>BASH_SOURCE</span><span class=p>[0]</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>)</span><span class=s2>&#34;</span> &gt;/dev/null <span class=o>&amp;&amp;</span> <span class=nb>pwd</span> <span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#===============================================================================================</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;In 5 seconds, will run the following script on each remote host:&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;====================&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$REMOTE_SCRIPT_DEPLOY</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;====================&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> 
</span></span><span class=line><span class=cl>  sleep <span class=m>5</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Reading host logins from </span><span class=nv>$HOSTS_FILE</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Starting.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> DST in <span class=sb>`</span>cat <span class=s2>&#34;</span><span class=nv>$DIR</span><span class=s2>/</span><span class=nv>$HOSTS_FILE</span><span class=s2>&#34;</span><span class=sb>`</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=nv>$DST</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>      <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;---------------------------&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Installing to </span><span class=nv>$DST</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Initial UF deployment&#34;</span>
</span></span><span class=line><span class=cl>    sudo ssh -t <span class=s2>&#34;</span><span class=nv>$DST</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$REMOTE_SCRIPT_DEPLOY</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>done</span>  
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;---------------------------&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Done&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Please use the following app folder name to override deploymentclient.conf options: </span><span class=nv>$DEPLOY_APP_FOLDER_NAME</span><span class=s2>&#34;</span></span></span></code></pre></div><h3 id=3-run-the-install-script>3. Run the install script</h3><p>We will run the install script now. You will see some Warnings at the end. This is totally normal. The script is built for use on remote machines, however for todays lab you will be using localhost.</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./install.sh</span></span></code></pre></div><p>You will be asked <code>Are you sure you want to continue connecting (yes/no/[fingerprint])?</code>
Answer Yes.</p><p>Enter your ssh password when prompted.</p><h3 id=4-verify-installation-of-the-universal-forwarader>4. Verify installation of the Universal Forwarader</h3><ul><li>We need to verify that the Splunk Universal Forwarder is installed and running.<ul><li>You should see a couple PID&rsquo;s return and a &ldquo;Splunk is currently running.&rdquo; message.</li></ul></li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/opt/splunkforwarder/bin/splunk status</span></span></code></pre></div><h4 id=5-configure-the-universal-forwarder-to-send-data-to-splunk-enterprise>5. Configure the Universal Forwarder to Send Data to Splunk Enterprise</h4><ul><li>We will be able to send the data to our Splunk Enterprise environment easily by entering one line into the cli.<ul><li><a href=https://docs.splunk.com/Documentation/Forwarder/9.0.3/Forwarder/Configuretheuniversalforwarder rel=external target=_blank>Universal Forwarder Config Guide</a></li></ul></li></ul><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/opt/splunkforwarder/bin/splunk add forward-server &lt;your_splunk_enterprise_ip&gt;:9997</span></span></code></pre></div><h4 id=6-verify-the-data-in-your-splunk-enterprise-environment>6. Verify the Data in Your Splunk Enterprise Environment</h4><ul><li><p>We are now going to take a look at the Splunk Enterprise environment to verify logs are coming in.</p><ul><li>Logs will be coming into <code>index=main</code></li></ul></li><li><p>Open your web browser and navigate to: <code>http://&lt;your_splunk_enterprise_ip:8000</code></p><ul><li>You will use the credentials <code>admin:&lt;your_ssh_password></code></li></ul></li><li><p>In the search bar, type in the following:</p></li><li><p><code>index=main host=&lt;your_host_name></code></p></li><li><p>You should see data from your host. Take note of the interesting fields and the different data sources flowing in.</p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=splunk-oncall>Splunk OnCall</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>1 hour 30 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Geoff Higginbottom</span></span><h2 id=aim>Aim</h2><p>This module is simply to ensure you have access to the Splunk On-Call UI (formerly known as VictorOps), Splunk Infrastructure Monitoring UI (formerly known as SignalFx) and the EC2 Instance which has been allocated to you.</p><p>Once you have access to each platform, keep them open for the duration of the workshop as you will be switching between them and the workshop instructions.</p><h2 id=1-activate-your-splunk-on-call-login>1. Activate your Splunk On-Call Login</h2><p>You should have received an invitation to Activate your Splunk On-Call account via e-mail, if you have not already done so, click the <em>Activate Account</em> link and follow the prompts.</p><p>If you did not receive an invitation it is probably because you already have a Splunk On-Call login, linked to a different organization.</p><p>If so log in to that Org, then use the organization dropdown next to your username in the top left to switch to the Observability Workshop Org.</p><p><a href=#R-image-eb20a67cf0029f059ebf736cdde9f468 class=lightbox-link><img alt="Switch Org" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/switch-org.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eb20a67cf0029f059ebf736cdde9f468><img alt="Switch Org" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/switch-org.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>If you do not see the Organisation dropdown menu item next to your name with Observability Workshop EMEA that is OK, it simply means you only have access to a single Org so that menu is not visible to you.</p><p>If you have forgotten your password go to the <a href=https://portal.victorops.com/membership/#/ rel=external target=_blank>https://portal.victorops.com/membership/#/</a> page and use the forgotten password link to reset your password.</p><p><a href=#R-image-1e7ed4ad0b616aeb3562aaf6c75ba743 class=lightbox-link><img alt="Reset Pwd" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/reset-password.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1e7ed4ad0b616aeb3562aaf6c75ba743><img alt="Reset Pwd" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/reset-password.png></a></p></div></details><h2 id=2-activate-your-splunk-infrastructure-monitoring-login>2. Activate your Splunk Infrastructure Monitoring Login</h2><p>You should have received an invitation to join the Splunk Infrastructure Monitoring - Observability Workshop. If you have not already done so click the <span class="btn cstyle transparent"><span><span class=title>JOIN NOW</span></span></span> button and follow the prompts to set a password and activate your login.</p><h2 id=3-access-your-ec2-instance>3. Access your EC2 Instance</h2><p>Splunk has provided you with a dedicated EC2 Instance which you can use during this workshop for triggering Incidents the same way the instructor did during the introductory demo. This VM has Splunk Infrastructure Monitoring deployed and has an associated Detector configured. The Detector will pass Alerts to Splunk On-Call which will then create Incidents and page the on-call user.</p><p>The welcome e-mail you received providing you all the details for this Workshop contain the instructions for accessing your allocated EC2 Instance.</p><h3 id=ssh-mac-oslinux>SSH (Mac OS/Linux)</h3><p>Most attendees will be able to connect to the workshop by using SSH from their Mac or Linux device.</p><p>To use SSH, open a terminal on your system and type <code>ssh splunk@x.x.x.x</code> (replacing x.x.x.x with the IP address found in your welcome e-mail).</p><p><a href=#R-image-ca9f029471ce8ac70faf7cf93cabe2d4 class=lightbox-link><img alt="ssh login" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/ssh-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ca9f029471ce8ac70faf7cf93cabe2d4><img alt="ssh login" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/ssh-1.png></a></p><p>When prompted <strong><code>Are you sure you want to continue connecting (yes/no/[fingerprint])?</code></strong> please type <strong><code>yes</code></strong>.</p><p><a href=#R-image-f297c7612a2fd238738c8a1f92788dcd class=lightbox-link><img alt="ssh password" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/ssh-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f297c7612a2fd238738c8a1f92788dcd><img alt="ssh password" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/ssh-2.png></a></p><p>Enter the password provided in the welcome e-mail.</p><p>Upon successful login you will be presented with the Splunk logo and the Linux prompt.</p><p><a href=#R-image-cedeb418417d3ac5f997124aec70c4ae class=lightbox-link><img alt="ssh connected" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/ssh-3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cedeb418417d3ac5f997124aec70c4ae><img alt="ssh connected" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/ssh-3.png></a></p><p>At this point you are ready to <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/getting_started/index.html>continue with the workshop</a> when instructed to do so by the instructor</p><hr><h3 id=putty-windows-users-only>Putty (Windows users only)</h3><p>If you do not have ssh pre-installed or if you are on a Windows system, the best option is to install putty, you can find the downloads <a href=https://www.putty.org/ rel=external target=_blank>here</a>.</p><p>!!! important
If you <strong>cannot</strong> install Putty, please go to <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/index.html#web-browser-all>Web Browser (All)</a>.</p><p>Open Putty and in the <strong>Host Name (or IP address)</strong> field enter the IP address provided in the welcome e-mail.</p><p>You can optionally save your settings by providing a name and pressing <strong>Save</strong>.</p><p><a href=#R-image-563791e1a9446469815a114aa11d356d class=lightbox-link><img alt=putty-2 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/putty-settings.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-563791e1a9446469815a114aa11d356d><img alt=putty-2 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/putty-settings.png></a></p><p>To then login to your instance click on the <strong>Open</strong> button as shown above.</p><p>If this is the first time connecting to your EC2 instance, you will be presented with a security dialogue, please click <strong>Yes</strong>.</p><p><a href=#R-image-c754ac49247b1656d8d4238b4b2e9a58 class=lightbox-link><img alt=putty-3 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/putty-security.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c754ac49247b1656d8d4238b4b2e9a58><img alt=putty-3 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/putty-security.png></a></p><p>Once connected, login in as <strong>splunk</strong> using the password provided in the welcome e-mail.</p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-1a7bc56b9a1cbae76958898d0ffba235 class=lightbox-link><img alt=putty-4 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/putty-loggedin.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1a7bc56b9a1cbae76958898d0ffba235><img alt=putty-4 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/putty-loggedin.png></a></p><p>At this point you are ready to <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/getting_started/index.html>continue with the workshop</a> when instructed to do so by the instructor</p><hr><h3 id=web-browser-all>Web Browser (All)</h3><p>If you are blocked from using SSH (Port 22) or unable to install Putty you may be able to connect to the workshop instance by using a web browser.</p><p>!!! note
This assumes that access to port 6501 is not restricted by your company&rsquo;s firewall.</p><p>Open your web browser and type <code>http://x.x.x.x:650</code> (where <code>x.x.x.x</code> is the IP address from the welcome e-mail).</p><p><a href=#R-image-4105fabbc2ec9ad9b726bfa116bdd8cc class=lightbox-link><img alt=http-6501 class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-url.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4105fabbc2ec9ad9b726bfa116bdd8cc><img alt=http-6501 class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-url.png></a></p><p>Once connected, login in as <strong>splunk</strong> and the password is the one provided in the welcome e-mail.</p><p><a href=#R-image-68ce39b61b085eb8d5fcccfec6bcb6de class=lightbox-link><img alt=http-connect class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-connect.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-68ce39b61b085eb8d5fcccfec6bcb6de><img alt=http-connect class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-connect.png></a></p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-666d74a60bd1073c32bc82a9ce0e1ca5 class=lightbox-link><img alt="web login" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-login.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-666d74a60bd1073c32bc82a9ce0e1ca5><img alt="web login" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-login.png></a></p><hr><h3 id=copy--paste-in-browser>Copy & Paste in browser</h3><p>Unlike when you are using regular SSH, <em>copy and paste</em> does require a few extra steps to complete when using a browser session. This is due to cross browser restrictions.</p><p>When the workshop asks you to copy instructions into your terminal, please do the following:</p><p><em>Copy the instruction as normal, but when ready to paste it in the web terminal, choose <strong>Paste from browser</strong> as show below:</em></p><p><a href=#R-image-60ce3b039d79866246fd47786fa86ed6 class=lightbox-link><img alt="web paste 1" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-paste-browser.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-60ce3b039d79866246fd47786fa86ed6><img alt="web paste 1" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-paste-browser.png></a></p><p>This will open a dialogue box asking for the text to be pasted into the web terminal:</p><p><a href=#R-image-509a90427615c0263a76cfd1d22c27be class=lightbox-link><img alt="web paste 3" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-example-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-509a90427615c0263a76cfd1d22c27be><img alt="web paste 3" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/images/shellinabox-example-1.png></a></p><p>Paste the text in the text box as show, then press <strong>OK</strong> to complete the copy and paste process.</p><details open class="box cstyle notices primary"><summary class="box-label a11y-only"><span class=a11y-only>Details</span></summary><div class=box-content><p>Unlike regular SSH connection, the web browser has a 60 second time out, and you will be disconnected, and a <strong>Connect</strong> button will be shown in the center of the web terminal.</p><p>Simply click the <strong>Connect</strong> button and you will be reconnected and will be able to continue.</p></div></details><p>At this point you are ready to <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/getting_started/index.html>continue with the workshop</a> when instructed to do so by the instructor</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Splunk OnCall</h1><article class=default><header class=headline></header><h1 id=user-profile>User Profile</h1><h2 id=aim>Aim</h2><p>The aim of this module is for you to configure your personal profile which controls how you will be notified by Splunk On-Call whenever you get paged.</p><h2 id=1-contact-methods>1. Contact Methods</h2><p>Switch to the Splunk On-Call UI and click on your login name in the top right hand corner and chose <strong>Profile</strong> from the drop down. Confirm your contact methods are listed correctly and add any additional phone numbers and e-mail address you wish to use.</p><h2 id=2-mobile-devices>2. Mobile Devices</h2><p>To install the Splunk On-Call app for your smartphone search your phones App Store for Splunk On-Call to find the appropriate version of the app. The publisher should be listed as VictorOps Inc.</p><p><a href=https://apps.apple.com/us/app/victorops/id696974262 rel=external target=_blank>Apple Store</a></p><p><a href="https://play.google.com/store/apps/details?id=com.victorops.androidclient&hl=en" rel=external target=_blank>Google Play</a></p><p>Configuration help guides are available:</p><ul><li><a href=https://help.victorops.com/knowledge-base/ios-application/ rel=external target=_blank>Apple</a></li><li><a href=https://help.victorops.com/knowledge-base/android-devices-victorops/ rel=external target=_blank>Android</a></li></ul><p>Install the App and login, then refresh the Profile page and your device should now be listed under the devices section. Click the <strong>Test push notification</strong> button and confirm you receive the test message.</p><h2 id=3-personal-calendar>3. Personal Calendar</h2><p>This link will enable you to sync your on-call schedule with your calendar, however as you do not have any allocated shifts yet this will currently be empty. You can add it to your calendar by copying the link into your preferred application and setting it up as a new subscription.</p><h2 id=4-paging-policies>4. Paging Policies</h2><p>Paging Polices specify how you will be contacted when on-call. The Primary Paging Policy will have defaulted to sending you an SMS assuming you added your phone number when activating your account. We will now configure this policy into a three tier multi-stage policy similar to the image below.</p><p><a href=#R-image-26eed73c7337cbb539d17a0f988bddf1 class=lightbox-link><img alt="Paging Policy" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/primary-paging-policy.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-26eed73c7337cbb539d17a0f988bddf1><img alt="Paging Policy" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/primary-paging-policy.png></a></p><h3 id=41-send-a-push-notification>4.1 Send a push notification</h3><p>Click the edit policy button in the top right corner for the Primary Paging Policy.</p><ul><li>Send a push notification to all my devices</li><li>Execute the next step if I have not responded within 5 minutes</li></ul><p><a href=#R-image-5c51d9e3c7aa65020716541641bbc7f7 class=lightbox-link><img alt="Step 1" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/pri-page-step1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5c51d9e3c7aa65020716541641bbc7f7><img alt="Step 1" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/pri-page-step1.png></a></p><p>Click <strong>Add a Step</strong></p><h3 id=42-send-an-e-mail>4.2 Send an e-mail</h3><ul><li>Send an e-mail to [your email address]</li><li>Execute the next step if I have not responded within 5 minutes</li></ul><p><a href=#R-image-ca389daaa98d0705dcb785fe38f9c19e class=lightbox-link><img alt="Step 2" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/pri-page-step2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ca389daaa98d0705dcb785fe38f9c19e><img alt="Step 2" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/pri-page-step2.png></a></p><p>Click <strong>Add a Step</strong></p><h3 id=43-call-your-number>4.3 Call your number</h3><ul><li>Every 5 minutes until we have reached you</li><li>Make a phone call to [your phone number]</li></ul><p>Click <span class="btn cstyle default" style=--VARIABLE-BOX-color:#00bce4><span><span class=title>Save</span></span></span> to save the policy.</p><p><a href=#R-image-923fcb451ce93625f1f3187337c2e624 class=lightbox-link><img alt="Step 3" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/pri-page-step3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-923fcb451ce93625f1f3187337c2e624><img alt="Step 3" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/pri-page-step3.png></a></p><p>When you are on-call or in the escalation path of an incident, you will receive notifications in this order following these time delays.</p><p>To cease the paging you must acknowledge the incident. Acknowledgements can occur in one of the following ways:</p><ul><li>Expanding the Push Notification on your device and selecting Acknowledge</li><li>Responding to the SMS with the 5 digit code included</li><li>Pressing 4 during the Phone Call</li><li>Slack Button</li></ul><p>For more information on Notification Types, see <a href=https://help.victorops.com/knowledge-base/notification-types/ rel=external target=_blank>here</a>.</p><h2 id=5-custom-paging-policies>5. Custom Paging Policies</h2><p>Custom paging polices enable you to override the primary policy based on the time and day of the week. A good example would be to get the system to immediately phone you whenever you get a page during the evening or weekends as this is more likely to get your attention than a push notification.</p><p>Create a new Custom Policy by clicking <strong>Add a Policy</strong> and configure with the following settings:</p><h3 id=51-custom-evening-policy>5.1 Custom evening policy</h3><p>Policy Name: Evening</p><ul><li>Every 5 minutes until we have reached you<ul><li>Make a phone call to [your phone number]</li><li>Time Period: All 7 Days</li><li>Time zone<ul><li>Between 7pm and 9am</li></ul></li></ul></li></ul><p><a href=#R-image-1a06f418e2cfc2716826d53c79fdde3f class=lightbox-link><img alt=Evening class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/evening.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1a06f418e2cfc2716826d53c79fdde3f><img alt=Evening class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/evening.png></a></p><p>Click <span class="btn cstyle default" style=--VARIABLE-BOX-color:#00bce4><span><span class=title>Save</span></span></span> to save the policy then add one more.</p><h3 id=52-custom-weekend-policy>5.2 Custom weekend policy</h3><p>Policy Name: Weekend</p><ul><li>Every 5 minutes until we have reached you<ul><li>Make a phone call to [your phone number]</li><li>Time Period: Sat & Sun</li><li>Time zone<ul><li>Between 9am and 7pm</li></ul></li></ul></li></ul><p>Click <span class="btn cstyle default" style=--VARIABLE-BOX-color:#00bce4><span><span class=title>Save</span></span></span> to save the policy.</p><p><a href=#R-image-9045b031732a2ba67ffd4a23d407d6a4 class=lightbox-link><img alt=Weekends class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/weekends.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9045b031732a2ba67ffd4a23d407d6a4><img alt=Weekends class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/weekends.png></a></p><p>These custom paging policies will be used during the specified times in place of the Primary Policy. However, admins do have the ability to ignore these custom policies, and we will highlight how this is achieved in a later module.</p><p>The final option here is the setting for Recovery Notifications. These are typically low priority, will default to Push, but can also be email, sms or phone call. Your profile is now fully configured using these example configurations.</p><p>Organizations will have different views on how profiles should be configured and will typically issue guidelines for paging policies and times between escalations etc.</p><p>Please wait for the instructor before proceeding to the Teams module.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Getting Started</h1><article class=default><header class=headline></header><h1 id=teams>Teams</h1><h2 id=aim>Aim</h2><p>The aim of this module is for you to complete the first step of Team configuration by adding users to your Team.</p><h2 id=1-find-your-team>1. Find your Team</h2><p>Navigate to the <strong>Teams</strong> tab on the main toolbar, you should find you that a Team has been created for you as part of the workshop pre-setup and you would have been informed of your Team Name via e-mail.</p><p>If you have found your pre-configured Team, <strong>skip Step 2.</strong> and proceed to <strong><a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/getting_started/team/index.html#3-configure-your-team>Step 3. Configure Your Team</a></strong>. However, if you cannot find your allocated Team, you will need to create a new one, so proceed with <strong>Step 2. Create Team</strong></p><h2 id=2-create-team>2. Create Team</h2><p>Only complete this step if you <strong>cannot</strong> find your pre-allocated Team as detailed in your workshop e-mail. Select <strong>Add Team</strong>, then enter your allocated team name, this will typically be in the format of &ldquo;AttendeeID Workshop&rdquo; and then save by clicking the <strong>Add Team</strong> button.</p><h2 id=3-configure-your-team>3. Configure Your Team</h2><p>You now need to add other users to your team. If you are running this workshop using the Splunk provided environment, the following accounts are available for testing. If you are running this lab in your own environment, you will have been provided a list of usernames you can use in place of the table below.</p><p>These users are dummy accounts who will not receive notifications when they are on call.</p><table><thead><tr><th style=text-align:left>Name</th><th style=text-align:left>Username</th><th style=text-align:left>Shift</th></tr></thead><tbody><tr><td style=text-align:left>Duane Chow</td><td style=text-align:left>duanechow</td><td style=text-align:left>Europe</td></tr><tr><td style=text-align:left>Steven Gomez</td><td style=text-align:left>gomez</td><td style=text-align:left>Europe</td></tr><tr><td style=text-align:left>Walter White</td><td style=text-align:left>heisenberg</td><td style=text-align:left>Europe</td></tr><tr><td style=text-align:left>Jim Halpert</td><td style=text-align:left>jimhalpert</td><td style=text-align:left>Asia</td></tr><tr><td style=text-align:left>Lydia Rodarte-Quayle</td><td style=text-align:left>lydia</td><td style=text-align:left>Asia</td></tr><tr><td style=text-align:left>Marie Schrader</td><td style=text-align:left>marie</td><td style=text-align:left>Asia</td></tr><tr><td style=text-align:left>Maximo Arciniega</td><td style=text-align:left>maximo</td><td style=text-align:left>West Coast</td></tr><tr><td style=text-align:left>Michael Scott</td><td style=text-align:left>michaelscott</td><td style=text-align:left>West Coast</td></tr><tr><td style=text-align:left>Tuco Salamanca</td><td style=text-align:left>tuco</td><td style=text-align:left>West Coast</td></tr><tr><td style=text-align:left>Jack Welker</td><td style=text-align:left>jackwelker</td><td style=text-align:left>24/7</td></tr><tr><td style=text-align:left>Hank Schrader</td><td style=text-align:left>hank</td><td style=text-align:left>24/7</td></tr><tr><td style=text-align:left>Pam Beesly</td><td style=text-align:left>pambeesly</td><td style=text-align:left>24/7</td></tr></tbody></table><p>Add the users to your team, using either the above list or the alternate one provided to you. The value in the <strong>Shift</strong> column can be ignored for now, but will be required for a later step.</p><p>Click <span class="btn cstyle default" style=--VARIABLE-BOX-color:#00bce4><span><span class=title>Invite User</span></span></span> button on the right hand side, then either start typing the usernames (this will filter the list), or copy and paste them into the dialogue box. Once all users are added to the list click the <strong>Add User</strong> button.</p><p><a href=#R-image-054e091dd158f80b943755d61cecb910 class=lightbox-link><img alt="Add Team Members" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/add-team-members.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-054e091dd158f80b943755d61cecb910><img alt="Add Team Members" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/add-team-members.png></a></p><p>To make a team member a Team Admin, simply click the :fontawesome-regular-edit: icon in the right hand column, pick any user and make them an Admin.</p><p><a href=#R-image-6f4aaa72c244761fa20547ed7fb3aca8 class=lightbox-link><img alt="Add Admin" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/team-admin.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6f4aaa72c244761fa20547ed7fb3aca8><img alt="Add Admin" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/team-admin.png></a></p><details open class="box cstyle notices default" style=--VARIABLE-BOX-color:info><summary class=box-label>Tip</summary><div class=box-content><p>For large team management you can use the APIs to streamline this process.</p></div></details><p>Continue and also complete the <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/getting_started/rotations/index.html>Configure Rotations</a> module.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=configure-rotations>Configure Rotations</h1><h2 id=aim>Aim</h2><p>A rotation is a recurring schedule, that consists of one or more shifts, with members who rotate through a shift.</p><p>The aim of this module is for you to configure two example Rotations, and assign Team Members to the Rotations.</p><hr><p>Navigate to the <strong>Rotations</strong> tab on the <strong>Teams</strong> sub menu, you should have no existing Rotations so we need to create some.</p><p>The 1st Rotation you will create is for a follow the sun support pattern where the members of each shift provide cover during their normal working hours within their time zone.</p><p>The 2nd will be a Rotation used to provide escalation support by more experienced senior members of the team, based on a 24/7, 1 week shift pattern.</p><h2 id=1-follow-the-sun-support---business-hours>1. Follow the Sun Support - Business Hours</h2><p>Click <strong>Add Rotation</strong></p><p><a href=#R-image-c243ec1e61bce4e3c608db8da119a616 class=lightbox-link><img alt="Add Rotation" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/add-rotation.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c243ec1e61bce4e3c608db8da119a616><img alt="Add Rotation" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/add-rotation.png></a></p><p>Enter a name of &ldquo;<em>Follow the Sun Support - Business Hours</em>&rdquo; and Select <strong>Partial day</strong> from the three available shift templates.</p><p><a href=#R-image-3dfcd4ce0e6644cfcee37365ae8a15d2 class=lightbox-link><img alt="Follow the Sun" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/follow-the-sun.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3dfcd4ce0e6644cfcee37365ae8a15d2><img alt="Follow the Sun" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/follow-the-sun.png></a></p><ul><li>Enter a Shift name of &ldquo;<em>Asia</em>&rdquo;</li><li>Time Zone set to &ldquo;<em>Asia/Tokyo</em>&rdquo;</li><li>Each user is on duty from &ldquo;<em>Monday through Friday from 9.00am to 5.00pm</em>&rdquo;</li><li>Handoff happens every &ldquo;<em>5 days</em>&rdquo;</li><li>The next handoff happens - Select the next Monday using the calendar</li><li>Click <strong>Save Rotation</strong></li></ul><p><a href=#R-image-b29ef992624f9fc4ee17a8d7e385942b class=lightbox-link><img alt="Asia Shift" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/asia-shift.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b29ef992624f9fc4ee17a8d7e385942b><img alt="Asia Shift" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/asia-shift.png></a></p><p>You will now be prompted to add Members to this shift; add the Asia members who are <strong>Jim Halpert, Lydie Rodarte-Quayle and Marie Schrader</strong>, but only if you&rsquo;re using the Splunk provided environment for this workshop.</p><p>If you&rsquo;re using your own Organisation refer to the specific list provided separately.</p><p><a href=#R-image-2bbd2a0ab4fa04807e55136676c0c33a class=lightbox-link><img alt="Asia Members" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/asia-members.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2bbd2a0ab4fa04807e55136676c0c33a><img alt="Asia Members" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/asia-members.png></a></p><p>Now add an 2nd shift for Europe by again clicking <strong>+Add a shift → Partial Day</strong></p><ul><li>Enter a Shift name of &ldquo;<em>Europe</em>&rdquo;</li><li>Time Zone set to &ldquo;<em>Europe/London</em>&rdquo;</li><li>Each user is on duty from &ldquo;<em>Monday through Friday from 9.00am to 5.00pm</em>&rdquo;</li><li>Handoff happens every &ldquo;<em>5 days</em>&rdquo;</li><li>The next handoff happens - Select the next Monday using the calendar</li><li>Click <strong>Save Shift</strong></li></ul><p><a href=#R-image-808cc354934e182efc389aeb49f902b5 class=lightbox-link><img alt="Europe Shift" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/europe-shift.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-808cc354934e182efc389aeb49f902b5><img alt="Europe Shift" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/europe-shift.png></a></p><p>You will again be prompted to add Members to this shift; add the Europe members who are <strong>Duane Chow, Steven Gomez and Walter White</strong>, but only if you&rsquo;re using the Observability Workshop Org for this workshop.</p><p>If you&rsquo;re using your own Organisation refer to the specific list provided separately.</p><p><a href=#R-image-738c74edd4b063906a0a325d3675d0f7 class=lightbox-link><img alt="Europe Members" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/europe-members.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-738c74edd4b063906a0a325d3675d0f7><img alt="Europe Members" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/europe-members.png></a></p><p>Now add a 3rd shift for West Coast USA by again clicking <code>+Add a shift</code> - <code>Partial Day</code></p><ul><li>Enter a Shift name of &ldquo;<em>West Coast</em>&rdquo;</li><li>Time Zone set to &ldquo;<em>US/Pacific</em>&rdquo;</li><li>Each user is on duty from &ldquo;<em>Monday through Friday from 9.00am to 5.00pm</em>&rdquo;</li><li>Handoff happens every &ldquo;<em>5 days</em>&rdquo;</li><li>The next handoff happens - Select the next Monday using the calendar</li><li>Click <strong>Save Shift</strong></li></ul><p><a href=#R-image-c4e2068bddcbf3c0f7f959506b0bcc43 class=lightbox-link><img alt="West Coast Shift" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/west-coast-shift.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c4e2068bddcbf3c0f7f959506b0bcc43><img alt="West Coast Shift" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/west-coast-shift.png></a></p><p>You will again be prompted to add Members to this shift; add the West Coast members who are <strong>Maximo Arciniega, Michael Scott and Tuco Salamanca</strong>, but only if you&rsquo;re using the Observability Workshop Org for this workshop.</p><p>If you&rsquo;re using your own Organisation refer to the specific list provided separately.</p><p><a href=#R-image-979a54145c230bb1c16f76449200bf4d class=lightbox-link><img alt="West Coast Members" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/west-coast-members.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-979a54145c230bb1c16f76449200bf4d><img alt="West Coast Members" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/west-coast-members.png></a></p><p>The first user added will be the &lsquo;current&rsquo; user for that shift.</p><p>You can re-order the shifts by simply dragging the users up and down, and you can change the current user by clicking <code>Set Current</code> on an alternate user</p><p>You will now have three different Shift patterns, that provide cover 24hr hours, Mon - Fri, but with no cover at weekends.</p><p>We will now add another Rotation for our Senior SRE Escalation cover.</p><hr><h2 id=2-senior-sre-escalation>2. Senior SRE Escalation</h2><ul><li>Click <strong>Add Rotation</strong></li><li>Enter a name of &ldquo;<em>Senior SRE Escalation</em>&rdquo;</li><li>Select <code>24/7</code> from the three available shift templates</li><li>Enter a Shift name of &ldquo;<em>Senior SRE Escalation</em>&rdquo;</li><li>Time Zone set to &ldquo;<em>Asia/Tokyo</em>&rdquo;</li><li>Handoff happens every &ldquo;<em>7 days at 9.00am</em>&rdquo;</li><li>The next handoff happens [select the next Monday from the date picker]</li><li>Click <strong>Save Rotation</strong></li></ul><p><a href=#R-image-edf25c1c9e171403b62f7ab481b58d02 class=lightbox-link><img alt="24/7 Shift" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/24-7-shift.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-edf25c1c9e171403b62f7ab481b58d02><img alt="24/7 Shift" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/24-7-shift.png></a></p><p>You will again be prompted to add Members to this shift; add the 24/7 members who are <strong>Jack Welker, Hank Schrader and Pam Beesly</strong>, but only if you&rsquo;re using the Observability Workshop Org for this workshop.</p><p>If you&rsquo;re using your own Organisation refer to the specific list provided separately.</p><p><a href=#R-image-14aa53a136c4a970b9e31961281cb9db class=lightbox-link><img alt="24/7 Members" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/24-7-members.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-14aa53a136c4a970b9e31961281cb9db><img alt="24/7 Members" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/24-7-members.png></a></p><hr><p>Please wait for the instructor before proceeding to the Configuring Escalation Policies module.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=configure-escalation-policies>Configure Escalation Policies</h1><h2 id=aim>Aim</h2><p>Escalation policies determine who is actually on-call for a given team and are the link to utilizing any rotations that have been created.</p><p>The aim of this module is for you to create three different Escalation Policies to demonstrate a number of different features and operating models.</p><p>The instructor will start by explaining the concepts before you proceed with the configuration.</p><hr><p>Navigate to the Escalation Polices tab on the Teams sub menu, you should have no existing Polices so we need to create some.</p><p><a href=#R-image-c3d927c2896364628370a209aab2f164 class=lightbox-link><img alt="No Escalation Policies" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/no-escalation.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c3d927c2896364628370a209aab2f164><img alt="No Escalation Policies" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/no-escalation.png></a></p><p>We are going to create the following Polices to cover off three typical use cases.</p><p><a href=#R-image-3b6ffa336cef3e9c3938b7add5086344 class=lightbox-link><img alt="Escalation Policies" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/escalation-policies.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3b6ffa336cef3e9c3938b7add5086344><img alt="Escalation Policies" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/escalation-policies.png></a></p><h2 id=1-247-policy>1. 24/7 Policy</h2><p>Click <strong>Add Escalation Policy</strong></p><ul><li>Policy Name: 24/7</li><li>Step 1</li><li>Immediately<ul><li>Notify the on-duty user(s) in rotation → Senior SRE Escalation</li><li>Click <strong>Save</strong></li></ul></li></ul><p><a href=#R-image-36e3db900483fb434a6d01548b941996 class=lightbox-link><img alt="24/7 Escalation Policy " class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/24-7-escalation-policy.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-36e3db900483fb434a6d01548b941996><img alt="24/7 Escalation Policy " class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/24-7-escalation-policy.png></a></p><h2 id=2-primary-policy>2. Primary Policy</h2><p>Click <strong>Add Escalation Policy</strong></p><ul><li>Policy Name: Primary</li><li>Step 1</li><li>Immediately</li><li>Notify the on-duty user(s) in rotation → Follow the Sun Support - Business Hours</li><li>Click <strong>Add Step</strong></li></ul><p><a href=#R-image-15afc47de9194a9a5fda930daff249f7 class=lightbox-link><img alt="Pri Escalation Policy Step 1" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/pri-escalation-policy-step-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-15afc47de9194a9a5fda930daff249f7><img alt="Pri Escalation Policy Step 1" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/pri-escalation-policy-step-1.png></a></p><ul><li>Step 2</li><li>If still un-acknowledged after 15 minutes</li><li>Notify the next user(s) in the current on-duty shift → Follow the Sun Support - Business Hours</li><li>Click <strong>Add Step</strong></li></ul><p><a href=#R-image-95fcbc3a5fc2beef0ca8ee5c9e00fdf3 class=lightbox-link><img alt="Pri Escalation Policy Step 2" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/pri-escalation-policy-step-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-95fcbc3a5fc2beef0ca8ee5c9e00fdf3><img alt="Pri Escalation Policy Step 2" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/pri-escalation-policy-step-2.png></a></p><ul><li>Step 3</li><li>If still un-acknowledged after 15 more minutes</li><li>Execute Policy → [Your Team Name] : 24/7</li><li>Click <strong>Save</strong></li></ul><p><a href=#R-image-78a0890f5a18cb7b87c1d1cdaf189969 class=lightbox-link><img alt="Pri Escalation Policy Step 3" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/pri-escalation-policy-step-3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-78a0890f5a18cb7b87c1d1cdaf189969><img alt="Pri Escalation Policy Step 3" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/pri-escalation-policy-step-3.png></a></p><h2 id=3-waiting-room-policy>3. Waiting Room Policy</h2><p>Click <strong>Add Escalation Policy</strong></p><ul><li>Policy Name: Waiting Room</li><li>Step 1</li><li>If still un-acknowledged after 10 more minutes</li><li>Execute Policy → [Your Team Name] : Primary</li><li>Click <strong>Save</strong></li></ul><p><a href=#R-image-d208525bc7fe1f704da07064fedcc76a class=lightbox-link><img alt="WR Escalation Policy" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/wr-escalation-policy.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d208525bc7fe1f704da07064fedcc76a><img alt="WR Escalation Policy" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/wr-escalation-policy.png></a></p><p>You should now have the following three escalation polices:</p><p><a href=#R-image-71091a3c51db76ba03bda467e2163bfd class=lightbox-link><img alt="Escalation Policies" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/escalation-policies.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-71091a3c51db76ba03bda467e2163bfd><img alt="Escalation Policies" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/escalation-policies.png></a></p><p>You may have noticed that when we created each policy there was the following warning message:</p><details open class="box cstyle notices warning"><summary class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>There are no routing keys for this policy - it will only receive incidents via manual reroute or when on another escalation policy</p></div></details><p>This is because there are no Routing Keys linked to these Escalation Polices, so now that we have these polices configured we can create the Routing Keys and link them to our Polices..</p><hr><p>Continue and also complete the <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/getting_started/routing/index.html>Creating Routing Keys</a> module.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=creating-routing-keys>Creating Routing Keys</h1><h2 id=aim>Aim</h2><p>Routing Keys map the incoming alert messages from your monitoring system to an Escalation Policy which in turn sends the notifications to the appropriate team.</p><p>Note that routing keys are case insensitive and should only be composed of letters, numbers, hyphens, and underscores.</p><p>The aim of this module is for you to create some routing keys and then link them to your Escalation Policies you have created in the previous exercise.</p><hr><h2 id=1-instance-id>1. Instance ID</h2><p>Each participant requires a unique Routing Key so we use the Hostname of the EC2 Instance you were allocated. We are only doing this to ensure your Routing Key is unique and we know all Hostnames are unique. In a production deployment the Routing Key would typically reflect the name of a System or Service being monitored, or a Team such as 1st Line Support etc.</p><p>Your welcome e-mail informed you of the details of your EC2 Instance that has been provided for you to use during this workshop and you should have logged into this as part of the 1st exercise.</p><p>The e-mail also contained the Hostname of the Instance, but you can also obtain it from the Instance directly. To get your Hostname from within the shell session connected to your Instance run the following command:</p><div class=tab-panel data-tab-group=2355fa4a37c89830a61021dc5caac93b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=export-hostname class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2355fa4a37c89830a61021dc5caac93b","export-hostname")'>
<span class=tab-nav-text>Export Hostname</span>
</button>
<button data-tab-item=example-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2355fa4a37c89830a61021dc5caac93b","example-output")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div data-tab-item=export-hostname class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=si>${</span><span class=nv>HOSTNAME</span><span class=si>}</span></span></span></code></pre></div></div></div><div data-tab-item=example-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>zevn</span></span></code></pre></div></div></div></div></div><p>It is very important that when creating the Routing Keys you use the 4 letter hostname allocated to you as a Detector has been configured within Splunk Infrastructure Monitoring using this hostname, so any deviation will cause future exercises to fail.</p><h2 id=2-create-routing-keys>2 Create Routing Keys</h2><p>Navigate to <strong>Settings</strong> on the main menu bar, you should now be at the <strong>Routing Keys</strong> page.</p><p>You are going to create the following two Routing Keys using the naming conventions listed in the following table, but replacing {==HOSTNAME==} with the value from above and replace <strong><code>TEAM_NAME</code></strong> with the team you were allocated or created earlier.</p><table><thead><tr><th style=text-align:left>Routing Key</th><th style=text-align:left>Escalation Policies</th></tr></thead><tbody><tr><td style=text-align:left><strong><code>HOSTNAME</code></strong>_PRI</td><td style=text-align:left><strong><code>TEAM_NAME</code></strong> : Primary</td></tr><tr><td style=text-align:left><strong><code>HOSTNAME</code></strong>_WR</td><td style=text-align:left><strong><code>TEAM_NAME</code></strong> : Waiting Room</td></tr></tbody></table><p>There will probably already be a number of Routing Keys configured, but to add a new one simply scroll to the bottom of the page and then click <strong>Add Key</strong></p><p>In the left hand box, enter the name for the key as per the table above. In the <strong>Routing Key</strong> column, select your Teams <strong>Primary</strong> policy from the drop down in the <strong>Escalation Polices</strong> column. You can start typing your Team Name to filter the results.</p><p><a href=#R-image-7a1b9883a61833c91a0fd785faea506d class=lightbox-link><img alt="Add Routing Key" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/routing-key-add.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a1b9883a61833c91a0fd785faea506d><img alt="Add Routing Key" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/routing-key-add.png></a></p><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>If there are a large number of participants on the workshop, resulting in an unusually large number of Escalation Policies sometimes the search filter does not list all the Policies under your Team Name. If this happens instead of using the search feature, simply scroll down to your team name, all the policies will then be listed.</p></div></details><p>Repeat the above steps for both Keys, <strong><code>xxxx_PRI</code></strong> and <strong><code>xxxx_WR</code></strong>, mapping them to your Teams Primary and Waiting Room policies.</p><p>You should now have two Routing Keys configured, similar to the following:</p><p><a href=#R-image-c6dfa5c2f184f49908f47a9ccf29096c class=lightbox-link><img alt="Routing Keys" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/routing-keys.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c6dfa5c2f184f49908f47a9ccf29096c><img alt="Routing Keys" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/routing-keys.png></a></p><details open class="box cstyle notices tip"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>You can assign a Routing Key to multiple Escalation Policies if required by simply selecting more from the list</p></div></details><p>If you now navigate back to <strong>Teams → [Your Team Name] → Escalation Policies</strong> and look at the settings for your <strong>Primary</strong> and <strong>Waiting Room</strong> polices you will see that these now have <strong>Routes</strong> assigned to them.</p><p><a href=#R-image-1d5cd720bcdbf501a545a4220880bfc3 class=lightbox-link><img alt="Routing Keys Assigned" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/routing-keys-assigned.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1d5cd720bcdbf501a545a4220880bfc3><img alt="Routing Keys Assigned" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/routing-keys-assigned.png></a></p><p>The <strong>24/7</strong> policy does not have a Route assigned as this will only be triggered via an <strong>Execute Policy</strong> escalation from the <strong>Primary</strong> policy.</p><hr><p>Please wait for the instructor before proceeding to the Incident Lifecycle/Overview module.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=incident-lifecycle>Incident Lifecycle</h1><h2 id=aim>Aim</h2><p>The aim of this module is for you to get more familiar with the Timeline Tab and the filtering features.</p><h2 id=1-timeline>1. Timeline</h2><p>The aim of Splunk On-Call is to make being on call more bearable, and it does this by getting the critical data, to the right people, at the right time.</p><p>The key to making it work for you is to centralize all your alerting sources, sending them all to the Splunk On-Call platform, then you have a single pane of glass in which to manage all of your alerting.</p><p>Login to the Splunk On-Call UI and select the <strong>Timeline</strong> tab on the main menu bar, you should have a screen similar to the following image:</p><p><a href=#R-image-7000edc099c6902412d605df76bfc7b0 class=lightbox-link><img alt="Splunk On-Call UI" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/m7-vo-ui.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7000edc099c6902412d605df76bfc7b0><img alt="Splunk On-Call UI" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/m7-vo-ui.png></a></p><h2 id=2-people>2. People</h2><p>On the left we have the <strong>People</strong> section with the <strong>Teams</strong> and <strong>Users</strong> sub tabs. On the <strong>Teams</strong> tab, click on <strong>All Teams</strong> then expand <em><strong>[Your Team name]</strong></em>.</p><p>Users with the Splunk On-Call Logo against their name are currently on call. Here you can see who is on call within a particular Team, or across all Teams via <strong>Users → On-Call</strong>.</p><p>If you click into one of the currently on call users, you can see their status. It shows which Rotation they are on call for, when their current Shift ends and their next Shift starts (times are displayed in your time zone), what contact methods they have and which Teams they belong to (dummy users such as Hank do not have Contact Methods configured).</p><p><a href=#R-image-4159a0e22e6ee8b9f16fc0d291527da3 class=lightbox-link><img alt="User Detail" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/m7-user-detail.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4159a0e22e6ee8b9f16fc0d291527da3><img alt="User Detail" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/m7-user-detail.png></a></p><h2 id=3-timeline>3. Timeline</h2><p>In the centre <strong>Timeline</strong> section you get a realtime view of what is happening within your environment with the newest messages at the top. Here you can quickly post update messages to make your colleagues aware of important developments etc.</p><p>You can filter the view using the buttons on the top toolbar showing only update messages, GitHub integrations, or apply more advanced filters.</p><p>Lets change the Filters settings to streamline your view. Click the <strong>Filters</strong> button then within the <strong>Routing Keys</strong> tab change the <strong>Show</strong> setting from <strong>all routing keys</strong> to <strong>selected routing keys</strong>. Change the <strong>My Keys</strong> value to <strong>all</strong> and the <strong>Other Keys</strong> value to <strong>selected</strong> and deselect all keys under the Other Keys section.</p><p>Click anywhere outside of the dialogue box to close it.</p><p><a href=#R-image-6ae8bba20a24ba24e9996348cee71bcf class=lightbox-link><img alt="Timeline Filters" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/m7-timeline-filters.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6ae8bba20a24ba24e9996348cee71bcf><img alt="Timeline Filters" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/m7-timeline-filters.png></a></p><p>You will probably now have a much simpler view as you will not currently have Incidents created using your Routing Keys, so you are left with the other types of messages that the Timeline can display.</p><p>Click on <strong>Filters</strong> again, but this time switch to the <strong>Message Types</strong> tab. Here you control the types of messages that are displayed.</p><p>For example, deselect <strong>On-call Changes</strong> and <strong>Escalations</strong>, this will reduce the amount of messages displayed.</p><p><a href=#R-image-6378c987e60561688b8872eb491ed4e3 class=lightbox-link><img alt="Timeline Filters Message Types" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../images/m7-timeline-filters-message-types.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6378c987e60561688b8872eb491ed4e3><img alt="Timeline Filters Message Types" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../images/m7-timeline-filters-message-types.png></a></p><h2 id=4-incidents>4. Incidents</h2><p>On the right we have the <strong>Incidents</strong> section. Here we get a list of all the incidents within the platform, or we can view a more specific list such as incidents you are specifically assigned to, or for any of the Teams you are a member of.</p><p>Select the <strong>Team Incidents</strong> tab you should find that the <strong>Triggered</strong>, <strong>Acknowledged</strong> & <strong>Resolved</strong> tabs are currently all empty as you have had no incidents logged.</p><p>Let&rsquo;s change that by generating your first incident!</p><p>Continue with the <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/incident_lifecycle/create_incidents/index.html>Create Incidents</a> module.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. Incident Lifecycle</h1><article class=default><header class=headline></header><h1 id=create-incidents>Create Incidents</h1><h2 id=aim>Aim</h2><p>The aim of this module is for you to place yourself &lsquo;On-Call&rsquo; then generate an Incident using the supplied EC2 Instance so you can then work through the lifecycle of an Incident.</p><hr><h2 id=1-on-call>1. On-Call</h2><p>Before generating any incidents you should assign yourself to the current Shift within your <strong>Follow the Sun Support - Business Hours</strong> Rotation and also place yourself <strong>On-Call</strong>.</p><ul><li>Click on the <strong>Schedule</strong> link within your <strong>Team</strong> in the <strong>People</strong> section on the left, or navigate to <strong>Teams → [Your Team] → Rotations</strong></li><li>Expand the <strong>Follow the Sun Support - Business Hours</strong> Rotation</li><li>Click on the <strong>Manage members</strong> icon (the figures) for the current active shift depending on your time zone
<a href=#R-image-5753f8297172ba42413d0bc60be10c09 class=lightbox-link><img alt="Manage Members" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/manage-members.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5753f8297172ba42413d0bc60be10c09><img alt="Manage Members" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/manage-members.png></a></li><li>Use the <strong>Select a user to add&mldr;</strong> dropdown to add yourself to the shift</li><li>Then click on <strong>Set Current</strong> next to your name to make yourself the current <strong>on-call</strong> user within the shift</li><li>You should now get a <strong>Push Notification</strong> to your phone informing you that <strong>You Are Now On-Call</strong>
<a href=#R-image-51775a544ac29df8b9234a16dea2c08b class=lightbox-link><img alt="On Duty" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/on-duty.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-51775a544ac29df8b9234a16dea2c08b><img alt="On Duty" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/on-duty.png></a></li></ul><h2 id=2-trigger-alert>2. Trigger Alert</h2><p>Switch back to your shell session connected to your EC2 Instance; all of the following commands will be executed from your Instance.</p><p>Force the CPU to spike to 100% by running the following command:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>openssl speed -multi $(grep -ci processor /proc/cpuinfo)</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Forked child 0
</span></span><span class=line><span class=cl>+DT:md4:3:16
</span></span><span class=line><span class=cl>+R:19357020:md4:3.000000
</span></span><span class=line><span class=cl>+DT:md4:3:64
</span></span><span class=line><span class=cl>+R:14706608:md4:3.010000
</span></span><span class=line><span class=cl>+DT:md4:3:256
</span></span><span class=line><span class=cl>+R:8262960:md4:3.000000
</span></span><span class=line><span class=cl>+DT:md4:3:1024</span></span></code></pre></div><p>This will result in an Alert being generated by Splunk Infrastructure Monitoring which in turn will generate an Incident within Splunk On-Call within a maximum of 10 seconds. This is the default polling time for the OpenTelemetry Collector installed on your instance (note it can be reduced to 1 second).</p><hr><p>Continue with the <a href=/observability-workshop/v5.76/en/unsupported-field-workshops/10-oncall/incident_lifecycle/manage_incidents/index.html>Manage Incidents</a> module.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=manage-incidents>Manage Incidents</h1><h2 id=1-acknowledge>1. Acknowledge</h2><p>Use your Splunk On-Call App on your phone to acknowledge the Incident by clicking on the <strong>push notification</strong> &mldr;</p><p><a href=#R-image-1e89a6895814e8a41f3ca1baa2420048 class=lightbox-link><img alt="Push Notification" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/mobile-notification.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1e89a6895814e8a41f3ca1baa2420048><img alt="Push Notification" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/mobile-notification.png></a></p><p>&mldr;to open the alert in the Splunk On-Call mobile app, then clicking on either the <strong>single tick</strong> in the top right hand corner, or the <strong>Acknowledge</strong> link to acknowledge the incident and stop the escalation process.</p><p>The :fontawesome-solid-check: will then transform into a :fontawesome-solid-check::fontawesome-solid-check:, and the status will change from <strong>TRIGGERED</strong> to <strong>ACKNOWLEDGED</strong>.</p><table><thead><tr><th style=text-align:left>Triggered Incident</th><th style=text-align:left>Acknowledge Incident</th></tr></thead><tbody><tr><td style=text-align:left><a href=#R-image-631a0d8861aa1e4ff29eac9bd6daf2e5 class=lightbox-link><img alt="Acknowledge Alert" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/phone-annotations.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-631a0d8861aa1e4ff29eac9bd6daf2e5><img alt="Acknowledge Alert" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/phone-annotations.png></a></td><td style=text-align:left><a href=#R-image-34c2c5c984b8943c856bb337220f71fc class=lightbox-link><img alt="Alert Acknowledged" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/phone-alert-acknowledged.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-34c2c5c984b8943c856bb337220f71fc><img alt="Alert Acknowledged" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/phone-alert-acknowledged.png></a></td></tr></tbody></table><h2 id=2-details-and-annotations>2. Details and Annotations</h2><p>Still on your phone, select the Alert Details tab. Then on the Web UI, navigate back to <strong>Timeline</strong>, select <strong>Team Incidents</strong> on the right, then select <strong>Acknowledged</strong> and click into the new <strong>Incident</strong>, this will open up the War Room Dashboard view of the Incident.</p><p>You should now have the <strong>Details</strong> tab displayed on both your Phone and the Web UI. Notice how they both show the exact same information.</p><p>Now select the <strong>Annotations</strong> tab on both the Phone and the Web UI, you should have a <strong>Graph</strong> displayed in the UI which is generated by Splunk Infrastructure Monitoring.</p><p><a href=#R-image-fb6f9e3017b5d52c58aaeecffde05acb class=lightbox-link><img alt="UI Annotations" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/ui-annotations.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fb6f9e3017b5d52c58aaeecffde05acb><img alt="UI Annotations" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/ui-annotations.png></a></p><p>On your phone you should get the same image displayed (sometimes it&rsquo;s a simple hyperlink depending on the image size)</p><p><a href=#R-image-35df95f846643cd3e7f22591d41f511d class=lightbox-link><img alt="Phone Link" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/phone-annotations.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-35df95f846643cd3e7f22591d41f511d><img alt="Phone Link" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/phone-annotations.png></a></p><p>Splunk On-Call is a &lsquo;Mobile First&rsquo; platform meaning the phone app is full functionality and you can manage an incident directly from your phone.</p><p>For the remainder of this module we will focus on the Web UI however please spend some time later exploring the phone app features.</p><h2 id=3-link-to-alerting-system>3. Link to Alerting System</h2><p>Sticking with the Web UI, click the <strong>2. Alert Details in SignalFx</strong> link.</p><p><a href=#R-image-2373d9c4eb889ade726ac8233a7bee74 class=lightbox-link><img alt="Alert Details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/alert-details-in-sfx.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2373d9c4eb889ade726ac8233a7bee74><img alt="Alert Details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/alert-details-in-sfx.png></a></p><p>This will open a new browser tab and take you directly to the Alert within Splunk Infrastructure Monitoring where you could then progress your troubleshooting using the powerful tools built into its UI.</p><p><a href=#R-image-31226d887ec83810e017eb65f34dc5de class=lightbox-link><img alt="SFX Alert Details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/sfx-alert-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-31226d887ec83810e017eb65f34dc5de><img alt="SFX Alert Details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/sfx-alert-details.png></a></p><p>However, we are focussing on Splunk On-Call so close this tab and return to the Splunk On-Call UI.</p><h2 id=4-similar-incidents>4. Similar Incidents</h2><p>What if Splunk On-Call could identify previous incidents within the system which may give you a clue to the best way to tackle this incident.</p><p>The <strong>Similar Incidents</strong> tab does exactly that, surfacing previous incidents allowing you to look at them and see what actions were taken to resolve them, actions which could be easily repeated for this incident.</p><p><a href=#R-image-a581d7a1ef047ff5689b8ada57f8c8ee class=lightbox-link><img alt="Similar Incidents" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/similar-incidents.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a581d7a1ef047ff5689b8ada57f8c8ee><img alt="Similar Incidents" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/similar-incidents.png></a></p><h2 id=5-timeline>5 Timeline</h2><p>On right we have a Time Line view where you can add messages and see the history of previous alerts and interactions.</p><p><a href=#R-image-125f7a91df503e655d25c44918c42e1e class=lightbox-link><img alt="Incident View" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/war-room-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-125f7a91df503e655d25c44918c42e1e><img alt="Incident View" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/war-room-dashboard.png></a></p><h2 id=6-add-responders>6 Add Responders</h2><p>On the far left you have the option of allocating additional resources to this incident by clicking on the <strong>Add Responders</strong> link.</p><p><a href=#R-image-676b83864a87cdffd318be9415387b1e class=lightbox-link><img alt=add-responders class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/add-responders.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-676b83864a87cdffd318be9415387b1e><img alt=add-responders class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/add-responders.png></a></p><p>This allows you build a virtual team specific to this incident by adding other Teams or individual Users, and also share details of a <strong>Conference Bridge</strong> where you can all get together and collaborate.</p><p><a href=#R-image-d706a4ee9d5aee26f7ba7ea442ca14f1 class=lightbox-link><img alt="Conference Bridge" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/conference-bridge.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d706a4ee9d5aee26f7ba7ea442ca14f1><img alt="Conference Bridge" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/conference-bridge.png></a></p><p>Once the system has built up some incident data history, it will use Machine Learning to suggest Teams and Users who have historically worked on similar incidents, as they may be best placed to help resolve this incident quickly.</p><p>You can select different Teams and/or Users and also choose from a pre-configured conference bridge, or populate the details of a new bridge from your preferred provider.</p><p>We do not need to add any Responders in this exercise so close the <strong>Add Responders</strong> dialogue by clicking <strong>Cancel</strong>.</p><h2 id=7-reroute>7 Reroute</h2><p>If it&rsquo;s decided that maybe the incident could be better dealt with by a different Team, the call can be <strong>Rerouted</strong> by clicking the <strong>Reroute</strong> Button at the top of the left hand panel.</p><p><a href=#R-image-e47ee2966b1a1e69746916ba12f5ac8a class=lightbox-link><img alt=Reroute class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/reroute1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e47ee2966b1a1e69746916ba12f5ac8a><img alt=Reroute class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/reroute1.png></a></p><p>In a similar method to that used in the Add Responders dialogue, you can select Teams or Users to Reroute the Incident to.</p><p><a href=#R-image-deae05643c78ba52755cb9eddf0ebeb4 class=lightbox-link><img alt="Reroute Incident" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/reroute2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-deae05643c78ba52755cb9eddf0ebeb4><img alt="Reroute Incident" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/reroute2.png></a></p><p>We do not need to actually Reroute in this exercise so close the <strong>Reroute Incident</strong> dialogue by clicking <strong>Cancel</strong>.</p><h2 id=8-snooze>8 Snooze</h2><p>You can also <strong>snooze</strong> this incident by clicking on the <strong>alarm clock</strong> Button at the top of the left hand panel.</p><p><a href=#R-image-2c9c92fb154456bb2a642e6e014e1750 class=lightbox-link><img alt=Snnoze class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/snooze1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2c9c92fb154456bb2a642e6e014e1750><img alt=Snnoze class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/snooze1.png></a></p><p>You can enter an amount of time upto 24 hours to snooze the incident. This action will be tracked in the Timeline, and when the time expires the paging will restart.</p><p>This is useful for low priority incidents, enabling you to put them on a back burner for a few hours, but it ensures they do not get forgotten thanks to the paging process starting again.</p><p><a href=#R-image-b3c013512b266fcf04699d7493f22a8f class=lightbox-link><img alt="Snooze Incident" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/snooze2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b3c013512b266fcf04699d7493f22a8f><img alt="Snooze Incident" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/snooze2.png></a></p><p>We do not need to actually Snooze in this exercise so close the <strong>Snooze Incident</strong> dialogue by clicking <strong>Cancel</strong>.</p><h2 id=9-action-tracking>9 Action Tracking</h2><p>Now lets fix this issue and update the Incident with what we did. Add a new message at the top of the right hand panel such as <strong>Discovered rogue process, terminated it</strong>.</p><p><a href=#R-image-0cf5bd0140a15933de901cd898974cd9 class=lightbox-link><img alt="Add Message" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/time-line-update-message.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0cf5bd0140a15933de901cd898974cd9><img alt="Add Message" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/time-line-update-message.png></a></p><p>All the actions related to the Incident will be recorded here, and can then be summarized is a <strong>Post Incident Review Report</strong> available from the <strong>Reports</strong> tab</p><h2 id=10-resolution>10 Resolution</h2><p>Now kill off the process we started in the VM to max out the CPU by switching back the Shell session for the VM and pressing <strong>ctrl+c</strong></p><p>Within no more than 10 seconds SignalFx should detect the new CPU value, clear the alert state in SignalFx, then automatically update the Incident in VictorOps marking it as <strong>Resolved</strong>.</p><p><a href=#R-image-c49b1f6b6b44525b3a875d6abc105bd1 class=lightbox-link><img alt=Resolved class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/m7-resolved.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c49b1f6b6b44525b3a875d6abc105bd1><img alt=Resolved class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/m7-resolved.png></a></p><p>As we have two way integration between Splunk Infrastructure Monitoring and Splunk On-Call we could have also marked the incident as Resolved in Splunk On-Call, and this would have resulted in the alert in Splunk Infrastructure Monitoring being resolved as well.</p><hr><p>That completes this introduction to Splunk On-Call!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section></section></section></section></div></main></div><script src=/observability-workshop/v5.76/js/clipboard.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/perfect-scrollbar.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/d3/d3-color.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/d3/d3-dispatch.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/d3/d3-drag.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/d3/d3-ease.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/d3/d3-interpolate.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/d3/d3-selection.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/d3/d3-timer.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/d3/d3-transition.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/d3/d3-zoom.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/js-yaml.min.js?1737480558 defer></script><script src=/observability-workshop/v5.76/js/mermaid.min.js?1737480558 defer></script><script>window.themeUseMermaid=JSON.parse("{}")</script><script src=/observability-workshop/v5.76/js/theme.js?1737480558 defer></script></body></html>